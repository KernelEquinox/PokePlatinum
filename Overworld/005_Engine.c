//----- (021D0D80) --------------------------------------------------------
int __fastcall Function_21d0d80_MainLoopFct(int a1)
{
  int v1;
  int v2;
  int v3;

  v1 = a1;
  Function_201c2b8(*(uint *)(a1 + 8));
  Function_201dcac();
  Function_200a858();
  v2 = GetSpriteListAdr18(*(uint *)(v1 + 56));
  v3 = LoadSpriteList_18_e0(v2);
  return Function_2020d68(v3);
}

//----- (021D0DA4) --------------------------------------------------------
int __fastcall OverWorldEngine_Init(int a1, int *a2)
{
  int *v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  ushort *v13;
  int v14;
  int v15;
  int v16;
  int v17;

  v2 = a2;
  v3 = 0;
  v4 = LoadPtrToOverWorldDataIn18(a1);
  v5 = *v2;
  v6 = v4;
  if ( (uint)*v2 <= 3 )
  {
    v7 = 2 * v5 + 35458494;
    JUMPOUT(__CS__, *(short *)(v7 + 6) + 35458502);
  }
  switch ( (uchar)v5 )
  {
    case 0:
      SetMainLoopFunctionCall(0, 0);
      Function_20177a4();
      REG_BLDCNT = 0;
      REG_BLDCNT_SUB = 0;
      Function_200f32c(0);
      Function_200f32c(1);
      Function_21d173c(v6);
      Function_20531a0(v6);
      if ( **(uint **)(v6 + 116) << 8 >> 28 )
      {
        LoadOverlay(6, 2, v8, v9);
        v10 = Function_21d1178(v6);
        if ( v10 )
        {
          if ( v10 == 1 )
          {
            LoadOverlay(7, 2, v11, v12);
          }
          else if ( v10 == 2 )
          {
            LoadOverlay(9, 2, v11, v12);
          }
        }
        else
        {
          LoadOverlay(8, 2, v11, v12);
        }
      }
      Function_2017fc8(3, 4, *(uint *)(*(uint *)(v6 + 116) + 4));
      if ( *(uint *)(v6 + 4) )
        ErrorHandler();
      v13 = (ushort *)malloc(4u, 40);
      *(uint *)(v6 + 4) = v13;
      MI_CpuFill8(v13, 0, 0x28u);
      *(uint *)(*(uint *)(v6 + 4) + 4) = CallocInitOverWorldTaskList(v6, 4, 8);
      InitBanks();
      Function_201dbec(128, 4u);
      Function_2020b90(4, 4u);
      v14 = Function_201caf4(4u);
      v15 = Function_21d15b4(v14);
      Function_21d154c(v15);
      Function_201ffe8();
      *(uint *)(v6 + 8) = Function_2018340(4u);
      Function_21d1444();
      Function_205d8cc(0, 1);
      Function_203f5c0(v6, 4);
      break;
    case 1:
      Function_21d1790();
      LoadAreaData(*(uint *)(v6 + 48));
      *(uint *)(v6 + 164) = Function_21e15f4(4);
      Function_21f0824(v6);
      Function_21d17ec(v6);
      Function_21d1878(v6);
      Function_21d1968(v6);
      if ( *(uint *)(*(uint *)(v6 + 4) + 12) )
      {
        v16 = LoadVariableAreaAdress_6(*(uint *)(v6 + 12));
        v17 = GetVariableAreaAdress_6_66(v16);
        Function_5_21d5f24(*(uint *)(*(uint *)(v6 + 4) + 12), v17);
      }
      Function_20556a0(v6, **(uint **)(v6 + 28));
      Function_203f5c0(v6, 3);
      *(uint *)(*(uint *)(v6 + 4) + 28) = Function_21ef3a8(4);
      Function_5_21ef3dc(*(uint *)(*(uint *)(v6 + 4) + 28));
      *(uint *)(*(uint *)(v6 + 4) + 32) = Function_21ef4bc(4, *(uint *)(*(uint *)(v6 + 4) + 28));
      break;
    case 2:
      Function_21d5bd8();
      break;
    case 3:
      if ( Function_21d5bf4() )
      {
        v3 = 1;
        *(uint *)(v6 + 104) = 1;
      }
      break;
    default:
      break;
  }
  ++*v2;
  return v3;
}

//----- (021D0F68) --------------------------------------------------------
BOOL __fastcall OverWorldEngine_Loop(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;

  v1 = LoadPtrToOverWorldDataIn18(a1);
  if ( Function_21d119c() )
  {
    Function_2055d94(v1, v2, v3, v4);
    Function_21d13b4_EnteringOtherArea(v1);
    Function_5_21ea714(v1);
    Function_21d11cc(v1);
  }
  Function_21d134c(v1, *(uint *)(v1 + 192) & 0xFF);
  return *(uint *)(v1 + 104) == 0;
}

//----- (021D0FB4) --------------------------------------------------------
int __fastcall OverWorldEngine_End(int a1, int *a2)
{
  int *v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  int v20;

  v2 = a2;
  v3 = LoadPtrToOverWorldDataIn18(a1);
  v4 = v3;
  v5 = *(uint *)(v3 + 40);
  Function_21e8188();
  v6 = *v2;
  if ( *v2 )
  {
    if ( v6 == 1 )
    {
      if ( Function_21e9300(*(uint *)(v4 + 40)) == 1 )
      {
        Function_21efa10(v4 + 48);
        Function_21e92e4(*(uint *)(v4 + 40));
        Function_21efb30(v4 + 168);
        Function_21d5ba8(v4);
        Function_5_21d5278(v4 + 76);
        Function_21e1b20(*(uint *)(v4 + 100));
        Function_21dd9c8(*(uint *)(*(uint *)(v4 + 4) + 8));
        if ( *(uint *)(*(uint *)(v4 + 4) + 12) )
          Function_21d5ef8_RemoveTask();
        Function_21ef4f8(*(uint *)(*(uint *)(v4 + 4) + 32));
        Function_21ef3bc(*(uint *)(*(uint *)(v4 + 4) + 28));
        Function_2055cbc(*(uint *)(*(uint *)(v4 + 4) + 24));
        Function_21d57d8(v4 + 72);
        v8 = Function_21d5894(v4 + 68);
        Function_21d1570(v8);
        Function_21d1524(*(uint *)(v4 + 8));
        Function_21d5c14(v4);
        ++*v2;
      }
    }
    else if ( v6 == 2 && Function_21d5c30(v4) )
    {
      Function_21d15e8();
      Function_2020bd0();
      Function_201dc3c();
      Function_201cba0();
      Function_21d1ae4(*(uint *)(*(uint *)(v4 + 4) + 4));
      SetMainLoopFunctionCall(0, 0);
      free(*(uint *)(v4 + 8));
      free(*(uint *)(v4 + 4));
      *(uint *)(v4 + 4) = 0;
      Function_201807c(4);
      if ( **(uint **)(v4 + 116) << 8 >> 28 )
      {
        UnloadOverlay(6, v9, v10, v11);
        UnloadOverlay(8, v12, v13, v14);
        UnloadOverlay(7, v15, v16, v17);
        UnloadOverlay(9, v18, v19, v20);
      }
      return 1;
    }
    return 0;
  }
  Function_2068368(v4);
  Function_5_21e9338(*(uint *)(v4 + 40));
  *(uint *)(*(uint *)(v4 + 28) + 8) = GetSpritePositionX(*(uint *)(v4 + 60));
  *(uint *)(*(uint *)(v4 + 28) + 12) = GetSpritePositionY(*(uint *)(v4 + 60));
  *(uint *)(*(uint *)(v4 + 28) + 16) = GetSpriteFaceDirection(*(uint *)(v4 + 60));
  Function_21ef300(*(uint *)(v4 + 160));
  if ( !*(uint *)(v4 + 80) )
    ErrorHandler();
  Function_21e924c(*(uint *)(v4 + 40));
  Function_21d3cac(*(uint *)(v4 + 80));
  Function_21d3d7c(*(uint *)(v4 + 80));
  Function_21d41b4(v4 + 84);
  Function_21d5e8c(*(uint *)(*(uint *)(v4 + 4) + 16));
  Function_21d5eac(*(uint *)(*(uint *)(v4 + 4) + 16));
  *(uint *)(*(uint *)(v4 + 4) + 16) = 0;
  Function_2061bf0(*(uint **)(v4 + 56));
  Function_21ecc78(*(uint *)(v4 + 56));
  Function_2062c30(*(uint **)(v4 + 56));
  Function_21df500(*(uint *)(v4 + 64));
  Function_21d1a70(*(uint *)(v4 + 52));
  *(uint *)(v4 + 52) = 0;
  return Function_21e1608(*(uint *)(v4 + 164));
}

//----- (021D1178) --------------------------------------------------------
int __fastcall Function_21d1178(int a1)
{
  int v1;
  int v2;
  int v3;

  v1 = GetOverWorldData_VariableAreaAdresses(a1);
  v2 = Function_2027860(v1);
  v3 = Function_2027f80(v2);
  if ( !v3 )
    return 1;
  if ( v3 == 9 )
    return 2;
  return 0;
}

//----- (021D119C) --------------------------------------------------------
int __fastcall Function_21d119c(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;

  v1 = a1;
  v2 = GetSpritePositionX(*(uint *)(a1 + 60));
  v3 = GetSpritePositionY(*(uint *)(v1 + 60));
  v4 = *(uint *)(v1 + 28);
  if ( v2 == *(uint *)(v4 + 8) && v3 == *(uint *)(v4 + 12) )
    return 0;
  *(uint *)(v4 + 8) = v2;
  *(uint *)(*(uint *)(v1 + 28) + 12) = v3;
  return 1;
}

//----- (021D11CC) --------------------------------------------------------
int __fastcall Function_21d11cc(int a1)
{
  int v1;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  uint v8;
  int v9;
  int v10;
  ushort *v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;

  v1 = a1;
  if ( Function_21d1a78() == 1 )
    return 0;
  v3 = GetSpritePositionX(*(uint *)(v1 + 60));
  v4 = (v3 - Function_5_21ea6ac(*(uint *)(v1 + 40))) / 32;
  v5 = GetSpritePositionY(*(uint *)(v1 + 60));
  v6 = Function_5_21ea6b4(*(uint *)(v1 + 40));
  v7 = Function_2039e30(*(uchar **)(v1 + 44), v4, (v5 - v6) / 32);
  v8 = **(uint **)(v1 + 28);
  if ( v7 == v8 )
    return 0;
  v9 = LoadVariableAreaAdress_6(*(uint *)(v1 + 12));
  **(uint **)(v1 + 28) = v7;
  LoadMap_EventsWildPkmnScript(v1, v7);
  Function_20531c0(v1, 1);
  v10 = Function_203a4b4(v1);
  v11 = (ushort *)Function_203a4bc(v1);
  Function_206184c(*(uint *)(v1 + 56), v8, v7, v10, v11);
  Function_2069434(*(uint *)(v1 + 148));
  v12 = Function_2055428(v1, **(uint **)(v1 + 28));
  Function_2055554(v1, v12, 1u);
  Function_203a418(v1);
  if ( *(uint *)(*(uint *)(v1 + 4) + 12) )
  {
    v13 = GetVariableAreaAdress_6_66(v9);
    Function_5_21d5f7c(*(uint *)(*(uint *)(v1 + 4) + 12), v13);
  }
  v14 = GetMapName(v8);
  v15 = GetMapName(v7);
  v16 = GetMapNameFrame(v7);
  v17 = v16;
  if ( v14 != v15 )
  {
    if ( v16 )
      v17 = v16 - 1;
    Function_21dd9e8(*(uint *)(*(uint *)(v1 + 4) + 8), v15, v17);
  }
  return 1;
}

//----- (021D12D0) --------------------------------------------------------
int __fastcall Function_5_21d12d0(int a1, uint a2)
{
  int v2;
  uint v3;
  int v4;
  int v5;
  int v6;
  ushort *v7;
  int v8;
  int result;
  int v10;

  v2 = a1;
  v3 = a2;
  v4 = **(uint **)(a1 + 28);
  v5 = LoadVariableAreaAdress_6(*(uint *)(a1 + 12));
  **(uint **)(v2 + 28) = v3;
  LoadMap_EventsWildPkmnScript(v2, v3);
  Function_20532a8(v2, 1);
  v6 = Function_203a4b4(v2);
  v7 = (ushort *)Function_203a4bc(v2);
  Function_206184c(*(uint *)(v2 + 56), v4, v3, v6, v7);
  v8 = Function_2055428(v2, **(uint **)(v2 + 28));
  Function_2055554(v2, v8, 1u);
  Function_203a418(v2);
  result = *(uint *)(*(uint *)(v2 + 4) + 12);
  if ( result )
  {
    v10 = GetVariableAreaAdress_6_66(v5);
    result = Function_5_21d5f7c(*(uint *)(*(uint *)(v2 + 4) + 12), v10);
  }
  return result;
}

//----- (021D134C) --------------------------------------------------------
int __fastcall Function_21d134c(int a1, char a2)
{
  uint *v2;
  char v3;
  int result;

  v2 = (uint *)a1;
  v3 = a2;
  if ( !Function_20509a4(a1) )
    Function_20559dc((int)v2);
  Function_21d5298(v2[19]);
  Function_5_21e1b68(v2);
  if ( v3 & 1 )
    Function_21d5dec(*(uint *)(v2[1] + 16));
  if ( v3 & 8 )
    Function_21d3f10(v2[20]);
  if ( v3 & 2 )
  {
    Function_21e8188(v2, v2[10]);
    if ( Function_21d1a78(v2) == 1 )
      ((void (__fastcall *)(uint *))dword_224C5DC[288])(v2);
  }
  result = 4;
  if ( v3 & 4 )
    result = Function_21d15f4(v2);
  return result;
}

//----- (021D13B4) --------------------------------------------------------
uint __fastcall Function_21d13b4_EnteringOtherArea(int a1)
{
  int *v1;
  uint result;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  char v9;

  v1 = (int *)a1;
  result = IsMapMatrixEqualZero(**(uint **)(a1 + 28));
  if ( result )
  {
    v3 = LoadVariableAreaAdress_6(v1[3]);
    v4 = AddVariableAreaAdress_6_6c(v3);
    v5 = GetSpritePositionX(v1[15]);
    v6 = (v5 - Function_5_21ea6ac(v1[10])) / 32;
    v7 = GetSpritePositionY(v1[15]);
    v8 = (v7 - Function_5_21ea6b4(v1[10])) / 32;
    v9 = GetSpriteFaceDirection(v1[15]);
    result = Function_2055740(v4, v6, v8, v9);
  }
  return result;
}

//----- (021D1414) --------------------------------------------------------
char *InitBanks()
{
  int *v0;
  char *v1;
  int v2;
  int v3;
  int v4;
  char v6;

  v0 = dword_21F8988;
  v1 = &v6;
  v2 = 5;
  do
  {
    v3 = *v0;
    v4 = v0[1];
    v0 += 2;
    *(uint *)v1 = v3;
    *((uint *)v1 + 1) = v4;
    v1 += 8;
    --v2;
  }
  while ( v2 );
  return GX_SetBanks((int *)&v6);
}

//----- (021D1434) --------------------------------------------------------
int Function_5_21d1434()
{
  return Function_21d1444();
}

//----- (021D143C) --------------------------------------------------------
int __fastcall Function_5_21d143c(int a1)
{
  return Function_21d1524(a1);
}

//----- (021D1444) --------------------------------------------------------
uint __fastcall Function_21d1444(uint *a1, int a2, int a3, int a4)
{
  uint *v4;
  short v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  int v20;
  int v21;
  int v22;
  int v23;
  int v24;
  int *v25;
  int v26;
  int v27;
  int v28;
  int v29;
  int v30;
  int v31;
  int v32;

  v32 = a4;
  v4 = a1;
  v28 = 1;
  v29 = 0;
  v30 = 0;
  v31 = 1;
  SetGraphicsModes(&v28);
  v21 = 0;
  v22 = 0;
  v23 = 2048;
  v24 = 0;
  v25 = (int *)((char *)&REG_DISPCNT + 1);
  v26 = 768;
  v27 = 0;
  Function_20183c4(v4, 1u, &v21, 0);
  Function_2019690(1u, 32, 0, 4u);
  Function_2019ebc(v4, 1u);
  v14 = 0;
  v15 = 0;
  v16 = 2048;
  v17 = 0;
  v18 = 83951617;
  v19 = 769;
  v20 = 0;
  Function_20183c4(v4, 2u, &v14, 0);
  Function_2019690(2u, 32, 0, 4u);
  Function_2019ebc(v4, 2u);
  v7 = 0;
  v8 = 0;
  v9 = 2048;
  v10 = 0;
  v11 = 33685505;
  v12 = 1;
  v13 = 0;
  Function_20183c4(v4, 3u, &v7, 0);
  Function_2019690(3u, 32, 0, 4u);
  Function_2019ebc(v4, 3u);
  v6 = 0;
  DC_FlushRange(0, 2);
  return GX_LoadBGPltt((int)&v6, 0, 2u);
}

//----- (021D1524) --------------------------------------------------------
int __fastcall Function_21d1524(int a1)
{
  int v1;

  v1 = a1;
  Function_201ff0c(0xFu, 0);
  Function_2019044(v1, 1);
  Function_2019044(v1, 2);
  return Function_2019044(v1, 3);
}

//----- (021D154C) --------------------------------------------------------
uint Function_21d154c()
{
  Function_20a7944();
  return Function_200a784(0, 124, 0, 31, 0, 0x7Cu, 0, 0x1Fu, 4u);
}

//----- (021D1570) --------------------------------------------------------
int *Function_21d1570()
{
  return Function_200a878();
}

//----- (021D1578) --------------------------------------------------------
int __fastcall Function_21d1578(int a1)
{
  int v1;

  v1 = a1;
  Function_21d5adc();
  Function_21d5af0(v1, 2, 0);
  Function_21d5b04(v1, 31, 0);
  Function_21d5b18(v1, 0x8000, 1, 0);
  return Function_21d58a8(v1, 0x400000);
}

//----- (021D15B4) --------------------------------------------------------
int Function_21d15b4()
{
  int v1;
  int v2;
  int v3;
  int v4;

  v1 = 20;
  v2 = 0x8000;
  v3 = 0x4000;
  v4 = 4;
  Function_201e88c(&v1, 16, 16);
  Function_201f834(20, 4u);
  Function_201e994();
  return Function_201f8e4();
}

//----- (021D15E8) --------------------------------------------------------
int *Function_21d15e8()
{
  Function_201e958();
  return Function_201f8b4();
}

//----- (021D15F4) --------------------------------------------------------
int __fastcall Function_21d15f4(uint *a1, int a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int *v12;
  char *v13;
  int v14;
  int v15;
  int v16;
  char *v17;
  char *v18;
  int v19;
  int v20;
  int v21;
  int v22;
  int v23;
  int v24;
  int v25;
  uint v26;
  char v28;
  int v29;
  int v30;
  char v31;
  int v32;

  v32 = a4;
  v4 = a1;
  Call_G3X_Reset();
  if ( v4[8] == 1 )
  {
    v5 = Function_21d1a78(v4);
    if ( v5 == 1 )
      v5 = ((int (__fastcall *)(uint *))dword_2249BD4[242])(v4);
    Function_202049c(v5, v6, v7, v8);
  }
  else
  {
    Function_20203ec();
  }
  Function_206979c((int)v4, v9, v10, v11);
  Function_21e91fc(v4[10], v4[17]);
  if ( Function_21d1a78(v4) == 1 )
    ((void (__fastcall *)(uint *))dword_224C5DC[285])(v4);
  Function_21e1a6c(v4[41], v4[12]);
  v12 = &dword_21C5A94;
  v13 = &v31;
  v14 = 8;
  do
  {
    v15 = *v12;
    v16 = v12[1];
    v12 += 2;
    *(uint *)v13 = v15;
    *((uint *)v13 + 1) = v16;
    v13 += 8;
    --v14;
  }
  while ( v14 );
  v17 = &v31;
  v18 = &v28;
  v19 = 8;
  do
  {
    v20 = *(uint *)v17;
    v21 = *((uint *)v17 + 1);
    v17 += 8;
    *(uint *)v18 = v20;
    *((uint *)v18 + 1) = v21;
    v18 += 8;
    --v19;
  }
  while ( v19 );
  v30 += (((ll)v29 << 14) + 2048) >> 12;
  MIi_CpuCopyFast((uint *)&v28, (uint *)&dword_21C5A94, 0x40u, 0);
  dword_21C5B88 &= 0xFFFFFFAF;
  Function_20af480();
  v22 = Function_21df4f8(v4[16]);
  Function_2020c08(v22, v23, v24, v25);
  if ( Function_21d1a78(v4) == 1 )
    ((void (__fastcall *)(uint *))dword_2250780[0])(v4);
  MIi_CpuCopyFast((uint *)&v31, (uint *)&dword_21C5A94, 0x40u, v26);
  dword_21C5B88 &= 0xFFFFFFAF;
  Function_20af480();
  RunOverWorldTaskList(*(uint *)(v4[1] + 4));
  return Function_20241bc(0, 1);
}

//----- (021D16F4) --------------------------------------------------------
uint *__fastcall Function_21d16f4(int a1, int a2)
{
  int v2;
  uint *result;
  uint v4;

  if ( a2 == 1 )
  {
    v2 = *(uint *)(a1 + 192) | 4;
    result = (uint *)(a1 + 192);
    *result = v2;
  }
  else
  {
    v4 = *(uint *)(a1 + 192) & 0xFFFFFFFB;
    result = (uint *)(a1 + 192);
    *result = v4;
  }
  return result;
}

//----- (021D1718) --------------------------------------------------------
uint *__fastcall Function_21d1718(int a1, int a2)
{
  int v2;
  uint *result;
  uint v4;

  if ( a2 == 1 )
  {
    v2 = *(uint *)(a1 + 192) | 1;
    result = (uint *)(a1 + 192);
    *result = v2;
  }
  else
  {
    v4 = *(uint *)(a1 + 192) & 0xFFFFFFFE;
    result = (uint *)(a1 + 192);
    *result = v4;
  }
  return result;
}

//----- (021D173C) --------------------------------------------------------
uint *__fastcall Function_21d173c(int a1)
{
  uint *result;

  result = (uint *)(a1 + 192);
  *result = 15;
  return result;
}

//----- (021D1744) --------------------------------------------------------
int *__fastcall Function_5_21d1744(int a1)
{
  if ( a1 == 1 )
    return Function_200f174(0, 1, 1, 0, 6, 1, 4);
  if ( a1 )
    return (int *)ErrorHandler();
  return Function_200f174(0, 0, 0, 0, 6, 1, 4);
}

//----- (021D1790) --------------------------------------------------------
int __fastcall Function_21d1790(int a1)
{
  int v1;
  int v2;
  int v3;
  int result;

  v1 = a1;
  Function_201ff0c(1u, 0);
  GFX_FLUSH = 2;
  *(uint *)(v1 + 80) = Function_21d38b8();
  *(uint *)(v1 + 84) = Function_21d4194();
  v2 = GetMapAreaData(**(uint **)(v1 + 28));
  *(uint *)(v1 + 48) = Function_21ef76c_AllocOverWorldData_30(v2, *(uint *)(v1 + 80));
  v3 = Function_203a04c(**(uint **)(v1 + 28));
  if ( *(uint *)(v1 + 52) )
    ErrorHandler();
  result = Function_21d1a14(4, v3);
  *(uint *)(v1 + 52) = result;
  return result;
}

//----- (021D17EC) --------------------------------------------------------
int __fastcall Function_21d17ec(int a1, int a2, int a3, int a4)
{
  int v4;
  int v6;
  int v7;
  int v8;
  int v9;

  v9 = a4;
  v4 = a1;
  *(uint *)(v4 + 40) = Function_21e9084(
                           *(uint *)(a1 + 44),
                           *(uint *)(v4 + 48),
                           *(uint *)(v4 + 80),
                           *(uint *)(v4 + 96));
  if ( Function_21d1a78(v4) == 1 )
  {
    v8 = 0;
    v7 = 0;
    v6 = 0;
    ((void (__fastcall *)(uint, int *, int *, int *))dword_2251094[0])(**(uint **)(v4 + 28), &v8, &v7, &v6);
    Function_5_21ea678(*(uint *)(v4 + 40), v8, v7, v6);
    Function_5_21ea6a4(*(uint *)(v4 + 40), 1);
    Function_5_21ea6d0(*(uint *)(v4 + 40), 1);
  }
  *(uint *)(v4 + 160) = Function_21ef28c(8, 4);
  *(uint *)(v4 + 168) = Function_21efb0c();
  if ( !*(uint *)(v4 + 112) )
    Function_21e9630(*(uint *)(v4 + 40), Function_21f0030, v4);
  return Function_21e9150(
           *(uint *)(v4 + 40),
           *(uint *)(*(uint *)(v4 + 28) + 8),
           *(uint *)(*(uint *)(v4 + 28) + 12));
}

//----- (021D1878) --------------------------------------------------------
int __fastcall Function_21d1878(int a1)
{
  int v1;
  int v2;
  int *v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int result;

  v1 = a1;
  *(uint *)(a1 + 64) = Function_21df440();
  v2 = 80;
  if ( Function_21d1a78(v1) == 1 )
    v2 = 112;
  Function_21df47c(*(uint *)(v1 + 64), v2);
  Function_21df488(*(uint *)(v1 + 64), 4);
  if ( (uint)(*(uint *)(v1 + 112) - 1) <= 1 )
    Function_2062ccc(*(uint **)(v1 + 56), 0);
  if ( *(uint *)(v1 + 112) == 1 )
  {
    v3 = dword_21FF7D0;
  }
  else if ( Function_21d1a78(v1) == 1 )
  {
    v3 = dword_21FF6B8;
  }
  else
  {
    v3 = dword_21FF744;
  }
  Function_21df4c8(*(uint *)(v1 + 64), v3);
  v4 = 10;
  if ( *(uint *)(v1 + 112) == 2 )
    v4 = 5;
  v5 = Function_21d1a6c(*(uint *)(v1 + 52));
  v6 = Function_21d1a68(*(uint *)(v1 + 52));
  Function_21ecc20(*(uint *)(v1 + 56), 32, v5 + 3, v6, v4);
  Function_21f1328(*(uint *)(v1 + 64));
  v7 = GetOverWorldData_VariableAreaAdresses(v1);
  v8 = Function_2027860(v7);
  v9 = Function_2027f80(v8);
  Function_205e884(*(uint *)(v1 + 60), v9);
  Function_2061c48(*(uint **)(v1 + 56));
  Function_20595a4();
  Function_2062c3c(*(uint **)(v1 + 56));
  v10 = Function_205eafc(*(uint *)(v1 + 60));
  Function_5_21e931c(v10, *(uint *)(v1 + 40));
  result = Function_2055c8c(v1, 4u);
  *(uint *)(*(uint *)(v1 + 4) + 24) = result;
  return result;
}

//----- (021D1968) --------------------------------------------------------
int __fastcall Function_21d1968(uint *a1)
{
  uint *v1;
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;

  v1 = a1;
  Function_201ff0c(1u, 1);
  v2 = Function_201ffd0();
  v3 = Function_21d5878(v2);
  v1[17] = v3;
  v4 = Function_21d1578(v3);
  v1[18] = Function_21d57bc(v4);
  v5 = LoadVariableAreaAdress_6(v1[3]);
  v6 = GetVariableAreaAdress_6_6a(v5);
  v7 = Function_205eafc(v1[15]);
  Function_21d5b40(v7, v1, v6, 1);
  v8 = Function_21efad8(v1[12]);
  v1[19] = Function_5_21d521c(v1[17], v8);
  if ( Function_21d1a78(v1) == 1 )
    *(uint *)(v1[1] + 12) = 0;
  else
    *(uint *)(v1[1] + 12) = Function_21d5eb8(v1);
  *(uint *)(v1[1] + 8) = Function_21dd98c(v1[2]);
  v1[25] = Function_21e1b08(4);
  *(uint *)(v1[1] + 16) = Function_21d5cb0();
  v9 = Function_21efa8c(v1[12]);
  Function_21d5ce4(*(uint *)(v1[1] + 16), v9);
  Function_2068344((int)v1);
  Function_21ee7c0(v1);
  return SetMainLoopFunctionCall((int)Function_21d0d80_MainLoopFct, (int)v1);
}

//----- (021D1A14) --------------------------------------------------------
ushort *__fastcall Function_21d1a14(uint a1, int a2)
{
  int v2;
  uint v3;
  ushort *v4;
  int v5;
  int v6;
  ushort *v7;
  int v8;
  ushort *v9;
  ushort *v10;

  v2 = a2;
  v3 = a1;
  v4 = (ushort *)malloc(a1, 100);
  v5 = LoadFromNARC_4(96, v2, v3);
  v6 = 0;
  v7 = v4;
  do
  {
    ++v6;
    *((uint *)v7 + 1) = 0xFFFF;
    v7 += 2;
  }
  while ( v6 < 24 );
  v8 = 0;
  v9 = (ushort *)v5;
  v10 = v4;
  do
  {
    *((uint *)v10 + 1) = *v9;
    if ( *v9 == 0xFFFF )
      break;
    ++v8;
    ++v9;
    v10 += 2;
  }
  while ( v8 < 24 );
  *v4 = v8;
  free(v5);
  return v4;
}

//----- (021D1A68) --------------------------------------------------------
int __fastcall Function_21d1a68(int a1)
{
  return a1 + 4;
}

//----- (021D1A6C) --------------------------------------------------------
int __fastcall Function_21d1a6c(ushort *a1)
{
  return *a1;
}

//----- (021D1A70) --------------------------------------------------------
uint __fastcall Function_21d1a70(int a1)
{
  return free(a1);
}

//----- (021D1A78) --------------------------------------------------------
BOOL __fastcall Function_21d1a78(int a1)
{
  int v1;
  int v2;

  v1 = GetOverWorldData_VariableAreaAdresses(a1);
  v2 = Function_2027860(v1);
  return Function_2027f80(v2) == 9;
}

//----- (021D1A94) --------------------------------------------------------
uint *__fastcall CallocInitOverWorldTaskList(int a1, uint a2, int a3)
{
  uint v3;
  int v4;
  int v5;
  uint *v6;
  uint *v7;
  int v8;

  v3 = a2;
  v4 = a1;
  v5 = a3;
  v6 = (uint *)malloc(a2, 20);
  v7 = v6;
  *v6 = v4;
  v6[1] = v3;
  v6[2] = v5;
  v6[3] = malloc(v3, 20 * v5);
  MIi_CpuClear32(0, (uint *)v7[3], 20 * v5);
  v8 = GetAllocSizeForTasks(v5);
  v7[4] = malloc(v3, v8);
  v7[4] = InitTaskList(v5, v7[4]);
  return v7;
}

//----- (021D1AE4) --------------------------------------------------------
uint __fastcall Function_21d1ae4(uint *a1)
{
  uint *v1;
  int v2;
  int v3;

  v1 = a1;
  v2 = 0;
  if ( a1[2] > 0 )
  {
    v3 = 0;
    do
    {
      Function_5_21d1bec(v1[3] + v3);
      ++v2;
      v3 += 20;
    }
    while ( v2 < v1[2] );
  }
  free(v1[3]);
  free(v1[4]);
  return free((int)v1);
}

//----- (021D1B18) --------------------------------------------------------
int __fastcall RunOverWorldTaskList(int a1)
{
  return RunTasks(*(uint **)(a1 + 16));
}

//----- (021D1B24) --------------------------------------------------------
int __fastcall Function_21d1b24(int a1, int **a2)
{
  int **v2;
  int result;
  int (__fastcall *v4)(int **, int, int *);

  v2 = a2;
  result = Function_203cd5c(**a2);
  if ( result )
  {
    result = (int)v2[3];
    v4 = *(int (__fastcall **)(int **, int, int *))(result + 16);
    if ( v4 )
      result = v4(v2, **v2, v2[4]);
  }
  return result;
}

//----- (021D1B48) --------------------------------------------------------
int __fastcall Function_21d1b48(int a1, int **a2)
{
  int **v2;
  int result;
  int (__fastcall *v4)(int **, int, int *);

  v2 = a2;
  result = Function_203cd5c(**a2);
  if ( result )
  {
    result = (int)v2[3];
    v4 = *(int (__fastcall **)(int **, int, int *))(result + 20);
    if ( v4 )
      result = v4(v2, **v2, v2[4]);
  }
  return result;
}

//----- (021D1B6C) --------------------------------------------------------
uint *__fastcall Function_5_21d1b6c(uint *a1, int a2)
{
  uint *v2;
  int v3;
  int v4;
  int v5;
  uint *v6;
  void (__fastcall *v7)(uint *, uint, uint);
  uint *result;

  v2 = a1;
  v3 = a1[2];
  v4 = a2;
  v5 = 0;
  v6 = (uint *)a1[3];
  if ( v3 <= 0 )
  {
LABEL_13:
    ErrorHandler();
    result = 0;
  }
  else
  {
    while ( v6[1] )
    {
      ++v5;
      v6 += 5;
      if ( v5 >= v3 )
        goto LABEL_13;
    }
    v6[1] = AddTaskToTaskList1((int)Function_21d1b24, (int)v6, *(uint *)v4);
    v6[2] = AddTaskToTaskList(v2[4], (int)Function_21d1b48, (int)v6, *(uint *)v4);
    *v6 = v2;
    v6[3] = v4;
    if ( !v6[1] )
      ErrorHandler();
    if ( !v6[2] )
      ErrorHandler();
    if ( *(ushort *)(v4 + 4) )
      v6[4] = malloc(v2[1], *(ushort *)(v4 + 4));
    v7 = *(void (__fastcall **)(uint *, uint, uint))(v4 + 8);
    if ( v7 )
      v7(v6, *v2, v6[4]);
    result = v6;
  }
  return result;
}

//----- (021D1BEC) --------------------------------------------------------
int __fastcall Function_5_21d1bec(int result)
{
  int v1;
  void (*v2)(void);
  int v3;
  int v4;

  v1 = result;
  if ( *(uint *)(result + 4) )
  {
    v2 = *(void (**)(void))(*(uint *)(result + 12) + 12);
    if ( v2 )
    {
      v3 = *(uint *)(result + 16);
      v4 = **(uint **)result;
      v2();
    }
    if ( *(ushort *)(*(uint *)(v1 + 12) + 4) )
      free(*(uint *)(v1 + 16));
    Call_RemoveTaskFromTaskList(*(int **)(v1 + 4));
    Call_RemoveTaskFromTaskList(*(int **)(v1 + 8));
    result = MIi_CpuClear32(0, (uint *)v1, 20);
  }
  return result;
}

//----- (021D1C2C) --------------------------------------------------------
int __fastcall Function_5_21d1c2c(int a1)
{
  return *(uint *)(a1 + 16);
}

//----- (021D1C30) --------------------------------------------------------
int __fastcall Function_21d1c30(int result)
{
  *(ushort *)result &= 0xFFFEu;
  *(ushort *)result &= 0xFFFDu;
  *(ushort *)result &= 0xFFFBu;
  *(ushort *)result &= 0xFFF7u;
  *(ushort *)result &= 0xFFEFu;
  *(ushort *)result &= 0xFFDFu;
  *(ushort *)result &= 0xFFBFu;
  *(ushort *)result &= 0xFF7Fu;
  *(ushort *)result &= 0xFEFFu;
  *(ushort *)result &= 0xFDFFu;
  *(ushort *)result &= 0xFBFFu;
  *(ushort *)result &= 0xF7FFu;
  *(uchar *)(result + 2) = -1;
  *(uchar *)(result + 3) = -1;
  return result;
}

//----- (021D1CAC) --------------------------------------------------------
int __fastcall Function_21d1cac(int a1, int a2, int a3, short a4)
{
  int v4;
  int v5;
  int v6;
  short v7;
  int v8;
  int result;
  int v10;
  int v11;

  v4 = a2;
  v5 = a1;
  v6 = a3;
  v7 = a4;
  Function_21d1c30(a1);
  v11 = Function_205eb14(*(uint *)(v4 + 60));
  v10 = Function_205eb0c(*(uint *)(v4 + 60));
  v8 = GetSpriteFaceDirection(*(uint *)(v4 + 60));
  *(ushort *)(v5 + 4) = v6;
  *(ushort *)(v5 + 6) = v7;
  if ( v11 == 3 || !v11 )
  {
    if ( v6 & 0x400 )
      *(ushort *)v5 |= 4u;
    if ( v6 & 0x800 )
      *(ushort *)v5 |= 8u;
    if ( v6 & 1 )
      *(ushort *)v5 = *(ushort *)v5 & 0xFFFE | 1;
    if ( v6 & 2 )
      *(ushort *)v5 |= 0x80u;
    if ( v7 & 0xF0 )
      *(ushort *)v5 |= 0x10u;
    if ( v7 & 0xF0 )
      *(ushort *)v5 |= 0x20u;
  }
  if ( v11 == 3 && v10 == 1 )
    *(ushort *)v5 |= 0x40u;
  if ( v11 == 3 )
    *(ushort *)v5 |= 2u;
  if ( !v8 && v7 & 0x40 || v8 == 1 && v7 & 0x80 || v8 == 2 && v7 & 0x20 || v8 == 3 && v7 & 0x10 )
    *(uchar *)(v5 + 3) = v8;
  else
    *(uchar *)(v5 + 3) = -1;
  result = Function_2061308(*(uint *)(v4 + 60), v6, v7);
  *(uchar *)(v5 + 2) = result;
  return result;
}

//----- (021D1DA4) --------------------------------------------------------
int __fastcall Function_5_21d1da4(ushort *a1, int a2, int a3, int a4)
{
  ushort *v4;
  int *v5;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  bool v19;
  uint *v20;
  int v21;
  int v22;
  ushort v23;
  uint v24;
  uint v25;
  ushort *v26;
  int v27;
  int v28;
  int v29;
  int v30;
  uchar v31;
  int v32;
  int v33;
  int v34;
  int v35;
  int v36;
  int v37;
  int v38;

  v38 = a4;
  v4 = a1;
  v5 = (int *)a2;
  if ( !(*a1 & 0x800) && Function_203f5c0(a2, 1) == 1 )
    return 1;
  if ( !(*v4 & 0x800) )
  {
    v7 = LoadPokePartyAdress(v5[3]);
    v8 = Function_2054ab0(v7);
    v9 = LoadFlagAdress(v5[3]);
    if ( Function_206a984(v9) == 1 )
      v8 = 1;
    if ( Function_2067a84((int)v5, v8, v10, v11) == 1
      || Function_2071cb4((int)v5, 2) == 1 && ((int (__fastcall *)(int *))dword_224C1C8[213])(v5) == 1 )
    {
      Function_205f56c(v5[15]);
      Function_2062c48(v5[14]);
      return 1;
    }
  }
  if ( *v4 & 0x40 )
  {
    v12 = LoadFlagAdress(v5[3]);
    Function_206a9a4(v12);
    if ( Function_21d2884(v5) == 1 )
      return 1;
  }
  if ( !(*v4 & 0x800) )
  {
    v13 = 0;
    v14 = Function_2061308(v5[15], (ushort)v4[2], v4[3]);
    v15 = LoadFlagAdress(v5[3]);
    if ( Function_206aeac(v15, 2) )
      v13 = 1;
    v16 = LoadPokePartyAdress(v5[3]);
    if ( Function_20549a0(v16, 127) != 255 )
      v13 |= 2u;
    if ( Function_2071cb4((int)v5, 9) == 1 && ((int (__fastcall *)(int *))dword_2250D18[151])(v5) == 1 )
      v13 |= 4u;
    if ( Function_21dfde0(v5, v5[15], v14, v13) == 1 )
      return 1;
  }
  if ( *v4 & 2 )
  {
    if ( Function_21d249c(v5) )
      return 1;
    if ( Function_21d20dc(v5) == 1 )
      return 1;
    if ( Function_2071cb4((int)v5, 9) == 1 )
    {
      v17 = *((char *)v4 + 2);
      if ( v17 == -1 )
        v17 = GetSpriteFaceDirection(v5[15]);
      if ( ((int (__fastcall *)(int *, int))dword_224A67C[0])(v5, v17) == 1 )
        return 1;
    }
  }
  if ( *v4 & 0x10 && *((uchar *)v4 + 2) == GetSpriteFaceDirection(v5[15]) && Function_21d20dc(v5) == 1 )
    return 1;
  if ( *v4 & 1 )
  {
    if ( Function_2071cb4((int)v5, 9) == 1 )
      v18 = Function_21d2ea4(v5, &v37);
    else
      v18 = Function_203ca40((int)v5, &v37);
    v19 = v18 == 1;
    v20 = (uint *)v5[15];
    if ( v19 )
    {
      if ( Function_205f588((int)v20) == 1 )
      {
        v21 = GetSpriteFaceDirection(v5[15]);
        Function_205f5e4(v5[15], v21);
      }
      if ( GetSpriteTrainer(v37) == 9 )
      {
        Function_203e880((int)v5, 0, v37);
      }
      else
      {
        v22 = v37;
        v23 = GetSpriteScript(v37);
        Function_203e880((int)v5, v23, v22);
      }
      return 1;
    }
    v24 = Function_205f108(v20);
    v25 = v24;
    if ( v24 <= 1 )
    {
      v26 = (ushort *)Function_203a440((int)v5);
      v27 = Function_203a448((int)v5);
      v29 = Function_203ca6c((int)v5, v26, v27, v28);
      if ( v29 != 0xFFFF )
      {
        Function_203e880((int)v5, (ushort)v29, 0);
        return 1;
      }
    }
    if ( !v25 && Function_21efb40(v5, &v36) )
    {
      Function_203e880((int)v5, (ushort)v36, 0);
      return 1;
    }
    v30 = Function_205eaa0((uint *)v5[15]);
    v31 = Function_20616f0((uint *)v5[15], v30);
    v32 = Function_21d271c(v5, v31);
    if ( v32 != 0xFFFF )
    {
      Function_203e880((int)v5, (ushort)v32, 0);
      return 1;
    }
    v33 = GetSpriteFaceDirection(v5[15]);
    Function_21d2c98(v5, &v35, &v34);
    if ( Function_21f8410(v5, v35, v34, v33) == 1 )
      return 1;
  }
  if ( *v4 & 0x20 )
  {
    if ( Function_2071cb4((int)v5, 9) == 1 )
    {
      ((void (__fastcall *)(int *, uint))dword_224A800[0])(v5, *((char *)v4 + 3));
    }
    else if ( Function_21d2504(v5, v4) == 1 )
    {
      Function_21d2e14(v5);
      return 1;
    }
  }
  if ( *v4 & 8 && Function_2069238((int)v5) == 1 )
    return 1;
  if ( !(*v4 & 4) || Function_203a9c8((int)v5) != 1 )
    return 0;
  Function_2005748(0x5FDu);
  Function_203a9e0((int)v5);
  return 1;
}

//----- (021D20DC) --------------------------------------------------------
int __fastcall Function_21d20dc(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  ushort v6;
  int result;
  int v8;
  int v9;
  int v10;
  int v11;

  v11 = a4;
  v4 = a1;
  if ( Function_203cbe0(a1, &v11) == 1 )
  {
    v5 = v11;
    v6 = GetSpriteScript(v11);
    Function_203e880(v4, v6, v5);
    result = 1;
  }
  else
  {
    v8 = Function_203a440(v4);
    v9 = Function_203a448(v4);
    v10 = Function_203cb80(v4, v8, v9);
    if ( v10 == 0xFFFF )
    {
      result = 0;
    }
    else
    {
      Function_203e880(v4, (ushort)v10, 0);
      result = 1;
    }
  }
  return result;
}

//----- (021D213C) --------------------------------------------------------
int __fastcall Function_21d213c(short *a1, int a2)
{
  short *v2;
  int result;
  int v4;
  short v5;

  v2 = a1;
  if ( !(*a1 & 0x800) && Function_203f5c0(a2, 1) == 1 )
    return 1;
  if ( Function_20363a0() )
    return 0;
  v4 = Function_203608c();
  if ( Function_20593cc(v4) )
    return 0;
  ((void (*)(void))dword_2242814[0])();
  v5 = *v2;
  if ( *v2 & 1 )
  {
    ((void (__fastcall *)(uint, int))dword_2242828[2])(0, v5 & 1);
    result = 0;
  }
  else
  {
    if ( v5 & 4 )
      ((void (*)(void))dword_22427F4[1])();
    else
      ((void (*)(void))dword_2242458[0])();
    result = 0;
  }
  return result;
}

//----- (021D219C) --------------------------------------------------------
int __fastcall Function_21d219c(int a1, int a2, int a3, int a4)
{
  ushort *v4;
  int v5;
  int v6;
  int result;
  int v8;
  int v9;
  int v10;
  ushort v11;
  int v12;

  v12 = a4;
  v4 = (ushort *)a1;
  v5 = a2;
  if ( *(ushort *)a1 & 0x20 && *(uchar *)(a1 + 3) == 1 && (v6 = Function_21d2cfc(a2), Function_205db1c(v6)) )
  {
    Function_203e880(v5, 0x238Du, 0);
    result = 1;
  }
  else if ( Function_20363a0() || (v8 = Function_203608c(), Function_20593cc(v8)) || !Function_2059d2c() )
  {
    result = 0;
  }
  else if ( *v4 & 1 && Function_203ca40(v5, &v12) == 1 && GetSpriteMovement(v12) != 1 )
  {
    if ( Function_205f588(*(uint *)(v5 + 60)) == 1 )
    {
      v9 = GetSpriteFaceDirection(*(uint *)(v5 + 60));
      Function_205f5e4(*(uint *)(v5 + 60), v9);
    }
    v10 = v12;
    v11 = GetSpriteScript(v12);
    Function_203e880(v5, v11, v10);
    result = 1;
  }
  else if ( *v4 & 1 )
  {
    Function_205b2d4(v5);
    result = 1;
  }
  else if ( *v4 & 4 )
  {
    Function_2005748(0x5FDu);
    Function_203aabc(v5);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (021D2274) --------------------------------------------------------
BOOL Function_21d2274()
{
  int v0;
  int v1;

  v0 = 0;
  v1 = 1;
  do
  {
    if ( Function_2032ee8(v1) )
      ++v0;
    ++v1;
  }
  while ( v1 < 5 );
  return v0 >= 1;
}

//----- (021D2298) --------------------------------------------------------
int __fastcall Function_21d2298(ushort *a1, uint *a2, int a3, int a4)
{
  ushort *v4;
  uint *v5;
  int result;
  int v7;
  int v8;
  ushort v9;
  int v10;
  int v11;

  v11 = a4;
  v4 = a1;
  v5 = a2;
  if ( Function_20318ec() & 0xFE )
  {
    if ( Function_21d2274() && Function_2035e18() > 1 )
    {
      Function_203e880((int)v5, 5u, 0);
      result = 1;
    }
    else
    {
      result = 0;
    }
  }
  else if ( *v4 & 1 && Function_203ca40((int)v5, &v11) == 1 )
  {
    if ( Function_205f588(v5[15]) == 1 )
    {
      v7 = GetSpriteFaceDirection(v5[15]);
      Function_205f5e4(v5[15], v7);
    }
    Function_2036b84();
    v8 = v11;
    v9 = GetSpriteScript(v11);
    Function_203e880((int)v5, v9, v8);
    result = 1;
  }
  else if ( *v4 & 0x40 && (v10 = Function_21d2cfc(v5), Function_205dee4(v10)) )
  {
    Function_20545ec(v5);
    result = 1;
  }
  else if ( *v4 & 4 && Function_2035e18() <= 1 )
  {
    Function_2005748(0x5FDu);
    Function_203aa78((int)v5);
    Function_205bea8(4u);
    Function_2036ba0();
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (021D2368) --------------------------------------------------------
int __fastcall Function_21d2368(ushort *a1, int a2, int a3, int a4)
{
  ushort *v4;
  int v5;
  int v7;
  int v8;
  ushort v9;
  ushort *v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;

  v17 = a4;
  v4 = a1;
  v5 = a2;
  if ( !(*a1 & 0x800) && Function_203f5c0(a2, 1) == 1 )
    return 1;
  if ( !(*v4 & 1) )
  {
LABEL_16:
    if ( *v4 & 0x20 && Function_21d2504(v5, v4) == 1 )
      return 1;
    if ( *v4 & 8 && Function_2069238(v5) == 1 )
      return 1;
    if ( !(*v4 & 4) )
      return 0;
    Function_2005748(0x5FDu);
    Function_203a9e0(v5);
    return 1;
  }
  if ( Function_203ca40(v5, &v16) != 1 )
  {
    v10 = (ushort *)Function_203a440(v5);
    v11 = Function_203a448(v5);
    v13 = Function_203ca6c(v5, v10, v11, v12);
    if ( v13 != 0xFFFF )
    {
      Function_203e880(v5, (ushort)v13, 0);
      return 1;
    }
    v14 = Function_21d2d18(v5);
    v15 = Function_21d271c(v5, v14);
    if ( v15 != 0xFFFF )
    {
      Function_203e880(v5, (ushort)v15, 0);
      return 1;
    }
    goto LABEL_16;
  }
  if ( Function_205f588(*(uint *)(v5 + 60)) == 1 )
  {
    v7 = GetSpriteFaceDirection(*(uint *)(v5 + 60));
    Function_205f5e4(*(uint *)(v5 + 60), v7);
  }
  if ( GetSpriteTrainer(v16) == 9 )
  {
    Function_203e880(v5, 0, v16);
  }
  else
  {
    v8 = v16;
    v9 = GetSpriteScript(v16);
    Function_203e880(v5, v9, v8);
  }
  return 1;
}

//----- (021D249C) --------------------------------------------------------
BOOL __fastcall Function_21d249c(int a1)
{
  int v1;
  int v2;
  int *v3;
  int v5;
  int v6;

  v1 = a1;
  Function_21d2c7c();
  v2 = LoadFlagAdress(*(uint *)(v1 + 12));
  if ( Function_206ae8c(v2) != 1 )
    return HasMapWildPkmn(**(uint **)(v1 + 28)) && ((int (__fastcall *)(int))dword_2240D5C[0])(v1) == 1;
  if ( Function_2056374(v1, v6, v5) != 1 )
    return 0;
  v3 = (int *)Function_205639c(v1);
  Function_2051450(v1, v3);
  return 1;
}

//----- (021D2504) --------------------------------------------------------
int __fastcall Function_21d2504(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  uint v17;
  int v18;
  int v19;

  v19 = a4;
  v4 = a2;
  v5 = a1;
  if ( *(char *)(a2 + 3) == -1 )
    return 0;
  if ( Function_2071cb4(a1, 4) == 1 && ((int (__fastcall *)(int))dword_224BF2C[8])(v5) == 1 )
    return 1;
  Function_21d2c98(v5, &v16, &v15);
  if ( !Function_2054f68(v5, v16, v15, v7) )
    return 0;
  v8 = Function_21d2d34(v5, v16, v15, &v17);
  if ( v8 )
  {
    if ( *(char *)(v4 + 3) != -1 )
    {
      v10 = Function_2054f94(v5, v16, v15, v9);
      if ( Function_205daec(v10) )
      {
        v14 = *(char *)(v4 + 3);
        if ( Function_2071cb4(v5, 2) == 1 )
          ((void (__fastcall *)(int, int, int, int *))dword_224C5DC[20])(v5, v16, v15, &v14);
        Function_2056bdc(v5, v17, v18, 0, 0, v14, 1);
        return 1;
      }
    }
  }
  Function_21d2c7c(v5, &v16, &v15);
  v12 = Function_2054f94(v5, v16, v15, v11);
  if ( Function_205daf8(v12) || Function_205db28(v12) )
  {
    if ( *(uchar *)(v4 + 3) != 3 )
      return 0;
  }
  else if ( Function_205db04(v12) || Function_205db34(v12) )
  {
    if ( *(uchar *)(v4 + 3) != 2 )
      return 0;
  }
  else if ( Function_205db1c(v12) || Function_205db4c(v12) )
  {
    if ( *(uchar *)(v4 + 3) != 1 )
      return 0;
  }
  else if ( Function_205dc44(v12) )
  {
    if ( *(uchar *)(v4 + 3) != 3 )
      return 0;
  }
  else if ( Function_205dc50(v12) && *(uchar *)(v4 + 3) != 2 )
  {
    return 0;
  }
  if ( !Function_21d2d34(v5, v16, v15, &v17) )
    return 0;
  if ( Function_205daec(v12) )
  {
    v13 = 1;
LABEL_49:
    Function_2056bdc(v5, v17, v18, 0, 0, *(char *)(v4 + 3), v13);
    return 1;
  }
  if ( Function_205dc44(v12) )
  {
    v13 = 3;
    goto LABEL_49;
  }
  if ( Function_205dc50(v12) )
  {
    v13 = 3;
    goto LABEL_49;
  }
  if ( !Function_205daf8(v12)
    && !Function_205db28(v12)
    && !Function_205db04(v12)
    && !Function_205db34(v12)
    && !Function_205db1c(v12)
    && !Function_205db4c(v12) )
  {
    return 0;
  }
  Function_2056c18(v5, v17, v18, 0, 0, *(char *)(v4 + 3));
  return 1;
}

//----- (021D271C) --------------------------------------------------------
int __fastcall Function_21d271c(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v6;
  int v7;
  int v8;

  v2 = a1;
  v3 = a2;
  v4 = GetSpriteFaceDirection(*(uint *)(a1 + 60));
  if ( Function_205dbe4(v3) && !v4 )
    return 2018;
  if ( Function_205dc80(v3) )
    return 2500;
  if ( Function_205dc8c(v3) )
    return 2501;
  if ( Function_205dc98(v3) )
    return 2502;
  if ( Function_205dca4(v3) )
    return 2503;
  if ( Function_205dcb0(v3) )
    return 2504;
  if ( Function_205dcbc(v3) )
    return 2505;
  if ( Function_205dcc8(v3) )
    return 2506;
  if ( Function_205dcd4(v3) )
    return 2507;
  if ( Function_205ddb4(v3) )
    return 10006;
  if ( Function_205dbf0(v3) )
    return 2508;
  if ( Function_205ddc0(v3) )
    return 2030;
  if ( Function_205de84(v3) && !v4 )
    return 10100;
  if ( Function_21e0760(v3, v4) )
    return 10003;
  if ( Function_205eb74(*(uint *)(v2 + 60)) != 2 )
  {
    v6 = LoadTrainerDataAdress(*(uint *)(v2 + 12));
    v7 = Function_2061760(*(uint *)(v2 + 60));
    if ( Function_21e0118(*(uint *)(v2 + 60), v7, v3) )
    {
      if ( CheckBadge(v6, 3) )
      {
        v8 = LoadPokePartyAdress(*(uint *)(v2 + 12));
        if ( Function_20549a0(v8, 57) != 255 )
          return 10004;
      }
    }
  }
  return 0xFFFF;
}

//----- (021D2884) --------------------------------------------------------
int __fastcall Function_21d2884(int a1)
{
  int v1;
  int result;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;

  v1 = a1;
  if ( Function_2071cb4(a1, 3) == 1 && ((int (__fastcall *)(int))dword_224AAA8[0])(v1) )
    return 1;
  if ( Function_2071cb4(v1, 9) == 1 && ((int (__fastcall *)(int))dword_224A71C[0])(v1) == 1 )
    return 1;
  v3 = GetSpriteFaceDirection(*(uint *)(v1 + 60));
  if ( Function_21e1154(v1, *(uint *)(v1 + 60), v3) == 1 )
    return 1;
  v4 = GetSpritePositionX(*(uint *)(v1 + 60));
  v5 = GetSpritePositionY(*(uint *)(v1 + 60));
  v7 = Function_2054f94(v1, v4, v5, v6);
  if ( Function_21d29a0(v1) == 1 )
    return 1;
  if ( Function_21d29d8(v1, v4, v5, v7) == 1 )
  {
    Function_21d2e14(v1);
    result = 1;
  }
  else if ( Function_205ef58(*(uint **)(v1 + 60)) )
  {
    result = 0;
  }
  else
  {
    Function_5_21ea714(v1);
    if ( Function_21d2b94(v1) == 1 )
    {
      result = 1;
    }
    else if ( Function_21d2c14(v1) == 1 )
    {
      result = 1;
    }
    else if ( Function_21d2abc(v1) == 1 )
    {
      result = 1;
    }
    else if ( Function_21d2b08(v1) == 1 )
    {
      result = 1;
    }
    else if ( Function_21d2b14(v1) == 1 )
    {
      result = 1;
    }
    else if ( Function_21d2b20(v1) == 1 )
    {
      result = 1;
    }
    else
    {
      if ( Function_21d2b2c(v1) )
        Function_21d2b54(v1);
      v8 = LoadFlagAdress(*(uint *)(v1 + 12));
      Function_206b238(v8);
      result = 0;
    }
  }
  return result;
}

//----- (021D29A0) --------------------------------------------------------
int __fastcall Function_21d29a0(int a1)
{
  int v1;
  ushort *v2;
  int v3;
  int v4;

  v1 = a1;
  v2 = (ushort *)Function_203a4ac(a1);
  v3 = Function_203a4a4(v1);
  v4 = Function_203cc14(v1, v2, v3);
  if ( v4 == 0xFFFF )
    return 0;
  Function_203e880(v1, v4, 0);
  return 1;
}

//----- (021D29D8) --------------------------------------------------------
int __fastcall Function_21d29d8(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int result;
  int v7;
  int v8;
  int v9;
  uint v10;
  int v11;
  int v12;

  v12 = a4;
  v4 = a4;
  v5 = a1;
  if ( !Function_21d2d34(a1, a2, a3, &v10) )
    return 0;
  if ( Function_205dc2c(v4) == 1 )
  {
    v7 = GetSpriteFaceDirection(*(uint *)(v5 + 60));
    if ( v7 == 2 )
    {
      v8 = 3;
    }
    else
    {
      if ( v7 != 3 )
      {
        ErrorHandler();
        return 0;
      }
      v8 = 2;
    }
    Function_2056bdc(v5, v10, v11, 0, 0, v8, 2);
    result = 1;
  }
  else if ( Function_205dc38(v4) == 1 )
  {
    v9 = GetSpriteFaceDirection(*(uint *)(v5 + 60));
    if ( v9 == 2 || v9 == 3 )
    {
      Function_2056bdc(v5, v10, v11, 0, 0, v9, 2);
      result = 1;
    }
    else
    {
      ErrorHandler();
      result = 0;
    }
  }
  else if ( Function_205db10(v4) || Function_205db40(v4) )
  {
    Function_2056c18(v5, v10, v11, 0, 0, 0);
    result = 1;
  }
  else if ( Function_205dee4(v4) )
  {
    Function_2053f58(v5, v10, v11);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (021D2ABC) --------------------------------------------------------
int __fastcall Function_21d2abc(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;

  v1 = a1;
  v2 = LoadPokePartyAdress(*(uint *)(a1 + 12));
  v3 = LoadVariableAreaAdress_8(*(uint *)(v1 + 12));
  if ( Function_21e7154(v3, v2, v1) != 1 )
    return 0;
  v4 = LoadVariableAreaAdress_14(*(uint *)(v1 + 12));
  Function_202cf28(v4, 11);
  Function_202cfec(v4, 15);
  Function_203e880(v1, 0x7EFu, 0);
  return 1;
}

//----- (021D2B08) --------------------------------------------------------
int Function_21d2b08()
{
  Function_21dbb94();
  return 0;
}

//----- (021D2B14) --------------------------------------------------------
int __fastcall Function_21d2b14(int a1)
{
  Function_2069b98(a1);
  return 0;
}

//----- (021D2B20) --------------------------------------------------------
void __fastcall Function_21d2b20(int a1)
{
  int v1;

  v1 = *(uint *)(a1 + 12);
  JUMPOUT(&dword_2246B40[45]);
}

//----- (021D2B2C) --------------------------------------------------------
int __fastcall Function_21d2b2c(int a1)
{
  int v1;
  int v2;
  uint v3;

  v1 = 0;
  v2 = LoadFlagAdress(*(uint *)(a1 + 12));
  v3 = (Function_206b44c(v2) + 1) & 0xFFFF;
  if ( v3 >= 0x80 )
  {
    LOWORD(v3) = 0;
    v1 = 1;
  }
  Function_206b45c(v2, v3);
  return v1;
}

//----- (021D2B54) --------------------------------------------------------
uint __fastcall Function_21d2b54(int a1)
{
  int v1;
  uint *v2;
  int v3;
  uint result;
  int v5;
  int i;
  int *v7;
  int v8;

  v1 = a1;
  v2 = (uint *)LoadPokePartyAdress(*(uint *)(a1 + 12));
  v3 = (ushort)GetMapName(**(uint **)(v1 + 28));
  result = GetNrOfPkmnInParty((int)v2);
  v5 = result;
  for ( i = 0; i < v5; ++i )
  {
    v7 = GetAdrOfPkmnInParty(v2, i);
    result = Function_2075c74(v7, 5, v3, v8);
  }
  return result;
}

//----- (021D2B94) --------------------------------------------------------
int __fastcall Function_21d2b94(int a1)
{
  int v1;
  int v2;
  int v3;
  ushort *v4;
  int result;
  ushort v6;
  int v7;
  int v8;
  int v9;

  v1 = a1;
  v2 = LoadPokePartyAdress(*(uint *)(a1 + 12));
  v3 = LoadVariableAreaAdress_6(*(uint *)(v1 + 12));
  v4 = (ushort *)AddVariableAreaAdress_6_94(v3);
  ++*v4;
  *v4 &= 3u;
  if ( *v4 )
    return 0;
  v6 = GetMapName(**(uint **)(v1 + 28));
  v9 = Function_2054b04(v2, v6, v7, v8);
  switch ( v9 )
  {
    case 0:
      return 0;
    case 1:
      Function_21ef518(*(uint *)(*(uint *)(v1 + 4) + 32));
      result = 0;
      break;
    case 2:
      Function_21ef518(*(uint *)(*(uint *)(v1 + 4) + 32));
      Function_203e880(v1, 0x7D3u, 0);
      result = 1;
      break;
    default:
      result = 0;
      break;
  }
  return result;
}

//----- (021D2C14) --------------------------------------------------------
int __fastcall Function_21d2c14(int a1)
{
  int v1;
  int v2;
  int result;
  int v4;
  int v5;
  ushort *v6;

  v1 = a1;
  v2 = LoadFlagAdress(*(uint *)(a1 + 12));
  if ( !Function_206ae5c(v2) )
    return 0;
  v4 = LoadVariableAreaAdress_6(*(uint *)(v1 + 12));
  if ( *(ushort *)AddVariableAreaAdress_6_98(v4) )
  {
    v5 = LoadVariableAreaAdress_6(*(uint *)(v1 + 12));
    v6 = (ushort *)AddVariableAreaAdress_6_96(v5);
    if ( (ushort)++*v6 < 0x1F4u )
    {
      result = 0;
    }
    else
    {
      Function_203e880(v1, 0x2261u, 0);
      result = 1;
    }
  }
  else
  {
    Function_203e880(v1, 0x2262u, 0);
    result = 1;
  }
  return result;
}

//----- (021D2C7C) --------------------------------------------------------
int __fastcall Function_21d2c7c(int a1, int *a2, int *a3)
{
  int v3;
  int *v4;
  int result;

  v3 = a1;
  v4 = a3;
  *a2 = GetSpritePositionX(*(uint *)(a1 + 60));
  result = GetSpritePositionY(*(uint *)(v3 + 60));
  *v4 = result;
  return result;
}

//----- (021D2C98) --------------------------------------------------------
int __fastcall Function_21d2c98(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;
  int v6;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = GetSpriteFaceDirection(*(uint *)(a1 + 60));
  return Function_21d2cb4(v3, v6, v4, v5);
}

//----- (021D2CB4) --------------------------------------------------------
int __fastcall Function_21d2cb4(int a1, int a2, int *a3, int *a4)
{
  int *v4;
  int *v5;
  int result;

  v4 = a3;
  v5 = a4;
  result = Function_21d2c7c(a1, a3, a4);
  switch ( (uchar)result )
  {
    case 0:
      result = *v5 - 1;
      *v5 = result;
      break;
    case 1:
      result = *v5 + 1;
      *v5 = result;
      break;
    case 2:
      result = *v4 - 1;
      *v4 = result;
      break;
    case 3:
      result = *v4 + 1;
      *v4 = result;
      break;
    default:
      return result;
  }
  return result;
}

//----- (021D2CFC) --------------------------------------------------------
int __fastcall Function_21d2cfc(int a1)
{
  int v1;
  int v2;
  int v4;
  int v5;

  v1 = a1;
  Function_21d2c7c(a1, &v5, &v4);
  return Function_2054f94(v1, v5, v4, v2);
}

//----- (021D2D18) --------------------------------------------------------
int __fastcall Function_21d2d18(int a1)
{
  int v1;
  int v2;
  int v4;
  int v5;

  v1 = a1;
  Function_21d2c98(a1, (int)&v5, (int)&v4);
  return Function_2054f94(v1, v5, v4, v2);
}

//----- (021D2D34) --------------------------------------------------------
int __fastcall Function_21d2d34(int a1, int a2, int a3, uint *a4)
{
  int v4;
  int v5;
  uint *v6;
  uint v7;
  ushort *v9;
  int v10;
  int v11;
  uint *v12;
  int v13;
  uint *v14;
  int v15;
  int v16;
  int v17;
  int v18;
  uint *v19;
  int v20;
  int v21;

  v4 = a1;
  v5 = a2;
  v21 = a3;
  v6 = a4;
  v7 = Function_203a468(a1, a2, a3);
  if ( v7 == -1 )
    return 0;
  v9 = (ushort *)GetPtrToWarpData(v4, v7);
  if ( !v9 )
    return 0;
  v10 = v9[3];
  if ( v10 == 256 )
  {
    if ( v9[2] != 4095 )
      ErrorHandler();
    v11 = LoadVariableAreaAdress_6(*(uint *)(v4 + 12));
    v12 = (uint *)AddVariableAreaAdress_6_MapData3(v11);
    v13 = v12[1];
    *v6 = *v12;
    v6[1] = v13;
    v14 = v6 + 2;
    v15 = v12[3];
    *v14 = v12[2];
    v14[1] = v15;
    v14[2] = v12[4];
  }
  else
  {
    v16 = v9[1];
    v17 = *v9;
    *v6 = v9[2];
    v6[1] = v10;
    v6[2] = v17;
    v6[3] = v16;
    v6[4] = 1;
  }
  v18 = LoadVariableAreaAdress_6(*(uint *)(v4 + 12));
  v19 = (uint *)AddVariableAreaAdress_6_MapData1(v18);
  v20 = GetSpriteFaceDirection(*(uint *)(v4 + 60));
  *v19 = **(uint **)(v4 + 28);
  v19[1] = v7;
  v19[2] = v5;
  v19[3] = v21;
  v19[4] = v20;
  return 1;
}

//----- (021D2DCC) --------------------------------------------------------
int __fastcall Function_21d2dcc(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  uint *v9;
  int *v10;
  int v11;
  int v12;
  int *v13;
  int v14;
  int result;

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v7 = a4;
  v8 = LoadVariableAreaAdress_6(*(uint *)(a1 + 12));
  v9 = (uint *)AddVariableAreaAdress_6_MapData4(v8);
  v10 = *(int **)(v4 + 28);
  v11 = *v10;
  v12 = v10[1];
  v10 += 2;
  *v9 = v11;
  v9[1] = v12;
  v13 = v9 + 2;
  v14 = v10[1];
  *v13 = *v10;
  v13[1] = v14;
  v13[2] = v10[2];
  v9[4] = v7;
  v9[2] = v5;
  v9[3] = v6;
  if ( !v7 )
    ++v9[3];
  *v9 = **(uint **)(v4 + 28);
  result = -1;
  v9[1] = -1;
  return result;
}

//----- (021D2E14) --------------------------------------------------------
int __fastcall Function_21d2e14(int a1, int a2, int a3, int a4)
{
  int v4;
  int result;
  int v6;
  int v7;
  int v8;
  int v9;
  uint v10;
  int v11;

  v11 = a4;
  v4 = a1;
  Function_21d2c7c(a1, &v9, &v8);
  if ( Function_21d2d34(v4, v9, v8, &v10) )
  {
    result = IsMapMatrixEqualZero(**(uint **)(v4 + 28));
    if ( result == 1 )
    {
      result = IsMapMatrixEqualZero(v10);
      if ( !result )
      {
        v6 = GetSpriteFaceDirection(*(uint *)(v4 + 60));
        result = Function_21d2dcc(v4, v9, v8, v6);
      }
    }
  }
  else
  {
    Function_21d2c98(v4, (int)&v9, (int)&v8);
    result = Function_21d2d34(v4, v9, v8, &v10);
    if ( result )
    {
      result = IsMapMatrixEqualZero(**(uint **)(v4 + 28));
      if ( result == 1 )
      {
        result = IsMapMatrixEqualZero(v10);
        if ( !result )
        {
          v7 = GetSpriteFaceDirection(*(uint *)(v4 + 60));
          result = Function_21d2dcc(v4, v9, v8, v7);
        }
      }
    }
  }
  return result;
}

//----- (021D2EA4) --------------------------------------------------------
int __fastcall Function_21d2ea4(int a1, int *a2, int a3, int a4)
{
  int v4;
  int *v5;
  int v6;
  int v7;
  int v8;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;

  v14 = a4;
  v4 = a1;
  v13 = 0;
  v5 = a2;
  Function_20617bc(*(uint **)(a1 + 60), &v12, &v11, &v10);
  if ( !Function_20625b0(*(uint *)(v4 + 56), v5, &v13, 1) )
    return 0;
  while ( 1 )
  {
    v6 = LoadSpritePositionX(*v5);
    v7 = LoadSpritePositionZ(*v5) / 2;
    v8 = LoadSpritePositionY(*v5);
    if ( v11 == v7 && v12 == v6 && v10 == v8 )
      break;
    if ( !Function_20625b0(*(uint *)(v4 + 56), v5, &v13, 1) )
      return 0;
  }
  return 1;
}

//----- (021D2F14) --------------------------------------------------------
uint __fastcall Function_5_21d2f14(int **a1, int a2, int a3, int a4)
{
  int **v4;
  uint v5;
  short v6;
  int v7;
  int v8;
  uint v9;
  uchar **v10;
  int v11;
  char *v12;
  int *v13;
  int v14;
  int v15;
  int **v16;
  int v17;
  int v18;
  int v19;
  uint v20;
  int *v21;
  int *v22;
  int v24;
  uint v25;
  int **v26;
  uint v27;

  v4 = a1;
  v24 = a2;
  v5 = a4;
  *a1 = Function_20095c4(a3, (int)(a1 + 1), a4, a4);
  *((ushort *)v4 + 177) = v5;
  if ( *(uint *)(v24 + 16) )
    v6 = 6;
  else
    v6 = 4;
  *((ushort *)v4 + 176) = v6;
  v7 = Function_2009f34();
  v8 = malloc(v5, *((ushort *)v4 + 176) * v7);
  v27 = 0;
  v9 = *((ushort *)v4 + 176);
  if ( *((ushort *)v4 + 176) )
  {
    v10 = (uchar **)v24;
    do
    {
      v11 = Function_2009f38(v8, v27);
      v12 = (char *)Function_2017a40(v5, *v10);
      Function_2009f40(v12, v11, v5);
      free((int)v12);
      ++v10;
      ++v27;
      v9 = *((ushort *)v4 + 176);
    }
    while ( v27 < v9 );
  }
  v13 = 0;
  if ( v9 )
  {
    v26 = v4;
    do
    {
      v14 = Function_2009f38(v8, (int)v13);
      v15 = Function_2009fa4(v14);
      v26[76] = (int *)Function_2009714(v15, v13, v5);
      ++v26;
      v9 = *((ushort *)v4 + 176);
      v13 = (int *)((char *)v13 + 1);
    }
    while ( (uint)v13 < v9 );
  }
  v25 = 0;
  if ( v9 )
  {
    v16 = v4;
    do
    {
      v17 = Function_2009f38(v8, v25);
      v18 = v17;
      v19 = Function_2009fa4(v17);
      v16[82] = Function_2009cfc(v19, v5);
      Function_2009c80(v16[76], v18, v16[82], v5);
      ++v16;
      ++v25;
      v9 = *((ushort *)v4 + 176);
    }
    while ( v25 < v9 );
  }
  v20 = 0;
  if ( v9 )
  {
    do
    {
      v21 = (int *)Function_2009f38(v8, v20);
      Function_2009f8c(v21);
      ++v20;
    }
    while ( v20 < *((ushort *)v4 + 176) );
  }
  free(v8);
  Function_200a41c(v4[82]);
  Function_200a684(v4[83]);
  v22 = (int *)Function_2017a40(v5, *(uchar **)(v24 + 24));
  v4[75] = Function_2009508(v22, v5, (int)v4[76], (int)v4[77], (int)v4[78], (int)v4[79], (int)v4[80], (int)v4[81]);
  return free((int)v22);
}

//----- (021D30A8) --------------------------------------------------------
uint __fastcall Function_5_21d30a8(int **a1)
{
  int **v1;
  uint result;
  uint v3;
  int **v4;

  v1 = a1;
  Function_2021964(*a1);
  Function_20095a8(v1[75]);
  Function_200a508(v1[82]);
  Function_200a700(v1[83]);
  result = *((ushort *)v1 + 176);
  v3 = 0;
  if ( *((ushort *)v1 + 176) )
  {
    v4 = v1;
    do
    {
      Function_2009d20(v4[82]);
      Function_2009754(v4[76]);
      result = *((ushort *)v1 + 176);
      ++v3;
      ++v4;
    }
    while ( v3 < result );
  }
  return result;
}

//----- (021D3104) --------------------------------------------------------
int __fastcall Function_5_21d3104(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  short v18;
  int v19;
  int v20;
  int v21;
  int v22;

  v22 = a4;
  v4 = a2;
  v5 = *(short *)(a2 + 4) << 12;
  v6 = *(short *)(a2 + 6) << 12;
  v7 = *(short *)(a2 + 8) << 12;
  v10 = *(uint *)a1;
  v11 = **(uint **)(a1 + 300) + 36 * *(uint *)a2;
  v12 = v5;
  v13 = v6;
  v14 = v7;
  v15 = 4096;
  v16 = 4096;
  v17 = 4096;
  v18 = 0;
  v19 = *(uint *)(a2 + 12);
  v20 = *(uint *)(a2 + 20);
  v21 = *(ushort *)(a1 + 354);
  v8 = Function_2021aa0((uint **)&v10);
  if ( !v8 )
    ErrorHandler();
  Function_2021d6c(v8, *(ushort *)(v4 + 10));
  Function_2021ec4(v8, *(uint *)(v4 + 16));
  return v8;
}

//----- (021D3190) --------------------------------------------------------
uint __fastcall Function_5_21d3190(int **a1, int *a2, int a3, int a4)
{
  int **v4;
  uint v5;
  int *v6;
  int *v7;
  int **v8;
  uint result;
  int **v10;
  int *v11;
  uint v12;
  int v13;
  int *v14;
  uint v15;
  uint v16;

  v4 = a1;
  v14 = a2;
  v15 = a4;
  *a1 = Function_20095c4(a3, (int)(a1 + 1), a4, a4);
  *((ushort *)v4 + 177) = v15;
  if ( v14[4] && v14[5] )
  {
    *((ushort *)v4 + 176) = 6;
  }
  else
  {
    *((ushort *)v4 + 176) = 4;
    v4[80] = 0;
    v4[81] = 0;
  }
  v5 = *((ushort *)v4 + 176);
  v6 = 0;
  if ( *((ushort *)v4 + 176) )
  {
    v7 = v14;
    v8 = v4;
    do
    {
      v8[76] = (int *)Function_2009714(*v7, v6, v15);
      v5 = *((ushort *)v4 + 176);
      v6 = (int *)((char *)v6 + 1);
      ++v7;
      ++v8;
    }
    while ( (uint)v6 < v5 );
  }
  result = 0;
  v16 = 0;
  if ( v5 )
  {
    v10 = v4;
    do
    {
      if ( *v14 )
      {
        v10[82] = Function_2009cfc(*v14, v15);
        v11 = v10[82];
        v12 = 0;
        if ( v11[1] )
        {
          v13 = 0;
          do
          {
            ++v12;
            *(uint *)(*v11 + v13) = 0;
            v11 = v10[82];
            v13 += 4;
          }
          while ( v12 < v11[1] );
        }
      }
      ++v10;
      ++v14;
      result = ++v16;
    }
    while ( v16 < *((ushort *)v4 + 176) );
  }
  return result;
}

//----- (021D3270) --------------------------------------------------------
int __fastcall Function_5_21d3270(int a1, int a2, int a3, int a4, int a5, int a6, int a7)
{
  int v7;
  int v8;
  int v9;
  int v10;
  int *v12;
  int *v13;

  v7 = a1;
  v8 = a2;
  v9 = a3;
  v10 = a4;
  if ( !Function_2009d34(*(int **)(a1 + 308), a7) )
    return ErrorHandler();
  v12 = Function_20098b8(*(uint *)(v7 + 308), v8, v9, v10, a7, a6, a5, *(ushort *)(v7 + 354));
  v13 = v12;
  if ( !v12 )
    return ErrorHandler();
  if ( Function_200a640(v12) != 1 )
    ErrorHandler();
  Function_21d3478(*(uint *)(v7 + 332), v13);
  return Function_200a760(v13, a6);
}

//----- (021D32E8) --------------------------------------------------------
int __fastcall Function_5_21d32e8(int a1, int a2, uint a3, int a4, int a5, int a6, int a7)
{
  int v7;
  int v8;
  uint v9;
  int v10;
  int *v12;
  int *v13;

  v7 = a1;
  v8 = a2;
  v9 = a3;
  v10 = a4;
  if ( !Function_2009d34(*(int **)(a1 + 308), a7) )
    return ErrorHandler();
  v12 = Function_2009b04(*(uint *)(v7 + 308), v8, v9, v10, a7, a6, a5, *(ushort *)(v7 + 354));
  v13 = v12;
  if ( !v12 )
    return ErrorHandler();
  if ( Function_200a640(v12) != 1 )
    ErrorHandler();
  Function_21d3478(*(uint *)(v7 + 332), v13);
  return Function_200a760(v13, a6);
}

//----- (021D3360) --------------------------------------------------------
int __fastcall Function_5_21d3360(int a1, int a2)
{
  return Function_21d34ac(a1, a2);
}

//----- (021D3374) --------------------------------------------------------
int __fastcall Function_5_21d3374(int a1, int a2)
{
  return Function_21d3518(a1, a2);
}

//----- (021D3388) --------------------------------------------------------
int __fastcall Function_5_21d3388(int a1, int a2)
{
  return Function_21d34ac(a1, a2);
}

//----- (021D339C) --------------------------------------------------------
int __fastcall Function_5_21d339c(int a1, int a2)
{
  return Function_21d3518(a1, a2);
}

//----- (021D33B0) --------------------------------------------------------
int __fastcall Function_5_21d33b0(int a1, int a2, int a3, int a4, int a5, int a6)
{
  int v6;
  int v7;
  int v8;
  int v9;
  int *v11;
  int *v12;

  v6 = a1;
  v7 = a2;
  v8 = a3;
  v9 = a4;
  if ( !Function_2009d34(*(int **)(a1 + 304), a6) )
    return ErrorHandler();
  v11 = Function_200985c(*(uint *)(v6 + 304), v7, v8, v9, a6, a5, *(ushort *)(v6 + 354));
  v12 = v11;
  if ( !v11 )
    return ErrorHandler();
  Function_200a3dc(v11);
  return Function_21d3478(*(uint *)(v6 + 328), v12);
}

//----- (021D3414) --------------------------------------------------------
int __fastcall Function_5_21d3414(int a1, int a2, uint a3, int a4, int a5, int a6)
{
  int v6;
  int v7;
  uint v8;
  int v9;
  int *v11;
  int *v12;

  v6 = a1;
  v7 = a2;
  v8 = a3;
  v9 = a4;
  if ( !Function_2009d34(*(int **)(a1 + 304), a6) )
    return ErrorHandler();
  v11 = Function_2009a4c(*(uint *)(v6 + 304), v7, v8, v9, a6, a5, *(ushort *)(v6 + 354));
  v12 = v11;
  if ( !v11 )
    return ErrorHandler();
  Function_200a3dc(v11);
  return Function_21d3478(*(uint *)(v6 + 328), v12);
}

//----- (021D3478) --------------------------------------------------------
int __fastcall Function_21d3478(int a1, int a2)
{
  int v2;
  int v3;
  uint *v4;

  v2 = *(uint *)(a1 + 4);
  v3 = 0;
  if ( v2 <= 0 )
    return 0;
  v4 = *(uint **)a1;
  while ( *v4 )
  {
    ++v3;
    ++v4;
    if ( v3 >= v2 )
      return 0;
  }
  *(uint *)(*(uint *)a1 + 4 * v3) = a2;
  ++*(uint *)(a1 + 8);
  return 1;
}

//----- (021D34AC) --------------------------------------------------------
uint __fastcall Function_21d34ac(int a1, int a2, int a3, int a4, uint a5, int a6)
{
  int v6;
  int v7;
  int v8;
  int v9;
  uint result;
  int *v11;
  int v12;
  int v13;

  v6 = a1;
  v7 = a2;
  v8 = 4 * a5;
  v9 = a1 + 304;
  v12 = a3;
  v13 = a4;
  if ( !Function_2009d34(*(int **)(a1 + 304 + 4 * a5), a6) )
    return ErrorHandler();
  v11 = Function_2009918(*(uint *)(v9 + v8), v7, v12, v13, a6, a5, *(ushort *)(v6 + 354));
  if ( !v11 )
    return ErrorHandler();
  result = Function_21d3478(*(uint *)(v6 + v8 + 328), (int)v11);
  if ( result != 1 )
    result = ErrorHandler();
  return result;
}

//----- (021D3518) --------------------------------------------------------
uint __fastcall Function_21d3518(int a1, int a2, uint a3, int a4, uint a5, int a6)
{
  int v6;
  int v7;
  int v8;
  int v9;
  uint result;
  int *v11;
  uint v12;
  int v13;

  v6 = a1;
  v7 = a2;
  v8 = 4 * a5;
  v9 = a1 + 304;
  v12 = a3;
  v13 = a4;
  if ( !Function_2009d34(*(int **)(a1 + 304 + 4 * a5), a6) )
    return ErrorHandler();
  v11 = Function_2009bc4(*(uint *)(v9 + v8), v7, v12, v13, a6, a5, *(ushort *)(v6 + 354));
  if ( !v11 )
    return ErrorHandler();
  result = Function_21d3478(*(uint *)(v6 + v8 + 328), (int)v11);
  if ( result != 1 )
    result = ErrorHandler();
  return result;
}

//----- (021D3584) --------------------------------------------------------
int *__fastcall Function_5_21d3584(int a1, short *a2, int a3, int a4)
{
  int v4;
  short *v5;
  int *v6;
  int v7;
  short *v8;
  int v9;
  int *v10;
  int v11;
  int *v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  int v20;
  int v21;
  int v22;
  int v23;
  int v24;
  int v25;
  char v26;
  int v28;
  int v29;
  int v30;
  int v31;
  int v32;
  int v33;
  int v34;
  int v35;
  uint v36;
  uint v37;
  uint v38;
  int v39;
  int v40;
  int v41;
  short v42;
  int v43;
  int v44;
  int v45;
  int v46;

  v46 = a4;
  v4 = a1;
  v5 = a2;
  v6 = (int *)malloc(*(ushort *)(a1 + 354), 16);
  v6[2] = malloc(*(ushort *)(v4 + 354), 8);
  v7 = malloc(*(ushort *)(v4 + 354), 36);
  v8 = v5;
  *(uint *)v6[2] = v7;
  v9 = 0;
  v10 = &v28;
  v6[1] = *(uint *)v6[2];
  do
  {
    v11 = *((uint *)v8 + 5);
    ++v9;
    v8 += 2;
    *v10 = v11;
    ++v10;
  }
  while ( v9 < 6 );
  v12 = *(int **)(v4 + 320);
  if ( v12 && *(uint *)(v4 + 324) )
  {
    if ( v32 != -1 && !Function_2009d34(v12, v32) )
      v32 = -1;
    if ( v33 != -1 && !Function_2009d34(*(int **)(v4 + 324), v33) )
      v33 = -1;
  }
  else
  {
    v32 = -1;
    v33 = -1;
  }
  Function_20093b4(
    v6[1],
    v28,
    v29,
    v30,
    v31,
    v32,
    v33,
    *((uint *)v5 + 12),
    *((uint *)v5 + 11),
    *(uint *)(v4 + 304),
    *(uint *)(v4 + 308),
    *(uint *)(v4 + 312),
    *(uint *)(v4 + 316),
    *(uint *)(v4 + 320),
    *(uint *)(v4 + 324));
  v34 = *(uint *)v4;
  v35 = v6[1];
  v13 = *v5;
  if ( v13 <= 0 )
  {
    v16 = fflt(v13 << 12);
    v15 = fsub(v16, 1056964608);
  }
  else
  {
    v14 = fflt(v13 << 12);
    v15 = fadd(0x3F000000u, v14);
  }
  v36 = ffix(v15);
  v17 = v5[1];
  if ( v17 <= 0 )
  {
    v20 = fflt(v17 << 12);
    v19 = fsub(v20, 1056964608);
  }
  else
  {
    v18 = fflt(v17 << 12);
    v19 = fadd(0x3F000000u, v18);
  }
  v37 = ffix(v19);
  v21 = v5[2];
  if ( v21 <= 0 )
  {
    v24 = fflt(v21 << 12);
    v23 = fsub(v24, 1056964608);
  }
  else
  {
    v22 = fflt(v21 << 12);
    v23 = fadd(0x3F000000u, v22);
  }
  v38 = ffix(v23);
  if ( *((uint *)v5 + 4) == 2 )
    v37 += 786432;
  v39 = 4096;
  v40 = 4096;
  v41 = 4096;
  v42 = 0;
  v43 = *((uint *)v5 + 2);
  v44 = *((uint *)v5 + 4);
  v45 = *(ushort *)(v4 + 354);
  v25 = Function_2021aa0((uint **)&v34);
  *v6 = v25;
  if ( v25 )
  {
    v26 = Function_2021ee8(v25);
    Function_2021d6c(*v6, (ushort)v5[3]);
    Function_2021e90(*v6, v26 + *((uint *)v5 + 3));
  }
  else
  {
    ErrorHandler();
  }
  return v6;
}

//----- (021D375C) --------------------------------------------------------
uint __fastcall Function_5_21d375c(int **a1)
{
  int **v1;
  uint result;
  uint v3;
  int **v4;

  v1 = a1;
  Function_2021964(*a1);
  Function_200a508(v1[82]);
  Function_200a700(v1[83]);
  result = *((ushort *)v1 + 176);
  v3 = 0;
  if ( *((ushort *)v1 + 176) )
  {
    v4 = v1;
    do
    {
      Function_2009d20(v4[82]);
      Function_2009754(v4[76]);
      result = *((ushort *)v1 + 176);
      ++v3;
      ++v4;
    }
    while ( v3 < result );
  }
  return result;
}

//----- (021D37AC) --------------------------------------------------------
int __fastcall Function_21d37ac(uint *a1, int a2, int a3, int a4)
{
  int v4;
  uint *v5;
  int v6;
  int v7;
  int v8;
  uint *v9;
  int v11;
  uint *v12;
  uint *v13;

  v4 = a3;
  v5 = a1;
  v6 = a2;
  v7 = a4;
  if ( *(uint *)(a3 + 24) == -1 )
    ErrorHandler();
  v8 = 0;
  v9 = v5;
  do
  {
    if ( *v9 && v7 == v9[3] && v9[1] == v6 )
      return 0;
    ++v8;
    v9 += 4;
  }
  while ( v8 < 2 );
  v11 = 0;
  v12 = v5;
  while ( *v12 )
  {
    ++v11;
    v12 += 4;
    if ( v11 >= 2 )
      return 1;
  }
  v5[4 * v11] = 1;
  v13 = &v5[4 * v11];
  v13[3] = v7;
  v13[2] = v4;
  v13[1] = v6;
  return 1;
}

//----- (021D380C) --------------------------------------------------------
int __fastcall Function_21d380c(int a1, uint a2, int a3, int *a4, int a5, int (***a6)(void))
{
  int v6;
  uint v7;
  int v8;
  int *v9;
  int v10;
  uchar *v11;

  v6 = a1;
  v7 = a2;
  v8 = a3;
  v9 = a4;
  if ( a2 == -1 )
    ErrorHandler();
  v10 = Function_2006cb8_LoadFileInMemory(v6, v7, 4u);
  if ( !v10 )
    ErrorHandler();
  v11 = (uchar *)Function_20b3c5c(v10, 0);
  if ( !v11 )
    ErrorHandler();
  *v9 = Function_20b2cb4(a6, v11, v8);
  if ( !v9 )
    ErrorHandler();
  Function_20ae4f0(*v9, v11, v8, a5);
  return v10;
}

//----- (021D3868) --------------------------------------------------------
int __fastcall Function_21d3868(int *a1, int a2)
{
  if ( !a2 )
    return 0;
  if ( !a1 )
    return 0;
  Function_20ae870(a1, a2);
  return 1;
}

//----- (021D3884) --------------------------------------------------------
int __fastcall Function_21d3884(int a1)
{
  int v1;
  int v2;
  int result;

  v1 = 0;
  v2 = a1;
  do
  {
    result = *(uint *)v2;
    if ( *(uint *)v2 )
    {
      result = Function_5_21d3f70(*(uint *)(v2 + 8));
      if ( result )
      {
        result = Function_21d3868(*(int **)(v2 + 4), **(uint **)(v2 + 8));
        *(uint *)v2 = 0;
        *(uint *)(v2 + 12) = 0;
        *(uint *)(v2 + 8) = 0;
        *(uint *)(v2 + 4) = 0;
      }
    }
    ++v1;
    v2 += 16;
  }
  while ( v1 < 2 );
  return result;
}

//----- (021D38B8) --------------------------------------------------------
uint *Function_21d38b8()
{
  uint *v0;
  int v1;
  uint *v2;
  int v3;
  uint *v4;
  int v5;
  int v6;
  int v7;
  int v8;

  v0 = (uint *)malloc(4u, 696);
  v1 = 0;
  v2 = v0;
  v3 = 0;
  do
  {
    v2[5] = 0;
    v2[8] = 0;
    v2[4] = 0;
    v2[6] = 0;
    v2[7] = 0;
    v2[9] = 0;
    v2[10] = -1;
    v2[11] = 0;
    v2[12] = 0;
    v2[13] = 0;
    ++v1;
    v2 += 10;
  }
  while ( v1 < 16 );
  v4 = v0;
  do
  {
    v4[164] = 0;
    v4[165] = 0;
    v4[166] = 0;
    v4[167] = 0;
    ++v3;
    v4 += 4;
  }
  while ( v3 < 2 );
  Function_20182cc(v0, 4u, 4);
  v0[172] = LoadFromNARC_8(110, 4u, v5, v6);
  v0[173] = LoadFromNARC_8(111, 4u, v7, v8);
  return v0;
}

//----- (021D3938) --------------------------------------------------------
int __fastcall Function_21d3938(int *a1)
{
  int result;

  if ( a1 )
    result = *a1;
  else
    result = 0;
  return result;
}

//----- (021D3944) --------------------------------------------------------
int __fastcall Function_21d3944(char a1)
{
  int v1;

  v1 = 1;
  if ( (a1 & 1) != 1 )
    v1 = 0;
  return v1;
}

//----- (021D3954) --------------------------------------------------------
int __fastcall Function_21d3954(int a1)
{
  int v1;
  int result;

  v1 = a1 >> 1;
  result = 1;
  if ( (v1 & 1) != 1 )
    result = 0;
  return result;
}

//----- (021D3964) --------------------------------------------------------
int __fastcall Function_21d3964(int a1)
{
  int v1;

  v1 = a1;
  if ( *(uint *)(a1 + 4) != 1 )
    ErrorHandler();
  return *(uint *)(v1 + 28);
}

//----- (021D3978) --------------------------------------------------------
int __fastcall Function_21d3978(uint a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10)
{
  int v10;
  int v11;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  uint *v18;
  int v19;
  uint *v20;
  int v21;
  uint v22;
  char v23;
  char v24;
  char v25[36];

  v10 = a2;
  v21 = a3;
  v11 = a4;
  LoadFileFromNARCFileHandler(*(uint *)(a10 + 692), a1, (int)&v23);
  if ( v10 >= 4 )
    ErrorHandler();
  v22 = *(uint *)&v25[4 * v10];
  if ( v22 == -1 )
    return 0;
  if ( a7 != Function_21d3944(v24) )
    return 0;
  v13 = 0;
  v14 = a10;
  do
  {
    if ( v11 )
    {
      if ( v11 == *(uint *)(v14 + 52) )
        ErrorHandler();
    }
    ++v13;
    v14 += 40;
  }
  while ( v13 < 16 );
  v15 = 0;
  v16 = a10;
  do
  {
    if ( !*(uint *)(v16 + 20) )
    {
      v17 = 40 * v15;
      v18 = (uint *)(a10 + 40 * v15);
      v18[5] = 1;
      v18[8] = a6;
      *(uint *)(a10 + 16 + 40 * v15) = 0;
      v18[6] = 0;
      v18[7] = v22;
      v18[12] = a5;
      v18[13] = v11;
      v19 = Function_21d380c(*(uint *)(a10 + 688), v22, a8, (int *)(a10 + 16 + 40 * v15), a9, (int (***)(void))a10);
      v20 = (uint *)(a10 + v17);
      v20[9] = v19;
      v20[10] = v21;
      v20[11] = 1;
      Function_5_21d3e7c(a10 + 16 + v17);
      return a10 + 16 + v17;
    }
    ++v15;
    v16 += 40;
  }
  while ( v15 < 16 );
  ErrorHandler();
  return 0;
}

//----- (021D3A50) --------------------------------------------------------
int __fastcall Function_21d3a50(uint a1, int a2, int a3, int a4)
{
  int v4;
  int result;
  int v6;
  int v7;
  uint *v8;
  int v9;
  int v10;
  uchar *v11;
  int v12;
  uint v13;
  uchar v14;
  char v15;
  char v16;

  v4 = a4;
  v9 = a2;
  v10 = a3;
  LoadFileFromNARCFileHandler(*(uint *)(a4 + 692), a1, (int)&v14);
  result = v14;
  if ( v14 )
  {
    v12 = 0;
    v11 = &v14;
    do
    {
      result = *((uint *)v11 + 1);
      v13 = result;
      if ( result == -1 )
        break;
      result = Function_21d3944(v15);
      if ( result )
        break;
      v6 = 0;
      v7 = v4;
      while ( *(uint *)(v7 + 20) )
      {
        ++v6;
        v7 += 40;
        if ( v6 >= 16 )
          goto LABEL_10;
      }
      v8 = (uint *)(v4 + 40 * v6);
      v8[5] = 1;
      v8[8] = 0;
      v8[4] = 0;
      v8[6] = 0;
      v8[7] = v13;
      v8[12] = 0;
      v8[13] = 0;
      v8[9] = Function_21d380c(*(uint *)(v4 + 688), v13, v9, (int *)(v4 + 16 + 40 * v6), v10, (int (***)(void))v4);
      v8[10] = -1;
      v8[11] = 1;
      Function_5_21d3e7c(v4 + 16 + 40 * v6);
      if ( v16 )
      {
        v8[8] = 1;
        v8[10] = 1;
      }
LABEL_10:
      if ( v6 == 16 )
        ErrorHandler();
      v11 += 4;
      result = v12 + 1;
      v12 = result;
    }
    while ( result < 4 );
  }
  return result;
}

//----- (021D3B24) --------------------------------------------------------
int __fastcall Function_21d3b24(int a1, int a2, int a3, int a4, int a5)
{
  uint v5;
  int v6;
  int v7;
  int result;
  int v9;
  int v10;
  int v11;
  int v12;
  uint v13;
  char v14;
  uchar v15;
  char v16;
  char v17[16];
  int v18;

  v18 = a4;
  v5 = a1;
  v6 = a2;
  v7 = a3;
  v13 = a4;
  if ( a5 )
  {
    if ( a1 < Function_21d3f84(a5) )
    {
      LoadFileFromNARCFileHandler(*(uint *)(a5 + 692), v5, (int)&v14);
      if ( v6 >= 4 )
        ErrorHandler();
      v9 = *(uint *)&v17[4 * v6];
      if ( v9 == -1 )
      {
        result = 0;
      }
      else if ( v7 == Function_21d3954(v15) )
      {
        v10 = 0;
        v11 = a5;
        while ( v9 != *(uint *)(v11 + 28) )
        {
          ++v10;
          v11 += 40;
          if ( v10 >= 16 )
            return 0;
        }
        if ( v16 )
          v12 = Function_21d37ac((uint *)(a5 + 656), v13, a5 + 16 + 40 * v10, (uchar)v9);
        else
          v12 = 1;
        if ( v12 )
          Function_20ae77c(v13, *(uint *)(a5 + 40 * v10 + 16));
        result = 1;
      }
      else
      {
        result = 0;
      }
    }
    else
    {
      result = 0;
    }
  }
  else
  {
    ErrorHandler();
    result = 0;
  }
  return result;
}

//----- (021D3BE4) --------------------------------------------------------
int __fastcall Function_21d3be4(int a1, uint a2, int a3)
{
  int v3;
  int v4;
  char *v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  uint v13;
  char v14;
  uchar v15;
  char v16;

  v3 = a1;
  v13 = a2;
  v4 = a3;
  v11 = 0;
  if ( !a3 )
    ErrorHandler();
  if ( v3 >= Function_21d3f84(v4) )
    return 0;
  LoadFileFromNARCFileHandler(*(uint *)(v4 + 692), v3, (int)&v14);
  if ( Function_21d3954(v15) )
    return 0;
  v12 = 0;
  v6 = &v14;
  do
  {
    v7 = *((uint *)v6 + 1);
    if ( v7 == -1 )
      return v11;
    v8 = 0;
    v9 = v4;
    while ( v7 != *(uint *)(v9 + 28) )
    {
      ++v8;
      v9 += 40;
      if ( v8 >= 16 )
        goto LABEL_18;
    }
    if ( v16 )
      v10 = Function_21d37ac((uint *)(v4 + 656), v13, v4 + 16 + 40 * v8, (uchar)v7);
    else
      v10 = 1;
    if ( v10 )
    {
      Function_20ae77c(v13, *(uint *)(v4 + 40 * v8 + 16));
      v11 = 1;
    }
LABEL_18:
    v6 += 4;
    ++v12;
  }
  while ( v12 < 4 );
  return v11;
}

//----- (021D3CAC) --------------------------------------------------------
uint *__fastcall Function_21d3cac(uint *result)
{
  int v1;
  int v2;
  uint *v3;
  int v4;

  v1 = (int)result;
  if ( result )
  {
    v2 = 0;
    v3 = result;
    do
    {
      result = (uint *)v3[5];
      if ( result )
      {
        if ( result == (uint *)1 )
        {
          v4 = v3[4];
          Function_20b2cd8(v1);
          v3[4] = 0;
          free(v3[9]);
        }
        result = 0;
        v3[5] = 0;
        v3[13] = 0;
      }
      ++v2;
      v3 += 10;
    }
    while ( v2 < 16 );
  }
  return result;
}

//----- (021D3CE4) --------------------------------------------------------
int *__fastcall Function_21d3ce4(int *result, int a2)
{
  int *v2;
  int v3;
  int v4;

  v2 = result;
  v3 = a2;
  if ( a2 )
  {
    if ( !result )
      ErrorHandler();
    result = (int *)v2[1];
    if ( result )
    {
      if ( result == (int *)1 )
      {
        v4 = *v2;
        Function_20b2cd8(v3);
        *v2 = 0;
        free(v2[5]);
      }
      result = 0;
      v2[1] = 0;
      v2[9] = 0;
    }
  }
  return result;
}

//----- (021D3D18) --------------------------------------------------------
uint __fastcall Function_21d3d18(int a1, int *a2, uint a3, int a4)
{
  int v4;
  int *v5;
  int v6;
  int v7;
  uint result;
  int *v9;
  char v10;
  char v11[16];
  int v12;

  v12 = a4;
  v4 = a1;
  v5 = a2;
  v6 = a4;
  LoadFileFromNARCFileHandler(*(uint *)(a1 + 692), a3, (int)&v10);
  if ( v6 >= 4 )
    ErrorHandler();
  v7 = *(uint *)&v11[4 * v6];
  if ( v7 == -1 )
    ErrorHandler();
  result = 0;
  while ( 1 )
  {
    v9 = (int *)(v4 + 40 * result);
    if ( v9[5] == 1 && v7 == v9[7] )
      break;
    result = (result + 1) & 0xFF;
    if ( result >= 0x10 )
      return result;
  }
  return Function_21d3868(v5, v9[4]);
}

//----- (021D3D7C) --------------------------------------------------------
uint __fastcall Function_21d3d7c(uint result)
{
  int v1;

  v1 = result;
  if ( result )
  {
    Call_FS_CloseFile(*(int **)(result + 688));
    Call_FS_CloseFile(*(int **)(v1 + 692));
    result = free(v1);
  }
  return result;
}

//----- (021D3DA0) --------------------------------------------------------
int __fastcall Function_5_21d3da0(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;

  v2 = a1;
  v3 = a2;
  if ( !a1 )
    ErrorHandler();
  v4 = 0;
  v5 = 0;
  v6 = v3;
  while ( v2 != *(uint *)(v6 + 52) )
  {
    ++v5;
    v6 += 40;
    if ( v5 >= 16 )
      goto LABEL_8;
  }
  v4 = v3 + 16 + 40 * v5;
  if ( !*(uint *)(v4 + 4) )
    ErrorHandler();
LABEL_8:
  if ( !v4 )
    ErrorHandler();
  return v4;
}

//----- (021D3DE4) --------------------------------------------------------
int __fastcall Function_5_21d3de4(uint a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  char v11;
  char v12;

  v3 = a3;
  v4 = a2;
  LoadFileFromNARCFileHandler(*(uint *)(a3 + 692), a1, (int)&v11);
  if ( v4 >= 4 )
    ErrorHandler();
  v5 = 4 * v4;
  v6 = 0;
  v7 = *(uint *)(&v12 + v5);
  v8 = 0;
  v9 = v3;
  while ( v7 != *(uint *)(v9 + 28) )
  {
    ++v8;
    v9 += 40;
    if ( v8 >= 16 )
      goto LABEL_8;
  }
  v6 = v3 + 16 + 40 * v8;
  if ( !*(uint *)(v6 + 4) )
    ErrorHandler();
LABEL_8:
  if ( !v6 )
    ErrorHandler();
  return v6;
}

//----- (021D3E40) --------------------------------------------------------
int __fastcall Function_5_21d3e40(int result, int a2)
{
  *(uint *)(result + 16) = a2;
  return result;
}

//----- (021D3E44) --------------------------------------------------------
int __fastcall Function_5_21d3e44(int result)
{
  *(uint *)(result + 28) = 1;
  return result;
}

//----- (021D3E4C) --------------------------------------------------------
BOOL __fastcall Function_5_21d3e4c(int a1)
{
  int v1;
  uint *v2;
  BOOL result;

  v1 = *(uint *)(a1 + 32);
  v2 = *(uint **)a1;
  if ( v1 )
    result = *v2 == 0;
  else
    result = *v2 >= (*(ushort *)(v2[2] + 4) << 12) - 4096;
  return result;
}

//----- (021D3E7C) --------------------------------------------------------
uint *__fastcall Function_5_21d3e7c(uint *a1)
{
  uint *result;
  uint *v2;

  if ( a1[8] )
  {
    v2 = (uint *)*a1;
    result = (uint *)((*(ushort *)(*(uint *)(*a1 + 8) + 4) << 12) - 4096);
    *v2 = result;
  }
  else
  {
    result = (uint *)*a1;
    *result = 0;
  }
  return result;
}

//----- (021D3E9C) --------------------------------------------------------
uint *__fastcall Function_5_21d3e9c(uint *a1)
{
  uint *v1;
  uint *result;

  if ( a1[8] )
  {
    result = (uint *)*a1;
    *result = 0;
  }
  else
  {
    v1 = (uint *)*a1;
    result = (uint *)((*(ushort *)(*(uint *)(*a1 + 8) + 4) << 12) - 4096);
    *v1 = result;
  }
  return result;
}

//----- (021D3EBC) --------------------------------------------------------
uint *__fastcall Function_21d3ebc(uint *a1)
{
  uint *v1;
  uint *result;

  if ( a1[8] )
  {
    result = (uint *)*a1;
    if ( *result > 0 )
      *result -= 4096;
    else
      *result = (*(ushort *)(result[2] + 4) << 12) - 4096;
  }
  else
  {
    *(uint *)*a1 += 4096;
    v1 = (uint *)*a1;
    result = (uint *)(*(ushort *)(*(uint *)(*a1 + 8) + 4) << 12);
    if ( (uint *)*v1 == result )
    {
      result = 0;
      *v1 = 0;
    }
  }
  return result;
}

//----- (021D3F04) --------------------------------------------------------
int __fastcall Function_5_21d3f04(int result, int a2)
{
  *(uint *)(result + 32) = a2;
  return result;
}

//----- (021D3F08) --------------------------------------------------------
int __fastcall Function_5_21d3f08(int result, int a2)
{
  *(uint *)(result + 24) = a2;
  return result;
}

//----- (021D3F0C) --------------------------------------------------------
int __fastcall Function_5_21d3f0c(int result, int a2)
{
  *(uint *)(result + 36) = a2;
  return result;
}

//----- (021D3F10) --------------------------------------------------------
int __fastcall Function_21d3f10(int result)
{
  int v1;
  uint *v2;
  int v3;
  int v4;

  v4 = result;
  if ( result )
  {
    v1 = 0;
    v2 = (uint *)(result + 16);
    do
    {
      if ( v2[1] == 1 && v2[4] != 1 )
      {
        if ( v2[7] )
        {
          Function_21d3ebc(v2);
          if ( v2[6] != -1 )
          {
            if ( Function_5_21d3e4c((int)v2) )
            {
              v3 = v2[2] + 1;
              if ( v3 < v2[6] )
                v2[2] = v3;
              else
                v2[7] = 0;
            }
          }
        }
      }
      ++v1;
      v2 += 10;
    }
    while ( v1 < 16 );
    result = Function_21d3884(v4 + 656);
  }
  return result;
}

//----- (021D3F70) --------------------------------------------------------
BOOL __fastcall Function_5_21d3f70(int a1)
{
  return Function_21d3964(a1) == 0;
}

//----- (021D3F84) --------------------------------------------------------
int __fastcall Function_21d3f84(int a1)
{
  return Function_2006e34(*(uint *)(a1 + 692));
}

//----- (021D3F94) --------------------------------------------------------
uint __fastcall Function_21d3f94(int a1, uint a2)
{
  uint result;
  char v3;

  LoadFileFromNARCFileHandler(*(uint *)(a1 + 692), a2, (int)&v3);
  if ( !v3 )
    return 0;
  result = 0;
  do
  {
    if ( *((uint *)&v3 + result + 1) == -1 )
      break;
    result = (result + 1) & 0xFF;
  }
  while ( result < 4 );
  return result;
}

//----- (021D3FD0) --------------------------------------------------------
int __fastcall Function_21d3fd0(int a1, int a2)
{
  int v2;
  char v3;
  int v4;
  uint v5;
  int result;

  v2 = a1;
  v3 = a2;
  if ( !a2 )
    ErrorHandler();
  v4 = 16;
  v5 = 0;
  do
  {
    if ( v4 == 16 && !*(uchar *)(v2 + 56 * v5 + 52) )
      v4 = v5;
    v5 = (v5 + 1) & 0xFF;
  }
  while ( v5 < 0x10 );
  if ( v4 == 16 )
  {
    ErrorHandler();
    result = 0;
  }
  else
  {
    *(uchar *)(v2 + 56 * v4 + 52) = v3;
    result = v2 + 56 * v4;
  }
  return result;
}

//----- (021D4020) --------------------------------------------------------
int __fastcall Function_21d4020(int result)
{
  uint v1;

  v1 = 0;
  *(uchar *)(result + 52) = 0;
  *(uint *)(result + 48) = 0;
  *(uint *)(result + 44) = 0;
  do
  {
    *(uint *)(result + 4 * v1 + 20) = 0;
    v1 = (v1 + 1) & 0xFF;
  }
  while ( v1 < 6 );
  return result;
}

//----- (021D4040) --------------------------------------------------------
int __fastcall Function_21d4040(int a1, int a2)
{
  int v2;
  int v3;
  int v4;

  v2 = 0;
  v3 = 0;
  v4 = a1;
  while ( a2 != *(uchar *)(v4 + 52) )
  {
    ++v3;
    v4 += 56;
    if ( v3 >= 16 )
      return v2;
  }
  return a1 + 56 * v3;
}

//----- (021D4068) --------------------------------------------------------
uint __fastcall Function_21d4068(uint result, int a2, int a3)
{
  int v3;
  uint v4;
  int v5;

  v3 = a2;
  v4 = result;
  v5 = a3;
  if ( a2 > 4 )
    result = ErrorHandler();
  if ( v4 )
    *(uint *)(v5 + 20) = v4;
  *(uint *)(v5 + 16) = v3;
  return result;
}

//----- (021D4084) --------------------------------------------------------
int __fastcall Function_21d4084(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;
  int result;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( a2 >= *(uint *)(a1 + 16) )
    ErrorHandler();
  result = 4 * v4;
  *(uint *)(v3 + 4 * v4) = v5;
  return result;
}

//----- (021D409C) --------------------------------------------------------
int __fastcall Function_21d409c(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  uint v5;
  int v6;
  int *v7;
  int result;
  int v9;
  int v10;

  v2 = a1;
  v3 = a2;
  if ( a2 >= *(uint *)(a1 + 16) )
    ErrorHandler();
  v10 = *(uint *)(v2 + 4 * v3);
  v9 = Function_21d3938(*(int **)(v2 + 4 * v3));
  v4 = Function_21d3938(*(int **)(v2 + 44));
  v5 = 0;
  do
  {
    v6 = v2 + 4 * v5;
    v7 = *(int **)(v6 + 20);
    if ( v7 )
    {
      Function_21d3868(v7, v4);
      Function_20ae77c(*(uint *)(v6 + 20), v9);
    }
    v5 = (v5 + 1) & 0xFF;
  }
  while ( v5 < 6 );
  result = v10;
  *(uint *)(v2 + 44) = v10;
  return result;
}

//----- (021D40F0) --------------------------------------------------------
int __fastcall Function_21d40f0(uint a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8)
{
  int result;
  int v9;
  int v10;
  uint v11;
  int v12;
  int v13;
  int i;

  v11 = a1;
  v12 = a2;
  v13 = a3;
  result = a4;
  v9 = 0;
  for ( i = a4; v9 < i; ++v9 )
  {
    v10 = Function_21d3978(v11, v9, a5, 0, a6, 1, 1, v12, v13, a7);
    if ( !v10 )
      ErrorHandler();
    Function_21d4084(a8, v9, v10);
    result = i;
  }
  return result;
}

//----- (021D414C) --------------------------------------------------------
int __fastcall Function_21d414c(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int *v6;
  int result;
  int v8;
  int **v9;
  int v10;

  v2 = a2;
  v10 = a1;
  v3 = Function_21d3938(*(int **)(a2 + 44));
  v4 = 0;
  v5 = v2;
  do
  {
    v6 = *(int **)(v5 + 20);
    if ( v6 )
      Function_21d3868(v6, v3);
    ++v4;
    v5 += 4;
  }
  while ( v4 < 6 );
  result = *(uint *)(v2 + 16);
  v8 = 0;
  if ( result > 0 )
  {
    v9 = (int **)v2;
    do
    {
      Function_21d3ce4(*v9, v10);
      *v9 = 0;
      ++v9;
      result = *(uint *)(v2 + 16);
      ++v8;
    }
    while ( v8 < result );
  }
  return result;
}

//----- (021D4194) --------------------------------------------------------
uint *Function_21d4194()
{
  uint *v0;

  v0 = (uint *)malloc(4u, 896);
  MIi_CpuClearFast(0, v0, 0x380u);
  return v0;
}

//----- (021D41B4) --------------------------------------------------------
int __fastcall Function_21d41b4(int *a1)
{
  int *v1;
  int result;

  v1 = a1;
  result = *a1;
  if ( result )
  {
    free(result);
    result = 0;
    *v1 = 0;
  }
  return result;
}

//----- (021D41C8) --------------------------------------------------------
int __fastcall Function_5_21d41c8(int a1, int a2, uchar a3, uint a4, uint a5, int a6, int a7, int a8, uchar a9, int a10)
{
  int v10;
  uint v11;
  int v12;
  int result;
  int v14;

  v10 = a1;
  v11 = a4;
  v12 = Function_21d3fd0(a2, a3);
  if ( !v12 )
    return ErrorHandler();
  Function_21d4068(a5, a8, v12);
  v14 = a9;
  if ( !a9 )
    ErrorHandler();
  if ( !a9 )
    v14 = 1;
  result = Function_21d40f0(v11, a6, a7, a8, v14, a10, v10, v12);
  *(uint *)(v12 + 48) = v11;
  return result;
}

//----- (021D4220) --------------------------------------------------------
uint __fastcall Function_5_21d4220(int a1, int a2, uint a3, int a4)
{
  uint v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  uint result;

  v4 = a3;
  v5 = a1;
  v6 = a2;
  v7 = a4;
  if ( a3 >= 6 )
    ErrorHandler();
  v8 = Function_21d4040(v5, v6);
  v9 = v8 + 20;
  v10 = 4 * v4;
  result = *(uint *)(v8 + 20 + v10);
  if ( result )
    result = ErrorHandler();
  *(uint *)(v9 + v10) = v7;
  return result;
}

//----- (021D4250) --------------------------------------------------------
int __fastcall Function_5_21d4250(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;

  v3 = a2;
  v4 = a1;
  v5 = a3;
  if ( !a2 )
    ErrorHandler();
  v6 = Function_21d4040(v4, v3);
  v7 = Function_21d409c(v6, v5);
  return Function_5_21d3e40(v7, 0);
}

//----- (021D4278) --------------------------------------------------------
int __fastcall Function_21d4278(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;

  v4 = a2;
  v5 = a1;
  v6 = a3;
  v7 = a4;
  if ( !a2 )
    ErrorHandler();
  v8 = Function_21d4040(v5, v4);
  v9 = Function_21d409c(v8, v6);
  if ( v7 )
    Function_2005748((ushort)v7);
  return Function_5_21d3e40(v9, 0);
}

//----- (021D42B0) --------------------------------------------------------
int __fastcall Function_5_21d42b0(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;
  int v6;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( !a3 )
    ErrorHandler();
  v6 = Function_21d4040(v4, v5);
  Function_21d414c(v3, v6);
  return Function_21d4020(v6);
}

//----- (021D42D8) --------------------------------------------------------
int __fastcall Function_21d42d8(int a1, int a2)
{
  int v2;
  int v3;

  v2 = a1;
  v3 = a2;
  if ( !a2 )
    ErrorHandler();
  return *(uint *)(Function_21d4040(v2, v3) + 44);
}

//----- (021D42F0) --------------------------------------------------------
BOOL __fastcall Function_5_21d42f0(int a1, int a2)
{
  int v2;

  v2 = Function_21d42d8(a1, a2);
  if ( !v2 )
    ErrorHandler();
  return Function_5_21d3f70(v2) != 0;
}

//----- (021D4310) --------------------------------------------------------
int __fastcall Function_21d4310(int a1, int a2)
{
  return *(uint *)(Function_21d4040(a1, a2) + 48);
}

//----- (021D431C) --------------------------------------------------------
uint *Function_5_21d431c()
{
  uint *result;

  result = (uint *)malloc2(4u, 40);
  *result = 0;
  return result;
}

//----- (021D432C) --------------------------------------------------------
uint __fastcall Function_5_21d432c(int a1)
{
  return free(a1);
}

//----- (021D4334) --------------------------------------------------------
int __fastcall Function_5_21d4334(int result, int a2, int a3)
{
  *(uint *)(a3 + 20) = result;
  *(uint *)(a3 + 24) = a2;
  return result;
}

//----- (021D433C) --------------------------------------------------------
int __fastcall Function_5_21d433c(int a1, uint *a2)
{
  uint *v2;
  int v3;
  int v4;
  int *v5;
  char *v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  uint v12;
  int v13;
  int result;
  int v15;
  int v16;
  int v17;
  uint *v18;
  uint *v19;
  int v20;
  int v21;
  int v22;
  uint v23;
  int v24;
  int v25[4];
  char v26;

  v2 = a2;
  v3 = a1;
  v4 = *a2;
  if ( *a2 <= 5u )
    JUMPOUT(__CS__, *((short *)&off_21D4358 + v4) + 35472218);
  switch ( (uchar)v4 )
  {
    case 0:
      v5 = dword_21F89F4;
      v6 = &v26;
      v7 = 10;
      do
      {
        v8 = *v5;
        v9 = v5[1];
        v5 += 2;
        *(uint *)v6 = v8;
        *((uint *)v6 + 1) = v9;
        v6 += 8;
        --v7;
      }
      while ( v7 );
      v2[8] = 0;
      *((uchar *)v2 + 29) = 0;
      Function_20550f4(v2[5], v2[6], -1, -1, 3, 1, v25);
      *((uchar *)v2 + 28) = 1;
      if ( Function_2055208(v3, (int)&v26, 0x14u, v25, &v24, (int *)&v23) )
      {
        v10 = Function_21d3f94(*(uint *)(v3 + 80), v23);
        *((uchar *)v2 + 30) = v10;
        v11 = Function_5_21efaa0(*(uint *)(v3 + 48));
        v12 = Function_5_21e18bc(v24);
        v13 = Function_5_21e18c0(v24);
        Function_5_21d41c8(*(uint *)(v3 + 80), *(uint *)(v3 + 84), 1u, v23, v12, v13, v11, v10, 1u, 0);
        ++*v2;
        goto LABEL_35;
      }
      ErrorHandler();
      return 1;
    case 1:
      v15 = Function_21d4310(*(uint *)(v3 + 84), 1);
      if ( v15 != 75 )
      {
        Function_20206b0(*(uint **)(v3 + 36));
        v2[8] = 1;
      }
      if ( Function_21d481c(v15) == 1 )
      {
        v16 = 1544;
      }
      else if ( Function_21d481c(v15) == 2 )
      {
        v16 = 1492;
      }
      else
      {
        v16 = 1541;
      }
      v17 = *((uchar *)v2 + 30);
      if ( v17 != 2 && v17 != 4 )
        ErrorHandler();
      Function_21d4278(*(uint *)(v3 + 84), 1, 0, v16);
      ++*v2;
      goto LABEL_35;
    case 2:
      if ( Function_5_21d42f0(*(uint *)(v3 + 84), 1) )
        ++*v2;
      goto LABEL_35;
    case 3:
      v18 = (uint *)Function_205eb3c(*(uint *)(v3 + 60));
      Function_2065638(v18, 12);
      ++*v2;
      goto LABEL_35;
    case 4:
      v19 = (uint *)Function_205eb3c(*(uint *)(v3 + 60));
      if ( Function_2065684(v19) == 1 )
      {
        Function_20656ac(v19);
        Function_2062d64(v19, 1);
        v20 = Function_21d4310(*(uint *)(v3 + 84), 1);
        if ( ((int (*)(void))Function_21d481c)() == 1 )
        {
          v21 = 0;
        }
        else if ( Function_21d481c(v20) == 2 )
        {
          v21 = 0;
        }
        else
        {
          v21 = 1543;
        }
        v22 = *((uchar *)v2 + 30);
        if ( v22 != 2 && v22 != 4 )
          ErrorHandler();
        Function_21d4278(*(uint *)(v3 + 84), 1, 1, v21);
        ++*v2;
      }
      goto LABEL_35;
    case 5:
      if ( !Function_5_21d42f0(*(uint *)(v3 + 84), 1) )
        goto LABEL_35;
      Function_5_21d42b0(*(uint *)(v3 + 80), *(uint *)(v3 + 84), 1);
      result = 1;
      break;
    default:
LABEL_35:
      if ( v2[8] )
        Function_21d4798(*(uint *)(v3 + 36), (char *)v2 + 29);
      result = 0;
      break;
  }
  return result;
}

//----- (021D453C) --------------------------------------------------------
int __fastcall Function_5_21d453c(int *a1, uint *a2)
{
  uint *v2;
  int *v3;
  int v4;
  int *v5;
  char *v6;
  int v7;
  int v8;
  int v9;
  uint v10;
  int v11;
  int v12;
  uint v13;
  int v14;
  int result;
  short v16;
  int v17;
  int v18;
  int v19;
  int v20;
  uint *v21;
  uint *v22;
  uint *v23;
  int v24;
  int v25;
  int v26;
  int v27;
  uint v28;
  int v29;
  int v30[4];
  char v31;

  v2 = a2;
  v3 = a1;
  v4 = *a2;
  if ( *a2 <= 6u )
    JUMPOUT(__CS__, *((short *)&off_21D4558 + v4) + 35472730);
  switch ( (uchar)v4 )
  {
    case 0:
      v5 = dword_21F8A44;
      v6 = &v31;
      v7 = 10;
      do
      {
        v8 = *v5;
        v9 = v5[1];
        v5 += 2;
        *(uint *)v6 = v8;
        *((uint *)v6 + 1) = v9;
        v6 += 8;
        --v7;
      }
      while ( v7 );
      v2[8] = 0;
      *((uchar *)v2 + 29) = 0;
      Function_20550f4(v2[5], v2[6], -1, 0, 3, 1, v30);
      *((uchar *)v2 + 28) = 1;
      if ( Function_2055208((int)v3, (int)&v31, 0x14u, v30, &v29, (int *)&v28) )
      {
        v10 = Function_21d3f94(v3[20], v28);
        v11 = v10;
        *((uchar *)v2 + 30) = v10;
        v12 = Function_5_21efaa0(v3[12]);
        v13 = Function_5_21e18bc(v29);
        v14 = Function_5_21e18c0(v29);
        Function_5_21d41c8(v3[20], v3[21], 1u, v28, v13, v14, v12, v11, 1u, 0);
        v16 = Function_2020a88(v3[9]);
        *((ushort *)v2 + 18) = v16;
        if ( v28 != 75 )
          Function_202094c(65440, v3[9]);
        ++*v2;
        goto LABEL_46;
      }
      ErrorHandler();
      Function_5_21d1744(1);
      *v2 = 6;
      return 0;
    case 1:
      Function_2056b30(v3[4], 0, 9, 1, 0, 6, 1, 0xBu);
      v17 = Function_21d4310(v3[21], 1);
      if ( v17 != 75 )
        v2[8] = 1;
      if ( Function_21d481c(v17) == 1 )
      {
        v18 = 1544;
      }
      else if ( Function_21d481c(v17) == 2 )
      {
        v18 = 1492;
      }
      else
      {
        v18 = 1541;
      }
      v19 = *((uchar *)v2 + 30);
      if ( v19 == 2 )
      {
        v20 = 0;
      }
      else if ( v19 == 4 )
      {
        v20 = 2;
      }
      else
      {
        ErrorHandler();
        v20 = 0;
      }
      Function_21d4278(v3[21], 1, v20, v18);
      ++*v2;
      goto LABEL_46;
    case 2:
      if ( Function_5_21d42f0(v3[21], 1) )
      {
        v21 = (uint *)Function_205eb3c(v3[15]);
        Function_2062d64(v21, 0);
        ++*v2;
      }
      goto LABEL_46;
    case 3:
      v22 = (uint *)Function_205eb3c(v3[15]);
      Function_2065638(v22, 13);
      ++*v2;
      goto LABEL_46;
    case 4:
      v23 = (uint *)Function_205eb3c(v3[15]);
      if ( Function_2065684(v23) == 1 )
      {
        Function_20656ac(v23);
        v24 = Function_21d4310(v3[21], 1);
        if ( Function_21d481c(v24) == 1 )
        {
          v25 = 0;
        }
        else if ( Function_21d481c(v24) == 2 )
        {
          v25 = 0;
        }
        else
        {
          v25 = 1543;
        }
        v26 = *((uchar *)v2 + 30);
        if ( v26 == 2 )
        {
          v27 = 1;
        }
        else if ( v26 == 4 )
        {
          v27 = 3;
        }
        else
        {
          ErrorHandler();
          v27 = 1;
        }
        Function_21d4278(v3[21], 1, v27, v25);
        ++*v2;
      }
      goto LABEL_46;
    case 5:
      if ( !Function_5_21d42f0(v3[21], 1)
        || !Function_200f2ac()
        || *((ushort *)v2 + 18) != Function_2020a88(v3[9]) )
      {
        goto LABEL_46;
      }
      Function_5_21d42b0(v3[20], v3[21], 1);
      return 1;
    case 6:
      if ( !Function_200f2ac() )
        goto LABEL_46;
      result = 1;
      break;
    default:
LABEL_46:
      if ( v2[8] )
        Function_21d47dc(v3[9], (char *)v2 + 29);
      result = 0;
      break;
  }
  return result;
}

//----- (021D4798) --------------------------------------------------------
int __fastcall Function_21d4798(int a1, uchar *a2)
{
  uchar *v2;
  int v3;
  int result;
  int v5;
  ushort v6;

  v2 = a2;
  v3 = a1;
  result = *a2;
  v5 = 12;
  v6 = 12 * result;
  if ( 12 * result <= 96 )
  {
    if ( v6 > 0x60u )
      v5 = (v6 - 96) & 0xFF;
    if ( (Function_2020a88(v3) - v5) & 0xFFFF )
      Function_202094c(-(short)v5, v3);
    result = (uchar)*v2 + 1;
    *v2 = result;
  }
  return result;
}

//----- (021D47DC) --------------------------------------------------------
int __fastcall Function_21d47dc(int a1, uchar *a2)
{
  uchar *v2;
  int v3;
  int result;
  int v5;

  v2 = a2;
  v3 = a1;
  result = 16 * *a2;
  if ( result < 96 )
  {
    result = (ushort)result;
    if ( (ushort)result <= 0x60u )
      v5 = 16;
    else
      v5 = (result - 96) & 0xFF;
    if ( (Function_2020a88(v3) + v5) & 0xFFFF )
      Function_202094c(v5, v3);
    result = (uchar)*v2 + 1;
    *v2 = result;
  }
  return result;
}

//----- (021D481C) --------------------------------------------------------
int __fastcall Function_21d481c(int a1)
{
  if ( a1 == 442 )
    return 2;
  if ( a1 != 70 && a1 != 298 && a1 != 456 && a1 != 427 && a1 != 484 && a1 != 75 )
    return 0;
  return 1;
}

//----- (021D4858) --------------------------------------------------------
int __fastcall Function_5_21d4858(uint *a1, uint *a2, int a3, int a4)
{
  uint *v4;
  uint *v5;
  int v6;
  int v7;
  int v8;
  uint v9;
  int v10;
  int result;
  uint *v12;
  uint *v13;
  int v14;
  uint *v15;
  uint *v16;
  int v17;
  uint *v18;
  uint v19;
  int v20;
  int v21;
  int v22;
  int v23;
  int v24;
  int v25[4];
  int v26;

  v26 = a4;
  v4 = a2;
  v5 = a1;
  v6 = *a2;
  v7 = a3;
  if ( *a2 <= 5u )
    JUMPOUT(__CS__, *((short *)&off_21D4876 + v6) + 35473528);
  switch ( (uchar)v6 )
  {
    case 0:
      v21 = 130;
      v22 = 131;
      v23 = 425;
      v24 = 426;
      if ( a3 == 2 )
        Function_20550f4(a2[5], a2[6], -1, 0, 2, 1, v25);
      else
        Function_20550f4(a2[5], a2[6], 0, 0, 2, 1, v25);
      *((uchar *)v4 + 28) = 2;
      if ( Function_2055208((int)v5, (int)&v21, 4u, v25, &v20, (int *)&v19) )
      {
        v8 = Function_5_21efaa0(v5[12]);
        v9 = Function_5_21e18bc(v20);
        v10 = Function_5_21e18c0(v20);
        Function_5_21d41c8(v5[20], v5[21], 2u, v19, v9, v10, v8, 1, 1u, 1);
        v12 = (uint *)Function_205eb3c(v5[15]);
        if ( IsSpriteMovable(v12) == 1 )
          Function_2065638(v12, 73);
        else
          ErrorHandler();
        ++*v4;
        goto LABEL_33;
      }
      ErrorHandler();
      return 1;
    case 1:
      Function_5_21d1744(1);
      Function_21d4278(v5[21], 2, 0, 1557);
      v13 = (uint *)Function_205eb3c(v5[15]);
      if ( IsSpriteMovable(v13) == 1 )
      {
        if ( v7 == 3 )
          v14 = 11;
        else
          v14 = 10;
        Function_2065638(v13, v14);
      }
      else
      {
        ErrorHandler();
      }
      ++*v4;
      goto LABEL_33;
    case 2:
      v15 = (uint *)Function_205eb3c(v5[15]);
      if ( IsSpriteMovable(v15) == 1 )
      {
        Function_2065638(v15, 74);
        ++*v4;
      }
      goto LABEL_33;
    case 3:
      v16 = (uint *)Function_205eb3c(v5[15]);
      if ( IsSpriteMovable(v16) == 1 )
      {
        if ( v7 == 3 )
          v17 = 11;
        else
          v17 = 10;
        Function_2065638(v16, v17);
        ++*v4;
      }
      goto LABEL_33;
    case 4:
      v18 = (uint *)Function_205eb3c(v5[15]);
      if ( Function_2065684(v18) == 1 )
      {
        Function_20656ac(v18);
        ++*v4;
      }
      goto LABEL_33;
    case 5:
      if ( !Function_5_21d42f0(v5[21], 2) || !Function_200f2ac() )
        goto LABEL_33;
      Function_5_21d42b0(v5[20], v5[21], 2);
      Function_20057a4(1557, 0);
      result = 1;
      break;
    default:
LABEL_33:
      result = 0;
      break;
  }
  return result;
}

//----- (021D4A24) --------------------------------------------------------
int __fastcall Function_21d4a24(uint *a1, uint *a2, int a3, int a4)
{
  uint *v4;
  uint *v5;
  int v6;
  int v7;
  int v8;
  uint v9;
  int v10;
  int result;
  uint *v12;
  uint *v13;
  int v14;
  uint *v15;
  uint *v16;
  uint v17;
  int v18;
  int v19;
  int v20;
  int v21;
  int v22;
  int v23[4];
  int v24;

  v24 = a4;
  v4 = a2;
  v5 = a1;
  v6 = *a2;
  v7 = a3;
  if ( *a2 <= 4u )
    JUMPOUT(__CS__, *((short *)&off_21D4A42 + v6) + 35473988);
  switch ( (uchar)v6 )
  {
    case 0:
      v19 = 130;
      v20 = 131;
      v21 = 425;
      v22 = 426;
      if ( a3 == 2 )
        Function_20550f4(a2[5], a2[6], -1, 0, 2, 1, v23);
      else
        Function_20550f4(a2[5], a2[6], 0, 0, 2, 1, v23);
      *((uchar *)v4 + 28) = 2;
      if ( Function_2055208((int)v5, (int)&v19, 4u, v23, &v18, (int *)&v17) )
      {
        v8 = Function_5_21efaa0(v5[12]);
        v9 = Function_5_21e18bc(v18);
        v10 = Function_5_21e18c0(v18);
        Function_5_21d41c8(v5[20], v5[21], 2u, v17, v9, v10, v8, 1, 1u, 0);
        v12 = (uint *)Function_205eb3c(v5[15]);
        if ( IsSpriteMovable(v12) == 1 )
          Function_2065638(v12, 73);
        else
          ErrorHandler();
        ++*v4;
        goto LABEL_28;
      }
      ErrorHandler();
      return 1;
    case 1:
      Function_21d4278(v5[21], 2, 0, 1557);
      v13 = (uint *)Function_205eb3c(v5[15]);
      if ( IsSpriteMovable(v13) == 1 )
      {
        if ( v7 == 2 )
          v14 = 10;
        else
          v14 = 11;
        Function_2065638(v13, v14);
      }
      else
      {
        ErrorHandler();
      }
      ++*v4;
      goto LABEL_28;
    case 2:
      v15 = (uint *)Function_205eb3c(v5[15]);
      if ( IsSpriteMovable(v15) == 1 )
      {
        Function_2065638(v15, 74);
        Function_5_21d1744(0);
        ++*v4;
      }
      goto LABEL_28;
    case 3:
      v16 = (uint *)Function_205eb3c(v5[15]);
      if ( Function_2065684(v16) == 1 )
      {
        Function_20656ac(v16);
        ++*v4;
      }
      goto LABEL_28;
    case 4:
      if ( !Function_5_21d42f0(v5[21], 2) || !Function_200f2ac() )
        goto LABEL_28;
      Function_5_21d42b0(v5[20], v5[21], 2);
      Function_20057a4(1557, 0);
      result = 1;
      break;
    default:
LABEL_28:
      result = 0;
      break;
  }
  return result;
}

//----- (021D4BC8) --------------------------------------------------------
int __fastcall Function_21d4bc8(int a1)
{
  int v1;
  int v2;
  uchar *v3;

  v1 = a1;
  v2 = LoadOverWorldDataAdress(a1);
  v3 = (uchar *)GetUnknownStruct01_c(v1);
  if ( !Function_5_21d42f0(*(uint *)(v2 + 84), *v3) )
    return 0;
  free((int)v3);
  return 1;
}

//----- (021D4BF4) --------------------------------------------------------
int __fastcall Function_5_21d4bf4(uint *a1, int a2, int a3, uchar a4)
{
  int *v4;
  uint *v5;
  int v6;
  char *v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  uint v13;
  int v14;
  uchar v16;
  uint v17;
  int v18;
  int v19[4];
  char v20;

  v4 = dword_21F8A94;
  v16 = a4;
  v5 = a1;
  v6 = a2;
  v7 = &v20;
  v8 = 10;
  do
  {
    v9 = *v4;
    v10 = v4[1];
    v4 += 2;
    *(uint *)v7 = v9;
    *((uint *)v7 + 1) = v10;
    v7 += 8;
    --v8;
  }
  while ( v8 );
  Function_20550f4(v6, a3, -1, 0, 3, 1, v19);
  if ( !Function_2055208((int)v5, (int)&v20, 0x14u, v19, &v18, (int *)&v17) )
    return ErrorHandler();
  v11 = Function_21d3f94(v5[20], v17);
  v12 = Function_5_21efaa0(v5[12]);
  v13 = Function_5_21e18bc(v18);
  v14 = Function_5_21e18c0(v18);
  return Function_5_21d41c8(v5[20], v5[21], v16, v17, v13, v14, v12, v11, 1u, 0);
}

//----- (021D4C88) --------------------------------------------------------
int __fastcall Function_5_21d4c88(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  uint v5;
  int v6;

  v2 = a1;
  v3 = a2;
  v4 = Function_21d4310(*(uint *)(a1 + 84), a2);
  v5 = Function_21d3f94(*(uint *)(v2 + 80), v4);
  if ( Function_21d481c(v4) == 1 )
  {
    v6 = 1544;
  }
  else if ( Function_21d481c(v4) == 2 )
  {
    v6 = 1492;
  }
  else
  {
    v6 = 1541;
  }
  if ( v5 != 2 && v5 != 4 )
    ErrorHandler();
  return Function_21d4278(*(uint *)(v2 + 84), v3, 0, v6);
}

//----- (021D4CEC) --------------------------------------------------------
int __fastcall Function_5_21d4cec(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  uint v5;
  int v6;

  v2 = a1;
  v3 = a2;
  v4 = Function_21d4310(*(uint *)(a1 + 84), a2);
  v5 = Function_21d3f94(*(uint *)(v2 + 80), v4);
  if ( Function_21d481c(v4) == 1 )
  {
    v6 = 0;
  }
  else if ( Function_21d481c(v4) == 2 )
  {
    v6 = 0;
  }
  else
  {
    v6 = 1543;
  }
  if ( v5 != 2 && v5 != 4 )
    ErrorHandler();
  return Function_21d4278(*(uint *)(v2 + 84), v3, 1, v6);
}

//----- (021D4D48) --------------------------------------------------------
uint *__fastcall Function_5_21d4d48(int a1, char a2)
{
  int v2;
  char v3;
  uchar *v4;

  v2 = a1;
  v3 = a2;
  v4 = (uchar *)malloc2(4u, 1);
  *v4 = v3;
  return Function_2050944(*(uint *)(v2 + 16), (int)Function_21d4bc8, (int)v4);
}

//----- (021D4D68) --------------------------------------------------------
int __fastcall Function_5_21d4d68(int a1, int a2)
{
  return Function_5_21d42b0(*(uint *)(a1 + 80), *(uint *)(a1 + 84), a2);
}

//----- (021D4D78) --------------------------------------------------------
int __fastcall Function_21d4d78(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  uint *v7;
  int v9;
  int v10;
  uint v11;
  int v12;
  char v13;

  v4 = a3;
  v5 = a4;
  v9 = 303;
  v10 = 304;
  Function_20550f4(a1, a2, 0, -1, 1, 3, &v13);
  if ( !Function_2055208(v5, (int)&v9, 2u, (int *)&v13, &v12, (int *)&v11) )
    ErrorHandler();
  v6 = Function_5_21e18bc(v12);
  if ( !Function_21d3b24(v11, v4, 1, v6, *(uint *)(v5 + 80)) )
    ErrorHandler();
  v7 = (uint *)Function_5_21d3de4(v11, v4, *(uint *)(v5 + 80));
  Function_5_21d3e7c(v7);
  Function_5_21d3e40((int)v7, 0);
  return Function_5_21d3e44((int)v7);
}

//----- (021D4E00) --------------------------------------------------------
uint *Function_5_21d4e00()
{
  uint *result;

  result = (uint *)malloc2(4u, 16);
  *result = 0;
  return result;
}

//----- (021D4E10) --------------------------------------------------------
int __fastcall Function_21d4e10(int a1)
{
  int v1;
  int v2;
  int v3;
  uint *v4;
  int v5;
  uint *v6;
  uint *v7;
  int result;

  v1 = a1;
  v2 = LoadOverWorldDataAdress(a1);
  v3 = GetUnknownStruct01_c(v1);
  switch ( (uchar)*(uint *)v3 )
  {
    case 0u:
      v4 = (uint *)Function_205eb3c(*(uint *)(v2 + 60));
      if ( GetSpriteFaceDirection(*(uint *)(v2 + 60)) == 1 )
      {
        Function_2062d64(v4, 1);
        v5 = 1;
      }
      else
      {
        Function_2062d64(v4, 0);
        v5 = 3;
      }
      *(uint *)v3 = v5;
      *(uint *)(v3 + 8) = 0;
      *(uchar *)(v3 + 4) = 0;
      *(ushort *)(v3 + 12) = Function_2020a88(*(uint *)(v2 + 36));
      Function_202094c(65440, *(uint *)(v2 + 36));
      Function_200f174(0, 1, 1, 0x7FFF, 6, 1, 11);
      *(uint *)(v3 + 8) = 1;
      goto LABEL_12;
    case 1u:
      v6 = (uint *)Function_205eb3c(*(uint *)(v2 + 60));
      Function_2062d64(v6, 0);
      Function_2065638(v6, 13);
      ++*(uint *)v3;
      goto LABEL_12;
    case 2u:
      v7 = (uint *)Function_205eb3c(*(uint *)(v2 + 60));
      if ( Function_2065684(v7) == 1 )
      {
        Function_20656ac(v7);
        ++*(uint *)v3;
      }
      goto LABEL_12;
    case 3u:
      if ( !Function_200f2ac() || *(ushort *)(v3 + 12) != Function_2020a88(*(uint *)(v2 + 36)) )
        goto LABEL_12;
      free(v3);
      result = 1;
      break;
    default:
LABEL_12:
      if ( *(uint *)(v3 + 8) )
        Function_21d47dc(*(uint *)(v2 + 36), (uchar *)(v3 + 4));
      result = 0;
      break;
  }
  return result;
}

//----- (021D4F14) --------------------------------------------------------
int __fastcall Function_21d4f14(int a1)
{
  int v1;
  int v2;
  int *v3;
  int v4;
  int v5;
  uint *v6;

  v1 = a1;
  v2 = LoadOverWorldDataAdress(a1);
  v3 = (int *)GetUnknownStruct01_c(v1);
  v4 = (int)v3;
  v5 = *v3;
  if ( v5 )
  {
    if ( v5 == 1 && Function_200f2ac() )
    {
      free(v4);
      return 1;
    }
  }
  else
  {
    v6 = (uint *)Function_205eb3c(*(uint *)(v2 + 60));
    Function_2062d64(v6, 1);
    *(uint *)(v4 + 8) = 0;
    *(uchar *)(v4 + 4) = 0;
    Function_2005748(0x603u);
    Function_200f174(0, 0, 0, 0x7FFF, 6, 1, 11);
    *(uint *)(v4 + 8) = 1;
    ++*(uint *)v4;
  }
  if ( *(uint *)(v4 + 8) )
    Function_21d4798(*(uint *)(v2 + 36), (uchar *)(v4 + 4));
  return 0;
}

//----- (021D4FA0) --------------------------------------------------------
int __fastcall Function_21d4fa0(int a1)
{
  int v1;
  int v2;
  int *v3;
  int v4;
  int v5;

  v1 = a1;
  v2 = LoadOverWorldDataAdress(a1);
  v3 = (int *)GetUnknownStruct01_c(v1);
  v4 = (int)v3;
  v5 = *v3;
  if ( v5 )
  {
    if ( v5 == 1 && Function_200f2ac() )
    {
      free(v4);
      return 1;
    }
  }
  else
  {
    *(uint *)(v4 + 8) = 0;
    *(uchar *)(v4 + 4) = 0;
    Function_2005748(0x603u);
    Function_2056b30(v1, 0, 16, 0, 0, 6, 1, 0xBu);
    *(uint *)(v4 + 8) = 1;
    ++*(uint *)v4;
  }
  if ( *(uint *)(v4 + 8) )
    Function_21d4798(*(uint *)(v2 + 36), (uchar *)(v4 + 4));
  return 0;
}

//----- (021D5020) --------------------------------------------------------
int __fastcall Function_21d5020(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  uint *v5;
  uint *v6;
  int result;
  int v8;
  uint *v9;

  v8 = a1;
  v2 = LoadOverWorldDataAdress(a1);
  v3 = GetUnknownStruct01_c(v8);
  switch ( (uchar)*(uint *)v3 )
  {
    case 0u:
      v9 = (uint *)Function_205eb3c(*(uint *)(v2 + 60));
      if ( (uchar)GetSpriteFaceDirection(*(uint *)(v2 + 60)) == 1 )
      {
        Function_2062d64(v9, 1);
        v4 = 1;
      }
      else
      {
        Function_2062d64(v9, 0);
        v4 = 3;
      }
      *(uint *)v3 = v4;
      *(uint *)(v3 + 8) = 0;
      *(uchar *)(v3 + 4) = 0;
      *(ushort *)(v3 + 12) = Function_2020a88(*(uint *)(v2 + 36));
      switch ( (uchar)Function_202094c(65440, *(uint *)(v2 + 36)) )
      {
        case 0u:
          v1 = 3;
          break;
        case 1u:
          v1 = 5;
          break;
        case 2u:
          v1 = 7;
          break;
        case 3u:
          v1 = 39;
          break;
        default:
          ErrorHandler();
          break;
      }
      Function_2056b30(v8, 0, v1, 1, 0, 6, 1, 0xBu);
      *(uint *)(v3 + 8) = 1;
      goto LABEL_18;
    case 1u:
      v5 = (uint *)Function_205eb3c(*(uint *)(v2 + 60));
      Function_2062d64(v5, 0);
      Function_2065638(v5, 13);
      ++*(uint *)v3;
      goto LABEL_18;
    case 2u:
      v6 = (uint *)Function_205eb3c(*(uint *)(v2 + 60));
      if ( Function_2065684(v6) == 1 )
      {
        Function_20656ac(v6);
        ++*(uint *)v3;
      }
      goto LABEL_18;
    case 3u:
      if ( !Function_200f2ac() || *(ushort *)(v3 + 12) != Function_2020a88(*(uint *)(v2 + 36)) )
        goto LABEL_18;
      free(v3);
      result = 1;
      break;
    default:
LABEL_18:
      if ( *(uint *)(v3 + 8) )
        Function_21d47dc(*(uint *)(v2 + 36), (uchar *)(v3 + 4));
      result = 0;
      break;
  }
  return result;
}

//----- (021D5150) --------------------------------------------------------
int __fastcall Function_21d5150(int a1)
{
  int v1;
  int v2;
  int *v3;
  uint *v4;
  int v5;
  uint *v6;
  uint *v7;
  int result;

  v1 = a1;
  v2 = LoadOverWorldDataAdress(a1);
  v3 = (int *)GetUnknownStruct01_c(v1);
  switch ( (uchar)*v3 )
  {
    case 0u:
      v4 = (uint *)Function_205eb3c(*(uint *)(v2 + 60));
      if ( (uchar)GetSpriteFaceDirection(*(uint *)(v2 + 60)) == 1 )
      {
        Function_2062d64(v4, 1);
        v5 = 1;
      }
      else
      {
        Function_2062d64(v4, 0);
        v5 = 3;
      }
      *v3 = v5;
      Function_2056b30(v1, 0, 1, 1, 0, 6, 1, 0xBu);
      goto LABEL_11;
    case 1u:
      v6 = (uint *)Function_205eb3c(*(uint *)(v2 + 60));
      Function_2062d64(v6, 0);
      Function_2065638(v6, 13);
      ++*v3;
      goto LABEL_11;
    case 2u:
      v7 = (uint *)Function_205eb3c(*(uint *)(v2 + 60));
      if ( Function_2065684(v7) == 1 )
      {
        Function_20656ac(v7);
        ++*v3;
      }
      goto LABEL_11;
    case 3u:
      if ( !Function_200f2ac() )
        goto LABEL_11;
      free((int)v3);
      result = 1;
      break;
    default:
LABEL_11:
      result = 0;
      break;
  }
  return result;
}

//----- (021D521C) --------------------------------------------------------
uint *__fastcall Function_5_21d521c(uint a1, uint a2)
{
  uint v2;
  uint v3;
  uint *v4;
  uint v5;
  uint v6;
  uint *v7;

  v2 = a2;
  v3 = a1;
  if ( a2 >= 4 )
    ErrorHandler();
  v4 = (uint *)malloc(4u, 20);
  v4[3] = v3;
  *v4 = Function_21d53d4(v2, v4 + 1);
  v4[2] = 0;
  v5 = Function_20138c8() / 2;
  v6 = 0;
  if ( *v4 )
  {
    v7 = (uint *)v4[1];
    while ( *v7 <= v5 )
    {
      ++v6;
      v7 += 12;
      if ( v6 >= *v4 )
        goto LABEL_8;
    }
    v4[2] = v6;
  }
LABEL_8:
  v4[4] = 1;
  Function_21d538c(v4, v6);
  return v4;
}

//----- (021D5278) --------------------------------------------------------
int __fastcall Function_5_21d5278(int *a1)
{
  int *v1;
  int result;

  v1 = a1;
  if ( !a1 )
    ErrorHandler();
  Function_21d555c(*v1 + 4);
  Function_2018238(4u, *v1);
  result = 0;
  *v1 = 0;
  return result;
}

//----- (021D5298) --------------------------------------------------------
int __fastcall Function_21d5298(uint *a1)
{
  uint *v1;
  int result;
  uint v3;
  int v4;
  uint v5;

  v1 = a1;
  if ( !a1 )
    ErrorHandler();
  result = Function_20138c8() / 2;
  if ( *v1 > 1 )
  {
    v3 = v1[2];
    v4 = (int)(v3 - 1) < 0 ? 0 : *(uint *)(v1[1] + 48 * (v3 - 1));
    if ( result >= *(uint *)(v1[1] + 48 * v3) || result < v4 )
    {
      v5 = v1[2] + 1;
      v1[2] = v5;
      if ( v5 >= *v1 )
        v1[2] = 0;
      result = v1[4];
      if ( result )
        result = Function_21d538c(v1, v5);
    }
  }
  return result;
}

//----- (021D52F4) --------------------------------------------------------
int __fastcall Function_21d52f4(short *a1, int a2)
{
  int v2;
  int v3;
  short *v4;
  short *v5;
  int v6;
  int v7;
  int v8;
  short *v10;

  v10 = a1;
  v2 = a2;
  v3 = 0;
  v4 = a1;
  v5 = a1;
  do
  {
    if ( (1 << v3) & (uchar)v10[2] )
    {
      v6 = v4[9];
      v7 = v4[7];
      v8 = v4[8];
      Function_21d5a50(v2, v3);
      Function_21d5a78(v2, v3, (ushort)v5[3]);
    }
    else
    {
      Function_21d5a50(v2, v3);
      Function_21d5a78(v2, v3, 0);
    }
    ++v3;
    v4 += 3;
    ++v5;
  }
  while ( v3 < 4 );
  Function_21d5a8c(v2, (ushort)v10[19]);
  Function_21d5aa0(v2, (ushort)v10[20], 1);
  Function_21d5ab4(v2, (ushort)v10[21]);
  return Function_21d5ac8(v2, (ushort)v10[22], 1);
}

//----- (021D538C) --------------------------------------------------------
int __fastcall Function_21d538c(uint *a1)
{
  return Function_21d52f4((short *)(a1[1] + 48 * a1[2]), a1[3]);
}

//----- (021D53A4) --------------------------------------------------------
int __fastcall Function_21d53a4(int a1)
{
  int v1;

  v1 = a1;
  Function_20b2ce4(a1, 0, 64);
  Function_20b2ce4(v1, 0, 128);
  Function_20b2ce4(v1, 0, 512);
  return Function_20b2ce4(v1, 0, 1024);
}

//----- (021D53D4) --------------------------------------------------------
int __fastcall Function_21d53d4(int a1, int *a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  ushort *v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  int v20;
  int v21;
  int v22;
  int v23;
  int *v25;
  int v26;
  int v27;
  int v28;
  int v29;
  int v30;
  int v31;
  char v32;
  char v33;
  char v34;
  char v35;
  int v36;

  v36 = a4;
  v25 = a2;
  v4 = Function_2006fe8_LoadFromNARC_UncompressLZ8(176, a1, 0, 4, 0);
  v30 = (int)v4;
  v27 = 0;
  do
  {
    v4 = (uint *)Function_201e0b8((int)v4, (int)&v33, 13);
    if ( v33 != 69 || v34 != 79 || v35 != 70 )
    {
      v5 = Function_201e0b8((int)v4, (int)&v33, 13);
      v6 = Function_201e0b8(v5, (int)&v33, 13);
      v7 = Function_201e0b8(v6, (int)&v33, 13);
      v8 = Function_201e0b8(v7, (int)&v33, 13);
      v9 = Function_201e0b8(v8, (int)&v33, 13);
      v10 = Function_201e0b8(v9, (int)&v33, 13);
      v11 = Function_201e0b8(v10, (int)&v33, 13);
      v12 = Function_201e0b8(v11, (int)&v33, 13);
      v4 = (uint *)Function_201e0b8(v12, (int)&v33, 13);
      ++v27;
    }
  }
  while ( v33 != 69 || v34 != 79 || v35 != 70 );
  v13 = (ushort *)malloc(4u, 48 * v27);
  *v25 = (int)v13;
  MI_CpuFill8(v13, 0, 48 * v27);
  v31 = 0;
  v14 = v30;
  if ( v27 > 0 )
  {
    v29 = 0;
    do
    {
      v15 = *v25;
      v16 = *v25 + v29;
      v26 = Function_201e0b8(v14, (int)&v33, 13);
      Function_201e0b8((int)&v33, (int)&v32, 44);
      *(uint *)(v15 + v29) = Function_201e0fc(&v32);
      v17 = 0;
      v18 = v16 + 14;
      v28 = v16 + 6;
      v19 = v16;
      do
      {
        v26 = Function_21d5570(v26, v28, v18);
        if ( *(ushort *)(v19 + 6) == 0xFFFF )
          *(ushort *)(v19 + 6) = 0;
        else
          *(uchar *)(v16 + 4) |= 1 << v17;
        ++v17;
        v18 += 6;
        v19 += 2;
        v28 += 2;
      }
      while ( v17 < 4 );
      v20 = Function_21d5660(v26, v16 + 38);
      v21 = Function_21d5660(v20, v16 + 40);
      v22 = Function_21d5660(v21, v16 + 42);
      v23 = Function_21d5660(v22, v16 + 44);
      v14 = Function_201e0b8(v23, (int)&v33, 13);
      v29 += 48;
      ++v31;
    }
    while ( v31 < v27 );
  }
  Function_2018238(4u, v30);
  return v27;
}

//----- (021D555C) --------------------------------------------------------
int __fastcall Function_21d555c(int *a1)
{
  int *v1;
  int result;

  v1 = a1;
  Function_2018238(4u, *a1);
  result = 0;
  *v1 = 0;
  return result;
}

//----- (021D5570) --------------------------------------------------------
int __fastcall Function_21d5570(int a1, ushort *a2, short *a3)
{
  short *v3;
  int v4;
  int v5;
  char *v6;
  int v7;
  int *v8;
  int v10;
  ushort *v11;
  char v12;
  short v13;
  short v14;
  int v15;
  int v16;
  int v17;
  char v18;
  char v19;

  v11 = a2;
  v3 = a3;
  v10 = Function_201e0b8(a1, (int)&v19, 13);
  v4 = Function_201e0b8((int)&v19, (int)&v18, 44);
  if ( Function_201e0fc(&v18) == 1 )
  {
    v5 = 0;
    v6 = &v12;
    do
    {
      v4 = Function_201e0b8(v4, (int)&v18, 44);
      *(ushort *)v6 = Function_201e0fc(&v18);
      ++v5;
      v6 += 2;
    }
    while ( v5 < 3 );
    v7 = 0;
    v8 = &v15;
    *v11 = 32 * v13 | *(ushort *)&v12 | (v14 << 10);
    do
    {
      v4 = Function_201e0b8(v4, (int)&v18, 44);
      ++v7;
      *v8 = Function_201e0fc(&v18);
      ++v8;
    }
    while ( v7 < 3 );
    *v3 = v15;
    v3[1] = v16;
    v3[2] = v17;
    if ( *v3 > 4096 )
      *v3 = 4096;
    if ( *v3 < -4096 )
      *v3 = -4096;
    if ( v3[1] > 4096 )
      v3[1] = 4096;
    if ( v3[1] < -4096 )
      v3[1] = -4096;
    if ( v3[2] > 4096 )
      v3[2] = 4096;
    if ( v3[2] < -4096 )
      v3[2] = -4096;
  }
  else
  {
    *v11 = -1;
  }
  return v10;
}

//----- (021D5660) --------------------------------------------------------
int __fastcall Function_21d5660(int a1, ushort *a2, int a3, int a4)
{
  short *v4;
  int v5;
  char *v6;
  int v8;
  ushort *v9;
  char v10;
  short v11;
  short v12;
  short v13;
  short v14;
  int v15;

  v15 = a4;
  v9 = a2;
  v8 = Function_201e0b8(a1, (int)&v14, 13);
  v4 = &v14;
  v5 = 0;
  v6 = &v10;
  do
  {
    v4 = (short *)Function_201e0b8((int)v4, (int)&v13, 44);
    *(ushort *)v6 = Function_201e0fc(&v13);
    ++v5;
    v6 += 2;
  }
  while ( v5 < 3 );
  *v9 = (v12 << 10) | 32 * v11 | *(ushort *)&v10;
  return v8;
}

//----- (021D56BC) --------------------------------------------------------
int Function_21d56bc()
{
  int v0;

  v0 = malloc(4u, 8);
  if ( !v0 )
    ErrorHandler();
  return v0;
}

//----- (021D56D4) --------------------------------------------------------
int __fastcall Function_21d56d4(uchar *a1, int *a2, int a3, int a4)
{
  uchar *v4;
  int *v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  ushort v13;
  ushort v14;
  int v15[18];
  int v16;

  v16 = a4;
  v4 = a1;
  v5 = a2;
  FS_InitFile(v15);
  if ( !FS_OpenFile(v15, v4, v6, v7) )
    return ErrorHandler();
  if ( FS_ReadFile(v15, (int)&v14, 2) < 0 )
    ErrorHandler();
  if ( FS_ReadFile(v15, (int)&v13, 2) < 0 )
    ErrorHandler();
  v8 = 4 * v14;
  v9 = 4 * v13;
  v10 = malloc(4u, 4 * v14);
  *v5 = v10;
  if ( !v10 )
    ErrorHandler();
  v11 = malloc(4u, v9);
  v5[1] = v11;
  if ( !v11 )
    ErrorHandler();
  if ( FS_ReadFile(v15, *v5, v8) < 0 )
    ErrorHandler();
  if ( FS_ReadFile(v15, v5[1], v9) < 0 )
    ErrorHandler();
  return FS_CloseFile(v15);
}

//----- (021D5778) --------------------------------------------------------
uint __fastcall Function_21d5778(int *a1)
{
  int *v1;

  v1 = a1;
  free(a1[1]);
  free(*v1);
  return free((int)v1);
}

//----- (021D5790) --------------------------------------------------------
int __fastcall Function_21d5790(int a1, uint *a2, ushort *a3)
{
  int result;

  result = *(ushort *)(*a2 + 4 * a1);
  *a3 = result;
  return result;
}

//----- (021D579C) --------------------------------------------------------
int __fastcall Function_21d579c(int a1, uint *a2, ushort *a3, ushort *a4)
{
  int result;

  *a3 = *(ushort *)(*a2 + 4 * a1);
  result = *(ushort *)(*a2 + 4 * a1 + 2);
  *a4 = result;
  return result;
}

//----- (021D57B4) --------------------------------------------------------
int __fastcall Function_21d57b4(int a1, int a2)
{
  return *(uint *)(a2 + 4) + 4 * a1;
}

//----- (021D57BC) --------------------------------------------------------
uint *Function_21d57bc()
{
  uint *v0;

  v0 = (uint *)malloc(4u, 56);
  MIi_CpuClear32(0, v0, 56);
  return v0;
}

//----- (021D57D8) --------------------------------------------------------
int __fastcall Function_21d57d8(int *a1)
{
  int *v1;
  int result;

  v1 = a1;
  Function_2018238(4u, *a1);
  result = 0;
  *v1 = 0;
  return result;
}

//----- (021D57EC) --------------------------------------------------------
int __fastcall Function_21d57ec(int a1)
{
  return *(uint *)a1;
}

//----- (021D57F0) --------------------------------------------------------
int __fastcall Function_21d57f0(int a1)
{
  return *(uint *)(a1 + 8);
}

//----- (021D57F4) --------------------------------------------------------
int __fastcall Function_21d57f4(int a1)
{
  return *(uint *)(a1 + 12);
}

//----- (021D57F8) --------------------------------------------------------
int __fastcall Function_21d57f8(int a1)
{
  return *(ushort *)(a1 + 16);
}

//----- (021D57FC) --------------------------------------------------------
int __fastcall Function_5_21d57fc_CallG3X_SetFog(int *a1, char a2, int a3, int a4, int a5, int a6)
{
  if ( a2 & 1 )
    *a1 = a3;
  if ( a2 & 2 )
    a1[1] = a4;
  if ( a2 & 4 )
    a1[2] = a5;
  if ( a2 & 8 )
    a1[3] = a6;
  return G3X_SetFog(*a1, a1[1], a1[2], a1[3]);
}

//----- (021D5834) --------------------------------------------------------
int *__fastcall Function_5_21d5834_SetGFXFogColor(int a1, char a2, short a3, int a4)
{
  int v4;
  int *result;

  if ( a2 & 0x10 )
    *(ushort *)(a1 + 16) = a3;
  if ( a2 & 0x20 )
    *(uint *)(a1 + 20) = a4;
  v4 = *(ushort *)(a1 + 16) | (*(uint *)(a1 + 20) << 16);
  result = &GFX_FOG_COLOR;
  GFX_FOG_COLOR = v4;
  return result;
}

//----- (021D585C) --------------------------------------------------------
int *__fastcall Function_5_21d585c(int a1, int *a2)
{
  int v2;

  v2 = a1;
  MI_CpuCopy32(a2, (uint *)(a1 + 24), 32);
  return Function_20bfd44((int *)(v2 + 24));
}

//----- (021D5878) --------------------------------------------------------
uint *Function_21d5878()
{
  uint *v0;

  v0 = (uint *)malloc(4u, 72);
  MIi_CpuClear32(0, v0, 72);
  return v0;
}

//----- (021D5894) --------------------------------------------------------
int __fastcall Function_21d5894(int *a1)
{
  int *v1;
  int result;

  v1 = a1;
  Function_2018238(4u, *a1);
  result = 0;
  *v1 = 0;
  return result;
}

//----- (021D58A8) --------------------------------------------------------
int *__fastcall Function_21d58a8(short *a1, int a2)
{
  int v2;
  int v3;
  short *v4;
  short *v5;
  int *result;
  short *v7;

  v7 = a1;
  v2 = a2;
  v3 = 0;
  v4 = a1;
  v5 = a1;
  do
  {
    if ( (1 << v3) & v2 )
      Function_20af51c(v3, *v4, v4[1], v4[2]);
    if ( (1 << (v3 + 4)) & v2 )
      Function_20af558(v3, (ushort)v5[12]);
    ++v3;
    v4 += 3;
    ++v5;
  }
  while ( v3 < 4 );
  if ( v2 & 0x300 )
    Function_20af56c((ushort)v7[16], (ushort)v7[17], *((uint *)v7 + 10));
  if ( v2 & 0xC00 )
    Function_20af590((ushort)v7[18], (ushort)v7[19], *((uint *)v7 + 11));
  result = (int *)4096;
  if ( v2 >= 4096 )
    result = Function_20af5b4(
               *((uint *)v7 + 12),
               *((uint *)v7 + 13),
               *((uint *)v7 + 14),
               *((uint *)v7 + 15),
               *((uint *)v7 + 16),
               *((uint *)v7 + 17));
  return result;
}

//----- (021D5948) --------------------------------------------------------
uint __fastcall Function_21d5948(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  uint result;

  v4 = a1;
  v5 = a3;
  v6 = a2;
  if ( a3 & 0x100 )
    Function_20b3564(a2, *(ushort *)(a1 + 32), a3, a4);
  if ( v5 & 0x200 )
    Function_20b35a4(v6, *(ushort *)(v4 + 34), a3, a4);
  if ( v5 & 0x400 )
    Function_20b35e4(v6, *(ushort *)(v4 + 36), a3, a4);
  if ( v5 & 0x800 )
    Function_20b3624(v6, *(ushort *)(v4 + 38), a3, a4);
  if ( v5 & 0x1000 )
    Function_20b3664(v6, *(uint *)(v4 + 48), a3, a4);
  if ( v5 & 0x2000 )
    Function_20b36a4(v6, *(uint *)(v4 + 52), a3, a4);
  if ( v5 & 0x4000 )
    Function_20b36e4(v6, *(uint *)(v4 + 56), a3, a4);
  if ( v5 & 0x8000 )
    Function_20b3724(v6, *(uint *)(v4 + 60), a3, a4);
  if ( v5 & 0x10000 )
    Function_20b3764(v6, *(uint *)(v4 + 64), a3, a4);
  if ( v5 & 0x20000 )
    Function_20b37a4(v6, *(uint *)(v4 + 68) & 0x8000, *(uint *)(v4 + 68), a4);
  if ( v5 & 0x40000 )
    Function_20b37e4(v6, *(uint *)(v4 + 68) & 0x4000, *(uint *)(v4 + 68), a4);
  if ( v5 & 0x80000 )
    Function_20b3824(v6, *(uint *)(v4 + 68) & 0x2000, *(uint *)(v4 + 68), a4);
  if ( v5 & 0x100000 )
    Function_20b3864(v6, *(uint *)(v4 + 68) & 0x1000, *(uint *)(v4 + 68), a4);
  result = v5;
  if ( v5 & 0x200000 )
    result = Function_20b38a4(v6, *(uint *)(v4 + 68) & 0x800, *(uint *)(v4 + 68), a4);
  return result;
}

//----- (021D5A50) --------------------------------------------------------
int __fastcall Function_21d5a50(int a1, int a2, short a3, short a4, short a5)
{
  int v5;

  v5 = 6 * a2;
  *(ushort *)(a1 + v5) = a3;
  *(ushort *)(a1 + 2 + v5) = a4;
  *(ushort *)(a1 + 4 + v5) = a5;
  return Function_20af51c(
           a2,
           *(short *)(a1 + 6 * a2),
           *(short *)(a1 + 2 + v5),
           *(short *)(a1 + 4 + v5));
}

//----- (021D5A78) --------------------------------------------------------
int __fastcall Function_21d5a78(int a1, int a2, short a3)
{
  *(ushort *)(a1 + 24 + 2 * a2) = a3;
  return Function_20af558(a2, *(ushort *)(a1 + 24 + 2 * a2));
}

//----- (021D5A8C) --------------------------------------------------------
int *__fastcall Function_21d5a8c(int *result, short a2, int a3, int a4)
{
  *((ushort *)result + 16) = a2;
  result[10] = a3;
  if ( a4 == 1 )
    result = Function_21d58a8((short *)result, 256);
  return result;
}

//----- (021D5AA0) --------------------------------------------------------
short *__fastcall Function_21d5aa0(short *result, short a2, int a3)
{
  result[17] = a2;
  if ( a3 == 1 )
    result = (short *)Function_21d58a8(result, 512);
  return result;
}

//----- (021D5AB4) --------------------------------------------------------
int *__fastcall Function_21d5ab4(int *result, short a2, int a3, int a4)
{
  *((ushort *)result + 18) = a2;
  result[11] = a3;
  if ( a4 == 1 )
    result = Function_21d58a8((short *)result, 1024);
  return result;
}

//----- (021D5AC8) --------------------------------------------------------
short *__fastcall Function_21d5ac8(short *result, short a2, int a3)
{
  result[19] = a2;
  if ( a3 == 1 )
    result = (short *)Function_21d58a8(result, 2048);
  return result;
}

//----- (021D5ADC) --------------------------------------------------------
int *__fastcall Function_21d5adc(int *result, int a2, int a3)
{
  result[13] = a2;
  if ( a3 == 1 )
    result = Function_21d58a8((short *)result, 0x2000);
  return result;
}

//----- (021D5AF0) --------------------------------------------------------
int *__fastcall Function_21d5af0(int *result, int a2, int a3)
{
  result[14] = a2;
  if ( a3 == 1 )
    result = Function_21d58a8((short *)result, 0x4000);
  return result;
}

//----- (021D5B04) --------------------------------------------------------
int *__fastcall Function_21d5b04(int *result, int a2, int a3)
{
  result[16] = a2;
  if ( a3 == 1 )
    result = Function_21d58a8((short *)result, 0x10000);
  return result;
}

//----- (021D5B18) --------------------------------------------------------
int *__fastcall Function_21d5b18(int *result, int a2, int a3, int a4)
{
  bool v4;
  int v5;

  v4 = a3 == 1;
  v5 = result[17];
  if ( v4 )
  {
    if ( v5 & a2 )
      return result;
  }
  else if ( !(v5 & a2) )
  {
    return result;
  }
  result[17] ^= a2;
  if ( a4 == 1 )
    result = Function_21d58a8((short *)result, 4096);
  return result;
}

//----- (021D5B40) --------------------------------------------------------
int *__fastcall Function_21d5b40(uint *a1, int a2, uint a3, int a4)
{
  uint *v4;
  int v5;
  int v6;
  int *v7;
  int *result;

  v4 = a1;
  v5 = a2;
  v6 = a4;
  v7 = &dword_21F8AE4[6 * a3];
  if ( a3 >= 0x11 )
    ErrorHandler();
  *(uint *)(v5 + 36) = Function_20203ac(4u);
  Function_20206d0(
    v4,
    *v7,
    (ushort *)v7 + 2,
    *((ushort *)v7 + 7),
    *((uchar *)v7 + 12),
    1,
    *(uint *)(v5 + 36));
  Function_20203d4(*(uint *)(v5 + 36));
  result = Function_20206bc(v7[4], v7[5], *(uint *)(v5 + 36));
  if ( v6 )
    result = (int *)Function_2020304(7, 6, 2, 4u, *(uint *)(v5 + 36));
  return result;
}

//----- (021D5BA8) --------------------------------------------------------
uint __fastcall Function_21d5ba8(int a1)
{
  int v1;

  v1 = a1;
  Function_20203e0();
  Function_2020390(*(uint *)(v1 + 36));
  return Call_free5(*(uint *)(v1 + 36));
}

//----- (021D5BC0) --------------------------------------------------------
int __fastcall Function_21d5bc0(int a1)
{
  int v1;

  v1 = *(uint *)(a1 + 24);
  if ( !v1 )
    ErrorHandler();
  if ( v1 >= 5 )
    ErrorHandler();
  return v1 - 1;
}

//----- (021D5BD8) --------------------------------------------------------
int __fastcall Function_21d5bd8(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  v2 = Function_21d5bc0(a1);
  return ((int (__fastcall *)(int))*(&off_21F8C7C + 4 * v2))(v1);
}

//----- (021D5BF4) --------------------------------------------------------
int __fastcall Function_21d5bf4(int a1)
{
  int v1;
  int (__fastcall *v2)(int);
  int result;

  v1 = a1;
  v2 = (int (__fastcall *)(int))dword_21F8C80[4 * Function_21d5bc0(a1)];
  if ( v2 )
    result = v2(v1);
  else
    result = 1;
  return result;
}

//----- (021D5C14) --------------------------------------------------------
int __fastcall Function_21d5c14(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  v2 = Function_21d5bc0(a1);
  return ((int (__fastcall *)(int))*(&off_21F8C84 + 4 * v2))(v1);
}

//----- (021D5C30) --------------------------------------------------------
int __fastcall Function_21d5c30(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  v2 = Function_21d5bc0(a1);
  return ((int (__fastcall *)(int))*(&off_21F8C88 + 4 * v2))(v1);
}

//----- (021D5C4C) --------------------------------------------------------
int Function_21d5c4c()
{
  return Function_21ea728();
}

//----- (021D5C54) --------------------------------------------------------
int Function_21d5c54()
{
  return Function_205a0bc();
}

//----- (021D5C5C) --------------------------------------------------------
int __fastcall Function_21d5c5c(int a1, int a2, int a3, int a4)
{
  int v4;
  int result;

  v4 = a1;
  LoadOverlay(56, 2, a3, a4);
  result = ((int (__fastcall *)(int))dword_2253DD8[2446])(v4);
  *(uint *)(v4 + 132) = result;
  return result;
}

//----- (021D5C78) --------------------------------------------------------
int Function_21d5c78()
{
  return Function_21ea790();
}

//----- (021D5C80) --------------------------------------------------------
int Function_21d5c80()
{
  return Function_205a0a0();
}

//----- (021D5C88) --------------------------------------------------------
int *__fastcall Function_21d5c88(int a1)
{
  int v1;
  int v2;
  int v3;

  ((void (__fastcall *)(uint))dword_2253DD8[2468])(*(uint *)(a1 + 132));
  return UnloadOverlay(56, v1, v2, v3);
}

//----- (021D5CA0) --------------------------------------------------------
int Function_21d5ca0()
{
  return Function_21ea7cc();
}

//----- (021D5CA8) --------------------------------------------------------
int Function_21d5ca8()
{
  return 1;
}

//----- (021D5CAC) --------------------------------------------------------
int Function_21d5cac()
{
  return 1;
}

//----- (021D5CB0) --------------------------------------------------------
int Function_21d5cb0()
{
  int v0;
  int v1;
  int v2;

  v0 = malloc(4u, 392);
  if ( !v0 )
    ErrorHandler();
  v1 = 0;
  v2 = v0;
  do
  {
    *(ushort *)(v2 + 28) = 0;
    *(ushort *)(v2 + 30) = 0;
    *(uint *)(v2 + 8) = 0;
    *(uint *)(v2 + 16) = 0;
    *(uint *)(v2 + 24) = 0;
    *(uint *)(v2 + 20) = 0;
    ++v1;
    v2 += 24;
  }
  while ( v1 < 16 );
  return v0;
}

//----- (021D5CE4) --------------------------------------------------------
int __fastcall Function_21d5ce4(uint *a1, int a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int *v6;
  int *v7;
  uint *v8;
  uint v9;
  int v11;

  v4 = a1;
  v11 = a2;
  v5 = 0;
  v6 = LoadFromNARC_8(155, 4u, a3, a4);
  v7 = v6;
  v8 = (uint *)Function_2006cb8_LoadFileInMemory((int)v6, 0, 4u);
  *v4 = v8;
  v4[1] = v8;
  v9 = 0;
  if ( *v8 )
  {
    do
    {
      if ( Function_21d5d30(v4, v11, v9, v7) >= 0 )
        ++v5;
      ++v9;
    }
    while ( v9 < *(uint *)v4[1] );
  }
  Call_FS_CloseFile(v7);
  return v5;
}

//----- (021D5D30) --------------------------------------------------------
int __fastcall Function_21d5d30(int a1, int a2, int a3, int a4)
{
  int v4;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  char v13;
  int v14;

  v14 = a4;
  v4 = a1;
  v10 = a2;
  v11 = a3;
  v12 = a4;
  if ( !a1 )
    return -1;
  v6 = 0;
  v7 = a1;
  do
  {
    if ( !*(uint *)(v7 + 20) )
      break;
    ++v6;
    v7 += 24;
  }
  while ( v6 < 16 );
  if ( v6 == 16 || !v10 )
    return -1;
  v8 = 24 * v6;
  v9 = 52 * a3;
  *(uint *)(a1 + 8 + 24 * v6) = Function_201df50(v10, (uchar *)(*(uint *)(a1 + 4) + 4 + 52 * a3));
  if ( !*(uint *)(v4 + 8 + 24 * v6) )
    return -1;
  *(uint *)(v4 + v8 + 12) = Function_201dfe4(v10, (uchar *)(*(uint *)(v4 + 4) + 4 + v9));
  Function_20d7510((int)&v13, "data/fld_anime%d.bin");
  *(uint *)(v4 + v8 + 24) = *(uint *)(v4 + 4) + 4 + v9;
  *(uint *)(v4 + 20 + v8) = Function_2006cb8_LoadFileInMemory(v12, v11 + 1, 4u);
  *(uint *)(v4 + v8 + 16) = Function_20b3c1c_GetTexOffsets(*(uint *)(v4 + 20 + v8));
  return v6;
}

//----- (021D5DEC) --------------------------------------------------------
int __fastcall Function_21d5dec(int result)
{
  int v1;
  int v2;
  int v3;
  int v4;
  int v5;

  if ( result )
  {
    v1 = 0;
    v2 = result + 8;
    do
    {
      result = *(uint *)(v2 + 12);
      if ( result )
      {
        v3 = *(uint *)(v2 + 16);
        if ( v3 )
        {
          v4 = *(ushort *)(v2 + 22);
          if ( *(uchar *)(v3 + 2 * *(ushort *)(v2 + 20) + 17) > v4 )
          {
            result = v4 + 1;
            *(ushort *)(v2 + 22) = result;
          }
          else
          {
            *(ushort *)(v2 + 22) = 0;
            if ( *(uchar *)(*(uint *)(v2 + 16) + 2 * (ushort)++*(ushort *)(v2 + 20) + 16) == 255 )
              *(ushort *)(v2 + 20) = 0;
            v5 = Function_201deac(
                   *(uint *)(v2 + 8),
                   *(uchar *)(*(uint *)(v2 + 16) + 2 * *(ushort *)(v2 + 20) + 16));
            result = Function_201dc68(0, *(uint *)v2, v5, *(uint *)(v2 + 4));
          }
        }
      }
      ++v1;
      v2 += 24;
    }
    while ( v1 < 16 );
  }
  return result;
}

//----- (021D5E5C) --------------------------------------------------------
int __fastcall Function_21d5e5c(int result, int a2)
{
  int v2;
  int v3;
  int v4;

  v2 = result;
  if ( result )
  {
    v3 = 24 * a2;
    v4 = *(uint *)(result + 24 * a2 + 20);
    if ( v4 )
      free(v4);
    if ( *(uint *)(v2 + 24 + v3) )
      *(uint *)(v2 + 24 + v3) = 0;
    result = v2 + v3;
    *(ushort *)(result + 28) = 0;
    *(ushort *)(result + 30) = 0;
  }
  return result;
}

//----- (021D5E8C) --------------------------------------------------------
uint __fastcall Function_21d5e8c(uint result)
{
  int *v1;
  int v2;

  v1 = (int *)result;
  if ( result )
  {
    v2 = 0;
    do
      Function_21d5e5c((int)v1, v2++);
    while ( v2 < 16 );
    result = free(*v1);
  }
  return result;
}

//----- (021D5EAC) --------------------------------------------------------
int __fastcall Function_21d5eac(int result)
{
  if ( result )
    result = free(result);
  return result;
}

//----- (021D5EB8) --------------------------------------------------------
uint *__fastcall Function_21d5eb8(int a1)
{
  int v1;
  uint *v2;
  uchar *v3;
  int v4;

  v1 = a1;
  v2 = (uint *)malloc(4u, 24);
  v3 = v2;
  v4 = 24;
  do
  {
    *v3++ = 0;
    --v4;
  }
  while ( v4 );
  *v2 = Function_21d6364_LoadWeatherSys_Narc(v1);
  v2[1] = 0;
  v2[2] = 0;
  v2[3] = 6;
  v2[5] = 0;
  v2[4] = 31;
  Function_201ff0c(0x10u, 1);
  return v2;
}

//----- (021D5EF8) --------------------------------------------------------
uint __fastcall Function_21d5ef8_RemoveTask(int a1)
{
  int v1;
  int *v2;
  uchar *v3;
  int v4;

  v1 = a1;
  v2 = *(int **)(a1 + 20);
  if ( v2 )
    Call_RemoveTaskFromTaskList(v2);
  Function_21d63a4(v1);
  v3 = (uchar *)v1;
  v4 = 24;
  do
  {
    *v3++ = 0;
    --v4;
  }
  while ( v4 );
  return free(v1);
}

//----- (021D5F24) --------------------------------------------------------
uint __fastcall Function_5_21d5f24(uint *a1, int a2)
{
  uint *v2;
  uint result;
  int v4;

  v2 = a1;
  result = a1[3];
  v4 = a2;
  if ( result != 6 )
    result = ErrorHandler();
  if ( v4 >= 31 )
    result = ErrorHandler();
  if ( v2[1] != v4 )
  {
    if ( !Function_21d6418(*v2, 8) )
      ErrorHandler();
    if ( !Function_21d6418(*v2, 0) )
      ErrorHandler();
    result = Function_21d6418(*v2, 3);
    if ( !result )
      result = ErrorHandler();
    v2[1] = v4;
  }
  return result;
}

//----- (021D5F7C) --------------------------------------------------------
int __fastcall Function_5_21d5f7c(uint *a1, int a2)
{
  int v2;
  uint *v3;
  int result;
  uint *v5;

  v2 = a2;
  v3 = a1;
  if ( a2 >= 31 )
    ErrorHandler();
  if ( v3[3] == 6 )
  {
    if ( v3[1] == v2 )
    {
      result = 1;
    }
    else
    {
      if ( v3[5] )
        ErrorHandler();
      v3[2] = v2;
      if ( Function_21d6178(v3[1], v2) )
      {
        v3[3] = 0;
        v5 = AddTaskToTaskList1((int)Function_21d60b4, (int)v3, 0);
      }
      else
      {
        v3[3] = 0;
        v5 = AddTaskToTaskList1((int)Function_21d5fe4, (int)v3, 0);
      }
      v3[5] = v5;
      result = 1;
    }
  }
  else
  {
    v3[4] = v2;
    result = 1;
  }
  return result;
}

//----- (021D5FE0) --------------------------------------------------------
int __fastcall Function_21d5fe0(int a1)
{
  return *(uint *)(a1 + 4);
}

//----- (021D5FE4) --------------------------------------------------------
int *__fastcall Function_21d5fe4(int *result, uint *a2)
{
  uint *v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;

  v2 = a2;
  switch ( (uchar)a2[3] )
  {
    case 0u:
      v3 = a2[1];
      if ( !Function_21d6418(*a2, 5) )
        ErrorHandler();
      result = (int *)(v2[3] + 1);
      v2[3] = result;
      break;
    case 1u:
      result = (int *)Function_21d64d0(*a2, a2[1]);
      if ( result != (int *)3 )
      {
        v4 = v2[1];
        if ( !Function_21d6418(*v2, 8) )
          ErrorHandler();
        result = (int *)(v2[3] + 1);
        v2[3] = result;
      }
      break;
    case 2u:
      v5 = a2[2];
      if ( !Function_21d6418(*a2, 1) )
        ErrorHandler();
      result = (int *)(v2[3] + 1);
      v2[3] = result;
      break;
    case 3u:
      result = (int *)Function_21d64d0(*a2, a2[2]);
      if ( result != (int *)1 )
      {
        result = (int *)(v2[3] + 1);
        v2[3] = result;
      }
      break;
    case 4u:
      v6 = a2[2];
      if ( !Function_21d6418(*a2, 2) )
        ErrorHandler();
      ++v2[3];
      v2[1] = v2[2];
      result = 0;
      v2[2] = 0;
      break;
    case 5u:
      a2[3] = 6;
      a2[5] = 0;
      result = (int *)Call_RemoveTaskFromTaskList(result);
      v7 = v2[4];
      if ( v7 != 31 )
      {
        Function_5_21d5f7c(v2, v7);
        result = (int *)31;
        v2[4] = 31;
      }
      break;
    default:
      return result;
  }
  return result;
}

//----- (021D60B4) --------------------------------------------------------
int *__fastcall Function_21d60b4(int *result, uint *a2)
{
  uint *v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;

  v2 = a2;
  switch ( (uchar)a2[3] )
  {
    case 0u:
      v3 = a2[2];
      if ( !Function_21d6418(*a2, 1) )
        ErrorHandler();
      result = (int *)(v2[3] + 1);
      v2[3] = result;
      break;
    case 1u:
      result = (int *)Function_21d64d0(*a2, a2[2]);
      if ( result != (int *)1 )
      {
        result = (int *)(v2[3] + 1);
        v2[3] = result;
      }
      break;
    case 2u:
      v4 = a2[1];
      if ( !Function_21d6418(*a2, 7) )
        ErrorHandler();
      v5 = v2[2];
      if ( !Function_21d6418(*v2, 4) )
        ErrorHandler();
      result = (int *)(v2[3] + 1);
      v2[3] = result;
      break;
    case 3u:
      result = (int *)Function_21d64d0(*a2, a2[1]);
      if ( result != (int *)3 )
      {
        v6 = v2[1];
        if ( !Function_21d6418(*v2, 8) )
          ErrorHandler();
        result = (int *)(v2[3] + 1);
        v2[3] = result;
      }
      break;
    case 4u:
      a2[1] = a2[2];
      a2[2] = 0;
      a2[3] = 6;
      a2[5] = 0;
      result = (int *)Call_RemoveTaskFromTaskList(result);
      v7 = v2[4];
      if ( v7 != 31 )
      {
        Function_5_21d5f7c(v2, v7);
        result = (int *)31;
        v2[4] = 31;
      }
      break;
    default:
      return result;
  }
  return result;
}

//----- (021D6178) --------------------------------------------------------
int __fastcall Function_21d6178(int a1, int a2)
{
  int v2;

  v2 = 0;
  if ( a1 > 7 )
  {
    if ( a1 == 21 && (uint)(a2 - 5) <= 2 )
      v2 = 1;
  }
  else if ( a1 >= 5 )
  {
    if ( a1 == 5 )
    {
      if ( a2 == 6 || a2 == 21 || a2 == 7 )
        v2 = 1;
    }
    else if ( a1 == 6 )
    {
      if ( a2 == 5 || a2 == 21 || a2 == 7 )
        v2 = 1;
    }
    else if ( a1 == 7 && (a2 == 5 || a2 == 21 || a2 == 6) )
    {
      v2 = 1;
    }
  }
  return v2;
}

//----- (021D61D0) --------------------------------------------------------
uint *__fastcall Function_21d61d0(uint *a1)
{
  uint *v1;
  int *v2;
  int ***v3;
  int **v4;
  int v5;
  uint *result;
  int v7;
  uint *v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;

  v1 = a1;
  Function_202309c((int)(a1 + 5), -4096);
  v10 = 0;
  v11 = 0;
  v12 = 1044480;
  v13 = 786432;
  Function_200a8b0((int)(v1 + 43), &v10, 1, (int)(v1 + 5));
  v2 = 0;
  v3 = (int ***)v1;
  do
  {
    v4 = Function_2009714(31, v2, 4u);
    v2 = (int *)((char *)v2 + 1);
    *v3 = v4;
    ++v3;
  }
  while ( (int)v2 < 4 );
  v5 = Function_2009f34();
  v1[4] = malloc(4u, 4 * v5);
  ((void (*)(void))Function_21d6290)();
  Function_21d6290(v1[4], 1, 64);
  Function_21d6290(v1[4], 2, 61);
  Function_21d6290(v1[4], 3, 62);
  v7 = 96;
  v8 = v1 + 5;
  v9 = 4;
  v1[61] = Function_20218bc(&v7);
  result = AddTaskToTaskList1((int)Function_21d6284, (int)v1, 0xAu);
  v1[62] = result;
  return result;
}

//----- (021D6284) --------------------------------------------------------
int __fastcall Function_21d6284(int a1, int a2)
{
  return Function_20219f8(*(uint *)(a2 + 244));
}

//----- (021D6290) --------------------------------------------------------
uint __fastcall Function_21d6290(int a1, int a2, int a3)
{
  int v3;
  int v4;
  uint *v5;

  v3 = a3;
  v4 = Function_2009f38(a1, a2);
  v5 = Function_2006fe8_LoadFromNARC_UncompressLZ8(65, v3, 0, 4, 1);
  Function_2009f40((char *)v5, v4, 4u);
  return free((int)v5);
}

//----- (021D62BC) --------------------------------------------------------
int __fastcall Function_21d62bc(int **a1)
{
  int **v1;
  int v2;
  int **v3;
  int *v4;
  int result;

  v1 = a1;
  v2 = 0;
  v3 = a1;
  do
  {
    v4 = (int *)Function_2009f38((int)v1[4], v2);
    Function_2009f8c(v4);
    Function_2009754(*v3);
    ++v2;
    ++v3;
  }
  while ( v2 < 4 );
  free((int)v1[4]);
  v1[4] = 0;
  Function_2021964(v1[61]);
  v1[61] = 0;
  Call_RemoveTaskFromTaskList(v1[62]);
  result = 0;
  v1[62] = 0;
  return result;
}

//----- (021D630C) --------------------------------------------------------
int __fastcall Function_21d630c(uint *a1, int *a2)
{
  int *v2;
  uint *v3;
  int v4;
  int v5;
  int v6;

  v2 = a2;
  v3 = a1;
  v4 = *a2;
  if ( *a2 <= 1306624 )
  {
    if ( v4 < -262144 )
      *a2 = v4 + 1306624;
  }
  else
  {
    s32_div_f(v4, 1306624);
    *v2 = v5;
  }
  v6 = v2[1];
  if ( v6 <= 0x100000 )
  {
    if ( v6 < -262144 )
      v2[1] = v6 + 0x100000;
  }
  else
  {
    v2[1] = ((uint)v6 >> 31) + __ROR4__((v6 << 12) - ((uint)v6 >> 31), 12);
  }
  return Function_2021c50(v3, v2);
}

//----- (021D6364) --------------------------------------------------------
uint *__fastcall Function_21d6364_LoadWeatherSys_Narc(int a1)
{
  int v1;
  int v2;
  uint *v3;
  int v4;
  int v5;

  v1 = a1;
  v2 = malloc(4u, 268);
  v3 = (uint *)v2;
  *(uint *)(v2 + 260) = v1;
  Function_21d61d0((uint *)(v2 + 8));
  *v3 = dword_2201D78;
  v3[1] = dword_21F8D90;
  v3[66] = LoadFromNARC_8(65, 4u, v4, v5);
  return v3;
}

//----- (021D63A4) --------------------------------------------------------
int __fastcall Function_21d63a4(int *a1)
{
  int *v1;
  int result;
  int v3;

  v1 = a1;
  result = *a1;
  if ( result )
  {
    v3 = 0;
    do
      Function_21d68b8(*v1, v3++);
    while ( v3 < 31 );
    Function_5_21d57fc_CallG3X_SetFog(*(int **)(*(uint *)(*v1 + 260) + 72), 1, 0, 0, 0, 0);
    REG_BG0CNT = REG_BG0CNT & 0xFFFC | 1;
    Function_201ff0c(4u, 0);
    Function_21d62bc((int **)(*v1 + 8));
    Call_FS_CloseFile(*(int **)(*v1 + 264));
    Function_2018238(4u, *v1);
    result = 0;
    *v1 = 0;
  }
  return result;
}

//----- (021D6418) --------------------------------------------------------
int __fastcall Function_21d6418(int a1, char a2, int a3)
{
  int v3;
  int v4;
  int v5;

  v3 = a3;
  v4 = a1;
  v5 = 1;
  if ( a3 > 31 )
    return 0;
  switch ( a2 )
  {
    case 0:
      v5 = Function_21d66d0();
      break;
    case 1:
      v5 = Function_21d6730();
      break;
    case 2:
      v5 = Function_21d676c(a1, a3, 0, 1);
      break;
    case 3:
      v5 = Function_21d676c(a1, a3, 2, 1);
      break;
    case 4:
      if ( Function_21d57ec(*(uint *)(*(uint *)(a1 + 260) + 72)) == 1 )
        v5 = Function_21d676c(v4, v3, 0, 2);
      else
        v5 = Function_21d676c(v4, v3, 0, 1);
      break;
    case 5:
      Function_21d6868();
      break;
    case 6:
      Function_21d6890();
      break;
    case 7:
      Function_21d6868();
      break;
    case 8:
      Function_21d68b8(a1, a3);
      break;
    default:
      return v5;
  }
  return v5;
}

//----- (021D64D0) --------------------------------------------------------
int __fastcall Function_21d64d0(uint *a1, int a2)
{
  int result;

  if ( a2 < 31 )
    result = *(ushort *)(*a1 + 28 * a2 + 16);
  else
    result = 0;
  return result;
}

//----- (021D64E4) --------------------------------------------------------
int *__fastcall Function_21d64e4(int a1, int a2)
{
  return G2x_SetBlendAlpha_((int *)&REG_BLDCNT, 4, 33, a1, a2);
}

//----- (021D64FC) --------------------------------------------------------
uint *__fastcall Function_21d64fc(uint *result, int a2, int a3, int a4)
{
  *result = a2;
  result[1] = a2;
  result[2] = a3 - a2;
  result[4] = a4;
  result[3] = 0;
  return result;
}

//----- (021D650C) --------------------------------------------------------
int __fastcall Function_21d650c(uint *a1)
{
  uint *v1;
  int v2;
  int v3;
  int result;

  v1 = a1;
  *v1 = s32_div_f(a1[3] * a1[2], a1[4]) + v1[1];
  v2 = v1[4];
  v3 = v1[3] + 1;
  if ( v3 > v2 )
  {
    v1[3] = v2;
    result = 1;
  }
  else
  {
    v1[3] = v3;
    result = 0;
  }
  return result;
}

//----- (021D6538) --------------------------------------------------------
int __fastcall Function_21d6538(int result, int a2, int a3, short a4)
{
  *(uint *)result = a2;
  *(uint *)(result + 4) = a2;
  *(uint *)(result + 8) = a3 - a2;
  *(ushort *)(result + 14) = a4;
  *(ushort *)(result + 12) = 0;
  return result;
}

//----- (021D6548) --------------------------------------------------------
int __fastcall Function_21d6548(int a1)
{
  int v1;
  long long v2;
  int v3;
  int v4;
  int result;

  v1 = a1;
  v2 = ll_mul(*(int *)(a1 + 8), *(short *)(a1 + 12));
  *(uint *)v1 = FX_Div((v2 + 2048) >> 12, *(short *)(v1 + 14)) + *(uint *)(v1 + 4);
  v3 = *(short *)(v1 + 14);
  v4 = *(short *)(v1 + 12) + 1;
  if ( v4 > v3 )
  {
    *(ushort *)(v1 + 12) = v3;
    result = 1;
  }
  else
  {
    *(ushort *)(v1 + 12) = v4;
    result = 0;
  }
  return result;
}

//----- (021D6594) --------------------------------------------------------
int __fastcall Function_21d6594(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  Function_21d6bfc();
  Function_21d6c30(v3, v4, v5);
  Function_21d6c64(v3, v4, v5);
  return Function_21d6ca0(v3, v4, v5);
}

//----- (021D65C0) --------------------------------------------------------
int *__fastcall Function_21d65c0(int a1, int a2, int a3, int a4, int a5, int a6)
{
  int v6;
  int v7;
  int *v8;
  int v9;
  char v10;
  int *v12;
  int v13;
  int v14;
  int v15;
  int v16;

  v6 = a3;
  v7 = a4;
  v8 = (int *)Function_2009f38(a1, a2);
  v13 = Function_2009fe8((int)v8, v6);
  v14 = Function_200a014((int)v8, v6);
  v15 = Function_200a040(v8, v6);
  v16 = Function_200a074(v8, v6);
  v9 = Function_2009fb4(v8, v6);
  switch ( v10 )
  {
    case 0:
      v12 = Function_2009aa8(v7, a5, v13, v14, v9, v15, 4u, a6);
      break;
    case 1:
      v12 = Function_2009b64(v7, a5, v13, v14, v9, v15, v16, 4u, a6);
      break;
    case 2:
      v12 = Function_2009bc4(v7, a5, v13, v14, v9, 2u, 4u);
      break;
    case 3:
      v12 = Function_2009bc4(v7, a5, v13, v14, v9, 3u, 4u);
      break;
    default:
      return v12;
  }
  return v12;
}

//----- (021D6690) --------------------------------------------------------
int *__fastcall Function_21d6690(int a1, int a2, int **a3)
{
  int v3;
  int *result;
  int **v5;
  int v6;

  v3 = a1;
  result = (int *)0xFFFF;
  v5 = a3;
  if ( a2 != 0xFFFF )
  {
    if ( *a3 )
      Function_200a4e4(*a3);
    result = v5[1];
    if ( result )
      result = (int *)Function_200a6dc(result);
    v6 = 0;
    do
    {
      if ( *v5 )
        result = (int *)Function_2009d68(*(int **)(v3 + 8), (uint **)*v5);
      ++v6;
      ++v5;
      v3 += 4;
    }
    while ( v6 < 4 );
  }
  return result;
}

//----- (021D66D0) --------------------------------------------------------
int __fastcall Function_21d66d0(uint *a1, int a2)
{
  uint *v2;
  ushort *v3;
  int result;

  v2 = a1;
  v3 = (ushort *)(*a1 + 28 * a2);
  if ( !*((uint *)v3 + 2) )
  {
    if ( !Function_21d6b60() )
      return 0;
    if ( !Function_21d6a48(v2, v3) )
    {
      free(*((uint *)v3 + 2));
      result = 0;
      *((uint *)v3 + 2) = 0;
      return result;
    }
    *(uint *)(*((uint *)v3 + 2) + 8) = *((uint *)v3 + 3);
    if ( *v3 != 0xFFFF )
      Function_21d6d34(*((uint *)v3 + 2));
    Function_21d6a2c(v2, v3[1]);
    v3[8] = 2;
  }
  return 1;
}

//----- (021D6730) --------------------------------------------------------
int __fastcall Function_21d6730(uint *a1, int a2)
{
  int v2;
  int result;

  v2 = *a1 + 28 * a2;
  if ( *(uint *)(v2 + 8) )
    return 1;
  if ( !Function_21d6b60() )
    return 0;
  *(uint *)(v2 + 20) = AddTaskToTaskList1((int)Function_21d6a84, v2, 1u);
  result = 1;
  *(ushort *)(v2 + 16) = 1;
  *(ushort *)(v2 + 18) = 0;
  return result;
}

//----- (021D676C) --------------------------------------------------------
int __fastcall Function_21d676c(uint *a1, int a2, short a3, short a4)
{
  short v4;
  ushort *v5;
  short v6;
  int v8;
  uint *v9;
  int v10;

  v4 = a3;
  v5 = (ushort *)(*a1 + 28 * a2);
  v6 = a4;
  if ( *v5 != 0xFFFF && !*((uint *)v5 + 3) )
    return 0;
  v8 = *((uint *)v5 + 2);
  if ( !v8 )
    return 0;
  if ( v5[8] != 2 )
    return 0;
  *(uint *)(*((uint *)v5 + 2) + 2952) = AddTaskToTaskList1(*((uint *)v5 + 6), v8, 4u);
  if ( !*(uint *)(*((uint *)v5 + 2) + 2952) )
    return 0;
  v5[8] = 3;
  *(ushort *)(*((uint *)v5 + 2) + 2978) = v4;
  *(ushort *)(*((uint *)v5 + 2) + 2982) = 0;
  *(uint *)(*((uint *)v5 + 2) + 64) = *((uint *)v5 + 2) + 12;
  *(uint *)(*((uint *)v5 + 2) + 68) = *((uint *)v5 + 2) + 12;
  *(ushort *)(*((uint *)v5 + 2) + 2980) = v6;
  *(uint *)(*((uint *)v5 + 2) + 2972) = 0;
  v9 = (uint *)(*((uint *)v5 + 2) + 2956);
  *v9 = dword_21C5CE4;
  v9[1] = dword_21C5CE8;
  v9[2] = dword_21C5CEC;
  v10 = *((uint *)v5 + 1);
  if ( v10 <= 0 )
  {
    *(uint *)(*((uint *)v5 + 2) + 2968) = 0;
  }
  else
  {
    *(uint *)(*((uint *)v5 + 2) + 2968) = malloc(4u, v10);
    Call_FillMemWithValue(*(int **)(*((uint *)v5 + 2) + 2968), 0, *((uint *)v5 + 1));
  }
  if ( v5[1] != 0xFFFF )
  {
    Function_201ff0c(4u, 0);
    REG_BG2CNT = REG_BG2CNT & 0xFFFC | 1;
    REG_BG0CNT = REG_BG0CNT & 0xFFFC | 2;
  }
  return 1;
}

//----- (021D6868) --------------------------------------------------------
int __fastcall Function_21d6868(uint *a1, int a2, short a3)
{
  int v3;
  int result;

  v3 = *a1 + 28 * a2;
  result = *(ushort *)(v3 + 16);
  if ( result == 3 )
  {
    *(ushort *)(*(uint *)(v3 + 8) + 2982) = 5;
    result = 2980;
    *(ushort *)(*(uint *)(v3 + 8) + 2980) = a3;
  }
  return result;
}

//----- (021D6890) --------------------------------------------------------
int __fastcall Function_21d6890(uint *a1, int a2)
{
  int v2;
  int result;

  v2 = *a1 + 28 * a2;
  result = Function_21d64d0(a1, a2);
  if ( result == 3 )
  {
    *(ushort *)(*(uint *)(v2 + 8) + 2978) = 5;
    result = (*(int (__fastcall **)(uint, uint))(v2 + 24))(0, *(uint *)(v2 + 8));
  }
  return result;
}

//----- (021D68B8) --------------------------------------------------------
int __fastcall Function_21d68b8(uint *a1, int a2)
{
  int v2;
  ushort *v3;
  int **v4;
  int *v5;
  int v6;
  int v7;
  int v8;
  int *v9;

  v2 = (int)a1;
  v3 = (ushort *)(*a1 + 28 * a2);
  if ( v3[1] != 0xFFFF )
  {
    Function_201ff0c(4u, 0);
    REG_BG2CNT = REG_BG2CNT & 0xFFFC | 3;
    REG_BG0CNT = REG_BG0CNT & 0xFFFC | 1;
    REG_BLDCNT = 0;
  }
  v4 = (int **)*((uint *)v3 + 3);
  if ( v4 )
  {
    Function_21d6690(v2, *v3, v4);
    Function_2018238(4u, *((uint *)v3 + 3));
    *((uint *)v3 + 3) = 0;
    v5 = (int *)*((uint *)v3 + 5);
    if ( v5 )
    {
      Call_RemoveTaskFromTaskList(v5);
      *((uint *)v3 + 5) = 0;
    }
  }
  v6 = *((uint *)v3 + 2);
  if ( v6 )
  {
    Function_21d6fd8(v6 + 12);
    if ( *v3 != 0xFFFF )
      Function_21d6d64(*((uint *)v3 + 2));
    if ( *(uint *)(*((uint *)v3 + 2) + 2972) == 1 )
      Function_21db4e4();
    v7 = *(uint *)(*((uint *)v3 + 2) + 2968);
    if ( v7 )
    {
      Function_2018238(4u, v7);
      *(uint *)(*((uint *)v3 + 2) + 2968) = 0;
    }
    v8 = v3[8];
    if ( v8 == 1 )
    {
      v9 = (int *)*((uint *)v3 + 5);
      if ( v9 )
        Call_RemoveTaskFromTaskList(v9);
    }
    else if ( v8 == 3 )
    {
      Call_RemoveTaskFromTaskList(*(int **)(*((uint *)v3 + 2) + 2952));
    }
    Function_2018238(4u, *((uint *)v3 + 2));
    *((uint *)v3 + 2) = 0;
  }
  return Function_5_21d57fc_CallG3X_SetFog(*(int **)(*(uint *)(v2 + 260) + 72), 1, 0, 0, 0, 0);
}

//----- (021D69B8) --------------------------------------------------------
int __fastcall Function_21d69b8(int a1)
{
  int v1;
  int result;

  v1 = a1;
  if ( *(ushort *)(a1 + 2) != 0xFFFF )
  {
    Function_201ff0c(4u, 0);
    REG_BG2CNT = REG_BG2CNT & 0xFFFC | 3;
    REG_BG0CNT = REG_BG0CNT & 0xFFFC | 1;
    REG_BLDCNT = 0;
  }
  result = *(uint *)(v1 + 8);
  if ( result )
  {
    Function_21d6fd8(result + 12);
    if ( *(uint *)(*(uint *)(v1 + 8) + 2972) == 1 )
      Function_21db4e4();
    result = *(ushort *)(v1 + 16);
    if ( result == 3 )
    {
      Call_RemoveTaskFromTaskList(*(int **)(*(uint *)(v1 + 8) + 2952));
      result = 2;
      *(ushort *)(v1 + 16) = 2;
    }
  }
  return result;
}

//----- (021D6A2C) --------------------------------------------------------
int __fastcall Function_21d6a2c(int a1, int a2)
{
  int v2;
  int v3;

  v2 = a1;
  v3 = a2;
  Function_21d6d84();
  Function_21d6dcc(v2, v3);
  return Function_21d6e20(v2, v3);
}

//----- (021D6A48) --------------------------------------------------------
int __fastcall Function_21d6a48(int a1, ushort *a2)
{
  ushort *v2;
  int v3;

  v2 = a2;
  v3 = a1;
  if ( *a2 != 0xFFFF && !*((uint *)a2 + 3) )
  {
    if ( !Function_21d6bc4(a2) )
      return 0;
    Function_21d6594(v3, *v2, *((uint *)v2 + 3));
    Function_21d6cdc(v3, v2);
  }
  return 1;
}

//----- (021D6A84) --------------------------------------------------------
int __fastcall Function_21d6a84(int *a1, ushort *a2)
{
  ushort *v2;
  int *v3;
  int result;

  v2 = a2;
  v3 = a1;
  result = **((uint **)a2 + 2);
  switch ( (uchar)a2[9] )
  {
    case 0u:
      if ( !Function_21d6bc4(a2) )
        ErrorHandler();
      result = v2[9] + 1;
      v2[9] = result;
      break;
    case 1u:
      Function_21d6bfc(result, *a2, *((uint *)a2 + 3));
      result = v2[9] + 1;
      v2[9] = result;
      break;
    case 2u:
      Function_21d6d84(result, a2[1]);
      result = v2[9] + 1;
      v2[9] = result;
      break;
    case 3u:
      Function_21d6c30(result, *a2, *((uint *)a2 + 3));
      result = v2[9] + 1;
      v2[9] = result;
      break;
    case 4u:
      Function_21d6dcc(result, a2[1]);
      result = v2[9] + 1;
      v2[9] = result;
      break;
    case 5u:
      Function_21d6c64(result, *a2, *((uint *)a2 + 3));
      result = v2[9] + 1;
      v2[9] = result;
      break;
    case 6u:
      Function_21d6e20(result, a2[1]);
      result = v2[9] + 1;
      v2[9] = result;
      break;
    case 7u:
      Function_21d6ca0(result, *a2, *((uint *)a2 + 3));
      result = v2[9] + 1;
      v2[9] = result;
      break;
    case 8u:
      Function_21d6cdc(result, a2);
      *(uint *)(*((uint *)v2 + 2) + 8) = *((uint *)v2 + 3);
      if ( *v2 != 0xFFFF )
        Function_21d6d34(*((uint *)v2 + 2));
      v2[8] = 2;
      v2[9] = 0;
      *((uint *)v2 + 5) = 0;
      result = Call_RemoveTaskFromTaskList(v3);
      break;
    default:
      return result;
  }
  return result;
}

//----- (021D6B60) --------------------------------------------------------
int __fastcall Function_21d6b60(int a1, int a2)
{
  int v2;
  int v3;
  int *v5;

  v2 = a2;
  v3 = a1;
  if ( *(uint *)(a2 + 8) )
    return 1;
  v5 = (int *)malloc(4u, 2984);
  *(uint *)(v2 + 8) = v5;
  if ( !v5 )
    return 0;
  Call_FillMemWithValue(v5, 0, 0xBA8u);
  **(uint **)(v2 + 8) = v3;
  *(ushort *)(*(uint *)(v2 + 8) + 2978) = 0;
  *(ushort *)(*(uint *)(v2 + 8) + 2982) = 0;
  *(uint *)(*(uint *)(v2 + 8) + 64) = *(uint *)(v2 + 8) + 12;
  *(uint *)(*(uint *)(v2 + 8) + 68) = *(uint *)(v2 + 8) + 12;
  *(uint *)(*(uint *)(v2 + 8) + 2968) = 0;
  *(uint *)(*(uint *)(v2 + 8) + 4) = v2;
  return 1;
}

//----- (021D6BC4) --------------------------------------------------------
int __fastcall Function_21d6bc4(ushort *a1)
{
  ushort *v1;
  int *v3;

  v1 = a1;
  if ( *a1 != 0xFFFF )
  {
    if ( *((uint *)a1 + 3) )
      return 1;
    v3 = (int *)malloc(4u, 100);
    *((uint *)v1 + 3) = v3;
    if ( !v3 )
      return 0;
    Call_FillMemWithValue(v3, 0, 0x64u);
  }
  return 1;
}

//----- (021D6BFC) --------------------------------------------------------
int *__fastcall Function_21d6bfc(int *a1, int a2, int a3)
{
  int *v3;
  int *result;
  int v5;

  v3 = a1;
  result = (int *)0xFFFF;
  v5 = a3;
  if ( a2 != 0xFFFF )
  {
    result = Function_21d65c0(v3[6], 2, a2, v3[4], v3[66], 0);
    *(uint *)(v5 + 8) = result;
  }
  return result;
}

//----- (021D6C30) --------------------------------------------------------
int *__fastcall Function_21d6c30(int *a1, int a2, int a3)
{
  int *v3;
  int *result;
  int v5;

  v3 = a1;
  result = (int *)0xFFFF;
  v5 = a3;
  if ( a2 != 0xFFFF )
  {
    result = Function_21d65c0(v3[6], 3, a2, v3[5], v3[66], 0);
    *(uint *)(v5 + 12) = result;
  }
  return result;
}

//----- (021D6C64) --------------------------------------------------------
int __fastcall Function_21d6c64(int *a1, int a2, int **a3)
{
  int *v3;
  int result;
  int **v5;
  int *v6;

  v3 = a1;
  result = 0xFFFF;
  v5 = a3;
  if ( a2 != 0xFFFF )
  {
    v6 = Function_21d65c0(v3[6], 0, a2, v3[2], v3[66], 1);
    *v5 = v6;
    Function_200a3dc(v6);
    result = Function_2009d4c(*v5);
  }
  return result;
}

//----- (021D6CA0) --------------------------------------------------------
int __fastcall Function_21d6ca0(int *a1, int a2, int a3)
{
  int *v3;
  int result;
  int v5;
  int *v6;

  v3 = a1;
  result = 0xFFFF;
  v5 = a3;
  if ( a2 != 0xFFFF )
  {
    v6 = Function_21d65c0(v3[6], 1, a2, v3[3], v3[66], 1);
    *(uint *)(v5 + 4) = v6;
    Function_200a640(v6);
    result = Function_2009d4c(*(int **)(v5 + 4));
  }
  return result;
}

//----- (021D6CDC) --------------------------------------------------------
int __fastcall Function_21d6cdc(int a1, ushort *a2)
{
  ushort *v2;
  int v3;
  int result;

  v2 = a2;
  v3 = a1;
  result = 0xFFFF;
  if ( *a2 != 0xFFFF )
  {
    Function_21d6f4c(*((uint *)a2 + 3) + 64, v3);
    Call_FillMemWithValue((int *)(*((uint *)v2 + 3) + 16), 0, 0x30u);
    *(uint *)(*((uint *)v2 + 3) + 16) = *(uint *)(v3 + 252);
    *(uint *)(*((uint *)v2 + 3) + 20) = *((uint *)v2 + 3) + 64;
    *(uint *)(*((uint *)v2 + 3) + 36) = 4096;
    *(uint *)(*((uint *)v2 + 3) + 40) = 4096;
    *(uint *)(*((uint *)v2 + 3) + 44) = 4096;
    result = *((uint *)v2 + 3);
    *(uint *)(result + 56) = 1;
  }
  return result;
}

//----- (021D6D34) --------------------------------------------------------
uint __fastcall Function_21d6d34(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  uint result;

  v1 = a1;
  v2 = 0;
  v3 = a1;
  do
  {
    v4 = Function_2021aa0((uint **)(*(uint *)(v1 + 8) + 16));
    *(uint *)(v3 + 76) = v4;
    Function_2021cac(v4, 0);
    result = *(uint *)(v3 + 76);
    if ( !result )
      result = ErrorHandler();
    ++v2;
    v3 += 60;
  }
  while ( v2 < 48 );
  return result;
}

//----- (021D6D64) --------------------------------------------------------
int __fastcall Function_21d6d64(int a1)
{
  int v1;
  int v2;
  int result;

  v1 = 0;
  v2 = a1;
  do
  {
    result = *(uint *)(v2 + 76);
    if ( result )
    {
      result = Function_2021bd4(result);
      *(uint *)(v2 + 76) = 0;
    }
    ++v1;
    v2 += 60;
  }
  while ( v1 < 48 );
  return result;
}

//----- (021D6D84) --------------------------------------------------------
int __fastcall Function_21d6d84(int a1, int a2, int a3, int a4)
{
  int v4;
  int result;
  int v6;
  int v7;
  int v8;

  v8 = a4;
  v4 = a1;
  result = 0xFFFF;
  if ( a2 != 0xFFFF )
  {
    v6 = Function_2006cb8_LoadFileInMemory(*(uint *)(v4 + 264), *(uint *)(*(uint *)(v4 + 4) + 12 * a2), 4u);
    Function_20a71b0(v6, &v7);
    Function_201972c(2u, *(uint *)(v7 + 12), 32, 192);
    free(v6);
    result = 0;
  }
  return result;
}

//----- (021D6DCC) --------------------------------------------------------
int __fastcall Function_21d6dcc(uint *a1, int a2, int a3, int a4)
{
  uint *v4;
  int result;
  int v6;
  int v7;
  int v8;

  v8 = a4;
  v4 = a1;
  result = 0xFFFF;
  if ( a2 != 0xFFFF )
  {
    v6 = Function_2006cb8_LoadFileInMemory(v4[66], *(uint *)(v4[1] + 12 * a2 + 4), 4u);
    NNS_G2dGetUnpackedPaletteData(v6, &v7);
    Function_201958c(*(uint **)(v4[65] + 8), 2u, *(int **)(v7 + 20), *(uint *)(v7 + 16), 0);
    free(v6);
    result = 0;
  }
  return result;
}

//----- (021D6E20) --------------------------------------------------------
int __fastcall Function_21d6e20(uint *a1, int a2)
{
  uint *v2;
  int result;
  int v4;
  int v5;
  int v6;

  v2 = a1;
  result = 0xFFFF;
  v4 = a2;
  if ( a2 != 0xFFFF )
  {
    Function_201ff0c(4u, 0);
    v5 = Function_2006cb8_LoadFileInMemory(v2[66], *(uint *)(v2[1] + 12 * v4 + 8), 4u);
    if ( !v5 )
      ErrorHandler();
    Function_20a7248(v5, &v6);
    Function_2019460(*(uint **)(v2[65] + 8), 2u, (int *)(v6 + 12), *(uint *)(v6 + 8), 0);
    Function_2019574(*(uint *)(v2[65] + 8), 2, (int *)(v6 + 12), *(uint *)(v6 + 8));
    Function_2019e2c(*(uint *)(v2[65] + 8), 2, 0, 0, 0x20u, 0x20u, 6u);
    Function_2019448(*(uint **)(v2[65] + 8), 2u);
    free(v5);
    result = 0;
  }
  return result;
}

//----- (021D6EC8) --------------------------------------------------------
int __fastcall Function_21d6ec8(int a1, uint a2)
{
  int v2;
  uint v3;
  int result;

  v2 = a1;
  v3 = a2;
  if ( *(uint *)(a1 + 8) )
    ErrorHandler();
  if ( (int)v3 <= 0 )
    ErrorHandler();
  if ( v3 > 0x28 )
    ErrorHandler();
  result = v2 + 12;
  *(uint *)(v2 + 8) = v2 + 12;
  return result;
}

//----- (021D6EF0) --------------------------------------------------------
int *__fastcall Function_21d6ef0(int a1)
{
  *(uint *)(a1 + 8) = 0;
  return Call_FillMemWithValue((int *)(a1 + 12), 0, 0x28u);
}

//----- (021D6F00) --------------------------------------------------------
uint *__fastcall Function_21d6f00(uint *a1, uint a2)
{
  uint *v2;
  uint v3;
  int v4;
  uint *v5;
  uint *v6;

  v2 = a1;
  v3 = a2;
  v4 = *a1;
  v5 = (uint *)Function_21d75e4();
  v6 = v5;
  if ( !v5 )
    return 0;
  *v5 = v4;
  v5[13] = v2 + 3;
  v5[14] = v2[17];
  *(uint *)(v2[17] + 52) = v5;
  v2[17] = v5;
  Function_21d6ec8((int)v5, v3);
  if ( !v6[2] )
    return 0;
  if ( !v6[1] )
    ErrorHandler();
  Function_2021cac(v6[1], 1);
  return v6;
}

//----- (021D6F4C) --------------------------------------------------------
int __fastcall Function_21d6f4c(int a1, int *a2, int **a3, int a4, int a5)
{
  int *v5;
  int **v6;
  int v7;
  int *v8;
  int v9;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;

  v11 = a1;
  v5 = a2;
  v6 = a3;
  v12 = a4;
  v7 = 0;
  v8 = &v13;
  do
  {
    v9 = Function_2009e08(*v6);
    ++v7;
    ++v6;
    *v8 = v9;
    ++v8;
  }
  while ( v7 < 4 );
  return Function_20093b4(v11, v13, v14, v15, v16, -1, -1, v12, a5, v5[2], v5[3], v5[4], v5[5], 0, 0);
}

//----- (021D6FA8) --------------------------------------------------------
int *__fastcall Function_21d6fa8(uint *a1)
{
  int *v1;
  int v2;
  int *result;

  v1 = (int *)a1;
  *(uint *)(a1[14] + 52) = a1[13];
  *(uint *)(a1[13] + 56) = a1[14];
  Function_2021cac(a1[1], 0);
  Function_21d6ef0((int)v1);
  v2 = v1[1];
  result = Call_FillMemWithValue(v1, 0, 0x3Cu);
  v1[1] = v2;
  return result;
}

//----- (021D6FD8) --------------------------------------------------------
uint *__fastcall Function_21d6fd8(int a1)
{
  uint *v1;
  uint *result;
  uint *v3;

  v1 = (uint *)a1;
  result = *(uint **)(a1 + 52);
  if ( result != v1 )
  {
    do
    {
      v3 = (uint *)result[13];
      Function_21d6fa8(result);
      result = v3;
    }
    while ( v3 != v1 );
  }
  return result;
}

//----- (021D6FF0) --------------------------------------------------------
int __fastcall Function_21d6ff0(int a1, void (*a2)(void))
{
  int v2;
  int result;
  void (*v4)(void);
  int i;

  v2 = a1;
  result = *(uint *)(a1 + 52);
  v4 = a2;
  for ( i = *(uint *)(result + 52); result != v2; i = *(uint *)(i + 52) )
  {
    v4();
    result = i;
  }
  return result;
}

//----- (021D700C) --------------------------------------------------------
void Function_21d700c()
{
  ;
}

//----- (021D7010) --------------------------------------------------------
int __fastcall Function_21d7010(uint *a1, int a2)
{
  uint *v2;
  int v3;
  uint *v4;
  uint *v5;
  int v6;
  int result;

  v2 = a1;
  v3 = *(uint *)(a2 + 4);
  Function_2021d28();
  v6 = v4[1];
  v5 = v4 + 2;
  *v2 = *v4;
  v2[1] = v6;
  result = v4[2];
  v2[2] = *v5;
  return result;
}

//----- (021D7028) --------------------------------------------------------
uint *__fastcall Function_21d7028(uint *a1, uint *a2, uint *a3)
{
  uint *v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  uint *v16;
  int v17;
  uint *result;
  uint *v19;
  uint *v20;
  int v21;
  int v22;
  int v23;
  int v24;
  int v25;

  v3 = a3;
  v19 = a1;
  v20 = a2;
  v23 = dword_21C5CE4;
  v24 = dword_21C5CE8;
  v25 = dword_21C5CEC;
  v4 = dword_21C5CE4 - a3[739];
  v5 = dword_21C5CEC - a3[741];
  v6 = FX_Div(0x4000, 12288);
  v7 = Function_2020a88(*(uint *)(*(uint *)(*v3 + 260) + 36));
  v8 = Function_2020a90(*(uint *)(*(uint *)(*v3 + 260) + 36));
  Function_201e34c(v7, v8, v6, &v22, &v21);
  v22 = FX_Div(v22, 0x100000);
  if ( v5 > 0 )
    v9 = FX_Div(v21, 780305);
  else
    v9 = FX_Div(v21, 780496);
  v10 = 4096;
  v21 = v9;
  if ( v4 < 0 )
  {
    v10 = -4096;
    v4 = (ll_mul(v4, -4096LL) + 2048) >> 12;
  }
  v11 = FX_Div(v4, v22);
  v12 = v11;
  if ( v10 < 0 )
    v12 = (ll_mul(v11, v10) + 2048) >> 12;
  v13 = 4096;
  if ( v5 < 0 )
  {
    v13 = -4096;
    v5 = (ll_mul(v5, -4096LL) + 2048) >> 12;
  }
  v14 = FX_Div(v5, v21);
  v15 = v14;
  if ( v13 < 0 )
    v15 = (ll_mul(v14, v13) + 2048) >> 12;
  if ( v12 + v15 )
  {
    v16 = v3 + 739;
    v17 = v24;
    *v16 = v23;
    v16[1] = v17;
    v3[741] = v25;
  }
  *v19 = v12;
  result = v20;
  *v20 = v15;
  return result;
}

//----- (021D717C) --------------------------------------------------------
int __fastcall Function_21d717c(int a1, int *a2, int *a3, int a4)
{
  int *v4;
  int *v5;
  int result;
  bool v7;
  int v8;
  int v9;
  int v10;
  int v11;

  v11 = a4;
  v4 = a2;
  v5 = a3;
  result = Function_21d71b4(a1, &v10, &v9);
  if ( v4 )
  {
    result = v10;
    v8 = v10 >> 12;
    v7 = v10 >> 12 < 0;
    *v4 = v10 >> 12;
    if ( v7 )
    {
      result = v8 + 4096;
      *v4 = v8 + 4096;
    }
  }
  if ( v5 )
  {
    result = v9 >> 12;
    v7 = v9 >> 12 < 0;
    *v5 = v9 >> 12;
    if ( v7 )
      *v5 = ++result;
  }
  return result;
}

//----- (021D71B4) --------------------------------------------------------
uint *__fastcall Function_21d71b4(uint *a1, uint *a2, uint *a3, int a4)
{
  uint *v4;
  uint *v5;
  int v6;
  int i;
  uint *result;
  uint *v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;

  v14 = a4;
  v4 = a1;
  v5 = a2;
  v9 = a3;
  Function_21d7028(&v11, &v10, a1);
  v6 = v4[16];
  for ( i = (int)(v4 + 3); v6 != i; v6 = *(uint *)(v6 + 52) )
  {
    Function_21d7010(&v12, v6);
    v12 -= v11;
    v13 -= v10;
    Function_21d630c(*(uint **)(v6 + 4), &v12);
  }
  if ( v5 )
    *v5 = v11;
  result = v9;
  if ( v9 )
    *v9 = v10;
  return result;
}

//----- (021D7210) --------------------------------------------------------
int __fastcall Function_21d7210(int result, int a2, short a3, short a4, short a5, short a6, short a7, short a8, int a9, int a10)
{
  *(uint *)result = a2;
  *(ushort *)(result + 4) = a3;
  *(ushort *)(result + 6) = 0;
  *(ushort *)(result + 8) = a4;
  *(ushort *)(result + 10) = 0;
  *(ushort *)(result + 12) = a5;
  *(ushort *)(result + 14) = a6;
  *(ushort *)(result + 16) = a7;
  *(ushort *)(result + 18) = a8;
  *(uint *)(result + 20) = a9;
  *(uint *)(result + 24) = a10;
  return result;
}

//----- (021D7238) --------------------------------------------------------
int __fastcall Function_21d7238(int result, short a2, short a3, short a4, int a5)
{
  *(ushort *)(result + 12) = a2;
  *(ushort *)(result + 14) = a3;
  *(ushort *)(result + 16) = a4;
  *(uint *)(result + 20) = a5;
  return result;
}

//----- (021D7244) --------------------------------------------------------
int __fastcall Function_21d7244(int a1)
{
  int v1;
  int v2;
  int v3;
  BOOL v4;
  int v5;
  int v6;
  int v7;
  BOOL v8;
  int v9;
  int v10;

  v1 = a1;
  v2 = *(short *)(a1 + 16);
  v3 = 0;
  if ( v2 )
  {
    v4 = v2 <= 0;
    v5 = *(short *)(v1 + 14);
    v6 = *(short *)(v1 + 8);
    if ( v6 >= v5 && !v4 || v6 <= v5 && v4 == 1 )
    {
      v3 = 1;
      *(ushort *)(v1 + 8) = v5;
    }
  }
  else
  {
    v3 = 1;
  }
  v7 = *(uint *)(v1 + 20);
  if ( v7 )
  {
    v8 = v7 <= 0;
    v9 = *(short *)(v1 + 12);
    v10 = *(short *)(v1 + 4);
    if ( v10 >= v9 && !v8 || v10 <= v9 && v8 == 1 )
    {
      v3 |= 2u;
      *(ushort *)(v1 + 4) = v9;
    }
  }
  else
  {
    v3 |= 2u;
  }
  if ( (short)--*(ushort *)(v1 + 6) <= 0 )
  {
    (*(void (__fastcall **)(uint, uint))(v1 + 24))(*(uint *)v1, *(short *)(v1 + 4));
    *(ushort *)(v1 + 6) = *(ushort *)(v1 + 8);
    if ( !(v3 & 1) )
      *(ushort *)(v1 + 8) += *(ushort *)(v1 + 16);
    if ( !(v3 & 2) && ++*(ushort *)(v1 + 10) >= *(ushort *)(v1 + 18) )
    {
      *(ushort *)(v1 + 10) = 0;
      *(ushort *)(v1 + 4) += *(uint *)(v1 + 20);
    }
  }
  return v3;
}

//----- (021D7308) --------------------------------------------------------
int __fastcall Function_21d7308(int result, uint *a2, int a3, int a4, int a5, ushort a6, int a7, int a8)
{
  uint *v8;

  v8 = a2;
  *a2 = a3;
  if ( a8 )
  {
    if ( a8 == 1 )
    {
      Function_21d7384(a3, a4, a5, a6);
      Function_21d7480(v8);
      result = Function_21d749c(v8, a7, 1);
    }
    else if ( a8 == 2 )
    {
      result = Function_21d73b0(result, a3, a4, a5, a6, 127 * a7);
    }
  }
  return result;
}

//----- (021D735C) --------------------------------------------------------
int __fastcall Function_21d735c(int a1, int a2, int a3)
{
  int v3;

  v3 = 1;
  if ( a3 )
  {
    if ( a3 == 1 )
    {
      v3 = Function_21d74b8(a2);
    }
    else if ( a3 == 2 && !Function_21d7434() )
    {
      v3 = 0;
    }
  }
  return v3;
}

//----- (021D7384) --------------------------------------------------------
int *__fastcall Function_21d7384(int *a1, int a2, int a3, short a4)
{
  short v4;
  int v5;

  v4 = a4;
  v5 = (int)a1;
  Function_5_21d57fc_CallG3X_SetFog(a1, -1, 1, 0, a2, a3);
  return Function_5_21d5834_SetGFXFogColor(v5, -1, v4, 31);
}

//----- (021D73B0) --------------------------------------------------------
uint *__fastcall Function_21d73b0(int *a1, int a2, int a3, int a4, ushort a5, int a6)
{
  int v6;
  int *v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;

  v6 = a2;
  v7 = a1;
  v8 = a3;
  v9 = a4;
  v10 = Function_21d57f0(a2);
  v11 = Function_21d57f4(v6);
  v12 = Function_21d57f8(v6);
  *v7 = v6;
  Function_21d64fc(v7 + 1, v11, v9, a6);
  Function_21d64fc(v7 + 6, v12 & 0x1F, a5 & 0x1F, a6);
  Function_21d64fc(v7 + 11, (v12 >> 5) & 0x1F, ((int)a5 >> 5) & 0x1F, a6);
  Function_21d64fc(v7 + 16, (v12 >> 10) & 0x1F, ((int)a5 >> 10) & 0x1F, a6);
  return Function_21d64fc(v7 + 21, v10, v8, a6);
}

//----- (021D7434) --------------------------------------------------------
int __fastcall Function_21d7434(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  v2 = Function_21d650c((uint *)(a1 + 4));
  Function_21d650c((uint *)(v1 + 24));
  Function_21d650c((uint *)(v1 + 44));
  Function_21d650c((uint *)(v1 + 64));
  Function_21d650c((uint *)(v1 + 84));
  Function_21d7384(
    *(int **)v1,
    *(uint *)(v1 + 84),
    *(uint *)(v1 + 4),
    *(ushort *)(v1 + 24) | 32 * *(ushort *)(v1 + 44) | (*(ushort *)(v1 + 64) << 10));
  return v2;
}

//----- (021D7480) --------------------------------------------------------
int *__fastcall Function_21d7480(int *a1)
{
  int v1;
  int *v2;
  int v3;

  v1 = 0;
  v2 = a1;
  do
  {
    v3 = (int)v2 + v1++;
    *(uchar *)(v3 + 4) = 0;
  }
  while ( v1 < 32 );
  return Function_5_21d585c(*v2, v2 + 1);
}

//----- (021D749C) --------------------------------------------------------
int __fastcall Function_21d749c(int result, short a2, int a3)
{
  *(uint *)(result + 36) = 127;
  *(uint *)(result + 40) = 0;
  *(ushort *)(result + 44) = a2;
  if ( a3 == 1 )
    *(ushort *)(result + 46) = 1;
  else
    *(ushort *)(result + 46) = -1;
  return result;
}

//----- (021D74B8) --------------------------------------------------------
int __fastcall Function_21d74b8(int *a1)
{
  int *v1;
  int v2;

  v1 = a1;
  v2 = Function_21d74f4();
  if ( !v1[10] )
    Function_5_21d585c(*v1, v1 + 1);
  return v2;
}

//----- (021D74D4) --------------------------------------------------------
int *__fastcall Function_21d74d4(int a1)
{
  int *v1;

  v1 = (int *)a1;
  *(uint *)(a1 + 36) = 1;
  *(uint *)(a1 + 40) = 0;
  *(ushort *)(a1 + 44) = 0;
  *(ushort *)(a1 + 46) = 1;
  Function_21d7534();
  return Function_5_21d585c(*v1, v1 + 1);
}

//----- (021D74F4) --------------------------------------------------------
int __fastcall Function_21d74f4(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;

  v1 = a1;
  v2 = 0;
  if ( !*(ushort *)(a1 + 46) )
    return 1;
  if ( *(uint *)(a1 + 36) <= 0 )
    return 1;
  v3 = *(uint *)(a1 + 40) + 1;
  *(uint *)(a1 + 40) = v3;
  if ( v3 >= *(short *)(a1 + 44) )
  {
    *(uint *)(a1 + 40) = 0;
    Function_21d7534();
    v4 = *(uint *)(v1 + 36) - 1;
    *(uint *)(v1 + 36) = v4;
    if ( v4 <= 0 )
      v2 = 1;
  }
  return v2;
}

//----- (021D7534) --------------------------------------------------------
int __fastcall Function_21d7534(int result)
{
  int v1;
  int v2;
  int i;
  int v4;
  int v5;

  v1 = *(uint *)(result + 36);
  if ( *(short *)(result + 46) < 0 )
    v1 = 127 - v1;
  v2 = v1 / 4;
  for ( i = 31; i > v2; *(uchar *)(v5 + 4) = v4 )
  {
    v4 = 4 * (i - v2);
    v5 = result + i--;
  }
  return result;
}

//----- (021D7568) --------------------------------------------------------
int __fastcall Function_21d7568(int a1, void (*a2)(void), int a3, int a4, int a5, void (__fastcall *a6)(int))
{
  int v6;
  int v7;
  int result;
  int i;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;

  v11 = a1;
  v13 = a3;
  v14 = a4;
  a2();
  v6 = 0;
  v7 = *(uint *)(v11 + 64);
  v16 = 0;
  v15 = *(uint *)(v7 + 52);
  result = v13;
  if ( v13 > 0 )
  {
    v12 = v11 + 12;
    do
    {
      result = v12;
      if ( v7 == v12 )
        break;
      for ( i = 0; i < v6; ++i )
      {
        a6(v7);
        if ( !*(uint *)(v7 + 8) )
          break;
      }
      v7 = v15;
      v15 = *(uint *)(v15 + 52);
      if ( v16 >= v14 )
      {
        s32_div_f(v16, v14);
        if ( !v10 )
          v6 += a5;
      }
      result = v13;
      ++v16;
    }
    while ( v16 < v13 );
  }
  return result;
}

//----- (021D75E4) --------------------------------------------------------
int __fastcall Function_21d75e4(int a1)
{
  int v1;
  int v2;

  v1 = 0;
  v2 = a1;
  do
  {
    if ( !*(uint *)(v2 + 72) )
      return a1 + 72 + 60 * v1;
    ++v1;
    v2 += 60;
  }
  while ( v1 < 48 );
  return 0;
}

//----- (021D7604) --------------------------------------------------------
int __fastcall Function_21d7604(int a1, int a2)
{
  int result;

  result = 2978;
  switch ( (uchar)*(ushort *)(a2 + 2978) )
  {
    case 0u:
      *(ushort *)(a2 + 2978) = 1;
      break;
    case 1u:
      *(ushort *)(a2 + 2978) = 3;
      break;
    case 2u:
      *(ushort *)(a2 + 2978) = 3;
      break;
    case 3u:
      if ( *(ushort *)(a2 + 2982) == 5 )
        *(ushort *)(a2 + 2978) = 4;
      break;
    case 4u:
      *(ushort *)(a2 + 2978) = 5;
      break;
    case 5u:
      result = Function_21d69b8(*(uint *)(a2 + 4));
      break;
    default:
      return result;
  }
  return result;
}

//----- (021D7658) --------------------------------------------------------
void __fastcall Function_21d7658(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int *v5;
  int v6;
  int v7;
  int v8;
  int v9;

  v2 = a2;
  v3 = *(uint *)(a2 + 2968);
  switch ( (uchar)*(ushort *)(a2 + 2978) )
  {
    case 0u:
      Function_21d7210(v3, a2, 1, 8, 4, 0, -1, 1, 1, (int)Function_21d78a4);
      Function_21d7308(
        v3 + 76,
        (uint *)(v3 + 28),
        *(uint *)(*(uint *)(*(uint *)v2 + 260) + 72),
        3,
        29295,
        0x6B5Au,
        1,
        *(ushort *)(v2 + 2980));
      *(uint *)(v3 + 180) = 0;
      Function_21db4b8(v2, 1593);
      *(ushort *)(v2 + 2978) = 1;
      break;
    case 1u:
      v4 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v3 + 180) <= 0 )
      {
        if ( Function_21d735c(v3 + 76, v3 + 28, *(ushort *)(v2 + 2980)) == 1 && v4 == 3 )
          *(ushort *)(v2 + 2978) = 3;
      }
      else
      {
        --*(uint *)(v3 + 180);
      }
      break;
    case 2u:
      Function_21d7210(v3, a2, 4, 0, 4, 0, -1, 1, 1, (int)Function_21d78a4);
      if ( *(ushort *)(v2 + 2980) )
      {
        v5 = *(int **)(*(uint *)(*(uint *)v2 + 260) + 72);
        *(uint *)(v3 + 28) = v5;
        Function_21d7384(v5, 3, 29295, 27482);
        Function_21d74d4(v3 + 28);
      }
      Function_21d7568(v2, (void (*)(void))Function_21d78a4, 20, 10, 1, (void (__fastcall *)(int))Function_21d7960);
      Function_21db4b8(v2, 1593);
      *(ushort *)(v2 + 2978) = 3;
      break;
    case 3u:
      v6 = *(short *)(v3 + 6);
      *(ushort *)(v3 + 6) = v6 - 1;
      if ( v6 <= 0 )
      {
        Function_21d78a4(v2, *(short *)(v3 + 4));
        *(ushort *)(v3 + 6) = *(ushort *)(v3 + 8);
      }
      if ( *(ushort *)(v2 + 2982) == 5 )
      {
        Function_21d7238(v3, 0, 8, 1, -1);
        if ( *(ushort *)(v2 + 2980) )
          Function_21d749c(v3 + 28, 1, 0);
        *(uint *)(v3 + 180) = 0;
        *(ushort *)(v2 + 2978) = 4;
        Function_21db4e4(v2);
      }
      break;
    case 4u:
      v7 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v3 + 180) <= 0 )
      {
        if ( *(ushort *)(v2 + 2980) )
          v8 = Function_21d74b8((int *)(v3 + 28));
        else
          v8 = 1;
        if ( v8 == 1 && v7 == 3 && *(uint *)(v2 + 64) == v2 + 12 )
          *(ushort *)(v2 + 2978) = 5;
      }
      else
      {
        --*(uint *)(v3 + 180);
      }
      break;
    case 5u:
      if ( *(ushort *)(a2 + 2980) )
        Function_5_21d57fc_CallG3X_SetFog(*(int **)(v3 + 28), 1, 0, 0, 0, 0);
      Function_21d69b8(*(uint *)(v2 + 4));
      break;
    default:
      break;
  }
  if ( *(ushort *)(v2 + 2978) != 5 )
  {
    if ( *(ushort *)(v2 + 2978) )
    {
      Function_21d6ff0(v2 + 12, (void (*)(void))Function_21d7960);
      Function_21d717c(v2, 0, 0, v9);
      Function_21d700c();
    }
  }
}

//----- (021D78A4) --------------------------------------------------------
uint *__fastcall Function_21d78a4(uint *a1, uint *a2, int a3, int a4)
{
  uint *result;
  uint *v5;
  uint *v6;
  int v7;
  int v8;
  int v9;
  int v10;
  uint v11;
  int v12;
  uint *v13;
  uint *i;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;

  v19 = a4;
  v13 = a1;
  v15 = 0;
  result = a2;
  for ( i = a2; v15 < (int)i; ++v15 )
  {
    result = Function_21d6f00(v13, 0x20u);
    v5 = result;
    if ( !result )
      break;
    v6 = (uint *)result[2];
    v7 = Function_201d35c();
    *v6 = 0;
    v8 = v7;
    u32_div_f(v7, 3);
    v10 = v9;
    Function_2021e50(v5[1], (ushort)v9);
    u32_div_f(v8, 20);
    v6[2] = v11 + 10 * (v10 + 1);
    if ( v10 == 2 )
      v6[2] += 10;
    v6[4] = s32_div_f(v11, -5) - 5 * (v10 + 1);
    if ( v10 == 2 )
      v6[4] -= 5;
    v6[3] = 0;
    v6[1] = v10 + 1;
    u32_div_f(v8, 270);
    v16 = (v12 + 15 * v10) << 12;
    v17 = -393216;
    v18 = 0;
    Function_21d630c((uint *)v5[1], &v16);
    result = i;
  }
  return result;
}

//----- (021D7960) --------------------------------------------------------
int *__fastcall Function_21d7960(int a1)
{
  int v1;
  int *v2;
  int *result;
  int v4;
  int v5;
  uint v6;
  int v7;
  int v8;
  int v9;

  v1 = a1;
  v2 = *(int **)(a1 + 8);
  Function_21d7010(&v8, a1);
  result = (int *)v2[3];
  if ( result )
  {
    if ( result == (int *)1 )
    {
      v7 = *v2;
      result = (int *)(*v2 - 1);
      *v2 = (int)result;
      if ( v7 <= 0 )
      {
        result = (int *)2;
        v2[3] = 2;
      }
    }
    else if ( result == (int *)2 )
    {
      result = Function_21d6fa8((uint *)v1);
    }
  }
  else
  {
    v8 += v2[4] << 13;
    v9 += v2[2] << 13;
    v4 = *v2 + 2;
    *v2 = v4;
    if ( v4 > v2[1] )
    {
      v5 = Function_201d35c();
      u32_div_f(v5, 10);
      if ( v6 >= 7 )
      {
        v2[3] = 1;
        *v2 = 4;
        Function_2021e50(*(uint *)(v1 + 4), 3u);
      }
      else
      {
        v2[3] = 2;
      }
    }
    result = (int *)Function_21d630c(*(uint **)(v1 + 4), &v8);
  }
  return result;
}

//----- (021D79F0) --------------------------------------------------------
void __fastcall Function_21d79f0(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int *v5;
  int v6;
  int v7;
  int v8;
  int v9;

  v2 = a2;
  v3 = *(uint *)(a2 + 2968);
  switch ( (uchar)*(ushort *)(a2 + 2978) )
  {
    case 0u:
      Function_21d7210(v3, a2, 1, 24, 1, 14, -5, 1, 0, (int)Function_21d7c40);
      *(uint *)(v3 + 184) = 0;
      Function_21d7308(
        v3 + 76,
        (uint *)(v3 + 28),
        *(uint *)(*(uint *)(*(uint *)v2 + 260) + 72),
        3,
        29295,
        0x6B5Au,
        1,
        *(ushort *)(v2 + 2980));
      *(uint *)(v3 + 180) = 16;
      *(ushort *)(v2 + 2978) = 1;
      break;
    case 1u:
      v4 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v3 + 180) <= 0 )
      {
        if ( Function_21d735c(v3 + 76, v3 + 28, *(ushort *)(v2 + 2980)) == 1 && v4 == 3 )
          *(ushort *)(v2 + 2978) = 3;
      }
      else
      {
        --*(uint *)(v3 + 180);
      }
      break;
    case 2u:
      Function_21d7210(v3, a2, 1, 14, 1, 14, -5, 1, 0, (int)Function_21d7c40);
      *(uint *)(v3 + 184) = 0;
      *(uint *)(v3 + 188) = 0;
      if ( *(ushort *)(v2 + 2980) )
      {
        v5 = *(int **)(*(uint *)(*(uint *)v2 + 260) + 72);
        *(uint *)(v3 + 28) = v5;
        Function_21d7384(v5, 3, 29295, 27482);
        Function_21d74d4(v3 + 28);
      }
      Function_21d7568(v2, (void (*)(void))Function_21d7c40, 20, 2, 24, (void (__fastcall *)(int))Function_21d7e20);
      *(ushort *)(v2 + 2978) = 3;
      break;
    case 3u:
      v6 = *(short *)(v3 + 6);
      *(ushort *)(v3 + 6) = v6 - 1;
      if ( v6 <= 0 )
      {
        Function_21d7c40(v2, *(short *)(v3 + 4));
        *(ushort *)(v3 + 6) = *(ushort *)(v3 + 8);
      }
      if ( *(ushort *)(v2 + 2982) == 5 )
      {
        Function_21d7238(v3, 0, 24, 5, -1);
        if ( *(ushort *)(v2 + 2980) )
          Function_21d749c(v3 + 28, 2, 0);
        *(uint *)(v3 + 180) = 32;
        *(ushort *)(v2 + 2978) = 4;
      }
      break;
    case 4u:
      v7 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v3 + 180) <= 0 )
      {
        if ( *(ushort *)(v2 + 2980) )
          v8 = Function_21d74b8((int *)(v3 + 28));
        else
          v8 = 1;
        if ( v8 == 1 && v7 == 3 )
        {
          *(uint *)(v3 + 188) = 1;
          if ( *(uint *)(v2 + 64) == v2 + 12 )
            *(ushort *)(v2 + 2978) = 5;
        }
      }
      else
      {
        --*(uint *)(v3 + 180);
      }
      break;
    case 5u:
      if ( *(ushort *)(a2 + 2980) )
        Function_5_21d57fc_CallG3X_SetFog(*(int **)(v3 + 28), 1, 0, 0, 0, 0);
      Function_21d69b8(*(uint *)(v2 + 4));
      break;
    default:
      break;
  }
  if ( *(ushort *)(v2 + 2978) != 5 )
  {
    if ( *(ushort *)(v2 + 2978) )
    {
      Function_21d6ff0(v2 + 12, (void (*)(void))Function_21d7e20);
      Function_21d717c(v2, 0, 0, v9);
      Function_21d700c();
    }
  }
}

//----- (021D7C40) --------------------------------------------------------
uint *__fastcall Function_21d7c40(uint *a1, int a2)
{
  int v2;
  int v3;
  uint *result;
  int i;
  uint *v6;
  uint *v7;
  char v8;
  uint v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  uint *v18;
  int v19;
  int v20;
  int v21;

  v2 = a2;
  v18 = a1;
  v3 = a1[742];
  v19 = v3;
  result = *(uint **)(v3 + 184);
  if ( result == (uint *)1 )
    v2 = 2 * a2;
  for ( i = 0; i < v2; ++i )
  {
    result = Function_21d6f00(v18, 0x28u);
    v6 = result;
    if ( !result )
      break;
    v7 = (uint *)result[2];
    v8 = Function_201d35c();
    Function_2021e50(v6[1], v8 & 3);
    v7[4] = 10;
    v7[5] = 0;
    v7[6] = 0;
    v7[8] = 0;
    v9 = Function_201d35c();
    s32_div_f(v9, 60);
    v7[9] = v10 + 4;
    v11 = (v9 >> 31) + __ROR4__((v9 << 31) - (v9 >> 31), 31) ? -1 : 1;
    v7[1] = v11;
    v7[2] = (Function_201d35c() & 1) + 4;
    v7[3] = (Function_201d35c() & 1) + 1;
    *v7 = v19 + 184;
    v7[7] = v19 + 188;
    v12 = Function_201d35c();
    u32_div_f(v12, 414);
    v20 = (v13 - 32) << 12;
    if ( *(uint *)(v19 + 184) != 1 || i < v2 / 2 )
    {
      v16 = Function_201d35c();
      u32_div_f(v16, 20);
      v21 = (-8 - v17) << 12;
    }
    else
    {
      v14 = Function_201d35c();
      u32_div_f(v14, 20);
      v21 = (-40 - v15) << 12;
    }
    result = (uint *)Function_21d630c((uint *)v6[1], &v20);
  }
  return result;
}

//----- (021D7D54) --------------------------------------------------------
int *__fastcall Function_21d7d54(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  bool v5;
  uchar v6;
  int v7;
  int v8;
  int v9;
  int *result;
  int v11;
  int v12;

  v2 = a1;
  v3 = a2;
  Function_21d7010(&v11, a1);
  if ( (*(uint *)(v3 + 20) & 0xFFFF) >= *(uint *)(v3 + 8) )
  {
    v11 += *(uint *)(v3 + 4) << 12;
    ++*(uint *)(v3 + 16);
    *(uint *)(v3 + 20) &= 0xFFFF0000;
    v4 = *(uint *)(v3 + 16);
    v6 = __OFSUB__(v4, 10);
    v5 = v4 - 10 < 0;
    v7 = *(uint *)(v3 + 8);
    v8 = v5 ^ v6 ? v7 - 1 : v7 + 1;
    *(uint *)(v3 + 8) = v8;
    if ( *(uint *)(v3 + 16) >= 20 )
    {
      *(uint *)(v3 + 16) = 0;
      *(uint *)(v3 + 4) = -*(uint *)(v3 + 4);
    }
  }
  if ( *(uint *)(v3 + 20) >> 16 >= *(uint *)(v3 + 12) )
  {
    v12 += 4096;
    *(uint *)(v3 + 20) &= 0xFFFFu;
  }
  Function_21d630c(*(uint **)(v2 + 4), &v11);
  v11 >>= 12;
  v12 >>= 12;
  s32_div_f(*(uint *)(v3 + 24) + 1, 100);
  *(uint *)(v3 + 24) = v9;
  *(uint *)(v3 + 20) += 65537;
  result = (int *)-284;
  if ( v12 < -284 && (result = (int *)-296, v12 > -296) || v12 > 212 && v12 < 232 )
  {
    **(uint **)v3 = 1;
    result = Function_21d6fa8((uint *)v2);
  }
  return result;
}

//----- (021D7E20) --------------------------------------------------------
int *__fastcall Function_21d7e20(uint *a1)
{
  int v1;
  int v2;
  int v3;

  v1 = a1[2];
  v2 = *(uint *)(v1 + 32);
  if ( v2 )
  {
    if ( v2 == 1 )
    {
      v3 = *(uint *)(v1 + 36) - 1;
      *(uint *)(v1 + 36) = v3;
      if ( v3 < 0 )
        return Function_21d6fa8(a1);
    }
  }
  else if ( **(uint **)(v1 + 28) == 1 )
  {
    *(uint *)(v1 + 32) = 1;
  }
  return Function_21d7d54((int)a1, v1);
}

//----- (021D7E54) --------------------------------------------------------
void __fastcall Function_21d7e54(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int *v5;
  int v6;
  int v7;
  int v8;
  int v9;

  v2 = a2;
  v3 = *(uint *)(a2 + 2968);
  switch ( (uchar)*(ushort *)(a2 + 2978) )
  {
    case 0u:
      Function_21d7210(v3, a2, 1, 30, 6, 3, -5, 2, 1, (int)Function_21d8098);
      Function_21d7308(
        v3 + 76,
        (uint *)(v3 + 28),
        *(uint *)(*(uint *)(*(uint *)v2 + 260) + 72),
        3,
        28015,
        0x6318u,
        2,
        *(ushort *)(v2 + 2980));
      *(uint *)(v3 + 180) = 8;
      *(uint *)(v3 + 184) = 0;
      *(ushort *)(v2 + 2978) = 1;
      break;
    case 1u:
      v4 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v3 + 180) <= 0 )
      {
        if ( Function_21d735c(v3 + 76, v3 + 28, *(ushort *)(v2 + 2980)) == 1 && v4 == 3 )
          *(ushort *)(v2 + 2978) = 3;
      }
      else
      {
        --*(uint *)(v3 + 180);
      }
      break;
    case 2u:
      Function_21d7210(v3, a2, 6, 3, 6, 3, -5, 2, 1, (int)Function_21d8098);
      if ( *(ushort *)(v2 + 2980) )
      {
        v5 = *(int **)(*(uint *)(*(uint *)v2 + 260) + 72);
        *(uint *)(v3 + 28) = v5;
        Function_21d7384(v5, 3, 28015, 25368);
        Function_21d74d4(v3 + 28);
      }
      *(uint *)(v3 + 184) = 0;
      Function_21d7568(v2, (void (*)(void))Function_21d8098, 20, 2, 3, (void (__fastcall *)(int))Function_21d81bc);
      *(ushort *)(v2 + 2978) = 3;
      break;
    case 3u:
      v6 = *(short *)(v3 + 6);
      *(ushort *)(v3 + 6) = v6 - 1;
      if ( v6 <= 0 )
      {
        Function_21d8098(v2, *(short *)(v3 + 4));
        *(ushort *)(v3 + 6) = *(ushort *)(v3 + 8);
      }
      if ( *(ushort *)(v2 + 2982) == 5 )
      {
        Function_21d7238(v3, 0, 30, 5, -3);
        if ( *(ushort *)(v2 + 2980) )
          Function_21d749c(v3 + 28, 1, 0);
        *(uint *)(v3 + 180) = 0;
        *(ushort *)(v2 + 2978) = 4;
      }
      break;
    case 4u:
      v7 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v3 + 180) <= 0 )
      {
        if ( *(ushort *)(v2 + 2980) )
          v8 = Function_21d74b8((int *)(v3 + 28));
        else
          v8 = 1;
        if ( v8 == 1 && v7 == 3 && *(uint *)(v2 + 64) == v2 + 12 )
          *(ushort *)(v2 + 2978) = 5;
      }
      else
      {
        --*(uint *)(v3 + 180);
      }
      break;
    case 5u:
      if ( *(ushort *)(a2 + 2980) )
        Function_5_21d57fc_CallG3X_SetFog(*(int **)(v3 + 28), 1, 0, 0, 0, 0);
      Function_21d69b8(*(uint *)(v2 + 4));
      break;
    default:
      break;
  }
  if ( *(ushort *)(v2 + 2978) != 5 )
  {
    if ( *(ushort *)(v2 + 2978) )
    {
      Function_21d6ff0(v2 + 12, (void (*)(void))Function_21d81bc);
      Function_21d717c(v2, 0, 0, v9);
      Function_21d700c();
    }
  }
}

//----- (021D8098) --------------------------------------------------------
uint *__fastcall Function_21d8098(uint *a1, uint *a2, int a3, int a4)
{
  int v4;
  uint *result;
  int v6;
  uint *v7;
  uint v8;
  uint v9;
  int v10;
  uint v11;
  uint v12;
  int v13;
  int v14;
  uint *v15;
  uint *v16;
  int v17;
  char v18;
  int v19;
  int v20;
  uint v21;
  int v22;
  int v23;
  int v24;
  int v25;
  int v26;
  int v27;
  int v28;
  int v29;
  int v30;
  int v31;
  int v32;

  v32 = a4;
  v15 = a1;
  v16 = a2;
  v28 = 16;
  v29 = 32;
  v30 = 16;
  v31 = 10;
  v24 = 2;
  v25 = 2;
  v26 = 2;
  v27 = 2;
  v4 = a1[742];
  v17 = 0;
  for ( result = a2; v17 < (int)v16; ++v17 )
  {
    result = Function_21d6f00(v15, 0x20u);
    v6 = (int)result;
    if ( !result )
      break;
    v7 = (uint *)result[2];
    if ( ++*(uint *)(v4 + 184) >= 800 )
      *(uint *)(v4 + 184) = 0;
    v8 = 4 * s32_div_f(*(uint *)(v4 + 184), 200);
    v9 = v8;
    v7[5] = *(int *)((char *)&v28 + v8);
    *v7 = 0;
    v10 = Function_201d35c();
    u32_div_f(v10, 42);
    v7[1] = v11 + 4;
    v12 = s32_div_f(v11, 15);
    Function_2021e50(*(uint *)(v6 + 4), (ushort)v12);
    v7[4] = -(v12 + 1);
    v7[2] = *(int *)((char *)&v24 + v9) * (v12 + 1);
    v7[3] = 0;
    Function_21d7010(&v18, v6);
    v21 = *(uint *)&v18;
    v22 = v19;
    v23 = v20;
    v13 = Function_201d35c();
    u32_div_f(v13, 420);
    v23 = 0;
    v21 = (-20 * (1 - v12) + v14) << 12;
    v22 = -32768;
    Function_21d630c(*(uint **)(v6 + 4), (int *)&v21);
    result = v16;
  }
  return result;
}

//----- (021D81BC) --------------------------------------------------------
int *__fastcall Function_21d81bc(int a1, int a2, int a3, int a4)
{
  int v4;
  uint *v5;
  int *result;
  int v7;
  int v8;
  int v9;
  char v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;

  v16 = a4;
  v4 = a1;
  v5 = *(uint **)(a1 + 8);
  Function_21d7010(&v10, a1);
  v13 = *(uint *)&v10;
  v14 = v11;
  v15 = v12;
  result = (int *)v5[3];
  if ( result )
  {
    if ( result == (int *)1 )
      result = Function_21d6fa8((uint *)v4);
  }
  else
  {
    v13 += v5[4] << 12;
    v14 += v5[2] << 12;
    v7 = (*v5)++;
    if ( v7 > (int)v5[1] )
      v5[3] = 1;
    s32_div_f(*v5, v5[5]);
    if ( !v8 )
    {
      --v5[4];
      v9 = v5[2];
      if ( v9 > 1 )
        v5[2] = v9 - 1;
    }
    result = (int *)Function_21d630c(*(uint **)(v4 + 4), &v13);
  }
  return result;
}

//----- (021D823C) --------------------------------------------------------
void *__fastcall Function_21d823c(int a1, int a2, int a3, int a4)
{
  ushort *v4;
  int v5;
  int v6;
  int v7;
  int *v8;
  int v9;
  int v10;
  int v11;
  void *result;
  int v13;

  v4 = (ushort *)a2;
  v5 = *(ushort *)(a2 + 2978);
  v6 = *(uint *)(a2 + 2968);
  switch ( (uchar)v5 )
  {
    case 0:
      Function_21d7210(v6, a2, 1, 30, 6, 3, -5, 2, 1, (int)Function_21d8098);
      Function_21d7308(
        v6 + 76,
        (uint *)(v6 + 28),
        *(uint *)(*(uint *)(*(uint *)v4 + 260) + 72),
        3,
        28527,
        0x6318u,
        2,
        (ushort)v4[1490]);
      *(uint *)(v6 + 180) = 8;
      *(uint *)(v6 + 184) = 0;
      *(uint *)(v6 + 188) = 0;
      v4[1489] = 1;
      break;
    case 1:
      v7 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v6 + 180) <= 0 )
      {
        if ( Function_21d735c(v6 + 76, v6 + 28, (ushort)v4[1490]) == 1 && v7 == 3 )
          v4[1489] = 3;
      }
      else
      {
        --*(uint *)(v6 + 180);
      }
      break;
    case 2:
      Function_21d7210(v6, a2, 6, 3, 6, 3, -5, 2, 1, (int)Function_21d8098);
      if ( v4[1490] )
      {
        v8 = *(int **)(*(uint *)(*(uint *)v4 + 260) + 72);
        *(uint *)(v6 + 28) = v8;
        Function_21d7384(v8, 3, 28527, 25368);
        Function_21d74d4(v6 + 28);
      }
      *(uint *)(v6 + 184) = 0;
      *(uint *)(v6 + 188) = 0;
      Function_21d7568((int)v4, (void (*)(void))Function_21d8098, 20, 2, 3, (void (__fastcall *)(int))Function_21d81bc);
      v4[1489] = 3;
      break;
    case 3:
      v9 = *(short *)(v6 + 6);
      *(ushort *)(v6 + 6) = v9 - 1;
      if ( v9 <= 0 )
      {
        Function_21d8098(v4, (uint *)*(short *)(v6 + 4), v5, a4);
        *(ushort *)(v6 + 6) = *(ushort *)(v6 + 8);
      }
      if ( v4[1491] == 5 )
      {
        Function_21d7238(v6, 0, 30, 5, -3);
        if ( v4[1490] )
          Function_21d749c(v6 + 28, 1, 0);
        *(uint *)(v6 + 180) = 0;
        v4[1489] = 4;
      }
      break;
    case 4:
      v10 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v6 + 180) <= 0 )
      {
        if ( v4[1490] )
          v11 = Function_21d74b8((int *)(v6 + 28));
        else
          v11 = 1;
        if ( v11 == 1 && v10 == 3 && *((ushort **)v4 + 16) == v4 + 6 )
          v4[1489] = 5;
      }
      else
      {
        --*(uint *)(v6 + 180);
      }
      break;
    case 5:
      if ( *(ushort *)(a2 + 2980) )
        Function_5_21d57fc_CallG3X_SetFog(*(int **)(v6 + 28), 1, 0, 0, 0, 0);
      Function_21d69b8(*((uint *)v4 + 1));
      break;
    default:
      break;
  }
  result = (void *)(ushort)v4[1489];
  if ( result != (void *)5 )
  {
    if ( v4[1489] )
    {
      Function_21d6ff0((int)(v4 + 6), (void (*)(void))Function_21d81bc);
      Function_21d717c((int)v4, 0, 0, v13);
      Function_21d700c();
      *(uint *)(v6 + 188) = ((uint)(*(uint *)(v6 + 188) + 6) >> 31)
                            + __ROR4__(
                                ((*(uint *)(v6 + 188) + 6) << 24) - ((uint)(*(uint *)(v6 + 188) + 6) >> 31),
                                24);
      result = &REG_BG2HOFS;
      REG_BG2HOFS = *(uint *)(v6 + 188) & 0x1FF | -65536 * *(uint *)(v6 + 188) & 0x1FF0000;
    }
  }
  return result;
}

//----- (021D84D4) --------------------------------------------------------
uint __fastcall Function_21d84d4(int a1, int a2)
{
  int v2;
  uint result;
  int **v4;
  int *v5;

  v2 = a2;
  result = *(ushort *)(a2 + 2978);
  v4 = *(int ***)(a2 + 2968);
  if ( result <= 5 )
    JUMPOUT(__CS__, *((short *)&off_21D84F6 + result) + 35489016);
  switch ( (uchar)result )
  {
    case 0:
      Function_21d7308(
        (int)(v4 + 12),
        v4,
        *(uint *)(*(uint *)(*(uint *)a2 + 260) + 72),
        3,
        29039,
        0x6B5Au,
        2,
        *(ushort *)(a2 + 2980));
      v4[38] = (int *)16;
      result = 2978;
      *(ushort *)(v2 + 2978) = 1;
      break;
    case 1:
      if ( (int)v4[38] <= 0 )
      {
        result = Function_21d735c((int)(v4 + 12), *(uint *)(a2 + 2968), *(ushort *)(a2 + 2980));
        if ( result == 1 )
        {
          result = 2978;
          *(ushort *)(v2 + 2978) = 3;
        }
      }
      else
      {
        result = (uint)v4[38] - 1;
        v4[38] = (int *)result;
      }
      break;
    case 2:
      if ( *(ushort *)(a2 + 2980) )
      {
        v5 = *(int **)(*(uint *)(*(uint *)a2 + 260) + 72);
        *v4 = v5;
        Function_21d7384(v5, 3, 29039, 27482);
        Function_21d74d4((int)v4);
      }
      result = 2978;
      *(ushort *)(v2 + 2978) = 3;
      break;
    case 3:
      result = *(ushort *)(a2 + 2982);
      if ( result == 5 )
      {
        if ( *(ushort *)(a2 + 2980) )
          Function_21d749c(*(uint *)(a2 + 2968), 2, 0);
        v4[38] = (int *)16;
        result = 2978;
        *(ushort *)(v2 + 2978) = 4;
      }
      break;
    case 4:
      if ( (int)v4[38] <= 0 )
      {
        if ( *(ushort *)(a2 + 2980) )
          result = Function_21d74b8(*(int **)(a2 + 2968));
        else
          result = 1;
        if ( result == 1 )
        {
          result = 2978;
          *(ushort *)(v2 + 2978) = 5;
        }
      }
      else
      {
        result = (uint)v4[38] - 1;
        v4[38] = (int *)result;
      }
      break;
    case 5:
      if ( *(ushort *)(a2 + 2980) )
        Function_5_21d57fc_CallG3X_SetFog(*v4, 1, 0, 0, 0, 0);
      result = Function_21d69b8(*(uint *)(v2 + 4));
      break;
    default:
      return result;
  }
  return result;
}

//----- (021D8638) --------------------------------------------------------
uint __fastcall Function_21d8638(int a1, int a2)
{
  int v2;
  uint result;
  int **v4;
  int *v5;

  v2 = a2;
  result = *(ushort *)(a2 + 2978);
  v4 = *(int ***)(a2 + 2968);
  if ( result <= 5 )
    JUMPOUT(__CS__, *((short *)&off_21D865A + result) + 35489372);
  switch ( (uchar)result )
  {
    case 0:
      Function_21d7308(
        (int)(v4 + 12),
        v4,
        *(uint *)(*(uint *)(*(uint *)a2 + 260) + 72),
        3,
        25999,
        0x6B5Au,
        2,
        *(ushort *)(a2 + 2980));
      v4[38] = (int *)16;
      result = 2978;
      *(ushort *)(v2 + 2978) = 1;
      break;
    case 1:
      if ( (int)v4[38] <= 0 )
      {
        result = Function_21d735c((int)(v4 + 12), *(uint *)(a2 + 2968), *(ushort *)(a2 + 2980));
        if ( result == 1 )
        {
          result = 2978;
          *(ushort *)(v2 + 2978) = 3;
        }
      }
      else
      {
        result = (uint)v4[38] - 1;
        v4[38] = (int *)result;
      }
      break;
    case 2:
      if ( *(ushort *)(a2 + 2980) )
      {
        v5 = *(int **)(*(uint *)(*(uint *)a2 + 260) + 72);
        *v4 = v5;
        Function_21d7384(v5, 3, 25999, 27482);
        Function_21d74d4((int)v4);
      }
      result = 2978;
      *(ushort *)(v2 + 2978) = 3;
      break;
    case 3:
      result = *(ushort *)(a2 + 2982);
      if ( result == 5 )
      {
        if ( *(ushort *)(a2 + 2980) )
          Function_21d749c(*(uint *)(a2 + 2968), 2, 0);
        v4[38] = (int *)16;
        result = 2978;
        *(ushort *)(v2 + 2978) = 4;
      }
      break;
    case 4:
      if ( (int)v4[38] <= 0 )
      {
        if ( *(ushort *)(a2 + 2980) )
          result = Function_21d74b8(*(int **)(a2 + 2968));
        else
          result = 1;
        if ( result == 1 )
        {
          result = 2978;
          *(ushort *)(v2 + 2978) = 5;
        }
      }
      else
      {
        result = (uint)v4[38] - 1;
        v4[38] = (int *)result;
      }
      break;
    case 5:
      if ( *(ushort *)(a2 + 2980) )
        Function_5_21d57fc_CallG3X_SetFog(*v4, 1, 0, 0, 0, 0);
      result = Function_21d69b8(*(uint *)(v2 + 4));
      break;
    default:
      return result;
  }
  return result;
}

//----- (021D879C) --------------------------------------------------------
int *__fastcall Function_21d879c(int a1, int a2)
{
  int *result;
  int v3;
  uint v4;
  int *v5;
  int v6;
  int v7;
  int *v8;
  int v9;
  int v10;

  result = (int *)2968;
  v3 = a2;
  v4 = *(ushort *)(a2 + 2978);
  v5 = *(int **)(v3 + 2968);
  if ( v4 <= 5 )
    JUMPOUT(__CS__, *((short *)&off_21D87BE + v4) + 35489728);
  switch ( (uchar)v4 )
  {
    case 0:
      Function_21d7308(
        (int)(v5 + 17),
        v5 + 5,
        *(uint *)(*(uint *)(*(uint *)v3 + 260) + 72),
        5,
        31247,
        0x7FFFu,
        2,
        *(ushort *)(v3 + 2980));
      Function_21d64fc(v5, 0, 16, 30);
      Function_21d64e4(0, 16);
      REG_BG2CNT = REG_BG2CNT & 0xFFFC | 3;
      Function_201ff0c(4u, 1);
      result = (int *)2978;
      *(ushort *)(v3 + 2978) = 1;
      break;
    case 1:
      v6 = Function_21d74b8(v5 + 5);
      v7 = Function_21d650c(v5);
      result = Function_21d64e4(*v5, 16 - *v5);
      if ( v6 == 1 && v7 == 1 )
      {
        result = (int *)2978;
        *(ushort *)(v3 + 2978) = 3;
      }
      break;
    case 2:
      if ( *(ushort *)(v3 + 2980) )
      {
        v8 = *(int **)(*(uint *)(*(uint *)v3 + 260) + 72);
        v5[5] = (int)v8;
        Function_21d7384(v8, 5, 31247, 0x7FFF);
        Function_21d74d4((int)(v5 + 5));
      }
      Function_21d64e4(16, 0);
      REG_BG2CNT = REG_BG2CNT & 0xFFFC | 3;
      Function_201ff0c(4u, 1);
      result = (int *)2978;
      *(ushort *)(v3 + 2978) = 3;
      break;
    case 3:
      if ( *(ushort *)(v3 + 2982) == 5 )
      {
        if ( *(ushort *)(v3 + 2980) )
          Function_21d749c((int)(v5 + 5), 1, 0);
        Function_21d64fc(v5, 16, 0, 30);
        result = (int *)2978;
        *(ushort *)(v3 + 2978) = 4;
      }
      break;
    case 4:
      if ( *(ushort *)(v3 + 2980) )
        v9 = Function_21d74b8(v5 + 5);
      else
        v9 = 1;
      v10 = Function_21d650c(v5);
      result = Function_21d64e4(*v5, 16 - *v5);
      if ( v9 == 1 && v10 == 1 )
      {
        result = (int *)2978;
        *(ushort *)(v3 + 2978) = 5;
      }
      break;
    case 5:
      if ( *(ushort *)(v3 + 2980) )
        Function_5_21d57fc_CallG3X_SetFog((int *)v5[5], 1, 0, 0, 0, 0);
      result = (int *)Function_21d69b8(*(uint *)(v3 + 4));
      break;
    default:
      return result;
  }
  return result;
}

//----- (021D8948) --------------------------------------------------------
void __fastcall Function_21d8948(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int *v5;
  int v6;
  int v7;
  int v8;
  int v9;

  v2 = a2;
  v3 = *(uint *)(a2 + 2968);
  switch ( (uchar)*(ushort *)(a2 + 2978) )
  {
    case 0u:
      Function_21d7210(v3, a2, 1, 15, 8, 1, -2, 4, 2, (int)Function_21d8b88);
      Function_21d7308(
        v3 + 76,
        (uint *)(v3 + 28),
        *(uint *)(*(uint *)(*(uint *)v2 + 260) + 72),
        3,
        28399,
        0x169Au,
        1,
        *(ushort *)(v2 + 2980));
      *(uint *)(v3 + 180) = 0;
      *(uint *)(v3 + 184) = 0;
      *(ushort *)(v2 + 2978) = 1;
      break;
    case 1u:
      v4 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v3 + 180) <= 0 )
      {
        if ( Function_21d735c(v3 + 76, v3 + 28, *(ushort *)(v2 + 2980)) == 1 && v4 == 3 )
          *(ushort *)(v2 + 2978) = 3;
      }
      else
      {
        --*(uint *)(v3 + 180);
      }
      break;
    case 2u:
      Function_21d7210(v3, a2, 8, 1, 8, 1, -2, 4, 2, (int)Function_21d8b88);
      if ( *(ushort *)(v2 + 2980) )
      {
        v5 = *(int **)(*(uint *)(*(uint *)v2 + 260) + 72);
        *(uint *)(v3 + 28) = v5;
        Function_21d7384(v5, 3, 28399, 5786);
        Function_21d74d4(v3 + 28);
      }
      *(uint *)(v3 + 184) = 0;
      Function_21d7568(v2, (void (*)(void))Function_21d8b88, 24, 2, 2, (void (__fastcall *)(int))Function_21d8c90);
      *(ushort *)(v2 + 2978) = 3;
      break;
    case 3u:
      v6 = *(short *)(v3 + 6);
      *(ushort *)(v3 + 6) = v6 - 1;
      if ( v6 <= 0 )
      {
        Function_21d8b88(v2, *(short *)(v3 + 4));
        *(ushort *)(v3 + 6) = *(ushort *)(v3 + 8);
      }
      if ( *(ushort *)(v2 + 2982) == 5 )
      {
        Function_21d7238(v3, 0, 15, 2, -3);
        if ( *(ushort *)(v2 + 2980) )
          Function_21d749c(v3 + 28, 1, 0);
        *(uint *)(v3 + 180) = 31;
        *(ushort *)(v2 + 2978) = 4;
      }
      break;
    case 4u:
      v7 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v3 + 180) <= 0 )
      {
        if ( *(ushort *)(v2 + 2980) )
          v8 = Function_21d74b8((int *)(v3 + 28));
        else
          v8 = 1;
        if ( v8 == 1 && v7 == 3 && *(uint *)(v2 + 64) == v2 + 12 )
          *(ushort *)(v2 + 2978) = 5;
      }
      else
      {
        --*(uint *)(v3 + 180);
      }
      break;
    case 5u:
      if ( *(ushort *)(a2 + 2980) )
        Function_5_21d57fc_CallG3X_SetFog(*(int **)(v3 + 28), 1, 0, 0, 0, 0);
      Function_21d69b8(*(uint *)(v2 + 4));
      break;
    default:
      break;
  }
  if ( *(ushort *)(v2 + 2978) != 5 )
  {
    if ( *(ushort *)(v2 + 2978) )
    {
      Function_21d6ff0(v2 + 12, (void (*)(void))Function_21d8c90);
      Function_21d717c(v2, 0, 0, v9);
      Function_21d700c();
    }
  }
}

//----- (021D8B88) --------------------------------------------------------
uint __fastcall Function_21d8b88(uint *a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  uint result;
  uint v7;
  int v8;
  uint *v9;
  int v10;
  int v11;
  uint v12;
  ushort v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  uint *v20;
  int v21;
  int v22;
  int v23;
  int v24;
  int v25;

  v25 = a4;
  v21 = a2;
  v20 = a1;
  v4 = a1[742];
  s32_div_f(*(uint *)(a1[742] + 184) + 1, 320);
  *(uint *)(v4 + 184) = v5;
  result = s32_div_f(*(uint *)(v4 + 184), 40);
  v22 = 0;
  if ( v21 > 0 )
  {
    v7 = result;
    do
    {
      result = (uint)Function_21d6f00(v20, 0x20u);
      v8 = result;
      if ( !result )
        break;
      v9 = *(uint **)(result + 8);
      *v9 = 0;
      v10 = Function_201d35c();
      u32_div_f(v10, 20);
      v11 += 15;
      v9[1] = v11;
      v12 = s32_div_f(v11 - 15, 6);
      v13 = 3 - v12;
      v12 = 4 - v12;
      v9[2] = dword_21F8D70[v7] * v12;
      v9[4] = dword_21F8D30[v7] * v12;
      v9[3] = 0;
      v9[5] = dword_21F8D30[v7];
      v14 = Function_201d35c();
      u32_div_f(v14, 1000);
      if ( v15 == 777 )
      {
        v13 = 4;
        v9[2] += v9[2] / 2;
      }
      Function_2021e50(*(uint *)(v8 + 4), v13);
      Function_21d7010(&v23, v8);
      v16 = Function_201d35c();
      u32_div_f(v16, 24);
      v23 = (v17 + 262) << 12;
      v18 = Function_201d35c();
      u32_div_f(v18, 192);
      v24 = (v19 - 64) << 12;
      Function_21d630c(*(uint **)(v8 + 4), &v23);
      result = v21;
      ++v22;
    }
    while ( v22 < v21 );
  }
  return result;
}

//----- (021D8C90) --------------------------------------------------------
int *__fastcall Function_21d8c90(int a1, int a2, int a3, int a4)
{
  int v4;
  uint *v5;
  int *result;
  int v7;
  int v8;
  char v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;

  v15 = a4;
  v4 = a1;
  v5 = *(uint **)(a1 + 8);
  Function_21d7010(&v9, a1);
  v12 = *(uint *)&v9;
  v13 = v10;
  v14 = v11;
  result = (int *)v5[3];
  if ( result )
  {
    if ( result == (int *)1 )
      result = Function_21d6fa8((uint *)v4);
  }
  else
  {
    v12 += v5[4] << 12;
    v13 += v5[2] << 12;
    s32_div_f(*v5, 5);
    if ( !v7 )
      v5[4] += v5[5];
    v8 = (*v5)++;
    if ( v8 > (int)v5[1] )
      v5[3] = 1;
    result = (int *)Function_21d630c(*(uint **)(v4 + 4), &v12);
  }
  return result;
}

//----- (021D8D08) --------------------------------------------------------
void *__fastcall Function_21d8d08(int a1, int a2, int a3, int a4)
{
  int v4;
  ushort *v5;
  int v6;
  int v7;
  int *v8;
  int v9;
  int v10;
  int v11;
  int v12;
  void *result;
  int v14;
  int v15;
  int v16;
  int v17;

  v17 = a4;
  v5 = (ushort *)a2;
  v6 = *(uint *)(a2 + 2968);
  switch ( (uchar)*(ushort *)(a2 + 2978) )
  {
    case 0u:
      Function_21d7210(v6, a2, 1, 15, 8, 1, -2, 4, 2, (int)Function_21d8b88);
      Function_21d7308(
        v6 + 76,
        (uint *)(v6 + 28),
        *(uint *)(*(uint *)(*(uint *)v5 + 260) + 72),
        3,
        28399,
        0x169Au,
        1,
        (ushort)v5[1490]);
      *(uint *)(v6 + 180) = 0;
      *(uint *)(v6 + 184) = 0;
      *(uint *)(v6 + 188) = 0;
      *(uint *)(v6 + 192) = 0;
      v5[1489] = 1;
      break;
    case 1u:
      v7 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v6 + 180) <= 0 )
      {
        if ( Function_21d735c(v6 + 76, v6 + 28, (ushort)v5[1490]) == 1 && v7 == 3 )
        {
          v5[1489] = 3;
          Function_201ff0c(4u, 1);
        }
      }
      else
      {
        --*(uint *)(v6 + 180);
      }
      break;
    case 2u:
      Function_21d7210(v6, a2, 8, 1, 8, 1, -2, 4, 2, (int)Function_21d8b88);
      if ( v5[1490] )
      {
        v8 = *(int **)(*(uint *)(*(uint *)v5 + 260) + 72);
        *(uint *)(v6 + 28) = v8;
        Function_21d7384(v8, 3, 28399, 5786);
        Function_21d74d4(v6 + 28);
      }
      *(uint *)(v6 + 184) = 0;
      *(uint *)(v6 + 188) = 0;
      *(uint *)(v6 + 192) = 0;
      Function_21d7568((int)v5, (void (*)(void))Function_21d8b88, 24, 2, 2, (void (__fastcall *)(int))Function_21d8c90);
      v5[1489] = 3;
      Function_201ff0c(4u, 1);
      break;
    case 3u:
      v9 = *(short *)(v6 + 6);
      *(ushort *)(v6 + 6) = v9 - 1;
      if ( v9 <= 0 )
      {
        *(uint *)(v6 + 192) = dword_21F8D10[s32_div_f(*(uint *)(v6 + 184), 40)];
        if ( *(uint *)(v6 + 192) > -6 )
          Function_21d8b88(v5, *(short *)(v6 + 4), v10, v11);
        else
          Function_21d8b88(v5, 2 * *(short *)(v6 + 4), v10, v11);
        *(ushort *)(v6 + 6) = *(ushort *)(v6 + 8);
      }
      if ( v5[1491] == 5 )
      {
        Function_21d7238(v6, 0, 15, 2, -3);
        if ( v5[1490] )
          Function_21d749c(v6 + 28, 1, 0);
        *(uint *)(v6 + 180) = 31;
        v5[1489] = 4;
        Function_201ff0c(4u, 0);
      }
      break;
    case 4u:
      v12 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v6 + 180) <= 0 )
      {
        if ( v5[1490] )
          v4 = Function_21d74b8((int *)(v6 + 28));
        if ( v4 == 1 && v12 == 3 && *((ushort **)v5 + 16) == v5 + 6 )
          v5[1489] = 5;
      }
      else
      {
        --*(uint *)(v6 + 180);
      }
      break;
    case 5u:
      if ( *(ushort *)(a2 + 2980) )
        Function_5_21d57fc_CallG3X_SetFog(*(int **)(v6 + 28), 1, 0, 0, 0, 0);
      Function_21d69b8(*((uint *)v5 + 1));
      break;
    default:
      break;
  }
  result = (void *)(ushort)v5[1489];
  if ( result != (void *)5 )
  {
    if ( v5[1489] )
    {
      Function_21d6ff0((int)(v5 + 6), (void (*)(void))Function_21d8c90);
      Function_21d717c((int)v5, &v16, &v15, v14);
      Function_21d700c();
      *(uint *)(v6 + 188) = ((uint)(*(uint *)(v6 + 188) + 6) >> 31)
                            + __ROR4__(
                                ((*(uint *)(v6 + 188) + 6) << 24) - ((uint)(*(uint *)(v6 + 188) + 6) >> 31),
                                24);
      result = &REG_BG2HOFS;
      REG_BG2HOFS = (2 * *(uint *)(v6 + 188) - v16) & 0x1FF | ((v15 - *(uint *)(v6 + 188)) << 16) & 0x1FF0000;
    }
  }
  return result;
}

//----- (021D8FF8) --------------------------------------------------------
void *__fastcall Function_21d8ff8(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int *v5;
  int v6;
  int v7;
  int v8;
  void *result;

  v2 = a2;
  v3 = *(uint *)(a2 + 2968);
  switch ( (uchar)*(ushort *)(a2 + 2978) )
  {
    case 0u:
      Function_21d7210(v3, a2, 1, 30, 10, 1, -4, 2, 3, (int)Function_21d92c4);
      Function_21d7308(
        v3 + 76,
        (uint *)(v3 + 28),
        *(uint *)(*(uint *)(*(uint *)v2 + 260) + 72),
        3,
        27503,
        0x6318u,
        1,
        *(ushort *)(v2 + 2980));
      *(uint *)(v3 + 180) = 16;
      *(uint *)(v3 + 184) = 0;
      *(uint *)(v3 + 188) = 0;
      *(ushort *)(v2 + 2978) = 1;
      break;
    case 1u:
      v4 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v3 + 180) <= 0 )
      {
        if ( Function_21d735c(v3 + 76, v3 + 28, *(ushort *)(v2 + 2980)) == 1 && v4 == 3 )
        {
          *(ushort *)(v2 + 2978) = 3;
          Function_201ff0c(4u, 1);
        }
      }
      else
      {
        --*(uint *)(v3 + 180);
      }
      break;
    case 2u:
      Function_21d7210(v3, a2, 10, 1, 10, 1, -4, 2, 3, (int)Function_21d92c4);
      if ( *(ushort *)(v2 + 2980) )
      {
        v5 = *(int **)(*(uint *)(*(uint *)v2 + 260) + 72);
        *(uint *)(v3 + 28) = v5;
        Function_21d7384(v5, 3, 27503, 25368);
        Function_21d74d4(v3 + 28);
      }
      *(uint *)(v3 + 184) = 0;
      *(uint *)(v3 + 188) = 0;
      Function_21d7568(v2, (void (*)(void))Function_21d92c4, 20, 2, 2, (void (__fastcall *)(int))Function_21d93dc);
      *(ushort *)(v2 + 2978) = 3;
      Function_201ff0c(4u, 1);
      break;
    case 3u:
      v6 = *(short *)(v3 + 6);
      *(ushort *)(v3 + 6) = v6 - 1;
      if ( v6 <= 0 )
      {
        if ( dword_21F8CDC[*(uint *)(v3 + 184) / 512] > -8 )
          Function_21d92c4(a2, *(short *)(v3 + 4));
        else
          Function_21d92c4(a2, 2 * *(short *)(v3 + 4));
        *(ushort *)(v3 + 6) = *(ushort *)(v3 + 8);
      }
      if ( *(ushort *)(v2 + 2982) == 5 )
      {
        Function_21d7238(v3, 0, 12, 4, -4);
        if ( *(ushort *)(v2 + 2980) )
          Function_21d749c(v3 + 28, 1, 0);
        *(uint *)(v3 + 180) = 20;
        *(ushort *)(v2 + 2978) = 4;
        Function_201ff0c(4u, 0);
      }
      break;
    case 4u:
      v7 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v3 + 180) <= 0 )
      {
        if ( *(ushort *)(v2 + 2980) )
          v8 = Function_21d74b8((int *)(v3 + 28));
        else
          v8 = 1;
        if ( v8 == 1 && v7 == 3 && *(uint *)(v2 + 64) == v2 + 12 )
          *(ushort *)(v2 + 2978) = 5;
      }
      else
      {
        --*(uint *)(v3 + 180);
      }
      break;
    case 5u:
      if ( *(ushort *)(a2 + 2980) )
        Function_5_21d57fc_CallG3X_SetFog(*(int **)(v3 + 28), 1, 0, 0, 0, 0);
      Function_21d69b8(*(uint *)(v2 + 4));
      break;
    default:
      break;
  }
  result = (void *)*(ushort *)(v2 + 2978);
  if ( result != (void *)5 )
  {
    if ( *(ushort *)(v2 + 2978) )
    {
      Function_21d6ff0(v2 + 12, (void (*)(void))Function_21d93dc);
      Function_21d700c();
      *(uint *)(v3 + 188) = ((uint)(*(uint *)(v3 + 188) + 12) >> 31)
                            + __ROR4__(
                                ((*(uint *)(v3 + 188) + 12) << 24)
                              - ((uint)(*(uint *)(v3 + 188) + 12) >> 31),
                                24);
      result = &REG_BG2HOFS;
      REG_BG2HOFS = 2 * *(uint *)(v3 + 188) & 0x1FF | -65536 * *(uint *)(v3 + 188) & 0x1FF0000;
    }
  }
  return result;
}

//----- (021D92C4) --------------------------------------------------------
uint *__fastcall Function_21d92c4(uint *a1, int a2)
{
  int v2;
  int v3;
  uint *result;
  int v5;
  int v6;
  uint *v7;
  int v8;
  int v9;
  uint v10;
  int v11;
  int v12;
  int v13;
  int v14;
  uint *v15;
  int v16;
  int v17;
  char v18;
  int v19;
  int v20;
  int v21;
  int v22;
  int v23;

  v15 = a1;
  v2 = a1[742];
  if ( ++*(uint *)(v2 + 184) >= 2048 )
    *(uint *)(v2 + 184) = 0;
  v3 = *(uint *)(v2 + 184) / 512;
  v17 = 0;
  result = (uint *)(4 * a2);
  v16 = 4 * a2;
  if ( 4 * a2 > 0 )
  {
    v5 = v3;
    do
    {
      result = Function_21d6f00(v15, 0x20u);
      v6 = (int)result;
      if ( !result )
        break;
      v7 = (uint *)result[2];
      *v7 = 0;
      v8 = Function_201d35c();
      u32_div_f(v8, 6);
      v7[1] = v9 + 18;
      v10 = Function_201d35c() & 3;
      Function_2021e50(*(uint *)(v6 + 4), v10);
      v7[4] = dword_21F8CDC[v5] * (v10 + 1);
      v7[2] = dword_21F8CEC[v5] * (v10 + 1);
      v7[3] = 0;
      if ( v10 == 3 )
      {
        v7[4] += dword_21F8CDC[v5];
        v7[2] += dword_21F8CEC[v5];
      }
      v7[5] = dword_21F8CDC[v5];
      Function_21d7010(&v18, v6);
      v21 = *(uint *)&v18;
      v22 = v19;
      v23 = v20;
      v11 = Function_201d35c();
      u32_div_f(v11, 24);
      v21 = v12 + 256;
      v13 = Function_201d35c();
      u32_div_f(v13, 168);
      v21 <<= 12;
      v22 = (v14 - 32) << 12;
      v23 = 0;
      Function_21d630c(*(uint **)(v6 + 4), &v21);
      result = (uint *)v16;
      ++v17;
    }
    while ( v17 < v16 );
  }
  return result;
}

//----- (021D93DC) --------------------------------------------------------
int *__fastcall Function_21d93dc(int a1, int a2, int a3, int a4)
{
  int v4;
  uint *v5;
  int *result;
  int v7;
  int v8;
  char v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;

  v15 = a4;
  v4 = a1;
  v5 = *(uint **)(a1 + 8);
  Function_21d7010(&v9, a1);
  v12 = *(uint *)&v9;
  v13 = v10;
  v14 = v11;
  result = (int *)v5[3];
  if ( result )
  {
    if ( result == (int *)1 )
      result = Function_21d6fa8((uint *)v4);
  }
  else
  {
    v12 += v5[4] << 12;
    v13 += v5[2] << 12;
    v7 = (*v5)++;
    if ( v7 > v5[1] )
      v5[3] = 1;
    if ( !((*v5 >> 31) + __ROR4__((*v5 << 30) - (*v5 >> 31), 30)) )
    {
      v5[4] += v5[5];
      v8 = v5[2];
      if ( v8 > 1 )
        v5[2] = v8 - 1;
    }
    result = (int *)Function_21d630c(*(uint **)(v4 + 4), &v12);
  }
  return result;
}

//----- (021D9464) --------------------------------------------------------
void __fastcall Function_21d9464(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int *v5;
  int v6;
  int v7;
  int v8;

  v2 = a2;
  v3 = *(uint *)(a2 + 2968);
  switch ( (uchar)*(ushort *)(a2 + 2978) )
  {
    case 0u:
      Function_21d7210(v3, a2, 2, 16, 20, 2, -2, 4, 2, (int)Function_21d9690);
      Function_21d7308(
        v3 + 76,
        (uint *)(v3 + 28),
        *(uint *)(*(uint *)(*(uint *)v2 + 260) + 72),
        3,
        29039,
        0x6B5Au,
        1,
        *(ushort *)(v2 + 2980));
      *(uint *)(v3 + 180) = 0;
      *(ushort *)(v2 + 2978) = 1;
      break;
    case 1u:
      v4 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v3 + 180) <= 0 )
      {
        if ( Function_21d735c(v3 + 76, v3 + 28, *(ushort *)(v2 + 2980)) == 1 && v4 == 3 )
          *(ushort *)(v2 + 2978) = 3;
      }
      else
      {
        --*(uint *)(v3 + 180);
      }
      break;
    case 2u:
      Function_21d7210(v3, a2, 20, 2, 20, 2, -2, 4, 2, (int)Function_21d9690);
      if ( *(ushort *)(v2 + 2980) )
      {
        v5 = *(int **)(*(uint *)(*(uint *)v2 + 260) + 72);
        *(uint *)(v3 + 28) = v5;
        Function_21d7384(v5, 3, 29039, 27482);
        Function_21d74d4(v3 + 28);
      }
      Function_21d7568(v2, (void (*)(void))Function_21d9690, 20, 10, 1, (void (__fastcall *)(int))Function_21d97c0);
      *(ushort *)(v2 + 2978) = 3;
      break;
    case 3u:
      v6 = *(short *)(v3 + 6);
      *(ushort *)(v3 + 6) = v6 - 1;
      if ( v6 <= 0 )
      {
        Function_21d9690(v2, *(short *)(v3 + 4));
        *(ushort *)(v3 + 6) = *(ushort *)(v3 + 8);
      }
      if ( *(ushort *)(v2 + 2982) == 5 )
      {
        Function_21d7238(v3, 0, 16, 6, -10);
        if ( *(ushort *)(v2 + 2980) )
          Function_21d749c(v3 + 28, 1, 0);
        *(uint *)(v3 + 180) = 20;
        *(ushort *)(v2 + 2978) = 4;
      }
      break;
    case 4u:
      v7 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v3 + 180) <= 0 )
      {
        if ( Function_21d735c(v3 + 76, v3 + 28, *(ushort *)(v2 + 2980)) == 1
          && v7 == 3
          && *(uint *)(v2 + 64) == v2 + 12 )
        {
          *(ushort *)(v2 + 2978) = 5;
        }
      }
      else
      {
        --*(uint *)(v3 + 180);
      }
      break;
    case 5u:
      if ( *(ushort *)(a2 + 2980) )
        Function_5_21d57fc_CallG3X_SetFog(*(int **)(v3 + 28), 1, 0, 0, 0, 0);
      Function_21d69b8(*(uint *)(v2 + 4));
      break;
    default:
      break;
  }
  if ( *(ushort *)(v2 + 2978) != 5 )
  {
    if ( *(ushort *)(v2 + 2978) )
    {
      Function_21d6ff0(v2 + 12, (void (*)(void))Function_21d97c0);
      Function_21d717c(v2, 0, 0, v8);
      Function_21d700c();
    }
  }
}

//----- (021D9690) --------------------------------------------------------
uint *__fastcall Function_21d9690(uint *a1, uint *a2)
{
  uint *result;
  int v3;
  uint *v4;
  int v5;
  int v6;
  int v7;
  uint v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  short v15;
  int v16;
  int v17;
  uchar v18;
  uint v19;
  int v20;
  int v21;
  int v22;
  int v23;
  int v24;
  int v25;
  int v26;
  uint *v27;
  uint *i;
  uint v29;
  int v30;
  int v31;
  int v32;
  int v33;

  v27 = a1;
  v30 = 0;
  result = a2;
  for ( i = a2; v30 < (int)i; ++v30 )
  {
    result = Function_21d6f00(v27, 0x20u);
    v3 = (int)result;
    if ( !result )
      break;
    v4 = (uint *)result[2];
    *v4 = 0;
    v5 = Function_201d35c();
    u32_div_f(v5, 5);
    v4[1] = v6 + 7;
    v7 = Function_201d35c();
    u32_div_f(v7, 1000);
    v9 = (v8 >> 31) + __ROR4__((v8 << 31) - (v8 >> 31), 31) ? -1 : 1;
    v4[2] = v9;
    v4[3] = 1;
    v10 = Function_201d35c();
    u32_div_f(v10, 6);
    v4[4] = v11 + 3;
    v12 = Function_201d35c();
    u32_div_f(v12, 5);
    v4[5] = v13 + 4;
    v14 = Function_201d35c();
    u32_div_f(v14, 20);
    LOWORD(v29) = v15;
    Function_21d7010(&v31, v3);
    v16 = Function_201d35c();
    u32_div_f(v16, 384);
    v31 = v17 - 64;
    v18 = Function_201d35c();
    v31 <<= 12;
    v32 = (v18 - 8) << 12;
    v33 = 0;
    Function_21d630c(*(uint **)(v3 + 4), &v31);
    v32 >>= 12;
    v31 >>= 12;
    v19 = s32_div_f(v31, 3);
    v20 = 50 - v19;
    v21 = 206 - v19;
    if ( (int)(206 - v19) >= 0 )
    {
      v25 = Function_201d35c();
      u32_div_f(v25, v21);
      v24 = v20 + v26;
    }
    else
    {
      v22 = Function_201d35c();
      u32_div_f(v22, -v21);
      v24 = v20 - v23;
    }
    if ( v20 > v32 || v24 < v32 )
      v29 = Function_201d35c() & 3;
    else
      v4[1] *= 2;
    Function_2021e50(*(uint *)(v3 + 4), (ushort)v29);
    result = i;
  }
  return result;
}

//----- (021D97C0) --------------------------------------------------------
int *__fastcall Function_21d97c0(int a1)
{
  uint *v1;
  int *v2;
  int v3;
  int *result;
  char v5;

  v1 = (uint *)a1;
  v2 = *(int **)(a1 + 8);
  Function_21d7010(&v5, a1);
  v3 = *v2 + 1;
  *v2 = v3;
  result = (int *)v2[1];
  if ( v3 >= (int)result )
    result = Function_21d6fa8(v1);
  return result;
}

//----- (021D97E8) --------------------------------------------------------
int __fastcall Function_21d97e8(int a1, int a2)
{
  int v2;
  int *v3;
  int result;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  int v20;
  int v21;
  int v22;
  int v23;
  int v24;

  v2 = a2;
  v3 = *(int **)(a2 + 2968);
  result = *(ushort *)(a2 + 2978);
  switch ( (uchar)result )
  {
    case 0:
      *v3 = 0;
      v3[1] = 0;
      Function_21d64e4(0, 16);
      REG_BG2HOFS = 0x200000;
      Function_201ff0c(4u, 1);
      result = 2978;
      *(ushort *)(v2 + 2978) = 1;
      break;
    case 1:
      result = *v3 + 1;
      *v3 = result;
      if ( result >= 10 )
      {
        *v3 = 0;
        v5 = v3[1] + 1;
        v3[1] = v5;
        Function_21d64e4(v5, 16);
        result = v3[1];
        if ( result >= 10 )
        {
          v6 = Function_201d35c();
          u32_div_f(v6, 20);
          v3[2] = v7 + 10;
          v8 = Function_201d35c();
          u32_div_f(v8, 3);
          v3[3] = v9 + 5;
          v3[4] = 1;
          result = 2978;
          *(ushort *)(v2 + 2978) = 3;
        }
      }
      break;
    case 2:
      *v3 = 0;
      v3[1] = 10;
      REG_BG2HOFS = 0x200000;
      Function_21d64e4(v3[1], 16);
      v10 = Function_201d35c();
      u32_div_f(v10, 20);
      v3[2] = v11 + 10;
      v12 = Function_201d35c();
      u32_div_f(v12, 3);
      v3[3] = v13 + 5;
      v3[4] = 1;
      result = 2978;
      *(ushort *)(v2 + 2978) = 3;
      break;
    case 3:
      v14 = *v3 + 1;
      *v3 = v14;
      if ( v14 >= v3[2] )
      {
        *v3 = 0;
        v15 = v3[1];
        if ( v3[4] == 1 )
        {
          v3[1] = v15 - 1;
          if ( v15 - 1 <= v3[3] )
          {
            v16 = Function_201d35c();
            u32_div_f(v16, 15);
            v3[2] = v17 + 10;
            v18 = Function_201d35c();
            u32_div_f(v18, 3);
            v3[3] = v19 + 7;
            v3[4] = 0;
          }
        }
        else
        {
          v3[1] = v15 + 1;
          if ( v15 + 1 >= v3[3] )
          {
            v20 = Function_201d35c();
            u32_div_f(v20, 20);
            v3[2] = v21 + 10;
            v22 = Function_201d35c();
            u32_div_f(v22, 3);
            v3[3] = v23 + 5;
            v3[4] = 1;
          }
        }
      }
      Function_21d64e4(v3[1], 16);
      result = 2982;
      if ( *(ushort *)(v2 + 2982) == 5 )
      {
        result = 2978;
        *(ushort *)(v2 + 2978) = 4;
      }
      break;
    case 4:
      result = *v3 + 1;
      *v3 = result;
      if ( result >= 10 )
      {
        *v3 = 0;
        v24 = v3[1] - 1;
        v3[1] = v24;
        Function_21d64e4(v24, 16);
        result = v3[1];
        if ( result <= 0 )
        {
          result = 2978;
          *(ushort *)(v2 + 2978) = 5;
        }
      }
      break;
    case 5:
      result = Function_21d69b8(*(uint *)(a2 + 4));
      break;
    default:
      return result;
  }
  return result;
}

//----- (021D9984) --------------------------------------------------------
int __fastcall Function_21d9984(int a1, int a2)
{
  ushort *v2;
  uint *v3;

  v2 = (ushort *)a1;
  v3 = (uint *)a2;
  Function_21d7210(a2, a1, 1, 15, 10, 0, -3, 2, 1, (int)Function_21da0a8);
  Function_21d7308(
    (int)(v3 + 19),
    v3 + 7,
    *(uint *)(*(uint *)(*(uint *)v2 + 260) + 72),
    3,
    28527,
    0x6B5Au,
    1,
    v2[1490]);
  v3[45] = 0;
  v3[46] = 0;
  v3[47] = 0;
  return Function_21db4b8(v2, 1595);
}

//----- (021D9A0C) --------------------------------------------------------
int __fastcall Function_21d9a0c(int a1, int a2)
{
  int v2;
  int v3;
  int v4;

  v2 = a2;
  v3 = a1;
  v4 = Function_21d7244(a2);
  if ( *(uint *)(v2 + 180) <= 0 )
  {
    if ( Function_21d735c(v2 + 76, v2 + 28, *(ushort *)(v3 + 2980)) == 1 && v4 == 3 )
      return 1;
  }
  else
  {
    --*(uint *)(v2 + 180);
  }
  return 0;
}

//----- (021D9A58) --------------------------------------------------------
int __fastcall Function_21d9a58(int a1, int a2)
{
  ushort *v2;
  uint *v3;
  int *v4;

  v2 = (ushort *)a1;
  v3 = (uint *)a2;
  Function_21d7210(a2, a1, 10, 0, 10, 0, -3, 2, 1, (int)Function_21da0a8);
  if ( v2[1490] )
  {
    v4 = *(int **)(*(uint *)(*(uint *)v2 + 260) + 72);
    v3[7] = v4;
    Function_21d7384(v4, 3, 28527, 27482);
    Function_21d74d4((int)(v3 + 7));
  }
  v3[46] = 0;
  v3[47] = 0;
  Function_21d7568((int)v2, (void (*)(void))Function_21da0a8, 20, 5, 1, (void (__fastcall *)(int))Function_21da1a8);
  return Function_21db4b8(v2, 1595);
}

//----- (021D9AEC) --------------------------------------------------------
int __fastcall Function_21d9aec(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int result;

  v2 = a2;
  v3 = a1;
  s32_div_f(*(uint *)(a2 + 188) + 1, 300);
  *(uint *)(v2 + 188) = v4;
  v5 = *(short *)(v2 + 6);
  result = v5 - 1;
  *(ushort *)(v2 + 6) = v5 - 1;
  if ( v5 <= 0 )
  {
    Function_21da0a8(v3, *(short *)(v2 + 4));
    result = *(short *)(v2 + 8);
    *(ushort *)(v2 + 6) = result;
  }
  return result;
}

//----- (021D9B28) --------------------------------------------------------
int __fastcall Function_21d9b28(int a1, int a2)
{
  int v2;
  int v3;

  v2 = a1;
  v3 = a2;
  Function_21d7238(a2, 0, 15, 3, -3);
  if ( *(ushort *)(v2 + 2980) )
    Function_21d749c(v3 + 28, 1, 0);
  *(uint *)(v3 + 180) = 0;
  return Function_21db4e4(v2);
}

//----- (021D9B68) --------------------------------------------------------
int __fastcall Function_21d9b68(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;

  v2 = a2;
  v3 = a1;
  v4 = Function_21d7244(a2);
  if ( *(uint *)(v2 + 180) <= 0 )
  {
    if ( *(ushort *)(v3 + 2980) )
      v5 = Function_21d74b8((int *)(v2 + 28));
    else
      v5 = 1;
    if ( v5 == 1 && v4 == 3 && *(uint *)(v3 + 64) == v3 + 12 )
      return 1;
  }
  else
  {
    --*(uint *)(v2 + 180);
  }
  return 0;
}

//----- (021D9BC0) --------------------------------------------------------
int __fastcall Function_21d9bc0(int a1, int a2)
{
  int v2;

  v2 = a1;
  if ( *(ushort *)(a1 + 2980) )
    Function_5_21d57fc_CallG3X_SetFog(*(int **)(a2 + 28), 1, 0, 0, 0, 0);
  return Function_21d69b8(*(uint *)(v2 + 4));
}

//----- (021D9BEC) --------------------------------------------------------
void __fastcall Function_21d9bec(int a1)
{
  int v1;
  int v2;
  int v3;

  v1 = a1;
  v2 = *(ushort *)(a1 + 2978);
  if ( v2 != 5 )
  {
    if ( v2 )
    {
      Function_21d6ff0(v1 + 12, (void (*)(void))Function_21da1a8);
      Function_21d717c(v1, 0, 0, v3);
      Function_21d700c();
    }
  }
}

//----- (021D9C20) --------------------------------------------------------
int __fastcall Function_21d9c20(int a1, int a2, int a3, int a4, int a5, uint a6)
{
  int result;
  int v7;
  uint v8;
  int v9;
  int v10;
  int v11;

  result = 2968;
  v7 = a2;
  v8 = *(ushort *)(a2 + 2978);
  v9 = a3;
  v10 = *(uint *)(v7 + 2968);
  if ( v8 <= 5 )
    JUMPOUT(__CS__, *((short *)&off_21D9C44 + v8) + 35494982);
  switch ( (uchar)v8 )
  {
    case 0:
      if ( *(ushort *)(v7 + 2980) )
      {
        Function_21d7384(*(int **)(*(uint *)(*(uint *)v7 + 260) + 72), 5, 28591, 0);
        Function_5_21d585c(*(uint *)(*(uint *)(*(uint *)v7 + 260) + 72), dword_21F8E14);
        Function_21d64e4(v9, 16 - v9);
        Function_201ff0c(4u, 1);
        *(uint *)(v10 + 152) = a5;
        *(uint *)(v10 + 156) = 0;
      }
      result = 2978;
      *(ushort *)(v7 + 2978) = 1;
      break;
    case 1:
      result = 2978;
      *(ushort *)(v7 + 2978) = 3;
      break;
    case 2:
      if ( *(ushort *)(v7 + 2980) )
      {
        Function_21d7384(*(int **)(*(uint *)(*(uint *)v7 + 260) + 72), 5, 28591, 0);
        Function_5_21d585c(*(uint *)(*(uint *)(*(uint *)v7 + 260) + 72), dword_21F8E14);
        Function_21d64e4(v9, 16 - v9);
        Function_201ff0c(4u, 1);
        *(uint *)(v10 + 152) = a5;
        *(uint *)(v10 + 156) = 0;
      }
      result = 2978;
      *(ushort *)(v7 + 2978) = 3;
      break;
    case 3:
      v11 = *(uint *)(v10 + 156);
      if ( v11 )
      {
        if ( v11 == 1 )
        {
          if ( ++*(uint *)(v10 + 152) >= a6 )
            *(uint *)(v10 + 156) = 2;
        }
        else if ( --*(uint *)(v10 + 152) <= 0 )
        {
          *(uint *)(v10 + 156) = 1;
        }
      }
      else
      {
        *(uint *)(v10 + 152) -= a4;
        if ( *(uint *)(v10 + 152) <= 0 )
          *(uint *)(v10 + 156) = 1;
      }
      Function_21d64e4(a3 + *(uint *)(v10 + 152) / 128, 16 - (a3 + *(uint *)(v10 + 152) / 128));
      result = 2982;
      if ( *(ushort *)(v7 + 2982) == 5 )
      {
        result = 2978;
        *(ushort *)(v7 + 2978) = 4;
      }
      break;
    case 4:
      Function_21d64e4(0, 16);
      Function_201ff0c(4u, 0);
      result = 2978;
      *(ushort *)(v7 + 2978) = 5;
      break;
    case 5:
      if ( *(ushort *)(v7 + 2980) )
        Function_5_21d57fc_CallG3X_SetFog(*(int **)(*(uint *)(*(uint *)v7 + 260) + 72), 1, 0, 0, 0, 0);
      result = Function_21d69b8(*(uint *)(v7 + 4));
      break;
    default:
      return result;
  }
  return result;
}

//----- (021D9DFC) --------------------------------------------------------
int __fastcall Function_21d9dfc(int a1, int *a2, int a3, int a4, short a5, int a6, short a7)
{
  int v7;
  int result;
  int v9;
  int *v10;

  v7 = a1;
  result = *(ushort *)(a1 + 2978);
  v9 = (int)a2;
  switch ( (uchar)result )
  {
    case 0:
      Function_21d7308(
        (int)(a2 + 12),
        a2,
        *(uint *)(*(uint *)(*(uint *)v7 + 260) + 72),
        a3,
        a4,
        a5,
        a6,
        *(ushort *)(v7 + 2980));
      result = 2978;
      *(ushort *)(v7 + 2978) = 1;
      break;
    case 1:
      result = Function_21d735c((int)(a2 + 12), (int)a2, *(ushort *)(v7 + 2980));
      if ( result == 1 )
      {
        result = 2978;
        *(ushort *)(v7 + 2978) = 3;
      }
      break;
    case 2:
      if ( *(ushort *)(v7 + 2980) )
      {
        v10 = *(int **)(*(uint *)(*(uint *)v7 + 260) + 72);
        *a2 = (int)v10;
        Function_21d7384(v10, a3, a4, a5);
        Function_21d74d4(v9);
      }
      result = 2978;
      *(ushort *)(v7 + 2978) = 3;
      break;
    case 3:
      result = *(ushort *)(v7 + 2982);
      if ( result == 5 )
      {
        if ( *(ushort *)(v7 + 2980) )
          Function_21d749c((int)a2, a7, 0);
        result = 2978;
        *(ushort *)(v7 + 2978) = 4;
      }
      break;
    case 4:
      if ( *(ushort *)(v7 + 2980) )
        result = Function_21d74b8(a2);
      else
        result = 1;
      if ( result == 1 )
      {
        result = 2978;
        *(ushort *)(v7 + 2978) = 5;
      }
      break;
    case 5:
      if ( *(ushort *)(v7 + 2980) )
        Function_5_21d57fc_CallG3X_SetFog((int *)*a2, 1, 0, 0, 0, 0);
      result = Function_21d69b8(*(uint *)(v7 + 4));
      break;
    default:
      return result;
  }
  return result;
}

//----- (021D9F0C) --------------------------------------------------------
void __fastcall Function_21d9f0c(int a1, int a2)
{
  int v2;
  int v3;

  v2 = a2;
  v3 = *(uint *)(a2 + 2968);
  switch ( (uchar)*(ushort *)(a2 + 2978) )
  {
    case 0u:
      Function_21d9984(a2, *(uint *)(a2 + 2968));
      Function_21d6418(*(uint *)v2, 0, 17);
      Function_21d6418(*(uint *)v2, 3, 17);
      *(ushort *)(v2 + 2978) = 1;
      break;
    case 1u:
      if ( Function_21d9a0c(a2, *(uint *)(a2 + 2968)) )
        *(ushort *)(v2 + 2978) = 3;
      break;
    case 2u:
      Function_21d9a58(a2, *(uint *)(a2 + 2968));
      Function_21d6418(*(uint *)v2, 0, 17);
      Function_21d6418(*(uint *)v2, 3, 17);
      *(ushort *)(v2 + 2978) = 3;
      break;
    case 3u:
      Function_21d9aec(a2, *(uint *)(a2 + 2968));
      if ( *(ushort *)(v2 + 2982) == 5 )
      {
        Function_21d9b28(v2, v3);
        Function_21d6418(*(uint *)v2, 5, 17);
        *(ushort *)(v2 + 2978) = 4;
      }
      break;
    case 4u:
      if ( Function_21d9b68(a2, *(uint *)(a2 + 2968)) )
        *(ushort *)(v2 + 2978) = 5;
      break;
    case 5u:
      Function_21d9bc0(a2, *(uint *)(a2 + 2968));
      Function_21d6418(*(uint *)v2, 8, 17);
      break;
    default:
      break;
  }
  Function_21d9bec(v2);
}

//----- (021D9FF8) --------------------------------------------------------
void __fastcall Function_21d9ff8(int a1, int a2)
{
  int v2;
  int v3;

  v2 = a2;
  v3 = *(uint *)(a2 + 2968);
  switch ( (uchar)*(ushort *)(a2 + 2978) )
  {
    case 0u:
      Function_21d9984(a2, *(uint *)(a2 + 2968));
      *(ushort *)(v2 + 2978) = 1;
      break;
    case 1u:
      if ( Function_21d9a0c(a2, *(uint *)(a2 + 2968)) )
        *(ushort *)(v2 + 2978) = 3;
      break;
    case 2u:
      Function_21d9a58(a2, *(uint *)(a2 + 2968));
      *(ushort *)(v2 + 2978) = 3;
      break;
    case 3u:
      Function_21d9aec(a2, *(uint *)(a2 + 2968));
      if ( *(ushort *)(v2 + 2982) == 5 )
      {
        Function_21d9b28(v2, v3);
        *(ushort *)(v2 + 2978) = 4;
      }
      break;
    case 4u:
      if ( Function_21d9b68(a2, *(uint *)(a2 + 2968)) )
        *(ushort *)(v2 + 2978) = 5;
      break;
    case 5u:
      Function_21d9bc0(a2, *(uint *)(a2 + 2968));
      break;
    default:
      break;
  }
  Function_21d9bec(v2);
}

//----- (021DA0A8) --------------------------------------------------------
uint *__fastcall Function_21da0a8(uint *a1, uint *a2, int a3, int a4)
{
  int v4;
  uint *result;
  int v6;
  uint *v7;
  int v8;
  int v9;
  int v10;
  int v11;
  uint v12;
  int v13;
  uint *v14;
  uint *v15;
  int v16;
  char v17;
  int v18;
  int v19;
  int v20;
  int v21;
  int v22;
  int v23;

  v23 = a4;
  v15 = a2;
  v14 = a1;
  v4 = a1[742];
  v16 = 0;
  for ( result = a2; v16 < (int)v15; ++v16 )
  {
    result = Function_21d6f00(v14, 0x20u);
    v6 = (int)result;
    if ( !result )
      break;
    v7 = (uint *)result[2];
    v8 = Function_201d35c();
    *v7 = 0;
    v9 = v8;
    u32_div_f(v8, 3);
    v11 = v10;
    Function_2021e50(*(uint *)(v6 + 4), (ushort)v10);
    v7[4] = -24 * (v11 + 1);
    v7[2] = 24 * (v11 + 1);
    v7[4] *= dword_21F8CFC[s32_div_f(*(uint *)(v4 + 188), 60)];
    v7[2] *= dword_21F8CFC[s32_div_f(*(uint *)(v4 + 188), 60)];
    v7[3] = 0;
    v7[1] = v9 & 3;
    v12 = s32_div_f(*(uint *)(v4 + 188), 60);
    v7[1] = s32_div_f(v7[1], dword_21F8CFC[v12]);
    Function_21d7010(&v17, v6);
    v21 = v18;
    v22 = v19;
    v20 = v9 & 0x1FF;
    u32_div_f(v9, 48);
    v22 = 0;
    v20 <<= 12;
    v21 = (v13 - 80) << 12;
    Function_21d630c(*(uint **)(v6 + 4), &v20);
    result = v15;
  }
  return result;
}

//----- (021DA1A8) --------------------------------------------------------
int *__fastcall Function_21da1a8(int a1, int a2, int a3, int a4)
{
  int v4;
  int *v5;
  int *result;
  int v7;
  int v8;
  uint v9;
  int v10;
  char v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;

  v17 = a4;
  v4 = a1;
  v5 = *(int **)(a1 + 8);
  Function_21d7010(&v11, a1);
  v14 = *(uint *)&v11;
  v15 = v12;
  v16 = v13;
  result = (int *)v5[3];
  if ( result )
  {
    if ( result == (int *)1 )
    {
      v10 = *v5;
      result = (int *)(*v5 - 1);
      *v5 = (int)result;
      if ( v10 <= 0 )
      {
        result = (int *)2;
        v5[3] = 2;
      }
    }
    else if ( result == (int *)2 )
    {
      result = Function_21d6fa8((uint *)v4);
    }
  }
  else
  {
    v14 += v5[4] << 13;
    v15 += v5[2] << 13;
    v7 = *v5 + 2;
    *v5 = v7;
    if ( v7 > v5[1] )
    {
      v8 = Function_201d35c();
      u32_div_f(v8, 10);
      if ( v9 >= 5 )
      {
        v5[3] = 1;
        *v5 = 4;
        Function_2021e50(*(uint *)(v4 + 4), 3u);
      }
      else
      {
        v5[3] = 2;
      }
    }
    result = (int *)Function_21d630c(*(uint **)(v4 + 4), &v14);
  }
  return result;
}

//----- (021DA244) --------------------------------------------------------
int __fastcall Function_21da244(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int *v5;
  int v6;
  int v7;
  int v8;
  int result;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;

  v2 = a2;
  v3 = *(uint *)(a2 + 2968);
  switch ( (uchar)*(ushort *)(a2 + 2978) )
  {
    case 0u:
      Function_21d7210(v3, a2, 1, 12, 1, 6, -1, 4, 0, (int)Function_21da5a0);
      *(uint *)(v3 + 184) = 0;
      *(uint *)(v3 + 188) = 0;
      *(uint *)(v3 + 196) = 0;
      *(uint *)(v3 + 200) = 0;
      Function_21d7308(
        v3 + 76,
        (uint *)(v3 + 28),
        *(uint *)(*(uint *)(*(uint *)v2 + 260) + 72),
        3,
        28463,
        0x3A94u,
        1,
        *(ushort *)(v2 + 2980));
      *(uint *)(v3 + 180) = 0;
      *(ushort *)(v2 + 2978) = 1;
      break;
    case 1u:
      v4 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v3 + 180) <= 0 )
      {
        if ( Function_21d735c(v3 + 76, v3 + 28, *(ushort *)(v2 + 2980)) == 1 && v4 == 3 )
        {
          *(ushort *)(v2 + 2978) = 3;
          Function_201ff0c(4u, 1);
        }
      }
      else
      {
        --*(uint *)(v3 + 180);
      }
      break;
    case 2u:
      Function_21d7210(v3, a2, 1, 6, 1, 6, -1, 4, 0, (int)Function_21da5a0);
      *(uint *)(v3 + 184) = 0;
      *(uint *)(v3 + 188) = 0;
      *(uint *)(v3 + 196) = 0;
      *(uint *)(v3 + 200) = 0;
      if ( *(ushort *)(v2 + 2980) )
      {
        v5 = *(int **)(*(uint *)(*(uint *)v2 + 260) + 72);
        *(uint *)(v3 + 28) = v5;
        Function_21d7384(v5, 3, 28463, 14996);
        Function_21d74d4(v3 + 28);
      }
      Function_21d7568(v2, (void (*)(void))Function_21da5a0, 20, 2, 16, (void (__fastcall *)(int))Function_21da6bc);
      *(ushort *)(v2 + 2978) = 3;
      Function_201ff0c(4u, 1);
      break;
    case 3u:
      v6 = *(short *)(v3 + 6);
      *(ushort *)(v3 + 6) = v6 - 1;
      if ( v6 <= 0 )
      {
        Function_21da5a0(v2, *(short *)(v3 + 4));
        *(ushort *)(v3 + 6) = *(ushort *)(v3 + 8);
      }
      if ( *(ushort *)(v2 + 2982) == 5 )
      {
        Function_21d7238(v3, 0, 12, 1, -1);
        if ( *(ushort *)(v2 + 2980) )
          Function_21d749c(v3 + 28, 1, 0);
        *(uint *)(v3 + 180) = 9;
        *(ushort *)(v2 + 2978) = 4;
        *(uint *)(v3 + 200) = 1;
        Function_201ff0c(4u, 0);
      }
      break;
    case 4u:
      v7 = Function_21d7244(*(uint *)(a2 + 2968));
      if ( *(uint *)(v3 + 180) <= 0 )
      {
        if ( *(ushort *)(v2 + 2980) )
          v8 = Function_21d74b8((int *)(v3 + 28));
        else
          v8 = 1;
        if ( v8 == 1 && v7 == 3 && *(uint *)(v2 + 64) == v2 + 12 )
          *(ushort *)(v2 + 2978) = 5;
      }
      else
      {
        --*(uint *)(v3 + 180);
      }
      break;
    case 5u:
      if ( *(ushort *)(a2 + 2980) )
        Function_5_21d57fc_CallG3X_SetFog(*(int **)(v3 + 28), 1, 0, 0, 0, 0);
      Function_21d69b8(*(uint *)(v2 + 4));
      break;
    default:
      break;
  }
  result = *(ushort *)(v2 + 2978);
  if ( result != 5 && *(ushort *)(v2 + 2978) )
  {
    Function_21d6ff0(v2 + 12, (void (*)(void))Function_21da6bc);
    Function_21d717c(v2, &v16, &v15, v10);
    Function_21d700c();
    v11 = *(uint *)(v3 + 188);
    v12 = (short)(HIWORD(v11) + v16);
    v13 = (short)(v11 - 5 * v15);
    if ( v12 >= 0 )
    {
      if ( v12 >= 256 )
        v12 = (short)(v12 - 256);
    }
    else
    {
      v12 = (short)(v12 + 256);
    }
    if ( v13 < 0 )
      v13 = (short)(v13 + 2048);
    *(uint *)(v3 + 196) += 2;
    if ( *(uint *)(v3 + 196) > 60 )
    {
      *(uint *)(v3 + 196) = 0;
      v12 = (short)(((uint)(v12 + 32) >> 31)
                           + __ROR4__(((v12 + 32) << 24) - ((uint)(v12 + 32) >> 31), 24));
    }
    v14 = (short)(((uint)(v13 + 2) >> 31)
                         + __ROR4__(((v13 + 2) << 21) - ((uint)(v13 + 2) >> 31), 21));
    REG_BG2HOFS = v12 & 0x1FF | (s32_div_f(-v14, 5) << 16) & 0x1FF0000;
    *(uint *)(v3 + 188) = v12 << 16;
    result = (ushort)v14 | *(uint *)(v3 + 188);
    *(uint *)(v3 + 188) = result;
  }
  return result;
}

//----- (021DA5A0) --------------------------------------------------------
uint *__fastcall Function_21da5a0(uint *a1, int a2)
{
  int v2;
  int v3;
  uint *result;
  int i;
  int v6;
  uint *v7;
  char v8;
  uint v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  uint *v19;
  int v20;
  char v21;
  int v22;
  int v23;
  int v24;
  int v25;
  int v26;

  v2 = a2;
  v19 = a1;
  v3 = a1[742];
  v20 = v3;
  result = *(uint **)(v3 + 184);
  if ( result == (uint *)1 )
    v2 = 2 * a2;
  for ( i = 0; i < v2; ++i )
  {
    result = Function_21d6f00(v19, 0x20u);
    v6 = (int)result;
    if ( !result )
      break;
    v7 = (uint *)result[2];
    v8 = Function_201d35c();
    Function_2021e50(*(uint *)(v6 + 4), v8 & 3);
    v7[4] = 10;
    v7[5] = 0;
    v9 = Function_201d35c();
    v10 = (v9 >> 31) + __ROR4__((v9 << 31) - (v9 >> 31), 31) ? -1 : 1;
    v7[1] = v10;
    Function_201d35c();
    v7[3] = 1;
    *v7 = v20 + 184;
    v7[6] = v20 + 200;
    v11 = Function_201d35c();
    u32_div_f(v11, 20);
    v7[7] = v12 + 10;
    Function_21d7010(&v21, v6);
    v24 = *(uint *)&v21;
    v25 = v22;
    v26 = v23;
    v13 = Function_201d35c();
    u32_div_f(v13, 414);
    v24 = v14 - 32;
    if ( *(uint *)(v20 + 184) != 1 || i < v2 / 2 )
    {
      v17 = Function_201d35c();
      u32_div_f(v17, 20);
      v25 = -8 - v18;
    }
    else
    {
      v15 = Function_201d35c();
      u32_div_f(v15, 20);
      v25 = -40 - v16;
    }
    v24 <<= 12;
    v25 <<= 12;
    v26 = 0;
    result = (uint *)Function_21d630c(*(uint **)(v6 + 4), &v24);
  }
  return result;
}

//----- (021DA6BC) --------------------------------------------------------
int *__fastcall Function_21da6bc(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  int *result;
  char v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;

  v1 = a1;
  v2 = *(uint *)(a1 + 8);
  Function_21d7010(&v6, a1);
  v9 = *(uint *)&v6;
  v10 = v7;
  v3 = 0;
  v11 = v8;
  if ( *(uint *)(v2 + 20) >= *(uint *)(v2 + 12) )
  {
    v10 += 4096;
    *(uint *)(v2 + 20) = 0;
    Function_21d630c(*(uint **)(v1 + 4), &v9);
  }
  ++*(uint *)(v2 + 20);
  v10 >>= 12;
  if ( **(uint **)(v2 + 24) == 1 )
  {
    v4 = *(uint *)(v2 + 28) - 1;
    *(uint *)(v2 + 28) = v4;
    if ( v4 <= 0 )
      v3 = 1;
  }
  result = (int *)-284;
  if ( v10 < -284 && (result = (int *)-296, v10 > -296) || v10 > 212 && v10 < 232 )
    v3 = 1;
  if ( v3 == 1 )
  {
    **(uint **)v2 = 1;
    result = Function_21d6fa8((uint *)v1);
  }
  return result;
}

//----- (021DA748) --------------------------------------------------------
int __fastcall Function_21da748(int a1, int a2)
{
  int result;
  int v3;
  uint v4;
  uint *v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  uint v17;
  int v18;
  int v19;

  result = 2968;
  v3 = a2;
  v4 = *(ushort *)(a2 + 2978);
  v5 = *(uint **)(v3 + 2968);
  if ( v4 <= 5 )
    JUMPOUT(__CS__, *((short *)&off_21DA768 + v4) + 35497834);
  switch ( (uchar)v4 )
  {
    case 0:
    case 1:
    case 2:
      *v5 = 0;
      v5[4] = 0;
      v5[1] = 0;
      Function_21d64e4(0, 31);
      Function_201ff0c(4u, 1);
      result = 2978;
      *(ushort *)(v3 + 2978) = 3;
      break;
    case 3:
      v6 = v5[4];
      if ( v6 < 0 )
      {
        v7 = v5[1];
        if ( v7 )
        {
          if ( v7 == 1 )
          {
            ++v5[5];
            v5[7] += v5[6];
            if ( v5[5] >= 2 )
              v5[1] = 2;
            v12 = s32_div_f(v5[7], 100);
            Function_21d64e4(v12, 31);
          }
          else if ( v7 == 2 )
          {
            v13 = v5[7] - v5[2];
            v5[7] = v13;
            if ( v13 <= 0 )
            {
              v5[1] = 0;
              v5[7] = 0;
              if ( v5[2] == 200 )
              {
                v14 = Function_201d35c();
                u32_div_f(v14, 15);
                v5[4] = v15;
              }
              else
              {
                v16 = Function_201d35c();
                v17 = s32_div_f(50 * v5[6], 100);
                u32_div_f(v16, 120);
                v5[4] = v17 + v18;
              }
            }
            v19 = s32_div_f(v5[7], 100);
            Function_21d64e4(v19, 31);
          }
        }
        else
        {
          v5[1] = 1;
          v5[5] = 0;
          v8 = Function_201d35c();
          u32_div_f(v8, 480);
          v5[6] = v9 + 200;
          v5[7] = 0;
          v10 = Function_201d35c();
          u32_div_f(v10, 3);
          if ( v11 )
          {
            v5[2] = 36;
            Function_2005748(0x63Du);
          }
          else
          {
            v5[2] = 200;
            Function_2005748(0x63Cu);
          }
        }
      }
      else
      {
        v5[4] = v6 - 1;
      }
      result = 2982;
      if ( *(ushort *)(v3 + 2982) == 5 )
      {
        result = 2978;
        *(ushort *)(v3 + 2978) = 4;
      }
      break;
    case 4:
      result = 2978;
      *(ushort *)(v3 + 2978) = 5;
      break;
    case 5:
      result = Function_21d69b8(*(uint *)(v3 + 4));
      break;
    default:
      return result;
  }
  return result;
}

//----- (021DA8A0) --------------------------------------------------------
void __fastcall Function_21da8a0(int a1, int a2)
{
  int v2;
  short *v3;
  int v4;
  int v5;

  v2 = a2;
  v3 = *(short **)(a2 + 2968);
  switch ( (uchar)*(ushort *)(a2 + 2978) )
  {
    case 0u:
      Function_21d7210((int)v3, a2, 1, 35, 4, 15, -2, 5, 1, (int)Function_21da9dc);
      *(ushort *)(v2 + 2978) = 1;
      break;
    case 1u:
      if ( Function_21d7244(*(uint *)(a2 + 2968)) == 3 )
        *(ushort *)(v2 + 2978) = 3;
      break;
    case 2u:
      Function_21d7210((int)v3, a2, 1, 4, 15, 15, -2, 5, 1, (int)Function_21da9dc);
      Function_21d7568(v2, (void (*)(void))Function_21da9dc, 16, 2, 1, (void (__fastcall *)(int))Function_21daadc);
      *(ushort *)(v2 + 2978) = 3;
      break;
    case 3u:
      v4 = v3[3];
      v3[3] = v4 - 1;
      if ( v4 <= 0 )
      {
        Function_21da9dc(v2, v3[2]);
        v3[3] = v3[4];
      }
      if ( *(ushort *)(v2 + 2982) == 5 )
      {
        Function_21d7238((int)v3, 0, 35, 2, -3);
        *(ushort *)(v2 + 2978) = 4;
      }
      break;
    case 4u:
      if ( Function_21d7244(*(uint *)(a2 + 2968)) == 3 && *(uint *)(v2 + 64) == v2 + 12 )
        *(ushort *)(v2 + 2978) = 5;
      break;
    case 5u:
      Function_21d69b8(*(uint *)(a2 + 4));
      break;
    default:
      break;
  }
  if ( *(ushort *)(v2 + 2978) != 5 )
  {
    if ( *(ushort *)(v2 + 2978) )
    {
      Function_21d6ff0(v2 + 12, (void (*)(void))Function_21daadc);
      Function_21d717c(v2, 0, 0, v5);
      Function_21d700c();
    }
  }
}

//----- (021DA9DC) --------------------------------------------------------
uint *__fastcall Function_21da9dc(uint *a1, uint *a2)
{
  uint *result;
  int v3;
  uint *v4;
  uint *v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  uint *v13;
  uint *i;
  uint v15;
  int v16;
  int v17;

  v13 = a1;
  result = a2;
  v3 = 0;
  for ( i = a2; v3 < (int)i; ++v3 )
  {
    result = Function_21d6f00(v13, 0x20u);
    v4 = result;
    if ( !result )
      break;
    v5 = (uint *)result[2];
    v6 = Function_201d35c();
    u32_div_f(v6, 14);
    v8 = v7;
    Function_2021e50(v4[1], (ushort)v7);
    v8 /= 4;
    v9 = Function_201d35c();
    u32_div_f(v9, 25);
    *v5 = (v10 + 8) * (v8 + 1);
    v5[1] = s32_div_f(0x10u, v8 + 1);
    v5[2] = 0;
    v5[3] = Function_201d35c() & 1;
    v5[4] = 1;
    switch ( (uchar)v8 + 1 )
    {
      case 1:
      case 2:
        v15 = (Function_201d35c() & 0x1FF) - 128;
        v11 = Function_201d35c();
        u32_div_f(v11, 192);
        v16 = v12 + 8;
        break;
      case 3:
        v15 = (Function_201d35c() & 0x1FF) - 128;
        v16 = (Function_201d35c() & 0x7F) + 64;
        break;
      case 4:
        v15 = (Function_201d35c() & 0x1FF) - 128;
        v16 = (Function_201d35c() & 0x1F) + 160;
        break;
      default:
        break;
    }
    v17 = 0;
    v15 <<= 12;
    v16 <<= 12;
    Function_21d630c((uint *)v4[1], (int *)&v15);
    result = i;
  }
  return result;
}

//----- (021DAADC) --------------------------------------------------------
int *__fastcall Function_21daadc(int a1, int a2, int a3, int a4)
{
  int v4;
  uint *v5;
  uint v6;
  int v7;
  int *result;
  char v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;

  v15 = a4;
  v4 = a1;
  v5 = *(uint **)(a1 + 8);
  Function_21d7010(&v9, a1);
  v12 = *(uint *)&v9;
  v13 = v10;
  v14 = v11;
  v5[2] += v5[1];
  if ( *v5 <= 0 )
  {
    v6 = s32_div_f(v5[2], 50);
  }
  else
  {
    --*v5;
    v6 = s32_div_f(v5[2], 100);
  }
  v13 -= v6 << 12;
  v7 = v5[4] - 1;
  v5[4] = v7;
  if ( v7 <= 0 )
  {
    v5[4] = 1;
    if ( v5[3] )
    {
      v12 -= 0x2000;
      v5[3] = 0;
    }
    else
    {
      v12 += 0x2000;
      v5[3] = 1;
    }
  }
  Function_21d630c(*(uint **)(v4 + 4), &v12);
  result = (int *)-16;
  if ( v13 >> 12 <= -16 )
    result = Function_21d6fa8((uint *)v4);
  return result;
}

//----- (021DAB78) --------------------------------------------------------
int *__fastcall Function_21dab78(int a1, int a2)
{
  int *result;
  int v3;
  int *v4;
  int v5;
  int v6;

  result = (int *)2968;
  v3 = a2;
  v4 = *(int **)(a2 + 2968);
  switch ( (uchar)*(ushort *)(a2 + 2978) )
  {
    case 0u:
      Function_21d64fc(*(uint **)(a2 + 2968), 0, 16, 8);
      Function_21d64e4(0, 16);
      REG_BG2CNT = REG_BG2CNT & 0xFFFC | 3;
      Function_201ff0c(4u, 1);
      result = (int *)2978;
      *(ushort *)(v3 + 2978) = 1;
      break;
    case 1u:
      v5 = Function_21d650c(*(uint **)(a2 + 2968));
      result = Function_21d64e4(*v4, 16 - *v4);
      if ( v5 == 1 )
      {
        result = (int *)2978;
        *(ushort *)(v3 + 2978) = 3;
      }
      break;
    case 2u:
      Function_21d64e4(16, 0);
      REG_BG2CNT = REG_BG2CNT & 0xFFFC | 3;
      Function_201ff0c(4u, 1);
      result = (int *)2978;
      *(ushort *)(v3 + 2978) = 3;
      break;
    case 3u:
      result = (int *)*(ushort *)(a2 + 2982);
      if ( result == (int *)5 )
      {
        Function_21d64fc(*(uint **)(a2 + 2968), 16, 0, 8);
        result = (int *)2978;
        *(ushort *)(v3 + 2978) = 4;
      }
      break;
    case 4u:
      v6 = Function_21d650c(*(uint **)(a2 + 2968));
      result = Function_21d64e4(*v4, 16 - *v4);
      if ( v6 == 1 )
      {
        result = (int *)2978;
        *(ushort *)(v3 + 2978) = 5;
      }
      break;
    case 5u:
      result = (int *)Function_21d69b8(*(uint *)(a2 + 4));
      break;
    default:
      return result;
  }
  return result;
}

//----- (021DAC68) --------------------------------------------------------
int *__fastcall Function_21dac68(int a1, int a2)
{
  int *result;
  int v3;
  int *v4;
  int v5;
  int v6;

  result = (int *)2968;
  v3 = a2;
  v4 = *(int **)(a2 + 2968);
  switch ( (uchar)*(ushort *)(a2 + 2978) )
  {
    case 0u:
      Function_21d64fc(*(uint **)(a2 + 2968), 0, 4, 8);
      Function_21d64e4(0, 16);
      Function_201ff0c(4u, 1);
      result = (int *)2978;
      *(ushort *)(v3 + 2978) = 1;
      break;
    case 1u:
      v5 = Function_21d650c(*(uint **)(a2 + 2968));
      result = Function_21d64e4(*v4, 16 - *v4);
      if ( v5 )
      {
        result = (int *)2978;
        *(ushort *)(v3 + 2978) = 3;
      }
      break;
    case 2u:
      Function_21d64e4(4, 12);
      Function_201ff0c(4u, 1);
      result = (int *)2978;
      *(ushort *)(v3 + 2978) = 3;
      break;
    case 3u:
      result = (int *)*(ushort *)(a2 + 2982);
      if ( result == (int *)5 )
      {
        Function_21d64fc(*(uint **)(a2 + 2968), 4, 0, 8);
        result = (int *)2978;
        *(ushort *)(v3 + 2978) = 4;
      }
      break;
    case 4u:
      v6 = Function_21d650c(*(uint **)(a2 + 2968));
      result = Function_21d64e4(*v4, 16 - *v4);
      if ( v6 )
      {
        result = (int *)2978;
        *(ushort *)(v3 + 2978) = 5;
      }
      break;
    case 5u:
      result = (int *)Function_21d69b8(*(uint *)(a2 + 4));
      break;
    default:
      return result;
  }
  return result;
}

//----- (021DAD38) --------------------------------------------------------
int *__fastcall Function_21dad38(int a1, int a2)
{
  int *result;
  int v3;
  uint v4;
  int *v5;
  int v6;
  int v7;
  int *v8;
  int v9;
  int v10;

  result = (int *)2968;
  v3 = a2;
  v4 = *(ushort *)(a2 + 2978);
  v5 = *(int **)(v3 + 2968);
  if ( v4 <= 5 )
    JUMPOUT(__CS__, *((short *)&off_21DAD5A + v4) + 35499356);
  switch ( (uchar)v4 )
  {
    case 0:
      Function_21d7308(
        (int)(v5 + 17),
        v5 + 5,
        *(uint *)(*(uint *)(*(uint *)v3 + 260) + 72),
        7,
        30287,
        0,
        1,
        *(ushort *)(v3 + 2980));
      Function_21d64fc(v5, 0, 9, 30);
      Function_21d64e4(0, 16);
      Function_201ff0c(4u, 1);
      result = (int *)2978;
      *(ushort *)(v3 + 2978) = 1;
      break;
    case 1:
      v6 = Function_21d74b8(v5 + 5);
      v7 = Function_21d650c(v5);
      result = Function_21d64e4(*v5, 16 - *v5);
      if ( v6 == 1 && v7 == 1 )
      {
        result = (int *)2978;
        *(ushort *)(v3 + 2978) = 3;
      }
      break;
    case 2:
      if ( *(ushort *)(v3 + 2980) )
      {
        v8 = *(int **)(*(uint *)(*(uint *)v3 + 260) + 72);
        v5[5] = (int)v8;
        Function_21d7384(v8, 7, 30287, 0);
        Function_21d74d4((int)(v5 + 5));
      }
      Function_21d64e4(9, 7);
      Function_201ff0c(4u, 1);
      result = (int *)2978;
      *(ushort *)(v3 + 2978) = 3;
      break;
    case 3:
      if ( *(ushort *)(v3 + 2982) == 5 )
      {
        if ( *(ushort *)(v3 + 2980) )
          Function_21d749c((int)(v5 + 5), 1, 0);
        Function_21d64fc(v5, 9, 0, 30);
        result = (int *)2978;
        *(ushort *)(v3 + 2978) = 4;
      }
      break;
    case 4:
      if ( *(ushort *)(v3 + 2980) )
        v9 = Function_21d74b8(v5 + 5);
      else
        v9 = 1;
      v10 = Function_21d650c(v5);
      result = Function_21d64e4(*v5, 16 - *v5);
      if ( v9 == 1 && v10 == 1 )
      {
        result = (int *)2978;
        *(ushort *)(v3 + 2978) = 5;
      }
      break;
    case 5:
      if ( *(ushort *)(v3 + 2980) )
        Function_5_21d57fc_CallG3X_SetFog((int *)v5[5], 1, 0, 0, 0, 0);
      result = (int *)Function_21d69b8(*(uint *)(v3 + 4));
      break;
    default:
      return result;
  }
  return result;
}

//----- (021DAEC0) --------------------------------------------------------
int *__fastcall Function_21daec0(int a1, int a2)
{
  int *result;
  int v3;
  uint v4;
  int *v5;
  int v6;
  int v7;
  int *v8;
  int v9;
  int v10;

  result = (int *)2968;
  v3 = a2;
  v4 = *(ushort *)(a2 + 2978);
  v5 = *(int **)(v3 + 2968);
  if ( v4 <= 5 )
    JUMPOUT(__CS__, *((short *)&off_21DAEE2 + v4) + 35499748);
  switch ( (uchar)v4 )
  {
    case 0:
      Function_21d7308(
        (int)(v5 + 17),
        v5 + 5,
        *(uint *)(*(uint *)(*(uint *)v3 + 260) + 72),
        6,
        30037,
        0x7FFFu,
        1,
        *(ushort *)(v3 + 2980));
      Function_21d64fc(v5, 0, 9, 30);
      Function_21d64e4(0, 16);
      Function_201ff0c(4u, 1);
      result = (int *)2978;
      *(ushort *)(v3 + 2978) = 1;
      break;
    case 1:
      v6 = Function_21d74b8(v5 + 5);
      v7 = Function_21d650c(v5);
      result = Function_21d64e4(*v5, 16 - *v5);
      if ( v6 == 1 && v7 == 1 )
      {
        result = (int *)2978;
        *(ushort *)(v3 + 2978) = 3;
      }
      break;
    case 2:
      if ( *(ushort *)(v3 + 2980) )
      {
        v8 = *(int **)(*(uint *)(*(uint *)v3 + 260) + 72);
        v5[5] = (int)v8;
        Function_21d7384(v8, 6, 30037, 0x7FFF);
        Function_21d74d4((int)(v5 + 5));
      }
      Function_21d64e4(9, 7);
      Function_201ff0c(4u, 1);
      result = (int *)2978;
      *(ushort *)(v3 + 2978) = 3;
      break;
    case 3:
      if ( *(ushort *)(v3 + 2982) == 5 )
      {
        if ( *(ushort *)(v3 + 2980) )
          Function_21d749c((int)(v5 + 5), 1, 0);
        Function_21d64fc(v5, 9, 0, 30);
        result = (int *)2978;
        *(ushort *)(v3 + 2978) = 4;
      }
      break;
    case 4:
      if ( *(ushort *)(v3 + 2980) )
        v9 = Function_21d74b8(v5 + 5);
      else
        v9 = 1;
      v10 = Function_21d650c(v5);
      result = Function_21d64e4(*v5, 16 - *v5);
      if ( v9 == 1 && v10 == 1 )
      {
        result = (int *)2978;
        *(ushort *)(v3 + 2978) = 5;
      }
      break;
    case 5:
      if ( *(ushort *)(v3 + 2980) )
        Function_5_21d57fc_CallG3X_SetFog((int *)v5[5], 1, 0, 0, 0, 0);
      result = (int *)Function_21d69b8(*(uint *)(v3 + 4));
      break;
    default:
      return result;
  }
  return result;
}

//----- (021DB04C) --------------------------------------------------------
int __fastcall Function_21db04c(int a1, int a2)
{
  int v2;
  int v3;
  int result;
  int v5;

  v2 = a2;
  v3 = *(uint *)(*(uint *)a2 + 260);
  result = 2968;
  v5 = *(uint *)(v2 + 2968);
  switch ( (uchar)*(ushort *)(v2 + 2978) )
  {
    case 0u:
      Function_21db614(*(uint *)(v2 + 2968), *(uint *)(*(uint *)(v3 + 4) + 28));
      Function_21db6e0(v5);
      result = 2978;
      *(ushort *)(v2 + 2978) = 1;
      break;
    case 1u:
      result = Function_21db700(*(uint *)(v2 + 2968));
      if ( result == 1 )
      {
        Function_201ff0c(4u, 1);
        Function_21db7a4(v5);
        result = 2978;
        *(ushort *)(v2 + 2978) = 3;
      }
      break;
    case 2u:
      Function_201ff0c(4u, 1);
      result = 2978;
      *(ushort *)(v2 + 2978) = 3;
      break;
    case 3u:
      result = *(ushort *)(v2 + 2982);
      if ( result == 5 )
      {
        Function_21db614(*(uint *)(v2 + 2968), *(uint *)(*(uint *)(v3 + 4) + 28));
        Function_21db6e0(v5);
        result = 2978;
        *(ushort *)(v2 + 2978) = 4;
      }
      break;
    case 4u:
      Function_201ff0c(4u, 0);
      result = Function_21db700(v5);
      if ( result == 1 )
      {
        result = 2978;
        *(ushort *)(v2 + 2978) = 5;
      }
      break;
    case 5u:
      Function_21db690(*(uint *)(v2 + 2968), v3);
      result = Function_21d69b8(*(uint *)(v2 + 4));
      break;
    default:
      return result;
  }
  return result;
}

//----- (021DB144) --------------------------------------------------------
int __fastcall Function_21db144(int a1, int a2, int a3, int a4)
{
  int v4;
  uint v5;
  int v6;
  int v7;
  int v8;
  int *v9;
  int v10;
  int v11;
  int result;
  int v13;
  int v14;
  int v15;

  v15 = a4;
  v4 = a2;
  v5 = *(ushort *)(a2 + 2978);
  v6 = *(uint *)(a2 + 2968);
  if ( v5 <= 5 )
    JUMPOUT(__CS__, *((short *)&off_21DB166 + v5) + 35500392);
  switch ( (uchar)v5 )
  {
    case 0:
      Function_21d64fc(*(uint **)(a2 + 2968), 0, 7, 8);
      Function_21d64e4(0, 16);
      Function_201ff0c(4u, 1);
      Function_21d7308(
        v6 + 68,
        (uint *)(v6 + 20),
        *(uint *)(*(uint *)(*(uint *)v4 + 260) + 72),
        3,
        26927,
        0x7FFFu,
        1,
        *(ushort *)(v4 + 2980));
      *(uint *)(v6 + 172) = 0;
      *(uint *)(v6 + 176) = 0;
      *(ushort *)(v6 + 180) = 0;
      *(ushort *)(v4 + 2978) = 1;
      break;
    case 1:
      v7 = Function_21d735c(v6 + 68, v6 + 20, *(ushort *)(a2 + 2980));
      v8 = Function_21d650c((uint *)v6);
      Function_21d64e4(*(uint *)v6, 16 - *(uint *)v6);
      if ( v8 == v7 && v8 == 1 )
        *(ushort *)(v4 + 2978) = 3;
      break;
    case 2:
      Function_21d64e4(7, 9);
      if ( *(ushort *)(v4 + 2980) )
      {
        v9 = *(int **)(*(uint *)(*(uint *)v4 + 260) + 72);
        *(uint *)(v6 + 20) = v9;
        Function_21d7384(v9, 3, 26927, 0x7FFF);
        Function_21d74d4(v6 + 20);
      }
      Function_201ff0c(4u, 1);
      *(uint *)(v6 + 172) = 0;
      *(uint *)(v6 + 176) = 0;
      *(ushort *)(v6 + 180) = 0;
      *(ushort *)(v4 + 2978) = 3;
      break;
    case 3:
      if ( *(ushort *)(a2 + 2982) == 5 )
      {
        Function_21d64fc(*(uint **)(a2 + 2968), 7, 0, 8);
        if ( *(ushort *)(v4 + 2980) )
          Function_21d749c(v6 + 20, 1, 0);
        *(ushort *)(v4 + 2978) = 4;
      }
      break;
    case 4:
      v10 = Function_21d650c(*(uint **)(a2 + 2968));
      v11 = Function_21d74b8((int *)(v6 + 20));
      Function_21d64e4(*(uint *)v6, 16 - *(uint *)v6);
      if ( v10 == v11 && v10 == 1 )
        *(ushort *)(v4 + 2978) = 5;
      break;
    case 5:
      if ( *(ushort *)(a2 + 2980) )
        Function_5_21d57fc_CallG3X_SetFog(*(int **)(v6 + 20), 1, 0, 0, 0, 0);
      Function_21d69b8(*(uint *)(v4 + 4));
      break;
    default:
      break;
  }
  result = *(ushort *)(v4 + 2978);
  if ( result != 5 && *(ushort *)(v4 + 2978) )
  {
    Function_21d71b4((uint *)v4, &v14, &v13, a4);
    v13 = (ll_mul(v13, 3072LL) + 2048) >> 12;
    *(uint *)(v6 + 172) += v14;
    *(uint *)(v6 + 176) += v13;
    if ( (ushort)++*(ushort *)(v6 + 180) >= 0x200u )
      *(ushort *)(v6 + 180) = 0;
    Function_201c63c(
      *(uint *)(*(uint *)(*(uint *)v4 + 260) + 8),
      2,
      0,
      (*(uint *)(v6 + 172) >> 12)
    + *((uchar *)dword_2201D38 + ((uint)*(ushort *)(v6 + 180) >> 3)));
    result = Function_201c63c(*(uint *)(*(uint *)(*(uint *)v4 + 260) + 8), 2, 3u, *(uint *)(v6 + 176) >> 12);
  }
  return result;
}

//----- (021DB3A8) --------------------------------------------------------
int __fastcall Function_21db3a8(int a1, int a2)
{
  return Function_21d9c20(a1, a2, 4, 4, 1280, 0x100u);
}

//----- (021DB3C4) --------------------------------------------------------
int __fastcall Function_21db3c4(int a1, int a2)
{
  return Function_21d9c20(a1, a2, 6, 1, 1024, 0x100u);
}

//----- (021DB3E0) --------------------------------------------------------
int __fastcall Function_21db3e0(int a1, int a2)
{
  return Function_21d9dfc(a2, *(int **)(a2 + 2968), 3, 26095, 6210, 0, 0);
}

//----- (021DB40C) --------------------------------------------------------
int __fastcall Function_21db40c(int a1, int a2)
{
  return Function_21d9dfc(a2, *(int **)(a2 + 2968), 2, 26415, 31533, 0, 0);
}

//----- (021DB438) --------------------------------------------------------
int __fastcall Function_21db438(int a1, int a2)
{
  return Function_21d9dfc(a2, *(int **)(a2 + 2968), 2, 26415, 20, 0, 0);
}

//----- (021DB460) --------------------------------------------------------
int __fastcall Function_21db460(int a1, int a2)
{
  return Function_21d9dfc(a2, *(int **)(a2 + 2968), 2, 26415, 20480, 0, 0);
}

//----- (021DB48C) --------------------------------------------------------
int __fastcall Function_21db48c(int a1, int a2)
{
  return Function_21d9dfc(a2, *(int **)(a2 + 2968), 1, 19311, 1057, 0, 0);
}

//----- (021DB4B8) --------------------------------------------------------
int __fastcall Function_21db4b8(int a1, ushort a2)
{
  int v2;
  ushort v3;

  v2 = a1;
  v3 = a2;
  if ( *(uint *)(a1 + 2972) )
    ErrorHandler();
  *(uint *)(v2 + 2972) = 1;
  *(ushort *)(v2 + 2976) = v3;
  return Function_2005748(v3);
}

//----- (021DB4E4) --------------------------------------------------------
int __fastcall Function_21db4e4(int a1)
{
  int v1;
  int result;

  v1 = a1;
  Function_20057a4(*(ushort *)(a1 + 2976), 0);
  result = 2972;
  *(uint *)(v1 + 2972) = 0;
  return result;
}

//----- (021DB500) --------------------------------------------------------
int __fastcall Function_21db500(short *a1, int a2, int a3, int a4)
{
  short *v4;
  ushort *v5;
  int v6;
  ushort *v7;
  int v8;
  int result;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;

  v14 = a4;
  v4 = a1;
  v11 = Function_2013b54(*((uint *)a1 + 7));
  v5 = (ushort *)v11;
  v10 = Function_2013b54(*((uint *)v4 + 8));
  v6 = 0;
  v7 = (ushort *)v10;
  do
  {
    v8 = v4[1];
    if ( v6 > v8 )
    {
      if ( v6 > 2 * v8 )
      {
        Function_21db588(*((uint *)v4 + 1), *v4);
      }
      else
      {
        v13 = *(ushort *)(v11 + 2 * (2 * v8 - v6));
        v12 = *(ushort *)(v10 + 2 * (2 * v4[1] - v6));
      }
    }
    else
    {
      Function_21db588(*((uint *)v4 + 1), *v4);
    }
    ++v6;
    *v5 = v13;
    result = v12;
    ++v5;
    *v7 = v12;
    ++v7;
  }
  while ( v6 < 192 );
  return result;
}

//----- (021DB588) --------------------------------------------------------
int __fastcall Function_21db588(int a1, int a2, int a3, int a4, int *a5, int *a6)
{
  int v6;
  int result;
  int v8;
  int v9;
  long long v10;
  int v11;
  int v12;
  long long v13;
  int v14;
  int v15;
  int v16;
  int v17;

  v17 = a2;
  v6 = a4 - a3;
  if ( a4 - a3 < 0 )
    v6 = a3 - a4;
  if ( v6 < a1 )
  {
    v8 = v6 << 12;
    v9 = v6 << 12 >> 31;
    v10 = ll_mul(a1, a1);
    v11 = v10;
    LODWORD(v10) = v8;
    v12 = HIDWORD(v10);
    HIDWORD(v10) = v9;
    v13 = ll_mul(v10, __PAIR__(v9, v8));
    v14 = FX_Sqrt(
            (((uint)(v11 + 2048) >> 12) | ((__CFADD__(v11, 2048) + v12) << 20))
          - (ull)((v13 + 2048) >> 12));
    v15 = v14 >> 12;
    v16 = v17 - (v14 >> 12);
    *a5 = v16;
    if ( v16 < 0 )
      *a5 = 0;
    result = *a5 + 2 * v15;
    *a6 = result;
    if ( result > 255 )
    {
      result = 255;
      *a6 = 255;
    }
  }
  else
  {
    result = 0;
    *a5 = 0;
    *a6 = 0;
  }
  return result;
}

//----- (021DB614) --------------------------------------------------------
int __fastcall Function_21db614(int *a1, int a2)
{
  int v2;
  int *v3;
  int v4;
  int *v5;
  int result;

  v2 = a2;
  v3 = a1;
  Call_FillMemWithValue(a1, 0, 0x62Cu);
  v3[7] = (int)Function_2013b10(4u, (int)(v3 + 11), (int)(v3 + 107));
  v3[8] = (int)Function_2013b10(4u, (int)(v3 + 203), (int)(v3 + 299));
  v4 = 0;
  v5 = v3;
  do
  {
    *((ushort *)v5 + 406) = 255;
    *((ushort *)v5 + 598) = 255;
    ++v4;
    v5 = (int *)((char *)v5 + 2);
  }
  while ( v4 < 192 );
  v3[5] = v2;
  AddTaskToTaskList3((int)Function_21db7f8, (int)v3, 0x78u);
  v3[9] = (int)AddTaskToTaskList3((int)Function_21db78c, (int)v3, 0x400u);
  result = 0;
  v3[10] = 0;
  return result;
}

//----- (021DB690) --------------------------------------------------------
int *__fastcall Function_21db690(int a1)
{
  int v1;

  v1 = a1;
  REG_DISPCNT = ((((REG_DISPCNT & 0xE000u) >> 13) & 0xFFFFFFFD) << 13) | REG_DISPCNT & 0xFFFF1FFF;
  Function_21ef43c(*(uint *)(a1 + 24));
  Call_RemoveTaskFromTaskList(*(int **)(v1 + 36));
  Function_2013b40(*(uint *)(v1 + 28));
  Function_2013b40(*(uint *)(v1 + 32));
  return Call_FillMemWithValue((int *)v1, 0, 0x62Cu);
}

//----- (021DB6E0) --------------------------------------------------------
int __fastcall Function_21db6e0(int a1, int a2, int a3, short a4, short a5, short a6)
{
  int v6;
  short v7;
  int v8;
  int v9;
  int v10;

  v6 = a1;
  v7 = a4;
  Function_21d6538(a1 + 4, a2, a3, a6);
  *(ushort *)v6 = v7;
  *(ushort *)(v6 + 2) = a5;
  *(uint *)(v6 + 40) = 1;
  return Function_21db500((short *)v6, v8, v9, v10);
}

//----- (021DB700) --------------------------------------------------------
int __fastcall Function_21db700(int a1)
{
  int v1;
  int result;
  int v3;
  int v4;
  int v5;
  int v6;

  v1 = a1;
  if ( *(uint *)(a1 + 40) )
  {
    v3 = Function_21d6548(a1 + 4);
    Function_21db500((short *)v1, v4, v5, v6);
    if ( v3 == 1 )
      *(uint *)(v1 + 40) = 0;
    result = v3;
  }
  else
  {
    Function_21db7cc();
    result = 1;
  }
  return result;
}

//----- (021DB72C) --------------------------------------------------------
int __fastcall Function_21db72c(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int *v7;
  int result;
  int v9;
  int v10;
  int v11;
  int v12;

  v12 = a4;
  v4 = a2;
  v5 = (ushort)REG_VCOUNT;
  v6 = 0;
  v7 = &v10;
  do
  {
    result = Function_2013b68(*(uint *)(v4 + 28));
    ++v6;
    v4 += 4;
    *v7 = result;
    ++v7;
  }
  while ( v6 < 2 );
  if ( v5 < 192 )
  {
    v9 = v5 + 1;
    if ( v9 >= 192 )
      v9 -= 192;
    result = 2;
    if ( REG_DISPSTAT & 2 )
    {
      WIN1_X1 = *(ushort *)(v11 + 2 * v9) & 0xFF | (*(ushort *)(v10 + 2 * v9) << 8) & 0xFF00;
      result = 192;
      WIN1_Y1 = 192;
    }
  }
  return result;
}

//----- (021DB78C) --------------------------------------------------------
int __fastcall Function_21db78c(int a1, int a2)
{
  int v2;
  int v3;
  int result;

  v2 = a2;
  v3 = 0;
  do
  {
    result = Function_2013b94(*(uint *)(v2 + 28));
    ++v3;
    v2 += 4;
  }
  while ( v3 < 2 );
  return result;
}

//----- (021DB7A4) --------------------------------------------------------
uint *__fastcall Function_21db7a4(int a1)
{
  return AddTaskToTaskList3((int)Function_21db7b8, a1, 0x80u);
}

//----- (021DB7B8) --------------------------------------------------------
int __fastcall Function_21db7b8(int *a1, int a2)
{
  int *v2;

  v2 = a1;
  Function_21db690(a2);
  return Call_RemoveTaskFromTaskList(v2);
}

//----- (021DB7CC) --------------------------------------------------------
uchar *__fastcall Function_21db7cc(int a1)
{
  int v1;
  int v2;
  char *v3;
  uchar *v4;
  uchar *result;

  v1 = a1;
  v2 = 0;
  do
  {
    v3 = (char *)Function_2013b68(*(uint *)(v1 + 28));
    v4 = (uchar *)Function_2013b54(*(uint *)(v1 + 28));
    result = memcpy(v4, v3, 384);
    ++v2;
    v1 += 4;
  }
  while ( v2 < 2 );
  return result;
}

//----- (021DB7F8) --------------------------------------------------------
int __fastcall Function_21db7f8(int *a1, int a2, int a3, int a4)
{
  int vars0;
  int *v5;
  short v6;

  vars0 = a4;
  v5 = a1;
  LOBYTE(vars0) = WIN_OUT;
  WIN_IN = ((uint)&WIN_OUT >> 13) | WIN_IN & 0xC0FF | 0x3F00;
  v6 = WIN_OUT & 0xFFC0 | 0x3E;
  if ( WIN_OUT & 0x20 )
    v6 = WIN_OUT & 0xFFC0 | 0x3E;
  WIN_OUT = v6;
  WIN1_X1 = 255;
  WIN1_Y1 = 192;
  REG_DISPCNT = REG_DISPCNT & 0xFFFF1FFF | ((((REG_DISPCNT & 0xE000u) >> 13) | 2) << 13);
  *(uint *)(a2 + 24) = Function_21ef418(*(uint *)(a2 + 20), Function_21db72c, a2);
  return Call_RemoveTaskFromTaskList(v5);
}

//----- (021DB888) --------------------------------------------------------
uint *__fastcall Function_5_21db888(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;
  int *v6;
  int *v7;
  int v9;

  v9 = a1;
  v3 = a2;
  v4 = a3;
  v5 = LoadOverWorldDataAdress(a1);
  v6 = (int *)malloc(4u, 288);
  v7 = v6;
  if ( !v6 )
    return (uint *)ErrorHandler();
  Call_FillMemWithValue(v6, 0, 0x120u);
  v7[1] = v5;
  v7[2] = LoadFlagAdress(*(uint *)(v5 + 12));
  v7[69] = v4;
  v7[70] = v3;
  return Function_2050944(v9, (int)Function_21db8d8, (int)v7);
}

//----- (021DB8D8) --------------------------------------------------------
int __fastcall Function_21db8d8(int a1)
{
  uint *v1;
  uint *v2;
  int v3;
  int v4;
  int v5;
  int result;

  v1 = (uint *)GetUnknownStruct01_c(a1);
  v2 = v1;
  switch ( (uchar)*v1 )
  {
    case 0u:
      if ( Function_21dbf20(v1[1]) == 1 )
        Function_21dba54(v2, 1);
      goto LABEL_27;
    case 1u:
      Function_21dba7c();
      v3 = Function_21dba58(v2);
      if ( v3 == 2 )
      {
        *(ushort *)v2[69] = 0;
        Function_21dba54(v2, 2);
      }
      else if ( v3 )
      {
        *(ushort *)v2[69] = 2;
        Function_21dba54(v2, 8);
      }
      else
      {
        *(ushort *)v2[69] = 1;
        Function_21dba54(v2, 7);
      }
      goto LABEL_27;
    case 2u:
      v1[71] = Function_21e1014(v1[1]);
      Function_2005748(0x620u);
      Function_206b0f8(v2[2], 0);
      Function_21dba54(v2, 3);
      goto LABEL_27;
    case 3u:
      if ( !Function_21dbcd4() )
        Function_21dba54(v2, 4);
      goto LABEL_27;
    case 4u:
      if ( !Function_21dbce0() )
        *(ushort *)v2[69] = 3;
      Function_21dba54(v2, 5);
      goto LABEL_27;
    case 5u:
      if ( !Function_21dbcd4() )
        Function_21dba54(v2, 6);
      goto LABEL_27;
    case 6u:
      if ( !Function_20057d4(0x620u) )
      {
        Function_21e1020(v2[71]);
        Function_21dba54(v2, 9);
      }
      goto LABEL_27;
    case 7u:
      v4 = 100 - Function_206b0e8(v1[2]);
      if ( s32_div_f(v4, 10) )
      {
        if ( s32_div_f(v4, 100) )
          v5 = 3;
        else
          v5 = 2;
      }
      else
      {
        v5 = 1;
      }
      Function_200b60c(v2[70], 0, v4, v5, 1, 1);
      Function_21dba54(v2, 9);
      goto LABEL_27;
    case 8u:
      ((void (*)(void))Function_21dba54)();
      goto LABEL_27;
    case 9u:
      free((int)v1);
      result = 1;
      break;
    default:
LABEL_27:
      result = 0;
      break;
  }
  return result;
}

//----- (021DBA54) --------------------------------------------------------
uint *__fastcall Function_21dba54(uint *result, int a2)
{
  *result = a2;
  return result;
}

//----- (021DBA58) --------------------------------------------------------
int __fastcall Function_21dba58(int a1)
{
  int v1;

  v1 = a1;
  if ( Function_206b0e8(*(uint *)(a1 + 8)) != 100 )
    return 0;
  if ( *(ushort *)(v1 + 272) )
    return 2;
  return 1;
}

//----- (021DBA7C) --------------------------------------------------------
int __fastcall Function_21dba7c(int a1)
{
  uint v1;
  uint v2;
  int v3;
  int v4;
  int v5;
  uint v6;
  int v7;
  uint *v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int result;
  int v14;
  uint v15;
  int v16;
  int v17;
  int v18;
  int v19;
  short v20;

  v14 = a1;
  v1 = Function_203a4b4(*(uint *)(a1 + 4));
  v2 = 0;
  v15 = v1;
  v20 = 0;
  if ( v1 )
  {
    v3 = v14;
    do
    {
      ++v2;
      *(uint *)(v3 + 16) = 0;
      v3 += 4;
    }
    while ( v2 < v1 );
  }
  v4 = GetSpritePositionX(*(uint *)(*(uint *)(v14 + 4) + 60));
  v5 = GetSpritePositionY(*(uint *)(*(uint *)(v14 + 4) + 60));
  v19 = v4 - 7;
  v18 = v4 + 7;
  v16 = v5 + 6;
  v17 = v5 - 7;
  if ( v4 - 7 < 0 )
    v19 = 0;
  if ( v17 < 0 )
    v17 = 0;
  v6 = 0;
  if ( v15 )
  {
    v7 = v14;
    do
    {
      v8 = GetAdressOfSpriteID(*(uint *)(*(uint *)(v14 + 4) + 56), v6);
      v9 = (int)v8;
      if ( v8 )
      {
        switch ( (uchar)GetSpriteTrainer((int)v8) )
        {
          case 1u:
          case 2u:
          case 4u:
          case 5u:
          case 6u:
          case 7u:
          case 8u:
            v10 = LoadSpritePositionX(v9);
            v11 = LoadSpritePositionY(v9);
            if ( v10 >= v19 && v10 <= v18 && v11 >= v17 && v11 <= v16 )
            {
              v12 = GetSpriteMovement(v9);
              if ( !Function_21dbb70(v12) )
              {
                *(uint *)(v7 + 16) = v9;
                v7 += 4;
                ++v20;
              }
            }
            break;
          default:
            break;
        }
      }
      ++v6;
    }
    while ( v6 < v15 );
  }
  result = v14;
  *(ushort *)(v14 + 272) = v20;
  return result;
}

//----- (021DBB70) --------------------------------------------------------
int __fastcall Function_21dbb70(char a1)
{
  int result;

  switch ( a1 )
  {
    case 51:
    case 52:
    case 53:
    case 54:
      result = 1;
      break;
    default:
      result = 0;
      break;
  }
  return result;
}

//----- (021DBB94) --------------------------------------------------------
int __fastcall Function_21dbb94(int a1)
{
  int v1;
  int v2;
  uint v3;
  uint v4;
  int v5;

  v1 = a1;
  v2 = LoadFlagAdress(*(uint *)(a1 + 12));
  v3 = Function_206b0e8(v2);
  v4 = Function_206b108(v2);
  v5 = LoadVariableAreaAdressItemList(*(uint *)(v1 + 12));
  if ( CheckItem(v5, 0x1BBu, 1u, 4u) == 1 && v3 < 0x64 )
    Function_206b0f8(v2, v3 + 1);
  if ( Function_206a9e4(v2) == 1 )
  {
    if ( v4 < 0x64 )
    {
      v4 = (v4 + 1) & 0xFFFF;
      Function_206b118(v2, v4);
    }
    if ( v4 == 100 )
    {
      Function_206b0d4(v2);
      Function_21dbc08(v1);
    }
  }
  return 0;
}

//----- (021DBC08) --------------------------------------------------------
uint *__fastcall Function_21dbc08(int a1)
{
  int v1;
  uint *result;
  uint *v3;
  uint v4;
  uint *v5;

  v1 = a1;
  result = (uint *)Function_203a4b4(a1);
  v3 = result;
  v4 = 0;
  if ( result )
  {
    do
    {
      result = GetAdressOfSpriteID(*(uint *)(v1 + 56), v4);
      v5 = result;
      if ( result )
      {
        result = (uint *)GetSpriteMovement((int)result);
        if ( result == (uint *)49 )
          result = (uint *)Function_21dbecc(v5, 2);
      }
      ++v4;
    }
    while ( v4 < (uint)v3 );
  }
  return result;
}

//----- (021DBC40) --------------------------------------------------------
int __fastcall Function_21dbc40(int a1, int a2, int a3)
{
  int v3;
  uint *v4;

  v3 = a1;
  v4 = Malloc_MovementScript(a2, a3);
  ++*(ushort *)(v3 + 274);
  return Function_21dbc64(v3, v4);
}

//----- (021DBC64) --------------------------------------------------------
uint *__fastcall Function_21dbc64(int a1, int a2)
{
  int v2;
  int v3;
  uint *v4;
  uint *result;

  v2 = a1;
  v3 = a2;
  v4 = (uint *)malloc(4u, 12);
  if ( !v4 )
    return (uint *)ErrorHandler();
  v4[2] = v2;
  v4[1] = v3;
  result = AddTaskToTaskList1((int)Function_21dbc94, (int)v4, 0);
  *v4 = result;
  return result;
}

//----- (021DBC94) --------------------------------------------------------
uint __fastcall Function_21dbc94(int a1, int a2)
{
  int v2;
  uint result;

  v2 = a2;
  result = Function_206574c(*(uint *)(a2 + 4));
  if ( result == 1 )
  {
    if ( !*(ushort *)(*(uint *)(v2 + 8) + 274) )
      ErrorHandler();
    --*(ushort *)(*(uint *)(v2 + 8) + 274);
    Function_2065758(*(uint *)(v2 + 4));
    Call_RemoveTaskFromTaskList(*(int **)v2);
    result = Function_2018238(4u, v2);
  }
  return result;
}

//----- (021DBCD4) --------------------------------------------------------
int __fastcall Function_21dbcd4(int a1)
{
  return *(ushort *)(a1 + 274);
}

//----- (021DBCE0) --------------------------------------------------------
int __fastcall Function_21dbce0(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  int v5;
  uint v6;
  int v7;
  int v8;
  int v9;
  int v11;

  v1 = a1;
  v11 = LoadFlagAdress(*(uint *)(*(uint *)(a1 + 4) + 12));
  v2 = 0;
  v3 = 0;
  if ( (int)*(ushort *)(v1 + 272) > 0 )
  {
    v4 = v1;
    do
    {
      v5 = Function_21dbd88(*(uint *)(v4 + 16));
      if ( CheckFlag550(*(uint *)(v1 + 4), v5) )
      {
        v6 = PRNG();
        s32_div_f(v6, 100);
        if ( v7 < 50 && !Function_21dbeb8(*(uint *)(v4 + 16)) )
        {
          Function_21dbecc(*(uint *)(v4 + 16), 49);
          Function_21dbc40(v1, *(uint *)(v4 + 16), (int)dword_21F8E3C);
          v8 = Function_21dbf70(*(uint *)(v1 + 4), *(uint *)(v4 + 16), 0);
          v9 = v8;
          if ( v8 )
          {
            Function_21dbecc(v8, 49);
            Function_21dbc40(v1, v9, (int)dword_21F8E3C);
          }
          v2 = 1;
          Function_206a9c4(v11);
        }
      }
      else
      {
        Function_21dbc40(v1, *(uint *)(v4 + 16), (int)dword_21F8E34);
        v2 = 1;
      }
      ++v3;
      v4 += 4;
    }
    while ( v3 < *(ushort *)(v1 + 272) );
  }
  return v2;
}

//----- (021DBD88) --------------------------------------------------------
uint __fastcall Function_21dbd88(int a1)
{
  ushort v1;

  v1 = GetSpriteScript(a1);
  return NormalizeSpriteScriptNr(v1);
}

//----- (021DBD98) --------------------------------------------------------
int __fastcall Function_5_21dbd98(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v6;
  int v7;
  int v8;

  v3 = a1;
  v4 = a3;
  if ( !Function_21dbeb8(a2) )
    return 0;
  v6 = Function_21dbddc(v3, v4);
  if ( v6 == 255 )
    return 0;
  v7 = Function_21dbdfc(v3, v6);
  v8 = Function_21dbe48(v3, v6, v7);
  return Function_21dbea4(v6, v8);
}

//----- (021DBDDC) --------------------------------------------------------
int __fastcall Function_21dbddc(int a1, int a2)
{
  short *v2;
  uint v3;

  v2 = &word_21F8E48;
  v3 = 0;
  do
  {
    if ( a2 == (ushort)*v2 )
      return (ushort)v3;
    ++v3;
    v2 += 6;
  }
  while ( v3 < 0xF0 );
  return 255;
}

//----- (021DBDFC) --------------------------------------------------------
int __fastcall Function_21dbdfc(int a1, int a2)
{
  int v2;
  int v3;
  short *v4;
  int v5;

  v2 = a1;
  v3 = 1;
  v4 = &word_21F8E48[6 * a2 + 1];
  do
  {
    v5 = (ushort)*v4;
    if ( !*v4 )
      return (v3 - 1) & 0xFFFF;
    if ( v5 != 0xFFFF && !CheckFlag550(v2, v5) )
      return (ushort)v3;
    ++v3;
    ++v4;
  }
  while ( v3 < 6 );
  return (v3 - 1) & 0xFFFF;
}

//----- (021DBE48) --------------------------------------------------------
uint __fastcall Function_21dbe48(int a1, int a2, uint a3)
{
  int v3;
  uint v4;
  int v5;

  v3 = a2;
  v4 = a3;
  v5 = LoadFlagAdress(*(uint *)(a1 + 12));
  if ( v4 && !Function_206ab00(v5, v4) )
    v4 = Function_21dbe70(v3, v4);
  return v4;
}

//----- (021DBE70) --------------------------------------------------------
int __fastcall Function_21dbe70(int a1, int a2)
{
  int v2;

  v2 = (a2 - 1) & 0xFFFF;
  if ( !v2 )
    return 0;
  while ( (ushort)word_21F8E48[6 * a1 + v2] == 0xFFFF )
  {
    v2 = (v2 - 1) & 0xFFFF;
    if ( !v2 )
      return 0;
  }
  return v2;
}

//----- (021DBEA4) --------------------------------------------------------
int __fastcall Function_21dbea4(int a1, int a2)
{
  return (ushort)word_21F8E48[6 * a1 + a2];
}

//----- (021DBEB8) --------------------------------------------------------
BOOL __fastcall Function_21dbeb8(int a1)
{
  return GetSpriteMovement(a1) == 49;
}

//----- (021DBECC) --------------------------------------------------------
int __fastcall Function_21dbecc(int a1, int a2)
{
  return SetSpriteFollowHero(a1, a2);
}

//----- (021DBED4) --------------------------------------------------------
int __fastcall Function_5_21dbed4(int result, int a2)
{
  int v2;
  int v3;
  int v4;
  ushort v5;
  int v6;

  v2 = result;
  v3 = a2;
  if ( a2 )
  {
    v4 = LoadSpriteFaceDirection(a2);
    if ( v4 )
    {
      if ( v4 == 1 )
      {
        v5 = 15;
      }
      else if ( v4 == 2 )
      {
        v5 = 16;
      }
      else
      {
        v5 = 17;
      }
    }
    else
    {
      v5 = 14;
    }
    v6 = Function_21dbf70(v2, v3, 1);
    if ( v6 )
      Function_21dbecc(v6, v5);
    result = Function_21dbecc(v3, v5);
  }
  return result;
}

//----- (021DBF20) --------------------------------------------------------
BOOL __fastcall Function_21dbf20(int a1)
{
  int v1;
  uint v2;
  uint v3;
  uint *v4;
  uint *v5;
  int v7;

  v1 = a1;
  v2 = 0;
  v3 = Function_203a4b4(a1);
  v7 = 0;
  if ( v3 )
  {
    do
    {
      v4 = GetAdressOfSpriteID(*(uint *)(v1 + 56), v2);
      v5 = v4;
      if ( v4 )
      {
        if ( CheckSpriteFlag_2(v4) == 1 )
        {
          UnsetSpriteFlag_Lock(v5);
          v7 = 1;
        }
        else
        {
          SetSpriteFlag_Lock(v5);
        }
      }
      ++v2;
    }
    while ( v2 < v3 );
  }
  return v7 == 0;
}

//----- (021DBF70) --------------------------------------------------------
int __fastcall Function_21dbf70(int a1, int a2, int a3)
{
  int v3;
  uint v4;
  int result;
  int v6;
  uint *v7;
  int v8;
  int v9;
  uint v10;
  int v11;
  int v12;
  int v13;
  uint v14;

  v3 = a2;
  v11 = a1;
  v12 = a3;
  v4 = Function_203a4b4(a1);
  v14 = (ushort)GetSpriteScript(v3);
  v13 = NormalizeSpriteScriptNr(v14);
  if ( !Function_203f28c(v13) )
    return 0;
  v6 = 0;
  if ( !v4 )
    return 0;
  while ( 1 )
  {
    v7 = GetAdressOfSpriteID(*(uint *)(v11 + 56), v6);
    v8 = (int)v7;
    if ( v7 )
    {
      if ( v12 || GetSpriteMovement((int)v7) != 49 )
        break;
    }
LABEL_11:
    if ( ++v6 >= v4 )
      return 0;
  }
  switch ( (uchar)GetSpriteTrainer(v8) )
  {
    case 1u:
    case 2u:
    case 4u:
    case 5u:
    case 6u:
    case 7u:
    case 8u:
      v9 = GetSpriteScript(v8);
      v10 = NormalizeSpriteScriptNr((ushort)v9);
      if ( v14 == v9 || v13 != v10 )
        goto LABEL_11;
      result = v8;
      break;
    default:
      goto LABEL_11;
  }
  return result;
}

//----- (021DC018) --------------------------------------------------------
ushort *__fastcall Function_21dc018(int a1, int a2, char a3, char a4, uchar a5, char a6, int a7, int a8, int a9, int a10)
{
  int v10;
  int v11;
  char v12;
  char v13;
  char v14;
  int v15;
  int v16;
  int v17;
  uint *v18;
  int v19;
  int v20;
  int v21;
  int v22;
  uint *v23;
  ushort *result;

  v10 = a2;
  v11 = a1;
  v12 = a3;
  v13 = a4;
  if ( a10 )
  {
    *(uint *)(a2 + 140) = a10;
    v14 = *(uchar *)(a2 + 151) & 0xFD;
  }
  else
  {
    *(uint *)(a2 + 140) = LoadFromMsgNARC(1, 26, 361, 4u);
    v14 = *(uchar *)(v10 + 151) | 2;
  }
  *(uchar *)(v10 + 151) = v14;
  *(uint *)(v10 + 144) = a8;
  *(uint *)v10 = v11;
  *(uint *)(v10 + 160) = a7;
  v15 = 0;
  **(ushort **)(v10 + 160) = 0;
  *(uint *)(v10 + 164) = 0;
  *(uint *)(v10 + 168) = 0;
  *(uchar *)(v10 + 151) = *(uchar *)(v10 + 151) & 0xFE | a6 & 1;
  *(uchar *)(v10 + 150) = a5;
  *(uchar *)(v10 + 151) &= 0xBFu;
  *(uchar *)(v10 + 151) &= 0x7Fu;
  *(uchar *)(v10 + 152) = v12;
  *(uchar *)(v10 + 153) = v13;
  *(uchar *)(v10 + 155) = 0;
  *(uint *)(v10 + 24) = a9;
  *(uchar *)(v10 + 148) = 3;
  *(ushort *)(v10 + 732) = a5;
  v16 = v10;
  v17 = 0;
  do
  {
    *(uint *)(v16 + 188) = 0;
    v18 = (uint *)(v16 + 192);
    ++v15;
    v16 += 8;
    *v18 = 0;
  }
  while ( v15 < 28 );
  v19 = v10;
  v20 = v10;
  v21 = 0;
  do
  {
    *(uint *)(v19 + 452) = 0;
    *(uint *)(v19 + 456) = 0;
    *(ushort *)(v20 + 676) = 255;
    ++v17;
    v19 += 8;
    v20 += 2;
  }
  while ( v17 < 28 );
  v22 = v10;
  do
  {
    *(uint *)(v22 + 28) = Function_2023790(80, 4u);
    ++v21;
    v22 += 4;
  }
  while ( v21 < 28 );
  v23 = (uint *)(v10 + 160);
  result = (ushort *)*v23;
  *(ushort *)*v23 = -4370;
  return result;
}

//----- (021DC150) --------------------------------------------------------
int __fastcall Function_5_21dc150(int a1, char a2, char a3, uchar a4, char a5, int a6, int a7, int a8, int a9)
{
  char v9;
  int v10;
  uchar v11;
  int *v12;
  int v13;
  char v15;

  v9 = a2;
  v10 = a1;
  v15 = a3;
  v11 = a4;
  v12 = (int *)malloc(4u, 736);
  v13 = (int)v12;
  if ( !v12 )
    return 0;
  Call_FillMemWithValue(v12, 0, 0x2E0u);
  Function_21dc018(v10, v13, v9, v15, v11, a5, a6, a7, a8, a9);
  return v13;
}

//----- (021DC1A4) --------------------------------------------------------
int Function_5_21dc1a4()
{
  return Function_21dc290();
}

//----- (021DC1AC) --------------------------------------------------------
uint *__fastcall Function_5_21dc1ac(int a1)
{
  int v1;
  uint v2;
  uint *result;

  v1 = a1;
  v2 = Function_21dc300();
  if ( v2 & 7 )
    LOBYTE(v2) = (v2 >> 3) + 1;
  else
    v2 >>= 3;
  if ( *(uchar *)(v1 + 151) & 0x40 )
    *(uchar *)(v1 + 152) -= v2;
  if ( *(uchar *)(v1 + 151) & 0x80 )
    *(uchar *)(v1 + 153) -= 2 * *(uchar *)(v1 + 155);
  Function_201a7e8(
    *(uint **)(*(uint *)v1 + 8),
    v1 + 8,
    3,
    *(uchar *)(v1 + 152),
    *(uchar *)(v1 + 153),
    v2,
    2 * *(uchar *)(v1 + 155),
    13,
    61);
  Function_200daa4(*(uint **)(*(uint *)v1 + 8), 3u, 985, 11, 0, 4);
  Function_200dc48(v1 + 8, 1, 985, 0xBu);
  Function_21dc33c(v1);
  *(uint *)(v1 + 184) = Function_2001b9c(v1 + 172, *(uchar *)(v1 + 150), 4u);
  result = AddTaskToTaskList1((int)Function_21dc3b0, v1, 0);
  *(uint *)(v1 + 4) = result;
  return result;
}

//----- (021DC290) --------------------------------------------------------
int __fastcall Function_21dc290(int a1, uint a2, int a3)
{
  int v3;
  uint v4;
  int v5;
  ushort *v6;
  int v7;
  int v8;
  int result;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = (ushort *)Function_2023790(80, 4u);
  Function_200b1b8_CallMsgDecrypt(*(ushort ***)(v3 + 140), v4, v6);
  Function_200c388(*(uint **)(v3 + 144), *(uint *)(v3 + 4 * *(uchar *)(v3 + 155) + 28), (int)v6);
  v7 = *(uchar *)(v3 + 155);
  v8 = *(uint *)(v3 + 4 * v7 + 28);
  *(uint *)(v3 + 8 * v7 + 188) = v8;
  Function_20237bc_FreeMsg((int)v6, v8);
  *(uint *)(v3 + 8 * *(uchar *)(v3 + 155) + 192) = v5;
  result = *(uchar *)(v3 + 155) + 1;
  *(uchar *)(v3 + 155) = result;
  return result;
}

//----- (021DC300) --------------------------------------------------------
int __fastcall Function_21dc300(int a1)
{
  int v1;
  uint v2;
  int v3;
  int v4;
  int v5;
  uint v6;

  v1 = a1;
  v2 = 0;
  v3 = 0;
  if ( (int)*(uchar *)(a1 + 155) > 0 )
  {
    v4 = a1;
    do
    {
      v5 = *(uint *)(v4 + 188);
      if ( !v5 )
        break;
      v6 = Function_2002f04(0, v5);
      if ( v2 < v6 )
        v2 = v6;
      ++v3;
      v4 += 8;
    }
    while ( v3 < *(uchar *)(v1 + 155) );
  }
  return v2 + 12;
}

//----- (021DC33C) --------------------------------------------------------
int __fastcall Function_21dc33c(int a1)
{
  uchar *v1;
  int v2;
  uint v3;
  int result;

  *(uint *)(a1 + 172) = a1 + 188;
  *(uint *)(a1 + 176) = a1 + 8;
  *(uchar *)(a1 + 180) = 0;
  *(uchar *)(a1 + 181) = 1;
  *(uchar *)(a1 + 182) = *(uchar *)(a1 + 155);
  *(uchar *)(a1 + 183) &= 0xF0u;
  v1 = (uchar *)(a1 + 183);
  *(uchar *)(a1 + 183) &= 0xCFu;
  v2 = *(uchar *)(a1 + 183);
  if ( *(uchar *)(a1 + 155) < 4u )
  {
    result = 192;
    *v1 = v2 & 0x3F;
  }
  else
  {
    v3 = v2 & 0xFFFFFF3F;
    result = v3 | 0x40;
    *v1 = v3 | 0x40;
  }
  return result;
}

//----- (021DC3B0) --------------------------------------------------------
int __fastcall Function_21dc3b0(int a1, int a2)
{
  int v2;
  int result;

  v2 = a2;
  if ( *(uchar *)(a2 + 148) )
  {
    result = *(uchar *)(a2 + 148) - 1;
    *(uchar *)(a2 + 148) = result;
  }
  else
  {
    result = Function_200f2ac();
    if ( result )
    {
      result = Function_2001be0(*(uint *)(v2 + 184));
      if ( result == -2 )
      {
        result = *(uchar *)(v2 + 151) & 1;
        if ( result == 1 )
        {
          **(ushort **)(v2 + 160) = -2;
          result = Function_5_21dc424(v2);
        }
      }
      else if ( result != -1 )
      {
        **(ushort **)(v2 + 160) = result;
        result = Function_5_21dc424(v2);
      }
    }
  }
  return result;
}

//----- (021DC424) --------------------------------------------------------
uint __fastcall Function_5_21dc424(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;

  v1 = a1;
  Function_2005748(0x5DCu);
  Function_2001bc4(*(uint *)(v1 + 184), 0);
  Function_200dc9c(*(uint *)(v1 + 176), 0);
  Function_201a8fc(*(uint *)(v1 + 176));
  v3 = 0;
  v4 = v1;
  do
  {
    Function_20237bc_FreeMsg(*(uint *)(v4 + 28), v2);
    ++v3;
    v4 += 4;
  }
  while ( v3 < 28 );
  if ( (uint)*(uchar *)(v1 + 151) << 30 >> 31 == 1 )
    Function_200b190(*(ushort **)(v1 + 140));
  Call_RemoveTaskFromTaskList(*(int **)(v1 + 4));
  return free(v1);
}

//----- (021DC48C) --------------------------------------------------------
int __fastcall Function_5_21dc48c(int a1, char a2, char a3, uchar a4, char a5, int a6, int a7, int a8, int a9)
{
  return Function_5_21dc150(a1, a2, a3, a4, a5, a6, a7, a8, a9);
}

//----- (021DC4B0) --------------------------------------------------------
int Function_5_21dc4b0()
{
  return Function_21dc708();
}

//----- (021DC4B8) --------------------------------------------------------
int __fastcall Function_5_21dc4b8(uchar *a1)
{
  uchar *v1;
  uint v2;
  int v3;
  uint v4;

  v1 = a1;
  v2 = Function_21dc7a8();
  if ( v2 & 7 )
    v3 = (v2 >> 3) + 1;
  else
    v3 = v2 >> 3;
  if ( v1[151] & 0x40 )
    v1[152] -= v3;
  if ( v1[151] & 0x80 )
  {
    v4 = (uchar)v1[155];
    if ( v4 <= 8 )
      v1[153] -= 2 * v4;
    else
      v1[153] -= 16;
  }
  return Function_21dc530(v1);
}

//----- (021DC528) --------------------------------------------------------
int __fastcall Function_5_21dc528(int a1)
{
  return Function_21dc530(a1);
}

//----- (021DC530) --------------------------------------------------------
uint *__fastcall Function_21dc530(int a1, uchar a2)
{
  int v2;
  uint v3;
  uint *result;

  v2 = a1;
  v3 = *(uchar *)(a1 + 155);
  if ( v3 <= 8 )
    Function_201a7e8(
      *(uint **)(*(uint *)a1 + 8),
      a1 + 8,
      3,
      *(uchar *)(a1 + 152),
      *(uchar *)(a1 + 153),
      a2,
      2 * v3,
      13,
      61);
  else
    Function_201a7e8(
      *(uint **)(*(uint *)a1 + 8),
      a1 + 8,
      3,
      *(uchar *)(a1 + 152),
      *(uchar *)(a1 + 153),
      a2,
      0x10u,
      13,
      61);
  Function_200daa4(*(uint **)(*(uint *)v2 + 8), 3u, 985, 11, 0, 4);
  Function_200dc48(v2 + 8, 1, 985, 0xBu);
  Function_21dc7e4(v2);
  *(uint *)(v2 + 444) = Function_200112c((uint *)(v2 + 412), 0, *(uchar *)(v2 + 150), 4u);
  Function_21dcaf4(v2);
  result = AddTaskToTaskList1((int)Function_21dc95c, v2, 0);
  *(uint *)(v2 + 4) = result;
  return result;
}

//----- (021DC600) --------------------------------------------------------
uint *__fastcall Function_5_21dc600(int a1, short *a2, short *a3)
{
  int v3;
  short *v4;
  short *v5;
  uint v6;
  uint v7;
  uint v8;
  uint *result;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = Function_21dc7a8();
  if ( v6 & 7 )
    LOBYTE(v7) = (v6 >> 3) + 1;
  else
    v7 = v6 >> 3;
  v8 = *(uchar *)(v3 + 155);
  if ( v8 <= 8 )
    Function_201a7e8(
      *(uint **)(*(uint *)v3 + 8),
      v3 + 8,
      3,
      *(uchar *)(v3 + 152),
      *(uchar *)(v3 + 153),
      v7,
      2 * v8,
      13,
      61);
  else
    Function_201a7e8(
      *(uint **)(*(uint *)v3 + 8),
      v3 + 8,
      3,
      *(uchar *)(v3 + 152),
      *(uchar *)(v3 + 153),
      v7,
      0x10u,
      13,
      61);
  Function_200daa4(*(uint **)(*(uint *)v3 + 8), 3u, 985, 11, 0, 4);
  Function_200dc48(v3 + 8, 1, 985, 0xBu);
  Function_21dc7e4(v3);
  *(uint *)(v3 + 164) = v4;
  *(uint *)(v3 + 168) = v5;
  *(ushort *)(v3 + 732) = **(ushort **)(v3 + 164) + **(ushort **)(v3 + 168);
  *(uint *)(v3 + 444) = Function_200112c((uint *)(v3 + 412), *v4, *v5, 4u);
  Function_21dcaf4(v3);
  result = AddTaskToTaskList1((int)Function_21dc95c, v3, 0);
  *(uint *)(v3 + 4) = result;
  return result;
}

//----- (021DC708) --------------------------------------------------------
int __fastcall Function_21dc708(int a1, uint a2, short a3, int a4)
{
  int v4;
  uint v5;
  short v6;
  int v7;
  ushort *v8;
  int result;

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v7 = a4;
  v8 = (ushort *)Function_2023790(80, 4u);
  Function_200b1b8_CallMsgDecrypt(*(ushort ***)(v4 + 140), v5, v8);
  Function_200c388(*(uint **)(v4 + 144), *(uint *)(v4 + 4 * *(uchar *)(v4 + 155) + 28), (int)v8);
  *(uint *)(v4 + 8 * *(uchar *)(v4 + 155) + 452) = *(uint *)(v4 + 4 * *(uchar *)(v4 + 155) + 28);
  Function_20237bc_FreeMsg((int)v8, 452);
  if ( v7 == 250 )
    *(uint *)(v4 + 8 * *(uchar *)(v4 + 155) + 456) = -3;
  else
    *(uint *)(v4 + 8 * *(uchar *)(v4 + 155) + 456) = v7;
  *(ushort *)(v4 + 2 * *(uchar *)(v4 + 155) + 676) = v6;
  result = *(uchar *)(v4 + 155) + 1;
  *(uchar *)(v4 + 155) = result;
  return result;
}

//----- (021DC7A8) --------------------------------------------------------
int __fastcall Function_21dc7a8(int a1)
{
  int v1;
  uint v2;
  int v3;
  int v4;
  int v5;
  uint v6;

  v1 = a1;
  v2 = 0;
  v3 = 0;
  if ( (int)*(uchar *)(a1 + 155) > 0 )
  {
    v4 = a1;
    do
    {
      v5 = *(uint *)(v4 + 452);
      if ( !v5 )
        break;
      v6 = Function_2002f04(0, v5);
      if ( v2 < v6 )
        v2 = v6;
      ++v3;
      v4 += 8;
    }
    while ( v3 < *(uchar *)(v1 + 155) );
  }
  return v2 + 12;
}

//----- (021DC7E4) --------------------------------------------------------
int __fastcall Function_21dc7e4(int result)
{
  *(uint *)(result + 412) = result + 452;
  *(uint *)(result + 416) = Function_21dc918;
  *(uint *)(result + 420) = Function_21dc8f4;
  *(uint *)(result + 424) = result + 8;
  *(ushort *)(result + 428) = *(uchar *)(result + 155);
  *(ushort *)(result + 430) = 8;
  *(uchar *)(result + 432) = 1;
  *(uchar *)(result + 433) = 12;
  *(uchar *)(result + 434) = 2;
  *(uchar *)(result + 435) = *(uchar *)(result + 435) & 0xF0 | 1;
  *(uchar *)(result + 435) = *(uchar *)(result + 435) & 0xF | 0x10;
  *(uchar *)(result + 436) = *(uchar *)(result + 436) & 0xF0 | 0xF;
  *(uchar *)(result + 436) = *(uchar *)(result + 436) & 0xF | 0x20;
  *(ushort *)(result + 438) &= 0xFFF8u;
  *(ushort *)(result + 438) &= 0xFF87u;
  *(ushort *)(result + 438) = *(ushort *)(result + 438) & 0xFE7F | 0x80;
  *(ushort *)(result + 438) &= 0x81FFu;
  *(ushort *)(result + 438) &= 0x7FFFu;
  *(uint *)(result + 440) = result;
  return result;
}

//----- (021DC8F4) --------------------------------------------------------
uchar *__fastcall Function_21dc8f4(uchar *a1, int a2)
{
  uchar *result;

  if ( a2 == -3 )
    result = Function_200147c(a1, 3, 15, 4);
  else
    result = Function_200147c(a1, 1, 15, 2);
  return result;
}

//----- (021DC918) --------------------------------------------------------
ushort *__fastcall Function_21dc918(int a1)
{
  int v1;
  uint v2;
  ushort *result;
  ushort *v4;
  uint *v5;
  short v6;
  short v7;

  v7 = 0;
  v6 = 0;
  v1 = a1;
  v2 = Function_2001504(a1, 0x13u);
  Function_20014dc(v1, &v7, &v6);
  result = (ushort *)(v2 + 164);
  v4 = *(ushort **)(v2 + 164);
  if ( v4 )
  {
    result = *(ushort **)(v2 + 168);
    if ( result )
    {
      v5 = (uint *)(v2 + 168);
      *v4 = v7;
      result = (ushort *)*v5;
      *(ushort *)*v5 = v6;
    }
  }
  return result;
}

//----- (021DC95C) --------------------------------------------------------
int __fastcall Function_21dc95c(int a1, int a2)
{
  int v2;
  int result;
  int v4;
  int v5;

  v2 = a2;
  if ( *(uchar *)(a2 + 148) )
  {
    result = *(uchar *)(a2 + 148) - 1;
    *(uchar *)(a2 + 148) = result;
  }
  else
  {
    result = Function_200f2ac();
    if ( result )
    {
      v4 = Function_2001288(*(uint *)(v2 + 444));
      v5 = *(ushort *)(v2 + 732);
      Function_20014d0(*(uint *)(v2 + 444), (ushort *)(v2 + 732));
      if ( v5 != *(ushort *)(v2 + 732) )
        Function_2005748(0x5DCu);
      if ( dword_21BF6C8 & 0x40 || dword_21BF6C8 & 0x80 || dword_21BF6C8 & 0x20 || dword_21BF6C8 & 0x10 )
        Function_21dcaf4(v2);
      if ( v4 == -2 )
      {
        result = *(uchar *)(v2 + 151) & 1;
        if ( result == 1 )
        {
          Function_2005748(0x5DCu);
          **(ushort **)(v2 + 160) = -2;
          result = Function_21dca28(v2);
        }
      }
      else
      {
        result = -1;
        if ( v4 != -1 )
        {
          Function_2005748(0x5DCu);
          **(ushort **)(v2 + 160) = v4;
          result = Function_21dca28(v2);
        }
      }
    }
  }
  return result;
}

//----- (021DCA28) --------------------------------------------------------
uint __fastcall Function_21dca28(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;

  v1 = a1;
  Function_2005748(0x5DCu);
  Function_2001384(*(uint *)(v1 + 444), 0, 0);
  Function_200dc9c(*(uint *)(v1 + 424), 0);
  Function_201a8fc(v1 + 8);
  v3 = 0;
  v4 = v1;
  do
  {
    Function_20237bc_FreeMsg(*(uint *)(v4 + 28), v2);
    ++v3;
    v4 += 4;
  }
  while ( v3 < 28 );
  if ( (uint)*(uchar *)(v1 + 151) << 30 >> 31 == 1 )
    Function_200b190(*(ushort **)(v1 + 140));
  Call_RemoveTaskFromTaskList(*(int **)(v1 + 4));
  return free(v1);
}

//----- (021DCA90) --------------------------------------------------------
uint __fastcall Function_21dca90(int a1, uint a2)
{
  int v2;
  uint v3;
  ushort *v4;
  int v5;
  int v6;
  int v7;

  v2 = a1;
  v3 = a2;
  v4 = (ushort *)Function_2023790(80, 4u);
  v5 = Function_2023790(80, 4u);
  Function_201ada4_ClearTextBox(*(uint *)(v2 + 24), 15);
  Function_200b1b8_CallMsgDecrypt(*(ushort ***)(v2 + 140), v3, v4);
  Function_200c388(*(uint **)(v2 + 144), v5, (int)v4);
  Function_201d738_CallInitTextInterpreter(*(uint *)(v2 + 24), 1);
  Function_20237bc_FreeMsg((int)v4, v6);
  return Function_20237bc_FreeMsg(v5, v7);
}

//----- (021DCAF4) --------------------------------------------------------
uint __fastcall Function_21dcaf4(int a1)
{
  int v1;
  uint result;
  uint v3;

  v1 = a1;
  Function_20014d0(*(uint *)(a1 + 444), (ushort *)(a1 + 450));
  result = 676;
  v3 = *(ushort *)(v1 + 2 * *(ushort *)(v1 + 450) + 676);
  if ( v3 != 255 )
    result = Function_21dca90(v1, v3);
  return result;
}

//----- (021DCB24) --------------------------------------------------------
uint *__fastcall Function_5_21dcb24(int a1, char a2, char a3, int a4, int a5)
{
  int v5;
  int v6;
  uint *result;

  v5 = Function_5_21dc150(a1, a2, a3, 0, 0, a4, a5, 0, 0);
  v6 = Function_2002df8_GetLineHeight(0, 0) & 0x1FFFFFFF;
  Function_201a7e8(
    *(uint **)(*(uint *)v5 + 8),
    v5 + 8,
    3,
    *(uchar *)(v5 + 152),
    *(uchar *)(v5 + 153),
    v6,
    4u,
    13,
    221);
  Function_200daa4(*(uint **)(*(uint *)v5 + 8), 3u, 985, 11, 0, 4);
  Function_200dc48(v5 + 8, 1, 985, 0xBu);
  Function_201ae78(v5 + 8, 15, 0, 0, 8 * v6, 0x20u);
  Function_21dcc00(v5, 15);
  Function_21dcc00(v5, 16);
  *(uint *)(v5 + 176) = v5 + 8;
  Function_201a954(v5 + 8, v5 + 176);
  result = AddTaskToTaskList1((int)Function_21dcc64, v5, 0);
  *(uint *)(v5 + 4) = result;
  return result;
}

//----- (021DCC00) --------------------------------------------------------
uint __fastcall Function_21dcc00(int a1, uint a2)
{
  uint v2;
  int v3;
  ushort *v4;
  int v5;
  int v6;
  int v7;

  v2 = a2;
  v3 = a1;
  v4 = (ushort *)Function_2023790(80, 4u);
  v5 = Function_2023790(80, 4u);
  Function_200b1b8_CallMsgDecrypt(*(ushort ***)(v3 + 140), v2, v4);
  Function_200c388(*(uint **)(v3 + 144), v5, (int)v4);
  Function_201d738_CallInitTextInterpreter(v3 + 8, 0);
  Function_20237bc_FreeMsg((int)v4, v6);
  return Function_20237bc_FreeMsg(v5, v7);
}

//----- (021DCC64) --------------------------------------------------------
uint __fastcall Function_21dcc64(int a1, int a2)
{
  int v2;
  uint result;
  int v4;
  int v5;
  int v6;

  v2 = a2;
  result = 0xFFFF;
  if ( **(ushort **)(a2 + 160) == 0xFFFF )
  {
    Function_200dc9c(*(uint *)(a2 + 176), 0);
    Function_201a8fc(*(uint *)(v2 + 176));
    v5 = 0;
    v6 = v2;
    do
    {
      Function_20237bc_FreeMsg(*(uint *)(v6 + 28), v4);
      ++v5;
      v6 += 4;
    }
    while ( v5 < 28 );
    if ( (uint)*(uchar *)(v2 + 151) << 30 >> 31 == 1 )
      Function_200b190(*(ushort **)(v2 + 140));
    Call_RemoveTaskFromTaskList(*(int **)(v2 + 4));
    result = free(v2);
  }
  return result;
}

//----- (021DCCC8) --------------------------------------------------------
int __fastcall Function_5_21dccc8(int a1)
{
  if ( a1 > 138 )
  {
    if ( a1 > 164 )
    {
      if ( a1 > 462 )
      {
        if ( a1 == 566 )
          return 5;
      }
      else
      {
        if ( a1 >= 462 )
          return 0;
        if ( a1 == 461 )
          return 1;
      }
    }
    else
    {
      if ( a1 >= 164 )
        return 0;
      if ( a1 > 139 )
      {
        if ( a1 <= 150 && a1 >= 140 )
        {
          switch ( a1 )
          {
            case 140:
              return 1;
            case 141:
              return 0;
            case 150:
              return 1;
          }
        }
      }
      else if ( a1 == 139 )
      {
        return 2;
      }
    }
  }
  else
  {
    if ( a1 >= 138 )
      return 3;
    if ( a1 > 104 )
      JUMPOUT((char *)&off_21DCCEA + 14);
    if ( a1 >= 104 )
      return 0;
    if ( a1 > 14 )
      JUMPOUT((char *)&off_21DCCEA + 8);
    if ( a1 - 11 >= 0 )
      return ((int (*)(void))((char *)&off_21DCCEA + *((short *)&off_21DCCEA + a1 - 11) + 2))();
  }
  return 1;
}

//----- (021DCD94) --------------------------------------------------------
uint *__fastcall Function_5_21dcd94(int a1, int a2)
{
  int v2;
  int v3;
  uint v4;
  uint v5;
  uint v6;
  int v7;
  int v8;
  uint *result;

  v2 = a1;
  v3 = a2;
  v4 = Function_21dc300(a1);
  if ( v4 & 7 )
    LOBYTE(v5) = (v4 >> 3) + 1;
  else
    v5 = v4 >> 3;
  v6 = *(uchar *)(v2 + 155);
  v7 = (uchar)s32_div_f(v6, v3);
  s32_div_f(v6, v3);
  if ( v8 )
    v7 = (v7 + 1) & 0xFF;
  Function_201a7e8(
    *(uint **)(*(uint *)v2 + 8),
    v2 + 8,
    3,
    *(uchar *)(v2 + 152),
    *(uchar *)(v2 + 153),
    v5 * v3,
    2 * v7,
    13,
    61);
  Function_200daa4(*(uint **)(*(uint *)v2 + 8), 3u, 985, 11, 0, 4);
  Function_200dc48(v2 + 8, 1, 985, 0xBu);
  Function_21dce64(v2, v3, v7);
  *(uint *)(v2 + 184) = Function_2001b9c(v2 + 172, *(uchar *)(v2 + 150), 4u);
  result = AddTaskToTaskList1((int)Function_21dc3b0, v2, 0);
  *(uint *)(v2 + 4) = result;
  return result;
}

//----- (021DCE64) --------------------------------------------------------
uchar *__fastcall Function_21dce64(int a1, char a2, char a3)
{
  char v3;
  uchar *result;

  *(uint *)(a1 + 172) = a1 + 188;
  *(uint *)(a1 + 176) = a1 + 8;
  *(uchar *)(a1 + 180) = 0;
  *(uchar *)(a1 + 181) = a2;
  *(uchar *)(a1 + 182) = a3;
  *(uchar *)(a1 + 183) &= 0xF0u;
  v3 = *(uchar *)(a1 + 183);
  result = (uchar *)(a1 + 183);
  *result = v3 & 0xCF;
  return result;
}

//----- (021DCEB0) --------------------------------------------------------
int __fastcall Function_5_21dceb0(int a1, char a2, char a3)
{
  int v3;
  char v4;
  char v5;
  int v6;
  ushort **v7;
  ushort *v8;
  int v9;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = Function_201a778(4u, 1);
  Function_201a7e8(*(uint **)(v3 + 8), v6, 3, v4, v5, 0xAu, 4u, 13, 1);
  Function_200daa4(*(uint **)(v3 + 8), 3u, 985, 11, 0, 4);
  Function_200dc48(v6, 1, 985, 0xBu);
  Function_201ada4_ClearTextBox(v6, 15);
  v7 = (ushort **)LoadFromMsgNARC(0, 26, 543, 4u);
  v8 = Function_200b1ec_CallMsgDecrypt(v7, 0x12u);
  Function_201d738_CallInitTextInterpreter(v6, 0);
  Function_200b190((ushort *)v7);
  Function_20237bc_FreeMsg((int)v8, v9);
  Function_5_21dcf6c(v3, v6);
  return v6;
}

//----- (021DCF58) --------------------------------------------------------
uint __fastcall Function_5_21dcf58(int a1)
{
  int v1;

  v1 = a1;
  Function_200dc9c(a1, 0);
  return Function_201a928(v1, 1);
}

//----- (021DCF6C) --------------------------------------------------------
int __fastcall Function_5_21dcf6c(int a1, int a2)
{
  int v2;
  int v3;
  ushort **v4;
  uint *v5;
  int v6;
  ushort *v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;

  v2 = a1;
  v3 = a2;
  Function_201ae78(a2, 15, 0, 16, 0x50u, 0x10u);
  v4 = (ushort **)LoadFromMsgNARC(0, 26, 543, 4u);
  v5 = Function_200b358(4u);
  v6 = Function_2023790(16, 4u);
  v7 = Function_200b1ec_CallMsgDecrypt(v4, 0x13u);
  v8 = LoadTrainerDataAdress(*(uint *)(v2 + 12));
  v9 = GetMoney(v8);
  Function_200b60c((int)v5, 0, v9, 6, 1, 1);
  Function_200c388(v5, v6, (int)v7);
  Function_2002d7c(0, v6, 0);
  Function_201d738_CallInitTextInterpreter(v3, 0);
  Function_20237bc_FreeMsg((int)v7, v10);
  Function_20237bc_FreeMsg(v6, v11);
  Function_200b3f0(v5, v12);
  Function_200b190((ushort *)v4);
  return Function_201a9a4(v3);
}

//----- (021DD020) --------------------------------------------------------
int __fastcall Function_5_21dd020(int a1, char a2, char a3)
{
  int v3;
  char v4;
  char v5;
  int v6;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = Function_201a778(4u, 1);
  Function_201a7e8(*(uint **)(v3 + 8), v6, 3, v4, v5, 0xAu, 2u, 13, 41);
  Function_200daa4(*(uint **)(v3 + 8), 3u, 985, 11, 0, 4);
  Function_200dc48(v6, 1, 985, 0xBu);
  Function_5_21dd098(v3, v6);
  return v6;
}

//----- (021DD084) --------------------------------------------------------
uint __fastcall Function_5_21dd084(int a1)
{
  int v1;

  v1 = a1;
  Function_200dc9c(a1, 0);
  return Function_201a928(v1, 1);
}

//----- (021DD098) --------------------------------------------------------
int __fastcall Function_5_21dd098(int a1, int a2)
{
  int v2;
  int v3;
  ushort **v4;
  uint *v5;
  int v6;
  ushort *v7;
  ushort *v8;
  int v9;
  int v10;
  int v11;
  int v12;

  v2 = a1;
  v3 = a2;
  Function_201ada4_ClearTextBox(a2, 15);
  v4 = (ushort **)LoadFromMsgNARC(0, 26, 361, 4u);
  v5 = Function_200b358(4u);
  v6 = Function_2023790(16, 4u);
  v7 = Function_200b1ec_CallMsgDecrypt(v4, 0xC5u);
  v8 = (ushort *)LoadPlayerDataAdress_24(*(uint *)(v2 + 12));
  v9 = CheckCoins(v8);
  Function_200b60c((int)v5, 0, v9, 5, 1, 1);
  Function_200c388(v5, v6, (int)v7);
  Function_2002d7c(0, v6, 0);
  Function_201d738_CallInitTextInterpreter(v3, 0);
  Function_20237bc_FreeMsg((int)v7, v10);
  Function_20237bc_FreeMsg(v6, v11);
  Function_200b3f0(v5, v12);
  Function_200b190((ushort *)v4);
  return Function_201a9a4(v3);
}

//----- (021DD140) --------------------------------------------------------
int __fastcall Function_5_21dd140(int a1, char a2, char a3)
{
  int v3;
  char v4;
  char v5;
  int v6;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = Function_201a778(4u, 1);
  Function_201a7e8(*(uint **)(v3 + 8), v6, 3, v4, v5, 0xAu, 2u, 13, 41);
  Function_200daa4(*(uint **)(v3 + 8), 3u, 985, 11, 0, 4);
  Function_200dc48(v6, 1, 985, 0xBu);
  Function_5_21dd1a4(v3, v6);
  return v6;
}

//----- (021DD1A4) --------------------------------------------------------
int __fastcall Function_5_21dd1a4(int a1, int a2)
{
  int v2;
  int v3;
  ushort **v4;
  uint *v5;
  int v6;
  ushort *v7;
  ushort *v8;
  int v9;
  int v10;
  int v11;
  int v12;

  v2 = a1;
  v3 = a2;
  Function_201ada4_ClearTextBox(a2, 15);
  v4 = (ushort **)LoadFromMsgNARC(0, 26, 361, 4u);
  v5 = Function_200b358(4u);
  v6 = Function_2023790(16, 4u);
  v7 = Function_200b1ec_CallMsgDecrypt(v4, 0xE6u);
  v8 = (ushort *)Function_202d750(*(uint *)(v2 + 12));
  v9 = Function_202d230(v8, 0, 0);
  Function_200b60c((int)v5, 0, v9, 5, 1, 1);
  Function_200c388(v5, v6, (int)v7);
  Function_2002d7c(0, v6, 0);
  Function_201d738_CallInitTextInterpreter(v3, 0);
  Function_20237bc_FreeMsg((int)v7, v10);
  Function_20237bc_FreeMsg(v6, v11);
  Function_200b3f0(v5, v12);
  Function_200b190((ushort *)v4);
  return Function_201a9a4(v3);
}

//----- (021DD250) --------------------------------------------------------
int __fastcall Function_21dd250(int a1, char a2, char a3, int a4, int a5, uchar a6, uchar a7, uchar a8, uchar a9)
{
  int v9;

  v9 = Function_5_21dc150(a1, a2, a3, 0, 0, a4, a5, 0, 0);
  Function_201a7e8(
    *(uint **)(*(uint *)v9 + 8),
    v9 + 8,
    3,
    *(uchar *)(v9 + 152),
    *(uchar *)(v9 + 153),
    0xAu,
    0x10u,
    13,
    61);
  Function_200daa4(*(uint **)(*(uint *)v9 + 8), 3u, 985, 11, 0, 4);
  Function_200dc48(v9 + 8, 1, 985, 0xBu);
  Function_201ae78(v9 + 8, 15, 0, 0, 0x50u, 0x80u);
  Function_21dcc00(v9, 0x111u);
  Function_200b60c(a5, 0, a6, 3, 1, 1);
  Function_21dcc00(v9, 0x115u);
  Function_21dcc00(v9, 0x112u);
  Function_200b60c(a5, 0, a7, 3, 1, 1);
  Function_21dcc00(v9, 0x115u);
  Function_21dcc00(v9, 0x113u);
  Function_200b60c(a5, 0, a8, 3, 1, 1);
  Function_21dcc00(v9, 0x115u);
  Function_21dcc00(v9, 0x114u);
  Function_200b60c(a5, 0, a9, 3, 1, 1);
  Function_21dcc00(v9, 0x115u);
  *(uint *)(v9 + 176) = v9 + 8;
  Function_201a954(v9 + 8, v9 + 176);
  return v9;
}

//----- (021DD3A8) --------------------------------------------------------
uint __fastcall Function_21dd3a8(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;

  v1 = a1;
  Function_200dc9c(*(uint *)(a1 + 176), 0);
  Function_201a8fc(*(uint *)(v1 + 176));
  v3 = 0;
  v4 = v1;
  do
  {
    Function_20237bc_FreeMsg(*(uint *)(v4 + 28), v2);
    ++v3;
    v4 += 4;
  }
  while ( v3 < 28 );
  if ( (uint)*(uchar *)(v1 + 151) << 30 >> 31 == 1 )
    Function_200b190(*(ushort **)(v1 + 140));
  return free(v1);
}

//----- (021DD3F4) --------------------------------------------------------
uchar *__fastcall Function_5_21dd3f4(int a1, uchar a2)
{
  int v2;
  uchar *result;

  v2 = (a2 << 6) & 0x7F | (uchar)(*(uchar *)(a1 + 151) & 0xBF);
  result = (uchar *)(a1 + 151);
  *result = v2;
  return result;
}

//----- (021DD410) --------------------------------------------------------
uchar *__fastcall Function_5_21dd410(int a1, uchar a2)
{
  int v2;
  uchar *result;

  v2 = (a2 << 7) & 0xFF | *(uchar *)(a1 + 151) & 0x7F;
  result = (uchar *)(a1 + 151);
  *result = v2;
  return result;
}

//----- (021DD42C) --------------------------------------------------------
int __fastcall Function_5_21dd42c(uchar *a1, int a2)
{
  uchar *v2;
  int result;

  v2 = a1;
  *a1 = Function_21dd574(a2);
  v2[1] = 0;
  result = 1;
  v2[2] = 1;
  return result;
}

//----- (021DD444) --------------------------------------------------------
int __fastcall Function_5_21dd444_InitMsgData(int a1, int a2, int a3, int a4, uchar *a5)
{
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v12;
  char v13;
  int v14;

  v14 = a4;
  v5 = a1;
  v12 = a4;
  v6 = a2;
  v7 = a3;
  Function_5_21dd444_LoadSomeMsgData(*(uint *)(a1 + 128), &v13);
  Function_21dd610(*(uint *)(v5 + 128), &v13);
  Function_21dd648_CallMsgDecrypt(&v13, v6, v7);
  if ( a5 )
  {
    v8 = *a5;
    v9 = a5[1];
    v10 = a5[2];
  }
  else
  {
    v8 = Function_21dd574(v5);
    v9 = 0;
    v10 = 1;
  }
  return Function_21dd6b4(&v13, v10, v8, v12, v9);
}

//----- (021DD498) --------------------------------------------------------
int __fastcall Function_5_21dd498(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;
  char v7;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  Function_5_21dd444_LoadSomeMsgData(*(uint *)(a1 + 128), &v7);
  Function_21dd610(*(uint *)(v3 + 128), &v7);
  Function_21dd648_CallMsgDecrypt(&v7, v4, v5);
  return Function_21dd6dc(&v7, 1);
}

//----- (021DD4CC) --------------------------------------------------------
int __fastcall Function_5_21dd4cc(int a1, int a2, int a3, int a4, ushort a5, uchar a6)
{
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  char v12;

  v6 = a1;
  v7 = a2;
  v8 = a3;
  v9 = a4;
  Function_5_21dd444_LoadSomeMsgData(*(uint *)(a1 + 128), &v12);
  Function_21dd610(*(uint *)(v6 + 128), &v12);
  Function_21dd664(&v12, v7, v8, v9, a5);
  if ( a6 == 255 )
    return Function_21dd6dc(&v12, 1);
  v10 = Function_21dd574(v6);
  return Function_21dd6b4(&v12, 1, v10, a6, 0);
}

//----- (021DD530) --------------------------------------------------------
int __fastcall Function_5_21dd530(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  char v9;
  int v10;

  v10 = a4;
  v4 = a1;
  v5 = a3;
  v6 = a4;
  Function_21dd5d0(*(uint *)(a1 + 128), a2, &v9);
  Function_21dd610(*(uint *)(v4 + 128), &v9);
  Function_21dd648_CallMsgDecrypt(&v9, *(uint *)(v4 + 120), v5);
  v7 = Function_21dd574(v4);
  return Function_21dd6b4(&v9, 1, v7, v6, 0);
}

//----- (021DD574) --------------------------------------------------------
int __fastcall Function_21dd574(int a1)
{
  ushort *v1;

  v1 = (ushort *)LoadPlayerDataAdress(*(uint *)(*(uint *)(a1 + 128) + 12));
  return Function_2027ac0(v1);
}

//----- (021DD588) --------------------------------------------------------
int __fastcall Function_5_21dd444_LoadSomeMsgData(int a1, uint *a2)
{
  uint *v2;
  int v3;
  int result;

  v2 = a2;
  v3 = a1;
  *a2 = *(uint *)ScriptHandler_GetSomeScriptAddresses(a1, 0x10u);
  v2[1] = *(uint *)ScriptHandler_GetSomeScriptAddresses(v3, 0x11u);
  v2[2] = *(uint *)ScriptHandler_GetSomeScriptAddresses(v3, 0xFu);
  v2[3] = ScriptHandler_GetSomeScriptAddresses(v3, 1u);
  v2[4] = ScriptHandler_GetSomeScriptAddresses(v3, 6u);
  result = ScriptHandler_GetSomeScriptAddresses(v3, 3u);
  v2[5] = result;
  return result;
}

//----- (021DD5D0) --------------------------------------------------------
int __fastcall Function_21dd5d0(int a1, int a2, uint *a3)
{
  int v3;
  int v4;
  uint *v5;
  int result;

  v3 = a2;
  v4 = a1;
  v5 = a3;
  *a3 = *(uint *)ScriptHandler_GetSomeScriptAddresses(a1, 0x10u);
  v5[1] = *(uint *)ScriptHandler_GetSomeScriptAddresses(v4, 0x11u);
  v5[2] = v3;
  v5[3] = ScriptHandler_GetSomeScriptAddresses(v4, 1u);
  v5[4] = ScriptHandler_GetSomeScriptAddresses(v4, 6u);
  result = ScriptHandler_GetSomeScriptAddresses(v4, 3u);
  v5[5] = result;
  return result;
}

//----- (021DD610) --------------------------------------------------------
int __fastcall Function_21dd610(int a1, int a2)
{
  int v2;
  int v3;
  ushort *v4;

  v2 = a2;
  v3 = a1;
  if ( !**(uchar **)(a2 + 16) )
  {
    Function_205d8f4(*(uint **)(a1 + 8), *(uint *)(a2 + 12), 3);
    v4 = (ushort *)LoadPlayerDataAdress(*(uint *)(v3 + 12));
    Function_205d944(*(uint *)(v2 + 12), v4);
    **(uchar **)(v2 + 16) = 1;
  }
  return Function_201ada4_ClearTextBox(*(uint *)(v2 + 12), 15);
}

//----- (021DD648) --------------------------------------------------------
int __fastcall Function_21dd648_CallMsgDecrypt(int a1, ushort **a2, uint a3)
{
  int v3;

  v3 = a1;
  Function_200b1b8_CallMsgDecrypt(a2, a3, *(ushort **)(a1 + 4));
  return Function_200c388(*(uint **)(v3 + 8), *(uint *)v3, *(uint *)(v3 + 4));
}

//----- (021DD664) --------------------------------------------------------
uint __fastcall Function_21dd664(ushort **a1, uint a2, short a3, int a4, short a5)
{
  ushort **v5;
  uint v6;
  short v7;
  short v8;
  ushort *v9;
  int v10;
  ushort v12[4];
  int v13;

  v13 = a4;
  v5 = a1;
  v6 = a2;
  v7 = a3;
  v8 = a4;
  Function_2014a84(v12);
  Function_2014ce0((uint)v12, v6, v7);
  Function_2014cf8((int)v12, 0, v8);
  Function_2014cf8((int)v12, 1u, a5);
  v9 = Function_2014b34(v12, 0x20u);
  Function_2023810(*v5, (int)v9);
  return Function_20237bc_FreeMsg((int)v9, v10);
}

//----- (021DD6B4) --------------------------------------------------------
int __fastcall Function_21dd6b4(int *a1, int a2, int a3, char a4, int a5)
{
  int *v5;
  int result;

  v5 = a1;
  result = Function_205d9cc(a1[3], *a1, a2, a3, a4, a5);
  *(uchar *)v5[5] = result;
  return result;
}

//----- (021DD6DC) --------------------------------------------------------
int __fastcall Function_21dd6dc(uint *a1, int a2)
{
  uint *v2;
  int v3;
  int result;

  v2 = a1;
  v3 = *a1;
  result = Function_201d738_CallInitTextInterpreter(a1[3], a2);
  *(uchar *)v2[5] = result;
  return result;
}

//----- (021DD6FC) --------------------------------------------------------
uint __fastcall Function_21dd6fc(int a1, int a2, int a3)
{
  uint v3;
  int v4;
  int v5;

  v3 = 32 * a2;
  v4 = a1;
  v5 = a3;
  DC_FlushRange(a1, 32 * a2);
  return GX_LoadBGPltt(v4, 32 * v5, v3);
}

//----- (021DD718) --------------------------------------------------------
int __fastcall Function_21dd718(int a1)
{
  return Function_201a7e8(*(uint **)(a1 + 28), a1 + 32, 3, 0, 0, 0x20u, 5u, 7, 407);
}

//----- (021DD744) --------------------------------------------------------
uint __fastcall Function_21dd744(int a1, uint a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  uint v8;
  int v9;
  int v11;

  v4 = a1;
  v5 = a4;
  v6 = a3;
  v7 = 2 * *(uchar *)(a1 + 49) & 0xFF;
  v8 = a2;
  *(uint *)(a1 + 56) = Function_2006f50(160, v7, 0, (uint *)(a1 + 52), 4);
  Function_201958c(
    *(uint **)(v4 + 28),
    v8,
    *(int **)(*(uint *)(v4 + 52) + 20),
    *(uint *)(*(uint *)(v4 + 52) + 16),
    v6);
  v9 = Function_2006f88(160, v7 + 1, &v11, 4);
  Function_21dd6fc(*(uint *)(v11 + 12), 1, v5);
  return free(v9);
}

//----- (021DD7A0) --------------------------------------------------------
uint __fastcall Function_21dd7a0(int a1, int a2)
{
  int v2;
  int v3;
  uint v4;
  int v5;
  int v6;
  ushort v7;
  short v8;
  short v9;
  short v10;
  int v11;

  v2 = a1;
  v3 = (8 * ((a2 + 8) / 8) - a2) / 2;
  if ( v3 + 4 < 8 )
    v4 = (2 * (4 - (8 * ((a2 + 8) / 8) - a2) / 2)
        + 7
        + ((uint)((2 * (4 - (8 * ((a2 + 8) / 8) - a2) / 2) + 7) >> 2) >> 29)) << 21 >> 24;
  else
    v4 = 0;
  if ( a2 > 0 )
    v5 = (int)(8 * ((a2 + 8) / 8 + v4) + 8 - a2) / 2;
  else
    LOBYTE(v5) = 0;
  *(uchar *)(v2 + 48) = v5 + 4;
  Function_21dd744(v2, 3u, 729, 7);
  Function_201ada4_ClearTextBox(v2 + 32, 0);
  v6 = 0;
  v7 = 0;
  do
  {
    s32_div_f(v6, 17);
    v9 = v8;
    v10 = s32_div_f(v6, 17);
    Function_201addc(v2 + 32, *(uint *)(*(uint *)(v2 + 52) + 20), v7, 0, 8, 8, 8 * v9, 8 * v10, 8u, 8u);
    ++v6;
    v7 += 8;
  }
  while ( v6 < 85 );
  Function_201a954(v2 + 32, v11);
  return free(*(uint *)(v2 + 56));
}

//----- (021DD880) --------------------------------------------------------
int __fastcall Function_21dd880(int result)
{
  *(uint *)result = 0;
  *(uchar *)(result + 4) = 0;
  *(uint *)(result + 8) = 0;
  *(uint *)(result + 12) = 0;
  *(ushort *)(result + 16) = 0;
  *(uint *)(result + 20) = 0;
  *(uint *)(result + 24) = 0;
  *(uint *)(result + 28) = 0;
  return result;
}

//----- (021DD894) --------------------------------------------------------
int __fastcall Function_21dd894(int a1, int a2)
{
  int v2;
  int v3;
  int result;

  v2 = a1;
  v3 = a2;
  result = Function_21dd880(a1);
  *(uint *)(v2 + 28) = v3;
  return result;
}

//----- (021DD8A4) --------------------------------------------------------
uint __fastcall Function_21dd8a4(int a1, int a2)
{
  int v2;
  uint result;
  int v4;
  int v5;
  int v6;

  v2 = a2;
  result = *(uchar *)(a2 + 4);
  switch ( (uchar)result )
  {
    case 1:
      v4 = *(uint *)(a2 + 12) - 4;
      *(uint *)(a2 + 12) = v4;
      if ( v4 < 0 )
        *(uint *)(a2 + 12) = 0;
      Function_2019184(*(uint *)(a2 + 28), 3u, 3u, *(uint *)(a2 + 12));
      result = *(uint *)(v2 + 12);
      if ( !result )
      {
        *(ushort *)(v2 + 16) = 0;
        result = 3;
        *(uchar *)(v2 + 4) = 3;
      }
      break;
    case 2:
      v5 = *(uint *)(a2 + 12) + 4;
      *(uint *)(a2 + 12) = v5;
      if ( v5 > 38 )
        *(uint *)(a2 + 12) = 38;
      Function_2019184(*(uint *)(a2 + 28), 3u, 3u, *(uint *)(a2 + 12));
      result = *(uint *)(v2 + 12);
      if ( result == 38 )
      {
        if ( *(uint *)(v2 + 20) )
        {
          *(uint *)(v2 + 20) = 0;
          v6 = Function_2071cfc(*(ushort ***)(v2 + 60), *(uint *)(v2 + 24), *(ushort **)(v2 + 64));
          Function_21dd7a0(v2, v6);
          Function_21dd954(v2, *(uint *)(v2 + 64));
          result = 1;
          *(uchar *)(v2 + 4) = 1;
        }
        else
        {
          result = Function_5_21dda78(v2);
        }
      }
      break;
    case 3:
      result = (ushort)++*(ushort *)(a2 + 16);
      if ( result >= 0x3C )
      {
        *(ushort *)(a2 + 16) = 0;
        result = 2;
        *(uchar *)(a2 + 4) = 2;
      }
      break;
    default:
      return result;
  }
  return result;
}

//----- (021DD954) --------------------------------------------------------
int __fastcall Function_21dd954(int a1)
{
  int v1;

  v1 = *(uchar *)(a1 + 48);
  return Function_201d78c(a1 + 32, 0);
}

//----- (021DD980) --------------------------------------------------------
int __fastcall Function_21dd980(int result)
{
  *(uchar *)(result + 4) = 2;
  *(ushort *)(result + 16) = 0;
  return result;
}

//----- (021DD98C) --------------------------------------------------------
int __fastcall Function_21dd98c(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  v2 = malloc(4u, 68);
  *(uint *)(v2 + 64) = Function_2023790(22, 4u);
  Function_21dd894(v2, v1);
  Function_21dd718(v2);
  *(uint *)(v2 + 60) = LoadFromMsgNARC(1, 26, 433, 4u);
  return v2;
}

//----- (021DD9C8) --------------------------------------------------------
uint __fastcall Function_21dd9c8(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  Function_200b190(*(ushort **)(a1 + 60));
  Function_201a8fc(v1 + 32);
  Function_20237bc_FreeMsg(*(uint *)(v1 + 64), v2);
  return free(v1);
}

//----- (021DD9E8) --------------------------------------------------------
int __fastcall Function_21dd9e8(int a1, int a2, char a3)
{
  int v3;
  char v4;
  int v5;
  int v6;
  int result;

  v3 = a1;
  *(uint *)(a1 + 24) = a2;
  v4 = a3;
  if ( *(uint *)a1 )
  {
    switch ( *(uchar *)(a1 + 4) )
    {
      case 1:
      case 3:
        Function_21dd980(a1);
        result = 1;
        *(uint *)(v3 + 20) = 1;
        *(uchar *)(v3 + 49) = v4;
        break;
      case 2:
        result = 1;
        *(uint *)(v3 + 20) = 1;
        *(uchar *)(v3 + 49) = a3;
        break;
      default:
        result = ErrorHandler();
        break;
    }
  }
  else
  {
    *(uint *)a1 = 1;
    Function_2019184(*(uint *)(a1 + 28), 3u, 3u, 38);
    *(uint *)(v3 + 12) = 38;
    *(uint *)(v3 + 8) = AddTaskToTaskList1((int)Function_21dd8a4, v3, 0);
    *(uchar *)(v3 + 4) = 1;
    v5 = Function_2071cfc(*(ushort ***)(v3 + 60), *(uint *)(v3 + 24), *(ushort **)(v3 + 64));
    *(uchar *)(v3 + 49) = v4;
    Function_21dd7a0(v3, v5);
    v6 = *(uint *)(v3 + 64);
    result = Function_21dd954(v3);
  }
  return result;
}

//----- (021DDA78) --------------------------------------------------------
int __fastcall Function_5_21dda78(int a1)
{
  int v1;
  int *v2;

  v1 = a1;
  v2 = *(int **)(a1 + 8);
  if ( v2 )
    Call_RemoveTaskFromTaskList(v2);
  Function_201acf4(v1 + 32);
  Function_2019184(*(uint *)(v1 + 28), 3u, 3u, 0);
  return Function_21dd894(v1, *(uint *)(v1 + 28));
}

//----- (021DDAA4) --------------------------------------------------------
int __fastcall Function_5_21ddaa4(int a1)
{
  int v1;
  int result;
  int v3;
  int v4;
  char v5;

  v1 = a1;
  result = GetMapNameFrame(**(uint **)(a1 + 28));
  if ( result )
  {
    result = Function_203a288(**(uint **)(v1 + 28));
    if ( !result )
    {
      v3 = GetMapName(**(uint **)(v1 + 28));
      v4 = GetMapNameFrame(**(uint **)(v1 + 28));
      v5 = v4;
      if ( v4 )
        v5 = v4 - 1;
      result = Function_21dd9e8(*(uint *)(*(uint *)(v1 + 4) + 8), v3, v5);
    }
  }
  return result;
}

//----- (021DDAE4) --------------------------------------------------------
int __fastcall Function_21ddae4(int a1)
{
  int v1;
  uint *v2;
  uint *v3;
  uchar *v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int result;

  v1 = a1;
  v2 = (uint *)LoadOverWorldDataAdress(a1);
  v3 = (uint *)GetUnknownStruct01_c(v1);
  switch ( (uchar)*v3 )
  {
    case 0u:
      Function_200aae0(2, -16, 0, 63, 2);
      ++*v3;
      goto LABEL_10;
    case 1u:
      if ( Function_200ac1c(2) )
      {
        ((void (__fastcall *)(uint))byte_2253DA4)(v2[2]);
        ++*v3;
      }
      goto LABEL_10;
    case 2u:
      if ( ((int (__fastcall *)(uint))dword_2253DB4[0])(v2[2]) )
      {
        v4 = (uchar *)LoadVariableAreaAdress_5(v2[3]);
        UnloadOverlay(24, v5, v6, v7);
        LoadOverlay(25, 2, v8, v9);
        Function_20567d0(v4);
        v10 = Function_200a914(1);
        ((void (__fastcall *)(uint *, int, uint, uint, int))dword_2253CE8[0])(v2, v2[1] + 20, v2[3], v2[2], v10);
        ++*v3;
      }
      goto LABEL_10;
    case 3u:
      Function_200aae0(4, 0, -16, 63, 2);
      ++*v3;
      goto LABEL_10;
    case 4u:
      if ( !Function_200ac1c(2) )
        goto LABEL_10;
      free((int)v3);
      result = 1;
      break;
    default:
LABEL_10:
      result = 0;
      break;
  }
  return result;
}

//----- (021DDBC8) --------------------------------------------------------
uint *__fastcall Function_5_21ddbc8(int a1)
{
  int v1;
  uint *v2;

  v1 = a1;
  v2 = (uint *)malloc2(0xBu, 4);
  *v2 = 0;
  return Function_2050944(v1, (int)Function_21ddae4, (int)v2);
}

//----- (021DDBE8) --------------------------------------------------------
int __fastcall LoadFieldEncountereffect(int a1, int a2, int a3)
{
  int v3;
  int v4;
  uint *v5;
  uint *v6;
  int v7;
  int v8;
  uint *v9;
  int result;

  v3 = a2;
  v4 = a3;
  v5 = Function_200679c((int)*(&off_21F9A74 + a1), 36, 5u, 4u);
  v6 = (uint *)Function_201ced0((int)v5);
  v6[4] = v3;
  v6[5] = v4;
  v6[8] = LoadFromNARC_8(112, 4u, v7, v8);
  v9 = (uint *)v6[5];
  if ( v9 )
    *v9 = 0;
  result = 0;
  v6[6] = 0;
  return result;
}

//----- (021DDC28) --------------------------------------------------------
int __fastcall Function_21ddc28(int a1, int a2)
{
  int v2;
  int v3;

  v2 = a1;
  v3 = a2;
  Call_FS_CloseFile(*(int **)(a1 + 32));
  Function_2018238(4u, *(uint *)(v2 + 12));
  return Function_20067d0(v3);
}

//----- (021DDC44) --------------------------------------------------------
int __fastcall Function_21ddc44(int a1, int a2, int a3, uint *a4, int a5)
{
  int v5;
  int v6;
  uint *v7;
  int *v8;
  int result;
  int v10;

  v5 = a1;
  v6 = a2;
  v10 = a3;
  v7 = a4;
  v8 = (int *)malloc(4u, 76);
  Call_FillMemWithValue(v8, 0, 0x4Cu);
  AddTaskToTaskList1((int)Function_21ddc88, (int)v8, 5u);
  v8[18] = (int)v7;
  if ( v7 )
    *v7 = 0;
  v8[3] = v5;
  v8[4] = v6;
  v8[5] = v10;
  result = a5;
  v8[1] = a5;
  return result;
}

//----- (021DDC88) --------------------------------------------------------
uint __fastcall Function_21ddc88(int *a1, uint *a2)
{
  uint *v2;
  int v3;
  int v4;
  uint *v5;
  uint result;

  v2 = a2;
  switch ( (uchar)*a2 )
  {
    case 0u:
      v3 = a2[3];
      if ( v3 == 1 )
      {
        Function_21ddefc(a2 + 12, 0, a2[5], 2, 8);
      }
      else if ( v3 == 2 )
      {
        Function_21ddefc(a2 + 12, 0, a2[5], 1, 8);
      }
      ++*v2;
      goto LABEL_18;
    case 1u:
      Function_21ddefc(a2 + 6, 0, a2[4], a2[3], 3);
      ++*v2;
      goto LABEL_18;
    case 2u:
      if ( Function_21ddf08(a2 + 6) )
        ++*v2;
      goto LABEL_18;
    case 3u:
      Function_21ddefc(a2 + 6, a2[4], 0, a2[3], 3);
      ++*v2;
      goto LABEL_18;
    case 4u:
      if ( Function_21ddf08(a2 + 6) )
      {
        v4 = v2[2] + 1;
        v2[2] = v4;
        if ( v4 == v2[1] )
          *v2 = 5;
        else
          *v2 = 1;
      }
      goto LABEL_18;
    case 5u:
      *a2 = 0;
      a2[2] = 0;
      v5 = (uint *)a2[18];
      if ( v5 )
        *v5 = 1;
      Call_RemoveTaskFromTaskList(a1);
      result = free((int)v2);
      break;
    default:
LABEL_18:
      result = Function_21ddf08(v2 + 12);
      break;
  }
  return result;
}

//----- (021DDD7C) --------------------------------------------------------
int __fastcall Function_21ddd7c(int a1)
{
  return *(uint *)(a1 + 24);
}

//----- (021DDD80) --------------------------------------------------------
uint *__fastcall Function_21ddd80(uint *result, int a2, int a3, int a4)
{
  *result = a2;
  result[1] = a2;
  result[2] = a3 - a2;
  result[4] = a4;
  result[3] = 0;
  return result;
}

//----- (021DDD90) --------------------------------------------------------
int __fastcall Function_21ddd90(uint *a1)
{
  uint *v1;
  int v2;
  int v3;
  int result;

  v1 = a1;
  *v1 = s32_div_f(a1[3] * a1[2], a1[4]) + v1[1];
  v2 = v1[4];
  v3 = v1[3] + 1;
  if ( v3 > v2 )
  {
    v1[3] = v2;
    result = 1;
  }
  else
  {
    v1[3] = v3;
    result = 0;
  }
  return result;
}

//----- (021DDDBC) --------------------------------------------------------
uint *__fastcall Function_21dddbc(uint *result, int a2, int a3, int a4)
{
  *result = a2;
  result[1] = a2;
  result[2] = a3 - a2;
  result[4] = a4;
  result[3] = 0;
  return result;
}

//----- (021DDDCC) --------------------------------------------------------
int __fastcall Function_21dddcc(uint *a1)
{
  uint *v1;
  long long v2;
  int v3;
  int v4;
  int result;

  v1 = a1;
  v2 = ll_mul((int)a1[2], (int)(a1[3] << 12));
  *v1 = FX_Div((v2 + 2048) >> 12, v1[4] << 12) + v1[1];
  v3 = v1[4];
  v4 = v1[3] + 1;
  if ( v4 > v3 )
  {
    v1[3] = v3;
    result = 1;
  }
  else
  {
    v1[3] = v4;
    result = 0;
  }
  return result;
}

//----- (021DDE14) --------------------------------------------------------
int __fastcall Function_21dde14(uint *a1, int a2, int a3, int a4, int a5)
{
  uint *v5;
  int v6;
  long long v7;
  int v8;
  int v9;
  long long v10;
  int v11;
  int result;

  v5 = a1;
  v6 = a3;
  LODWORD(v7) = a4;
  v8 = a2;
  v9 = a4;
  HIDWORD(v7) = a4 >> 31;
  v10 = ll_mul(v7, a5 << 12);
  v11 = FX_Div(
          (((ll)(int)(v6 - v8 - (ull)((v10 + 2048) >> 12)) << 13) + 2048) >> 12,
          a5 * a5 << 12);
  *v5 = v8;
  v5[1] = v8;
  v5[2] = v9;
  v5[3] = v11;
  result = 0;
  v5[4] = 0;
  v5[5] = a5;
  return result;
}

//----- (021DDE74) --------------------------------------------------------
int __fastcall Function_21dde74(uint *a1)
{
  uint *v1;
  int v2;
  int v3;
  long long v4;
  int v5;
  int v6;
  int result;

  v1 = a1;
  v2 = a1[4];
  v3 = (ll_mul((int)a1[2], v2 << 12) + 2048) >> 12;
  v4 = ll_mul((int)v1[3], v2 * v2 << 12);
  *v1 = v1[1] + v3 + FX_Div((v4 + 2048) >> 12, 0x2000);
  v5 = v1[5];
  v6 = v1[4] + 1;
  if ( v6 > v5 )
  {
    v1[4] = v5;
    result = 1;
  }
  else
  {
    v1[4] = v6;
    result = 0;
  }
  return result;
}

//----- (021DDEDC) --------------------------------------------------------
ushort *__fastcall Function_21ddedc(int a1, int a2)
{
  ushort *result;

  if ( a1 == 1 )
    result = GXx_SetMasterBrightness_(&REG_MASTER_BRIGHT, a2);
  else
    result = GXx_SetMasterBrightness_(&REG_MASTER_BRIGHT_SUB, a2);
  return result;
}

//----- (021DDEFC) --------------------------------------------------------
uint *__fastcall Function_21ddefc(uint *a1, int a2, int a3, int a4, int a5)
{
  a1[5] = a4;
  return Function_21ddd80(a1, a2, a3, a5);
}

//----- (021DDF08) --------------------------------------------------------
int __fastcall Function_21ddf08(uint *a1)
{
  int v1;
  int v2;

  v1 = (int)a1;
  v2 = Function_21ddd90(a1);
  AddTaskToTaskList3((int)Function_21ddf24, v1, 0xAu);
  return v2;
}

//----- (021DDF24) --------------------------------------------------------
int __fastcall Function_21ddf24(int *a1, int *a2)
{
  int *v2;

  v2 = a1;
  Function_21ddedc(a2[5], *a2);
  return Call_RemoveTaskFromTaskList(v2);
}

//----- (021DDF38) --------------------------------------------------------
int *Function_21ddf38()
{
  int *v0;

  v0 = (int *)malloc(4u, 48);
  Call_FillMemWithValue(v0, 0, 0x30u);
  WIN_IN = WIN_IN & 0xFFC0 | 0x3F;
  WIN_IN &= 0xC0FFu;
  return v0;
}

//----- (021DDF74) --------------------------------------------------------
uint __fastcall Function_21ddf74(int a1)
{
  int v1;

  v1 = a1;
  if ( *(uint *)(a1 + 36) )
    Function_21de0f0();
  REG_DISPCNT &= 0xFFFF1FFF;
  return free(v1);
}

//----- (021DDF9C) --------------------------------------------------------
uint *__fastcall Function_21ddf9c(int a1, uint *a2, int a3, int a4, int a5, int a6, int a7)
{
  uint *v7;
  int v8;
  int v9;
  int v11;

  v7 = a2;
  v8 = a1;
  v9 = a3;
  v11 = a4;
  if ( a2[9] )
    ErrorHandler();
  *(uint *)(v8 + 24) = 0;
  v7[8] = *(uint *)(*(uint *)(*(uint *)(v8 + 16) + 4) + 28);
  v7[6] = v9;
  v7[7] = 0;
  v7[11] = v8 + 24;
  Function_21dde14(v7, a5, a6, a7, v11);
  if ( a5 < 0 )
  {
    WIN0_X1 = (a5 + 255) & 0xFF;
    WIN0_Y1 = 192;
    WIN1_X1 = (1 - a5) & 0xFF;
  }
  else
  {
    WIN0_X1 = 255 - a5;
    WIN0_Y1 = 192;
    WIN1_X1 = (a5 + 1) & 0xFF;
  }
  WIN1_Y1 = 192;
  return AddTaskToTaskList3((int)Function_21de028, (int)v7, 0x400u);
}

//----- (021DE028) --------------------------------------------------------
int __fastcall Function_21de028(int *a1, int a2)
{
  int *v2;
  int v3;

  v2 = a1;
  v3 = a2;
  *(uint *)(a2 + 40) = AddTaskToTaskList3((int)Function_21de088, a2, 0x400u);
  *(uint *)(v3 + 36) = Function_21ef418(*(uint *)(v3 + 32), Function_21de14c, v3);
  return Call_RemoveTaskFromTaskList(v2);
}

//----- (021DE058) --------------------------------------------------------
int __fastcall Function_21de058(int a1, uint *a2, int a3, int a4, int a5, int a6, int a7)
{
  uint *v7;
  int v8;
  int v9;

  v7 = a2;
  v8 = a3;
  v9 = a4;
  if ( Function_21ddd7c(a1) )
    ErrorHandler();
  v7[6] = v8;
  v7[7] = 0;
  return Function_21dde14(v7, a5, a6, a7, v9);
}

//----- (021DE088) --------------------------------------------------------
int __fastcall Function_21de088(int a1, uint *a2)
{
  uint *v2;
  int result;
  int v4;

  v2 = a2;
  result = a2[7];
  if ( result )
  {
    if ( result == 1 )
      result = Function_21de0f0(a2);
  }
  else
  {
    if ( Function_21dde74(a2) )
      ++v2[7];
    v4 = *v2 >> 12;
    if ( v4 < 0 )
    {
      WIN0_X1 = (v4 + 255) & 0xFF;
      WIN0_Y1 = 192;
      result = (1 - v4) & 0xFF;
    }
    else
    {
      WIN0_X1 = 255 - v4;
      WIN0_Y1 = 192;
      result = (v4 + 1) & 0xFF;
    }
    WIN1_X1 = result;
    WIN1_Y1 = 192;
  }
  return result;
}

//----- (021DE0F0) --------------------------------------------------------
int __fastcall Function_21de0f0(int a1)
{
  int v1;
  int result;

  v1 = a1;
  WIN_IN = WIN_IN & 0xFFC0 | 0x3F;
  WIN_OUT &= 0xFFC0u;
  WIN0_X1 = 0;
  WIN0_Y1 = 0;
  REG_DISPCNT = REG_DISPCNT & 0xFFFF1FFF | 0x2000;
  **(uint **)(a1 + 44) = 1;
  Function_21ef43c(*(uint *)(a1 + 36));
  *(uint *)(v1 + 36) = 0;
  Call_RemoveTaskFromTaskList(*(int **)(v1 + 40));
  result = 0;
  *(uint *)(v1 + 40) = 0;
  return result;
}

//----- (021DE14C) --------------------------------------------------------
short *__fastcall Function_21de14c(int a1, int *a2)
{
  int *v2;
  bool v3;
  int v4;
  short *result;

  v2 = a2;
  v3 = (u32_div_f((ushort)REG_VCOUNT, a2[6]) & 1) == 0;
  v4 = *v2;
  if ( !v3 )
    v4 = -v4;
  REG_BG0HOFS = (v4 >> 12) & 0x1FF;
  REG_BG1HOFS = (v4 >> 12) & 0x1FF;
  REG_BG2HOFS = (v4 >> 12) & 0x1FF;
  REG_BG3HOFS = (v4 >> 12) & 0x1FF;
  if ( v4 >> 12 < 0 )
  {
    REG_DISPCNT = ((uint)&REG_BG0HOFS << 10) | REG_DISPCNT & 0xFFFF1FFF;
    result = &WIN_OUT;
    WIN_OUT = WIN_OUT & 0xFFC0 | 0x3F;
  }
  else
  {
    REG_DISPCNT = ((uint)&REG_BG0HOFS << 9) | REG_DISPCNT & 0xFFFF1FFF;
    result = &WIN_OUT;
    WIN_OUT &= 0xFFC0u;
  }
  return result;
}

//----- (021DE1CC) --------------------------------------------------------
int *Function_21de1cc()
{
  int *v0;

  v0 = (int *)malloc(4u, 72);
  Call_FillMemWithValue(v0, 0, 0x48u);
  WIN_IN = WIN_IN & 0xFFC0 | 0x3F;
  WIN_IN = WIN_IN & 0xC0FF | 0x3F00;
  WIN_OUT &= 0xFFC0u;
  return v0;
}

//----- (021DE218) --------------------------------------------------------
uint __fastcall Function_21de218(int a1)
{
  int v1;

  v1 = a1;
  if ( *(uint *)(a1 + 60) )
    Function_21de374();
  REG_DISPCNT &= 0xFFFF1FFF;
  return free(v1);
}

//----- (021DE240) --------------------------------------------------------
uint *__fastcall Function_21de240(int a1, uint *a2, int a3, int a4, int a5)
{
  uint *v5;
  int v6;
  int v7;
  int v8;

  v5 = a2;
  v6 = a1;
  v7 = a3;
  v8 = a4;
  if ( a2[15] )
    ErrorHandler();
  *(uint *)(v6 + 24) = 0;
  v5[14] = *(uint *)(*(uint *)(*(uint *)(v6 + 16) + 4) + 28);
  v5[12] = 96;
  v5[13] = 0;
  v5[17] = v6 + 24;
  Function_21dde14(v5, 0, 1044480, v8, v7);
  Function_21dde14(v5 + 6, 0, 393216, a5, v7);
  WIN0_X1 = 255;
  WIN0_Y1 = 192;
  WIN1_X1 = 255;
  WIN1_Y1 = 192;
  return AddTaskToTaskList3((int)Function_21de2ac, (int)v5, (uint)&WIN0_X1 >> 16);
}

//----- (021DE2AC) --------------------------------------------------------
int __fastcall Function_21de2ac(int *a1, int a2)
{
  int *v2;
  int v3;

  v2 = a1;
  v3 = a2;
  *(uint *)(a2 + 64) = AddTaskToTaskList3((int)Function_21de2dc, a2, 0x400u);
  *(uint *)(v3 + 60) = Function_21ef418(*(uint *)(v3 + 56), Function_21de344, v3);
  return Call_RemoveTaskFromTaskList(v2);
}

//----- (021DE2DC) --------------------------------------------------------
void *__fastcall Function_21de2dc(int a1, uint *a2)
{
  uint *v2;
  void *result;
  int v4;
  int v5;

  v2 = a2;
  result = (void *)a2[13];
  if ( result )
  {
    if ( result == (void *)1 )
      result = (void *)Function_21de374(a2);
  }
  else
  {
    Function_21dde74(a2 + 6);
    if ( Function_21dde74(v2) )
      ++v2[13];
    v4 = *v2 >> 12;
    v5 = v2[6] >> 12;
    result = &WIN0_X1;
    WIN0_X1 = 255 - v4;
    WIN0_Y1 = (96 - v5) & 0xFF;
    WIN1_X1 = ((ushort)v4 << 8) & 0xFF00 | 0xFF;
    WIN1_Y1 = (((ushort)v5 + 96) << 8) & 0xFF00 | 0xC0;
  }
  return result;
}

//----- (021DE344) --------------------------------------------------------
uint __fastcall Function_21de344(int a1, int a2)
{
  uint result;

  if ( (uint)(ushort)REG_VCOUNT > *(uint *)(a2 + 48) )
  {
    result = ((uint)&REG_VCOUNT >> 12) | REG_DISPCNT & 0xFFFF1FFF;
    REG_DISPCNT = ((uint)&REG_VCOUNT >> 12) | REG_DISPCNT & 0xFFFF1FFF;
  }
  else
  {
    result = ((uint)&REG_VCOUNT >> 13) | REG_DISPCNT & 0xFFFF1FFF;
    REG_DISPCNT = ((uint)&REG_VCOUNT >> 13) | REG_DISPCNT & 0xFFFF1FFF;
  }
  return result;
}

//----- (021DE374) --------------------------------------------------------
int __fastcall Function_21de374(int a1)
{
  int v1;
  int result;

  v1 = a1;
  WIN_IN = WIN_IN & 0xFFC0 | 0x3F;
  WIN_OUT &= 0xFFC0u;
  WIN0_X1 = 0;
  WIN0_Y1 = 0;
  REG_DISPCNT = REG_DISPCNT & 0xFFFF1FFF | 0x2000;
  **(uint **)(a1 + 68) = 1;
  Function_21ef43c(*(uint *)(a1 + 60));
  *(uint *)(v1 + 60) = 0;
  Call_RemoveTaskFromTaskList(*(int **)(v1 + 64));
  result = 0;
  *(uint *)(v1 + 64) = 0;
  return result;
}

//----- (021DE3D0) --------------------------------------------------------
int __fastcall Function_21de3d0(int a1, uint a2, uint a3, uint a4, int a5, int a6, uint *a7, uchar a8)
{
  uint v8;
  uint v9;
  int v10;
  int v11;
  ushort *v13;
  uint v14;

  v14 = a4;
  v8 = a2;
  v9 = a3;
  v10 = a1;
  Function_2007130(a1, a4, 0, 32 * a5, 32 * a6, 4);
  Function_20070e8(v10, v9, a7, a8, 0, 0, 0, 4);
  v11 = Function_20071d0(v10, v8, 0, &v13, 4);
  Function_20198c0((int)a7, a8, (int)(v13 + 6), 0, 0, (uint)*v13 << 21 >> 24, (uint)v13[1] << 21 >> 24);
  Function_2019e2c((int)a7, a8, 0, 0, (uint)*v13 << 21 >> 24, (uint)v13[1] << 21 >> 24, a5);
  free(v11);
  return Function_201c3c0((int)a7, a8);
}

//----- (021DE47C) --------------------------------------------------------
int **__fastcall Function_21de47c(int **a1, int a2, int a3, int a4)
{
  int **v4;
  int v5;
  int *v6;
  int **result;

  v4 = a1;
  v5 = a3;
  *a1 = Function_20095c4(a2, (int)(a1 + 1), 4, a4);
  v6 = 0;
  do
  {
    result = Function_2009714(v5, v6, 4u);
    v4[75] = (int *)result;
    v6 = (int *)((char *)v6 + 1);
    ++v4;
  }
  while ( (int)v6 < 4 );
  return result;
}

//----- (021DE4AC) --------------------------------------------------------
uint __fastcall Function_21de4ac(int **a1)
{
  int **v1;
  int v2;
  uint result;

  v1 = a1;
  Function_2021964(*a1);
  v2 = 0;
  do
  {
    result = Function_2009754(v1[75]);
    ++v2;
    ++v1;
  }
  while ( v2 < 4 );
  return result;
}

//----- (021DE4CC) --------------------------------------------------------
int __fastcall Function_21de4cc(int a1, int *a2, int **a3, uint a4, int a5, uint a6, uint a7, uint a8, int a9)
{
  int *v9;
  int v10;
  int **v11;
  uint v12;

  v9 = a2;
  v10 = a1;
  v11 = a3;
  v12 = a4;
  *a3 = Function_2009aa8(a2[75], a1, a6, 0, a9, 1, 4u, 1);
  v11[1] = Function_2009b04(v9[76], v10, v12, 0, a9, 1, a5, 4u);
  v11[2] = Function_2009bc4(v9[77], v10, a7, 0, a9, 2u, 4u);
  v11[3] = Function_2009bc4(v9[78], v10, a8, 0, a9, 3u, 4u);
  Function_200a3dc(*v11);
  Function_2009d4c(*v11);
  Function_200a640(v11[1]);
  return Function_20093b4((int)(v11 + 4), a9, a9, a9, a9, -1, -1, 0, 0, v9[75], v9[76], v9[77], v9[78], 0, 0);
}

//----- (021DE5A4) --------------------------------------------------------
int __fastcall Function_21de5a4(int a1, int **a2)
{
  int **v2;
  int v3;
  int v4;
  int result;

  v2 = a2;
  v3 = a1;
  Function_200a4e4(*a2);
  Function_200a6dc(v2[1]);
  v4 = 0;
  do
  {
    result = Function_2009d68(*(int **)(v3 + 300), (uint **)*v2);
    ++v4;
    ++v2;
    v3 += 4;
  }
  while ( v4 < 4 );
  return result;
}

//----- (021DE5D0) --------------------------------------------------------
uint __fastcall Function_21de5d0(int a1, uint a2, int a3, int a4, ushort a5)
{
  int v5;
  uint v6;
  int v7;
  int v8;
  int v9;
  int v11;
  int v12;
  int v13;
  int v14;

  v14 = a4;
  v5 = a1;
  v6 = a2;
  v7 = a4;
  Function_2076aac(a3, 2, &v12);
  v8 = malloc(v6, 32);
  v9 = Function_2006f88(v12, v13, &v11, v6);
  Function_200393c(*(uint *)(v11 + 12), v8, 0x10u, v7, a5);
  Function_21de67c(v5, v8, 32);
  free(v8);
  return free(v9);
}

//----- (021DE62C) --------------------------------------------------------
int __fastcall Function_21de62c(int *a1, int a2, int a3, int a4, int a5, int a6)
{
  int v6;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;

  v8 = *a1;
  v9 = a2 + 16;
  v12 = a5;
  v10 = a3;
  v13 = a6;
  v14 = 1;
  v15 = 4;
  v11 = a4;
  v6 = Function_2021b90(&v8);
  if ( !v6 )
    ErrorHandler();
  return v6;
}

//----- (021DE660) --------------------------------------------------------
int __fastcall Function_21de660(uint *a1, int a2, int a3, int a4)
{
  uint *v4;
  int result;

  *a1 = a2;
  a1[1] = a3;
  v4 = a1 + 2;
  result = a4;
  *v4 = a4;
  return result;
}

//----- (021DE67C) --------------------------------------------------------
uint __fastcall Function_21de67c(int a1, int a2, uint a3)
{
  int v3;
  uint v4;
  int v5;
  int v6;

  v3 = a2;
  v4 = a3;
  v5 = Function_2021f9c(a1);
  DC_FlushRange(v3, v4);
  v6 = NNS_G2dGetImagePaletteLocation(v5, 1);
  return GX_LoadOBJPltt(v3, v6, v4);
}

//----- (021DE6A4) --------------------------------------------------------
int *__fastcall Function_21de6a4(uint a1)
{
  int *v1;

  v1 = (int *)malloc(a1, 48);
  Call_FillMemWithValue(v1, 0, 0x30u);
  return v1;
}

//----- (021DE6BC) --------------------------------------------------------
uint __fastcall Function_21de6bc(int a1)
{
  return free(a1);
}

//----- (021DE6C4) --------------------------------------------------------
int __fastcall Function_21de6c4(int a1, int a2, int a3, int a4, int a5, int a6, int a7, char a8, char a9, char a10)
{
  int v10;
  int v11;
  int v12;
  int v13;
  int result;

  v10 = a1;
  v11 = a2;
  v12 = a3;
  v13 = a4;
  if ( *(uchar *)(a1 + 46) )
    ErrorHandler();
  Function_21ddd80((uint *)v10, v11, v12, a6);
  Function_21ddd80((uint *)(v10 + 20), v13, a5, a6);
  *(uint *)(v10 + 40) = a7;
  *(uchar *)(v10 + 44) = a8;
  *(uchar *)(v10 + 45) = a9;
  *(uchar *)(v10 + 47) = a10;
  result = 1;
  *(uchar *)(v10 + 46) = 1;
  return result;
}

//----- (021DE71C) --------------------------------------------------------
int __fastcall Function_21de71c(int a1)
{
  int v1;
  int v3;
  int v4;
  int v5;
  int v6;

  v1 = a1;
  if ( !*(uchar *)(a1 + 46) )
    return 1;
  v3 = Function_21ddd90((uint *)a1);
  Function_21ddd90((uint *)(v1 + 20));
  v4 = (short)(*(ushort *)v1 - ((uint)*(uchar *)(v1 + 44) >> 1) + *(uchar *)(v1 + 44));
  v5 = (short)(*(uint *)(v1 + 20) - ((uint)*(uchar *)(v1 + 45) >> 1));
  v6 = *(uchar *)(v1 + 47);
  Function_21de89c(*(uint *)(v1 + 40));
  return v3;
}

//----- (021DE784) --------------------------------------------------------
int *__fastcall Function_21de784(uint a1)
{
  int *v1;

  v1 = (int *)malloc(a1, 48);
  Call_FillMemWithValue(v1, 0, 0x30u);
  return v1;
}

//----- (021DE79C) --------------------------------------------------------
uint __fastcall Function_21de79c(int a1)
{
  return free(a1);
}

//----- (021DE7A4) --------------------------------------------------------
int __fastcall Function_21de7a4(int a1, int a2, int a3, int a4, int a5, int a6, int a7, char a8, char a9, char a10)
{
  int v10;
  int v11;
  int v12;
  int v13;
  int result;

  v10 = a1;
  v11 = a2;
  v12 = a3;
  v13 = a4;
  if ( *(uchar *)(a1 + 46) )
    ErrorHandler();
  Function_21ddd80((uint *)v10, v11, v12, a6);
  Function_21ddd80((uint *)(v10 + 20), v13, a5, a6);
  *(uint *)(v10 + 40) = a7;
  *(uchar *)(v10 + 44) = a8;
  *(uchar *)(v10 + 45) = a9;
  *(uchar *)(v10 + 47) = a10;
  result = 1;
  *(uchar *)(v10 + 46) = 1;
  return result;
}

//----- (021DE7FC) --------------------------------------------------------
int __fastcall Function_21de7fc(int a1)
{
  int v1;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;

  v1 = a1;
  if ( !*(uchar *)(a1 + 46) )
    return 1;
  v3 = *(uint *)(a1 + 20);
  v4 = *(uchar *)(a1 + 45);
  v5 = (short)(*(ushort *)a1 - ((uint)*(uchar *)(a1 + 44) >> 1) + *(uchar *)(a1 + 44));
  Function_21de89c(*(uint *)(a1 + 40));
  v6 = Function_21ddd90((uint *)v1);
  Function_21ddd90((uint *)(v1 + 20));
  v7 = *(uint *)(v1 + 20);
  v8 = *(uchar *)(v1 + 45);
  v9 = (short)(*(ushort *)v1 - ((uint)*(uchar *)(v1 + 44) >> 1) + *(uchar *)(v1 + 44));
  v10 = *(uchar *)(v1 + 47);
  Function_21de89c(*(uint *)(v1 + 40));
  return v6;
}

//----- (021DE89C) --------------------------------------------------------
int __fastcall Function_21de89c(int result, int a2, int a3, int a4, int a5, char a6)
{
  short v6;
  ushort v7;

  v6 = a5;
  v7 = a2;
  if ( a5 > 0 && a3 > 0 && a4 != a5 && a2 != a3 )
  {
    if ( a4 < 0 )
      LOWORD(a4) = 0;
    if ( a5 > 256 )
      v6 = 256;
    if ( a2 < 0 )
      v7 = 0;
    if ( a3 > 256 )
      LOWORD(a3) = 256;
    result = Function_201ae78(result, a6, (ushort)a4, v7, v6 - a4, a3 - v7);
  }
  return result;
}

//----- (021DE8F8) --------------------------------------------------------
int *__fastcall Function_21de8f8(uint a1)
{
  uint v1;
  int *v2;
  int v3;
  int *v4;

  v1 = a1;
  v2 = (int *)malloc(4u, 204);
  Call_FillMemWithValue(v2, 0, 0xCCu);
  v3 = 0;
  v4 = v2;
  do
  {
    v4[1] = (int)Function_21de784(v1);
    ++v3;
    ++v4;
  }
  while ( v3 < 48 );
  return v2;
}

//----- (021DE928) --------------------------------------------------------
uint __fastcall Function_21de928(int a1)
{
  int v1;
  int v2;
  int v3;

  v1 = a1;
  v2 = 0;
  v3 = a1;
  do
  {
    Function_21de79c(*(uint *)(v3 + 4));
    ++v2;
    v3 += 4;
  }
  while ( v2 < 48 );
  return free(v1);
}

//----- (021DE948) --------------------------------------------------------
uchar *__fastcall Function_21de948(int a1, char a2, char a3, int a4, char a5)
{
  uchar *result;

  *(uint *)a1 = a4;
  *(uchar *)(a1 + 201) = a5;
  *(uchar *)(a1 + 198) = a2;
  *(uchar *)(a1 + 199) = a3;
  *(uchar *)(a1 + 196) = 0;
  *(uchar *)(a1 + 197) = 0;
  *(uchar *)(a1 + 200) = 0;
  result = (uchar *)(a1 + 202);
  *result = 1;
  return result;
}

//----- (021DE988) --------------------------------------------------------
int __fastcall Function_21de988(uchar *a1)
{
  uchar *v1;
  uint v3;
  int v4;
  int v5;
  int v6;
  int v7;

  v1 = a1;
  if ( !a1[202] )
    return 1;
  if ( a1[196] < 0x30u && (char)--a1[200] <= 0 )
  {
    a1[200] = a1[199];
    v3 = a1[196];
    v4 = 32 * *((uchar *)dword_21F9988 + (v3 >> 31) + __ROR4__((v3 << 29) - (v3 >> 31), 29)) + 16;
    Function_21de7a4(
      *(uint *)&v1[4 * v3 + 4],
      v4,
      v4,
      -16 - 32 * (v3 >> 3),
      176 - 32 * (v3 >> 3),
      v1[198],
      *(uint *)v1,
      32,
      32,
      v1[201]);
    ++v1[196];
  }
  v5 = v1[197];
  if ( v5 < v1[196] )
  {
    v6 = (int)&v1[4 * v5];
    do
    {
      v7 = Function_21de7fc(*(uint *)(v6 + 4));
      if ( v7 == 1 )
        ++v1[197];
      ++v5;
      v6 += 4;
    }
    while ( v5 < v1[196] );
  }
  if ( v1[197] < 0x30u || v7 != 1 )
    return 0;
  v1[202] = 0;
  return 1;
}

//----- (021DEA80) --------------------------------------------------------
long long __fastcall Function_21dea80(uint a1)
{
  long long result;
  uchar *v2;
  int v3;

  result = (uint)malloc(a1, 28);
  v2 = (uchar *)result;
  v3 = 28;
  do
  {
    *v2++ = 0;
    --v3;
  }
  while ( v3 );
  return result;
}

//----- (021DEA98) --------------------------------------------------------
uint __fastcall Function_21dea98(int a1)
{
  return free(a1);
}

//----- (021DEAA0) --------------------------------------------------------
uint *__fastcall Function_21deaa0(int a1, int a2, int a3, int a4, int a5, char a6)
{
  *(uint *)a1 = a5;
  *(uchar *)(a1 + 25) = a6;
  *(uchar *)(a1 + 24) = 1;
  return Function_21ddd80((uint *)(a1 + 4), a3, a4, a2);
}

//----- (021DEAC8) --------------------------------------------------------
int __fastcall Function_21deac8(int a1)
{
  int v1;
  int v3;
  int v4;

  v1 = a1;
  if ( !*(uchar *)(a1 + 24) )
    return 1;
  v3 = *(uint *)(a1 + 4) & 0xFFFF;
  v4 = Function_21ddd90((uint *)(a1 + 4));
  Function_21deb04(*(uint *)v1, v3, *(uint *)(v1 + 4) & 0xFFFF, *(uchar *)(v1 + 25));
  if ( v4 != 1 )
    return 0;
  *(uchar *)(v1 + 24) = 0;
  return 1;
}

//----- (021DEB04) --------------------------------------------------------
int __fastcall Function_21deb04(int a1, int a2, int a3, char a4)
{
  int v4;
  char v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int result;
  int v16;
  int v17;
  int v18;
  int v19;

  v16 = a1;
  v4 = a2;
  v5 = a4;
  v18 = FX_Div(SLOWORD(Unknown_20f983c[a3 >> 4]), *((short *)Unknown_20f983c + 2 * (a3 >> 4) + 1));
  v17 = FX_Div(SLOWORD(Unknown_20f983c[v4 >> 4]), *((short *)Unknown_20f983c + 2 * (v4 >> 4) + 1));
  v6 = 0;
  do
  {
    v19 = (int)((ll_mul(v18, (95 - v6) << 12) + 2048) >> 12) >> 12;
    v7 = (int)((ll_mul(v17, (95 - v6) << 12) + 2048) >> 12) >> 12;
    v8 = v7;
    v9 = 128 - v7;
    v10 = 128 - v19;
    v11 = v19 + 128;
    v12 = v8 + 128;
    v13 = v9;
    if ( v9 > 128 - v19 )
    {
      v13 = 128 - v19;
      v10 = v9;
    }
    if ( v12 > v11 )
    {
      v14 = v12;
      v12 = v19 + 128;
      v11 = v14;
    }
    Function_21de89c(v16, v6, v6 + 1, v13, v10 + 1, v5);
    result = Function_21de89c(v16, 191 - v6, 192 - v6, v12, v11 + 1, v5);
    ++v6;
  }
  while ( v6 < 96 );
  return result;
}

//----- (021DEBEC) --------------------------------------------------------
int *__fastcall Function_21debec(uint a1)
{
  uint v1;
  int *v2;
  int v3;
  int *v4;

  v1 = a1;
  v2 = (int *)malloc(a1, 36);
  Call_FillMemWithValue(v2, 0, 0x24u);
  v3 = 0;
  v4 = v2;
  do
  {
    ++v3;
    *v4 = Function_21dea80(v1);
    ++v4;
  }
  while ( v3 < 8 );
  return v2;
}

//----- (021DEC18) --------------------------------------------------------
uint __fastcall Function_21dec18(int *a1)
{
  int v1;
  int v2;
  int *v3;

  v1 = (int)a1;
  v2 = 0;
  v3 = a1;
  do
  {
    Function_21dea98(*v3);
    ++v2;
    ++v3;
  }
  while ( v2 < 8 );
  return free(v1);
}

//----- (021DEC38) --------------------------------------------------------
int __fastcall Function_21dec38(int *a1, int a2, int a3, char a4)
{
  short *v4;
  int v5;
  int *v6;
  ushort v7;
  ushort v8;
  int *v10;
  int v11;
  int v12;
  char v13;

  v11 = a2;
  v4 = &word_21F9A2C;
  v10 = a1;
  v12 = a3;
  v13 = a4;
  v5 = 0;
  v6 = a1;
  do
  {
    v7 = s32_div_f(0xFFFF * (ushort)*v4, 360);
    v8 = s32_div_f(0xFFFF * (ushort)v4[1], 360);
    Function_21deaa0(*v6, v11, v7, v8, v12, v13);
    ++v5;
    v4 += 2;
    ++v6;
  }
  while ( v5 < 8 );
  *((uchar *)v10 + 32) = 1;
  return Function_21de89c(v12, 93, 99, 0, 256, v13);
}

//----- (021DECB8) --------------------------------------------------------
int __fastcall Function_21decb8(int a1)
{
  int v1;
  int v3;
  int *v4;
  int v5;

  v1 = a1;
  if ( !*(uchar *)(a1 + 32) )
    return 1;
  v3 = 0;
  v4 = (int *)a1;
  do
  {
    v5 = Function_21deac8(*v4);
    ++v3;
    ++v4;
  }
  while ( v3 < 8 );
  if ( v5 != 1 )
    return 0;
  *(uchar *)(v1 + 32) = 0;
  return 1;
}

//----- (021DECEC) --------------------------------------------------------
int *Function_21decec()
{
  int *v0;

  v0 = (int *)malloc(4u, 232);
  Call_FillMemWithValue(v0, 0, 0xE8u);
  return v0;
}

//----- (021DED04) --------------------------------------------------------
uint __fastcall Function_21ded04(int a1)
{
  int v1;

  v1 = a1;
  if ( *(uint *)(a1 + 224) )
    Function_21dee84();
  return free(v1);
}

//----- (021DED20) --------------------------------------------------------
uint *__fastcall Function_21ded20(int a1, uint *a2, int a3, int a4, int a5, short a6, short a7)
{
  int v7;
  uint *v8;
  int v9;
  int v10;
  int v11;
  int v12;
  char v13;

  v7 = a1;
  v8 = a2;
  v9 = a3;
  v10 = a4;
  if ( a2[56] )
    ErrorHandler();
  *(uint *)(v7 + 24) = 0;
  v8[54] = *(uint *)(*(uint *)(*(uint *)(v7 + 16) + 4) + 28);
  v8[5] = 0;
  v8[57] = v7 + 24;
  Function_21ddd80(v8, 255, 0, v9);
  v11 = 0;
  do
  {
    u32_div_f(v11, v10);
    v13 = u32_div_f(a5 * v12, v10);
    if ( u32_div_f(v11, v10) & 1 )
      *((uchar *)v8 + v11 + 24) = a5 - v13;
    else
      *((uchar *)v8 + v11 + 24) = v13;
    ++v11;
  }
  while ( v11 < 192 );
  WIN_IN = WIN_IN & 0xFFC0 | a6 | 0x20;
  WIN_OUT = a7 | WIN_OUT & 0xFFC0;
  WIN0_X1 = 0;
  WIN0_Y1 = 192;
  REG_DISPCNT = REG_DISPCNT & 0xFFFF1FFF | 0x2000;
  return AddTaskToTaskList3((int)Function_21dede8, (int)v8, 0x400u);
}

//----- (021DEDE8) --------------------------------------------------------
int __fastcall Function_21dede8(int *a1, int a2)
{
  int v2;
  int *v3;

  v2 = a2;
  v3 = a1;
  *(uint *)(a2 + 220) = Function_21ef418(*(uint *)(a2 + 216), Function_21dee50, a2);
  *(uint *)(v2 + 224) = AddTaskToTaskList3((int)Function_21dee24, v2, 0x400u);
  return Call_RemoveTaskFromTaskList(v3);
}

//----- (021DEE24) --------------------------------------------------------
int __fastcall Function_21dee24(int a1, uint *a2)
{
  uint *v2;
  int result;

  v2 = a2;
  result = a2[5];
  if ( result )
  {
    if ( result == 1 )
      result = Function_21dee84(a2);
  }
  else
  {
    result = Function_21ddd90(a2);
    if ( result == 1 )
    {
      result = v2[5] + 1;
      v2[5] = result;
    }
  }
  return result;
}

//----- (021DEE50) --------------------------------------------------------
int __fastcall Function_21dee50(int a1, uint *a2)
{
  int result;
  int v3;

  result = (ushort)REG_VCOUNT;
  if ( (int)(ushort)REG_VCOUNT < 192 )
  {
    v3 = *a2 - *((uchar *)a2 + (ushort)REG_VCOUNT + 24);
    if ( v3 < 0 )
      LOWORD(v3) = 0;
    WIN0_X1 = ((ushort)v3 << 8) & 0xFF00 | 0xFF;
    result = 192;
    WIN0_Y1 = 192;
  }
  return result;
}

//----- (021DEE84) --------------------------------------------------------
int __fastcall Function_21dee84(int a1)
{
  int v1;
  int result;

  v1 = a1;
  REG_DISPCNT &= 0xFFFF1FFF;
  **(uint **)(a1 + 228) = 1;
  Function_21ef43c(*(uint *)(a1 + 220));
  *(uint *)(v1 + 220) = 0;
  Call_RemoveTaskFromTaskList(*(int **)(v1 + 224));
  result = 0;
  *(uint *)(v1 + 224) = 0;
  return result;
}

//----- (021DEEC8) --------------------------------------------------------
int __fastcall Function_21deec8(int *a1)
{
  int v1;
  int *v2;
  int v3;
  int v4;
  int *v5;
  int *v6;
  uint v7;
  int v8;

  v2 = a1;
  v3 = *a1;
  v4 = 1;
  if ( !(v3 & 1) )
  {
    if ( !(v3 & 0x720) && v3 )
    {
      ErrorHandler();
      v4 = 0;
    }
    else
    {
      v4 = 0;
    }
  }
  v5 = Function_2054a40(v2[1]);
  v6 = Function_2054a40(v2[2]);
  v7 = GetPkmnData(v5, 0xA1u, 0);
  v8 = GetPkmnData(v6, 0xA1u, 0) - v7;
  switch ( (uchar)v2[85] )
  {
    case 0u:
    case 1u:
    case 2u:
    case 3u:
    case 4u:
    case 6u:
    case 8u:
    case 9u:
    case 0xAu:
    case 0xBu:
    case 0x18u:
      v1 = 0;
      break;
    case 5u:
      v1 = 4;
      break;
    case 7u:
      v1 = 2;
      break;
    default:
      break;
  }
  if ( v8 > 0 )
    ++v1;
  return v1 + 6 * v4;
}

//----- (021DEF74) --------------------------------------------------------
int __fastcall Function_21def74(int *a1, int *a2)
{
  int *v2;

  v2 = a1;
  GXx_SetMasterBrightness_(&REG_MASTER_BRIGHT, *a2);
  return Call_RemoveTaskFromTaskList(v2);
}

//----- (021DEF8C) --------------------------------------------------------
uint *__fastcall Function_21def8c(int a1)
{
  return AddTaskToTaskList3((int)Function_21def74, a1, 0x400u);
}

//----- (021DEFA0) --------------------------------------------------------
uint *__fastcall Function_21defa0(int a1)
{
  int v1;
  uchar *v2;
  int v3;

  v1 = a1;
  if ( dword_2202120[0] )
    ErrorHandler();
  v2 = (uchar *)malloc(4u, 24);
  v3 = 24;
  dword_2202120[0] = (int)v2;
  do
  {
    *v2++ = 0;
    --v3;
  }
  while ( v3 );
  *(ushort *)dword_2202120[0] = 0;
  *(uchar *)(dword_2202120[0] + 2) = 0;
  *(uint *)(dword_2202120[0] + 4) = v1;
  Function_201ff0c(2u, 0);
  Function_201ff0c(4u, 0);
  Function_201ff0c(8u, 0);
  Function_20bec9c();
  MIi_CpuClearFast(0, (uint *)0x6840000, 0x20000u);
  REG_DISPCAPCNT = -1070461948;
  AddTaskToTaskList3((int)Function_21df258, dword_2202120[0], (uint)&REG_DISPCAPCNT >> 16);
  return AddTaskToTaskList1((int)Function_21df28c, dword_2202120[0], 0x400u);
}

//----- (021DF038) --------------------------------------------------------
int Function_21df038()
{
  int result;

  if ( !dword_2202120[0] )
    ErrorHandler();
  result = dword_2202120[0];
  *(uchar *)(dword_2202120[0] + 3) = 1;
  return result;
}

//----- (021DF054) --------------------------------------------------------
int Function_21df054()
{
  if ( !dword_2202120[0] )
    ErrorHandler();
  return *(uchar *)(dword_2202120[0] + 2);
}

//----- (021DF070) --------------------------------------------------------
int Function_21df070()
{
  int result;

  result = dword_2202120[0];
  if ( dword_2202120[0] )
    result = Function_201469c();
  return result;
}

//----- (021DF084) --------------------------------------------------------
int *Function_21df084()
{
  int *result;

  if ( !dword_2202120[0] )
    ErrorHandler();
  Function_20141e4();
  Function_21df3d4(*(uint *)(dword_2202120[0] + 4));
  Function_21d16f4(*(uint *)(dword_2202120[0] + 4), 1);
  Function_21d1718(*(uint *)(dword_2202120[0] + 4), 1);
  free(dword_2202120[0]);
  result = dword_2202120;
  dword_2202120[0] = 0;
  return result;
}

//----- (021DF0CC) --------------------------------------------------------
int *__fastcall Function_21df0cc(int a1, uint a2)
{
  int v2;
  uint v3;
  int v4;
  uint *v5;

  v2 = a1;
  v3 = a2;
  if ( !dword_2202120[0] )
    ErrorHandler();
  if ( *(uint *)(dword_2202120[0] + 8) )
    ErrorHandler();
  *(uint *)(dword_2202120[0] + 12) = malloc(4u, 18432);
  *(uint *)(dword_2202120[0] + 8) = Function_2014014(
                                        (int)Function_21df3e8,
                                        (int)Function_21df414,
                                        *(int **)(dword_2202120[0] + 12),
                                        0x4800u,
                                        1,
                                        4u);
  if ( !*(uint *)(dword_2202120[0] + 8) )
    ErrorHandler();
  Function_2014788(*(uint *)(dword_2202120[0] + 8), 1);
  v4 = Function_2014784(*(uint *)(dword_2202120[0] + 8));
  Function_20206bc(4096, 3686400, v4);
  v5 = Function_200723c(v2, v3, 0, 4, 0);
  return Function_20144cc(*(uint **)(dword_2202120[0] + 8), (int)v5, 0, 0);
}

//----- (021DF17C) --------------------------------------------------------
uint __fastcall Function_21df17c(uint a1)
{
  uint v1;
  uint result;
  uint v3;
  int v4;
  int v5;
  int v6;

  v1 = a1;
  v4 = 0;
  v5 = 0;
  v6 = 0;
  if ( !dword_2202120[0] )
    ErrorHandler();
  result = *(uint *)(dword_2202120[0] + 8);
  if ( !result )
    result = ErrorHandler();
  v3 = 0;
  if ( v1 )
  {
    do
      result = Function_20146e4(*(int **)(dword_2202120[0] + 8), v3++, &v4);
    while ( v3 < v1 );
  }
  return result;
}

//----- (021DF1CC) --------------------------------------------------------
BOOL Function_21df1cc()
{
  if ( !dword_2202120[0] )
    ErrorHandler();
  if ( !*(uint *)(dword_2202120[0] + 8) )
    return 1;
  Function_20146c0();
  return Function_2014710(*(uint *)(dword_2202120[0] + 8)) == 0;
}

//----- (021DF208) --------------------------------------------------------
BOOL Function_21df208()
{
  return Function_2014710(*(uint *)(dword_2202120[0] + 8)) == 0;
}

//----- (021DF224) --------------------------------------------------------
int Function_21df224()
{
  int result;

  if ( !dword_2202120[0] )
    ErrorHandler();
  Function_201411c(*(uint ***)(dword_2202120[0] + 8));
  free(*(uint *)(dword_2202120[0] + 12));
  *(uint *)(dword_2202120[0] + 8) = 0;
  result = dword_2202120[0];
  *(uint *)(dword_2202120[0] + 12) = 0;
  return result;
}

//----- (021DF258) --------------------------------------------------------
int __fastcall Function_21df258(int *a1, ushort *a2)
{
  ushort *v2;
  int *v3;
  int result;

  v2 = a2;
  v3 = a1;
  result = *a2;
  if ( *a2 )
  {
    if ( result == 1 )
    {
      result = *((uchar *)a2 + 3);
      if ( result == 1 )
      {
        Function_21df30c(*((uint *)a2 + 1));
        Call_RemoveTaskFromTaskList(v3);
        result = (ushort)*v2 + 1;
        *v2 = result;
      }
    }
  }
  else
  {
    *a2 = ++result;
  }
  return result;
}

//----- (021DF28C) --------------------------------------------------------
int __fastcall Function_21df28c(int *a1, ushort *a2)
{
  ushort *v2;
  int *v3;
  int result;
  int v5[9];
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;

  v2 = a2;
  v3 = a1;
  result = *a2;
  if ( result == 2 )
  {
    Function_2014000();
    v9 = 0;
    v10 = 0;
    v11 = 0;
    v6 = 4096;
    v7 = 4096;
    v8 = 4096;
    MTX_Identity33_(v5);
    Function_20af4bc(&v9);
    Function_20af4ec(&v6);
    MI_Copy36B(v5, dword_21C5B48);
    dword_21C5B88 &= 0xFFFFFF5B;
    Function_21d16f4(*((uint *)v2 + 1), 0);
    Function_21d1718(*((uint *)v2 + 1), 0);
    Function_2019060(0, 0);
    *((uchar *)v2 + 2) = 1;
    result = Call_RemoveTaskFromTaskList(v3);
  }
  return result;
}

//----- (021DF30C) --------------------------------------------------------
uint __fastcall Function_21df30c(int a1)
{
  int *v1;
  int v2;
  char *v3;
  int v4;
  int v5;
  int v6;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  char v15;
  int v16;
  int v17;
  int v18;
  int v19;
  char v20;

  v1 = dword_21F9A4C;
  v2 = a1;
  v3 = &v20;
  v4 = 5;
  do
  {
    v5 = *v1;
    v6 = v1[1];
    v1 += 2;
    *(uint *)v3 = v5;
    *((uint *)v3 + 1) = v6;
    v3 += 8;
    --v4;
  }
  while ( v4 );
  GX_SetBanks((int *)&v20);
  Function_201ff0c(1u, 0);
  v16 = 1;
  v17 = 3;
  v18 = 0;
  v19 = 1;
  SetGraphicsModes(&v16);
  Function_5_21d143c(*(uint *)(v2 + 8));
  REG_BG3CNT = REG_BG3CNT & 0x43 | 0x4884;
  Function_2019060(3u, 3);
  Function_201ff0c(8u, 1);
  Function_20bb44c(&v15);
  G2x_SetBGyAffine_((int *)&REG_BG3PA, &v15, 0, 0, 0, 0);
  v8 = 0;
  v9 = 0;
  v10 = 2048;
  v11 = 0;
  v12 = 1900545;
  v13 = 1;
  v14 = 0;
  Function_20183c4(*(uint **)(v2 + 8), 2u, &v8, 0);
  Function_2019690(2u, 32, 0, 4u);
  Function_2019ebc(*(uint **)(v2 + 8), 2u);
  return Function_201ff0c(0x10u, 1);
}

//----- (021DF3D4) --------------------------------------------------------
int __fastcall Function_21df3d4(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  Function_2019044(*(uint *)(a1 + 8), 2);
  v2 = *(uint *)(v1 + 8);
  return Function_5_21d1434();
}

//----- (021DF3E8) --------------------------------------------------------
int __fastcall Function_21df3e8(int a1, int a2)
{
  int v2;
  int v3;
  int result;

  v2 = a1;
  v3 = a2;
  if ( !dword_2202120[0] )
    ErrorHandler();
  if ( v3 )
    ErrorHandler();
  result = *(uint *)(dword_2202120[0] + 16);
  *(uint *)(dword_2202120[0] + 16) = result + v2;
  return result;
}

//----- (021DF414) --------------------------------------------------------
int __fastcall Function_21df414(int a1, int a2)
{
  int v2;
  int v3;
  int result;

  v2 = a1;
  v3 = a2;
  if ( !dword_2202120[0] )
    ErrorHandler();
  if ( v3 )
    ErrorHandler();
  result = *(uint *)(dword_2202120[0] + 20);
  *(uint *)(dword_2202120[0] + 20) = result + v2;
  return result;
}

//----- (021DF440) --------------------------------------------------------
int *__fastcall Function_21df440(int a1, int a2, uint a3)
{
  uint v3;
  int v4;
  int v5;
  int *v6;

  v3 = a3;
  v4 = a1;
  v5 = a2;
  v6 = (int *)malloc(a3, 36);
  Call_FillMemWithValue(v6, 0, 0x24u);
  *v6 = v3;
  v6[1] = v5;
  v6[4] = v4;
  v6[5] = malloc(v3, 8 * v5);
  Function_21df5e8(v6);
  Function_21df588(v6);
  return v6;
}

//----- (021DF47C) --------------------------------------------------------
int __fastcall Function_21df47c(int a1, int a2)
{
  *(uint *)(a1 + 8) = a2;
  return Function_21df6f8();
}

//----- (021DF488) --------------------------------------------------------
int __fastcall Function_21df488(int a1, int a2, int a3, int a4, int a5)
{
  return Function_21df754(a1, a2, a3, a4, a5);
}

//----- (021DF4A8) --------------------------------------------------------
uint __fastcall Function_5_21df4a8(int a1, int a2)
{
  int v2;
  int v3;
  uint result;

  v2 = a1;
  v3 = a2;
  if ( Function_21df694() )
    result = ErrorHandler();
  else
    result = Function_21df600(v2, v3);
  return result;
}

//----- (021DF4C8) --------------------------------------------------------
uint __fastcall Function_21df4c8(uint result, int *a2)
{
  int *v2;
  int v3;
  int v4;

  v2 = a2;
  v3 = *a2;
  v4 = result;
  if ( v3 != 34 )
  {
    do
    {
      result = Function_5_21df4a8(v4, v3);
      ++v2;
      v3 = *v2;
    }
    while ( *v2 != 34 );
  }
  return result;
}

//----- (021DF4E4) --------------------------------------------------------
BOOL Function_21df4e4()
{
  return Function_21df694() != 0;
}

//----- (021DF4F8) --------------------------------------------------------
int Function_21df4f8()
{
  return Function_21df71c();
}

//----- (021DF500) --------------------------------------------------------
uint __fastcall Function_21df500(int a1)
{
  int v1;

  v1 = a1;
  Function_21df708();
  Function_21df644(v1);
  Function_21df7c4(v1);
  Function_21df59c(v1);
  free(*(uint *)(v1 + 20));
  return free(v1);
}

//----- (021DF528) --------------------------------------------------------
int __fastcall Function_21df528(uint *a1, int a2, int a3)
{
  uint v3;
  int result;

  v3 = *a1;
  if ( a3 )
    result = malloc2(v3, a2);
  else
    result = malloc(v3, a2);
  return result;
}

//----- (021DF53C) --------------------------------------------------------
int *__fastcall Function_21df53c(uint *a1, int a2, int a3, uchar a4)
{
  uint v4;
  uchar v5;
  int *v6;

  v4 = a2;
  v5 = a4;
  v6 = (int *)Function_21df528(a1, a2, a3);
  Call_FillMemWithValue(v6, v5, v4);
  return v6;
}

//----- (021DF554) --------------------------------------------------------
uint __fastcall Function_5_21df554(int a1)
{
  return free(a1);
}

//----- (021DF55C) --------------------------------------------------------
int Function_21df55c()
{
  int v0;

  v0 = Function_21df694();
  if ( v0 )
    return *(uint *)(v0 + 4);
  ErrorHandler();
  return 0;
}

//----- (021DF574) --------------------------------------------------------
int __fastcall Function_21df574(int a1)
{
  return *(uint *)(a1 + 16);
}

//----- (021DF578) --------------------------------------------------------
int __fastcall Function_21df578(int a1)
{
  return *(uint *)(GetSpriteSpriteListFirstSprite(a1) + 64);
}

//----- (021DF584) --------------------------------------------------------
int __fastcall Function_21df584(int a1)
{
  return *(uint *)a1;
}

//----- (021DF588) --------------------------------------------------------
int *__fastcall Function_21df588(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  int *result;

  v1 = a1;
  v2 = Function_21df584(a1);
  result = LoadFromNARC_8(107, v2, v3, v4);
  *(uint *)(v1 + 24) = result;
  return result;
}

//----- (021DF59C) --------------------------------------------------------
uint __fastcall Function_21df59c(int a1)
{
  return Call_FS_CloseFile(*(int **)(a1 + 24));
}

//----- (021DF5A8) --------------------------------------------------------
int __fastcall Function_5_21df5a8(int a1, uint a2, int a3)
{
  return Function_2006d84_GetFilesize(*(uint *)(a1 + 24), a2, a3, (int)Function_2006d84_GetFilesize);
}

//----- (021DF5B4) --------------------------------------------------------
int __fastcall Function_5_21df5b4(int a1, uint a2, int a3)
{
  return LoadFileFromNARCFileHandler(*(uint *)(a1 + 24), a2, a3);
}

//----- (021DF5C0) --------------------------------------------------------
int __fastcall Function_5_21df5c0(int a1, uint a2, int a3, int a4)
{
  int v4;
  int v5;
  uint v6;
  int v7;
  int v8;

  v4 = a1;
  v5 = a3;
  v6 = a2;
  v7 = Function_2006d84_GetFilesize(*(uint *)(a1 + 24), a2, a3, a4);
  v8 = Function_21df528((uint *)v4, v7, v5);
  LoadFileFromNARCFileHandler(*(uint *)(v4 + 24), v6, v8);
  return v8;
}

//----- (021DF5E8) --------------------------------------------------------
int __fastcall Function_21df5e8(int result)
{
  int v1;
  int i;

  v1 = *(uint *)(result + 4);
  for ( i = *(uint *)(result + 20); v1; --v1 )
  {
    result = Function_21df6ac(i);
    i += 8;
  }
  return result;
}

//----- (021DF600) --------------------------------------------------------
int __fastcall Function_21df600(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;

  v2 = a2;
  v3 = a1;
  v4 = Function_21df6d0(a2);
  v5 = (*(int (__fastcall **)(int))(v4 + 4))(v3);
  v6 = Function_21df66c(v3);
  return Function_21df6b8(v6, v2, v5);
}

//----- (021DF628) --------------------------------------------------------
int __fastcall Function_21df628(int a1, uint *a2)
{
  uint *v2;
  int v3;

  v2 = a2;
  v3 = Function_21df6d0(*a2);
  (*(void (__fastcall **)(uint))(v3 + 8))(v2[1]);
  return Function_21df6ac(v2);
}

//----- (021DF644) --------------------------------------------------------
int __fastcall Function_21df644(int result)
{
  int v1;
  int v2;
  uint *i;

  v1 = result;
  v2 = *(uint *)(result + 4);
  for ( i = *(uint **)(result + 20); v2; --v2 )
  {
    result = Function_21df6c0(i);
    if ( !result )
      result = Function_21df628(v1, i);
    i += 2;
  }
  return result;
}

//----- (021DF66C) --------------------------------------------------------
int __fastcall Function_21df66c(int a1)
{
  int v1;
  int v2;
  int result;

  v1 = *(uint *)(a1 + 4);
  v2 = *(uint *)(a1 + 20);
  if ( v1 )
  {
    while ( Function_21df6c0(v2) != 1 )
    {
      v2 += 8;
      if ( !--v1 )
        goto LABEL_5;
    }
    result = v2;
  }
  else
  {
LABEL_5:
    ErrorHandler();
    result = 0;
  }
  return result;
}

//----- (021DF694) --------------------------------------------------------
uint *__fastcall Function_21df694(int a1, int a2)
{
  int v2;
  uint *result;

  v2 = *(uint *)(a1 + 4);
  result = *(uint **)(a1 + 20);
  if ( !v2 )
    return 0;
  while ( *result != a2 )
  {
    result += 2;
    if ( !--v2 )
      return 0;
  }
  return result;
}

//----- (021DF6AC) --------------------------------------------------------
uint *__fastcall Function_21df6ac(uint *result)
{
  *result = 34;
  result[1] = 0;
  return result;
}

//----- (021DF6B8) --------------------------------------------------------
uint *__fastcall Function_21df6b8(uint *result, int a2, int a3)
{
  *result = a2;
  result[1] = a3;
  return result;
}

//----- (021DF6C0) --------------------------------------------------------
BOOL __fastcall Function_21df6c0(uint *a1)
{
  return *a1 == 34;
}

//----- (021DF6D0) --------------------------------------------------------
int *__fastcall Function_21df6d0(int a1)
{
  int *v1;
  int v2;

  v1 = &dword_21FF85C;
  v2 = 0;
  do
  {
    if ( v2 == a1 )
      return v1;
    v1 += 3;
    v2 = *v1;
  }
  while ( *v1 != 34 );
  ErrorHandler();
  return 0;
}

//----- (021DF6F8) --------------------------------------------------------
int *__fastcall Function_21df6f8(int a1)
{
  int v1;
  int *result;

  v1 = a1;
  result = Function_20711ec(*(uint *)a1, *(uint *)(a1 + 8));
  *(uint *)(v1 + 28) = result;
  return result;
}

//----- (021DF708) --------------------------------------------------------
int __fastcall Function_21df708(int a1)
{
  int v1;
  int result;

  v1 = a1;
  result = *(uint *)(a1 + 28);
  if ( result )
  {
    Function_207121c(result);
    result = 0;
    *(uint *)(v1 + 28) = 0;
  }
  return result;
}

//----- (021DF71C) --------------------------------------------------------
int __fastcall Function_21df71c(int a1)
{
  int result;

  result = *(uint *)(a1 + 28);
  if ( result )
    result = Function_20713d0(result);
  return result;
}

//----- (021DF72C) --------------------------------------------------------
int *__fastcall Function_5_21df72c(int a1, int *a2, int *a3, int a4, int a5, uint a6)
{
  int *v6;

  v6 = Function_2071330(*(uint *)(a1 + 28), a2, a3, a4, a5, a6);
  if ( !v6 )
    ErrorHandler();
  return v6;
}

//----- (021DF74C) --------------------------------------------------------
int *__fastcall Function_5_21df74c(int *a1)
{
  return Function_207136c(a1);
}

//----- (021DF754) --------------------------------------------------------
uint *__fastcall Function_21df754(uint *a1, uint a2, int a3, int a4, int a5, int a6, int a7, int a8)
{
  int v8;
  uint v9;
  int v10;
  int v11;
  int *v12;
  int *v13;
  uint *result;
  int v15;
  int v16;

  v8 = a3;
  v9 = a2;
  v10 = a4;
  v11 = (int)a1;
  v12 = Function_21df53c(a1, 36, 0, 0);
  v13 = v12;
  *(uint *)(v11 + 32) = v12;
  *v12 = v9;
  *((ushort *)v12 + 2) = v8;
  *((ushort *)v12 + 3) = v10;
  *((ushort *)v12 + 4) = a5;
  *((ushort *)v12 + 5) = a6;
  v12[4] = Function_21f067c(v9, 69, a7, v10);
  v13[5] = Function_21f067c(v9, 70, a8, a5);
  v13[6] = (int)Function_2022bd8(a6, v9);
  Function_21df8c8(v11, v13, v8);
  v15 = v8;
  v16 = Function_21df584(v11);
  result = Function_2020c44((int)&v15);
  v13[3] = (int)result;
  return result;
}

//----- (021DF7C4) --------------------------------------------------------
int __fastcall Function_21df7c4(int result)
{
  int v1;
  int v2;

  v1 = result;
  v2 = *(uint *)(result + 32);
  if ( v2 )
  {
    Function_2020ccc(*(uchar **)(v2 + 12));
    Function_21df8fc(v2);
    Function_21f06d8(*(uint *)(v2 + 16));
    Function_21f06d8(*(uint *)(v2 + 20));
    Function_2022c1c(*(int **)(v2 + 24));
    Function_5_21df554(v2);
    result = 0;
    *(uint *)(v1 + 32) = 0;
  }
  return result;
}

//----- (021DF7F8) --------------------------------------------------------
int __fastcall Function_21df7f8(int a1, int a2, int *a3)
{
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;

  v10 = *(uint *)(*(uint *)(a1 + 32) + 12);
  v11 = a2;
  v3 = a3[1];
  v12 = *a3;
  v13 = v3;
  v14 = a3[2];
  v15 = 4096;
  v16 = 4096;
  v17 = 4096;
  v4 = Function_202119c((uint **)&v10);
  if ( !v4 )
    ErrorHandler();
  if ( v4 )
  {
    v5 = Function_20213f4(v4);
    Function_20b37a4(v5, 1, v6, v7);
    v8 = Function_20213f4(v4);
    Function_21d53a4(v8);
  }
  return v4;
}

//----- (021DF84C) --------------------------------------------------------
int __fastcall Function_21df84c(int a1, int a2, int *a3)
{
  int v3;
  int *v4;
  int v5;

  v3 = a1;
  v4 = a3;
  v5 = Function_21df9b4(*(uint *)(a1 + 32));
  return Function_21df7f8(v3, v5, v4);
}

//----- (021DF864) --------------------------------------------------------
int __fastcall Function_21df864(int a1, int a2, int a3, int a4, int a5, int a6, int a7)
{
  int v7;
  int v8;
  int v9;
  int v10;
  uint *v11;
  int *v12;
  int v13;
  int v14;
  char v16;

  v7 = *(uint *)(a1 + 32);
  v8 = a2;
  v9 = a4;
  v10 = Function_21f075c(*(uint *)(v7 + 16), a3);
  v11 = (uint *)Function_21f075c(*(uint *)(v7 + 20), v9);
  Function_2024184(v11, &v16);
  v12 = (int *)Function_2022d98(*(uint **)(v7 + 24), a5);
  if ( !v12 )
    ErrorHandler();
  v13 = Function_2022df4(v12);
  if ( a6 == 1 )
    v12 = 0;
  v14 = Function_21df930(v7, v8, v10, &v16, v13, v12, a7);
  if ( !v14 )
    ErrorHandler();
  return v14;
}

//----- (021DF8C8) --------------------------------------------------------
uint *__fastcall Function_21df8c8(uint *a1, int a2, int a3)
{
  int v3;
  int v4;
  uint *v5;
  int v6;
  int v7;
  uint *result;

  v3 = a2;
  v4 = a3;
  v5 = a1;
  v6 = Function_21df528(a1, 40 * a3, 0);
  v7 = v6;
  *(uint *)(v3 + 32) = v6;
  result = (uint *)Function_21df528(v5, 8 * v4, 0);
  *(uint *)(v3 + 28) = result;
  do
  {
    *result = 17;
    result[1] = v7;
    result += 2;
    v7 += 40;
    --v4;
  }
  while ( v4 );
  return result;
}

//----- (021DF8FC) --------------------------------------------------------
uint __fastcall Function_21df8fc(int a1)
{
  int v1;

  v1 = a1;
  Function_5_21df554(*(uint *)(a1 + 28));
  return Function_5_21df554(*(uint *)(v1 + 32));
}

//----- (021DF910) --------------------------------------------------------
uint __fastcall Function_21df910(int a1, int a2)
{
  int v2;
  uint *v3;
  uint result;

  v2 = *(ushort *)(a1 + 4);
  v3 = *(uint **)(a1 + 28);
  do
  {
    if ( *v3 == a2 )
    {
      result = 17;
      *v3 = 17;
      return result;
    }
    v3 += 2;
    --v2;
  }
  while ( v2 );
  return ErrorHandler();
}

//----- (021DF930) --------------------------------------------------------
int *__fastcall Function_21df930(int a1, int a2, int a3, int *a4, int a5, int a6, int a7)
{
  int v7;
  uint *v8;
  int *v9;
  int *v10;
  int v11;
  uint *v12;
  uint *v14;
  int v15;
  uint *v16;
  int v17;
  uint *v18;
  int v19;
  int v20;

  v7 = *(ushort *)(a1 + 4);
  v20 = a3;
  v8 = *(uint **)(a1 + 28);
  v9 = a4;
  v10 = 0;
  v11 = *(ushort *)(a1 + 4);
  v12 = *(uint **)(a1 + 28);
  do
  {
    if ( *v12 == a2 )
      return (int *)v12[1];
    v12 += 2;
    --v11;
  }
  while ( v11 );
  while ( *v8 != 17 )
  {
    v8 += 2;
    if ( !--v7 )
      goto LABEL_8;
  }
  *v8 = a2;
  v10 = (int *)v8[1];
LABEL_8:
  if ( !v10 )
    ErrorHandler();
  Call_FillMemWithValue(v10, 0, 0x28u);
  *v10 = v20;
  v14 = v10 + 3;
  v15 = *v9;
  v17 = v9[1];
  v16 = v9 + 2;
  *v14 = v15;
  v14[1] = v17;
  v18 = v10 + 5;
  v19 = v16[1];
  *v18 = *v16;
  v18[1] = v19;
  v10[1] = a5;
  if ( a6 )
  {
    v10[7] = Function_2022ef4(a6);
    v10[8] = Function_2022f04(a6);
    v10[9] = Function_2022f14(a6);
  }
  v10[2] = a7;
  return v10;
}

//----- (021DF9B4) --------------------------------------------------------
int __fastcall Function_21df9b4(int a1, int a2)
{
  int v2;
  uint *v3;

  v2 = *(ushort *)(a1 + 4);
  v3 = *(uint **)(a1 + 28);
  do
  {
    if ( *v3 == a2 )
      return v3[1];
    v3 += 2;
    --v2;
  }
  while ( v2 );
  ErrorHandler();
  return 0;
}

//----- (021DF9D4) --------------------------------------------------------
uint __fastcall Function_21df9d4(int a1, int a2)
{
  return Function_21df910(*(uint *)(a1 + 32), a2);
}

//----- (021DF9E0) --------------------------------------------------------
int __fastcall Function_21df9e0(int a1, int a2, int a3)
{
  return Function_21f0784(*(uint *)(*(uint *)(a1 + 32) + 16), a2, *(uint *)(a1 + 24), a3, 0);
}

//----- (021DF9FC) --------------------------------------------------------
int __fastcall Function_21df9fc(int a1, int a2)
{
  return Function_21f075c(*(uint *)(*(uint *)(a1 + 32) + 16), a2);
}

//----- (021DFA08) --------------------------------------------------------
int __fastcall Function_21dfa08(int a1)
{
  return Function_21f0740(*(uint *)(*(uint *)(a1 + 32) + 16));
}

//----- (021DFA14) --------------------------------------------------------
int __fastcall Function_21dfa14(int a1, int a2, int a3)
{
  return Function_21f0784(*(uint *)(*(uint *)(a1 + 32) + 20), a2, *(uint *)(a1 + 24), a3, 0);
}

//----- (021DFA30) --------------------------------------------------------
int __fastcall Function_21dfa30(int a1)
{
  return Function_21f0740(*(uint *)(*(uint *)(a1 + 32) + 20));
}

//----- (021DFA3C) --------------------------------------------------------
int __fastcall Function_21dfa3c(int a1, int a2, uint a3, int a4)
{
  int v4;
  int v5;
  int v6;
  short v7;
  int v8;
  int v9;

  v4 = a1;
  v5 = a2;
  v6 = *(uint *)(a1 + 32);
  v7 = a4;
  v8 = Function_5_21df5c0(a1, a3, 1, a4);
  v9 = Function_21df584(v4);
  if ( !Function_2022c9c(*(uint **)(v6 + 24), v8, v5, v7, v9) )
    ErrorHandler();
  return Function_21dfa88(v4, v5, *(uint *)(v6 + 24));
}

//----- (021DFA7C) --------------------------------------------------------
int __fastcall Function_21dfa7c(int a1, int a2)
{
  return Function_2022d38(*(int **)(*(uint *)(a1 + 32) + 24), a2);
}

//----- (021DFA88) --------------------------------------------------------
uint *__fastcall Function_21dfa88(uint *a1, int a2, int a3)
{
  int v3;
  int v4;
  uint *v5;
  int v6;

  v3 = a2;
  v4 = a3;
  v5 = (uint *)Function_21df528(a1, 12, 1);
  v6 = (int)v5;
  *v5 = 1;
  v5[1] = v3;
  v5[2] = v4;
  AddTaskToTaskList2((int)Function_21dfac0, (int)v5, 0xFFu);
  return AddTaskToTaskList3((int)Function_21dfadc, v6, 0xFFu);
}

//----- (021DFAC0) --------------------------------------------------------
int __fastcall Function_21dfac0(int *a1, int a2)
{
  uint *v2;
  int *v3;

  v2 = (uint *)a2;
  v3 = a1;
  Function_2022e38(*(uint **)(a2 + 8), *(uint *)(a2 + 4));
  *v2 = 1;
  return Call_RemoveTaskFromTaskList(v3);
}

//----- (021DFADC) --------------------------------------------------------
int __fastcall Function_21dfadc(int *a1, int a2)
{
  int v2;
  int *v3;
  int result;

  v2 = a2;
  v3 = a1;
  result = *(uint *)a2;
  if ( *(uint *)a2 == 1 )
  {
    Function_2022ea0(*(uint **)(a2 + 8), *(uint *)(a2 + 4));
    Function_5_21df554(v2);
    result = Call_RemoveTaskFromTaskList(v3);
  }
  return result;
}

//----- (021DFB00) --------------------------------------------------------
uint *__fastcall Function_5_21dfb00(int *a1, uchar *a2, uint a3, uint a4, int a5)
{
  int v5;

  v5 = (int)a2;
  Function_207389c(a2, a3, a1[6], a4, *a1, a5);
  return Function_20738ec(v5);
}

//----- (021DFB24) --------------------------------------------------------
int __fastcall Function_21dfb24(int *a1, int *a2, int a3, uint a4, int a5)
{
  return Function_20739b4(a2, a3, a1[6], a4, *a1, a5);
}

//----- (021DFB40) --------------------------------------------------------
int __fastcall Function_21dfb40(uint *a1, int *a2, int a3, int a4, int a5)
{
  return Function_2073a6c(a2, a3, a4, a5, *a1);
}

//----- (021DFB54) --------------------------------------------------------
int __fastcall Function_5_21dfb54(int result, int a2)
{
  return Function_205eb84(result, a2);
}

//----- (021DFB5C) --------------------------------------------------------
int __fastcall Function_5_21dfb5c(int a1)
{
  int v1;
  uint v2;
  int *v3;
  uint v4;

  v1 = a1;
  v2 = 0;
  v3 = &dword_21F9B74;
  v4 = Function_205eb90(a1);
  do
  {
    if ( v4 & 1 )
      ((void (__fastcall *)(int))*v3)(v1);
    ++v2;
    v4 >>= 1;
    ++v3;
  }
  while ( v2 < 0xA );
  return Function_205eb8c(v1, 0);
}

//----- (021DFB90) --------------------------------------------------------
int __fastcall Function_21dfb90(uint *a1)
{
  uint *v1;
  uint v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int *v7;

  v1 = a1;
  v2 = 0;
  if ( Function_205f108(a1) )
  {
    v2 = 24;
  }
  else
  {
    v3 = Function_205eb3c((int)v1);
    v4 = GetSpriteSpriteListFirstSprite(v3);
    if ( Function_2071cb4(v4, 2) == 1 )
      v2 = 28;
  }
  v5 = Function_205eb98((int)v1);
  v6 = Function_205ed6c(v2, v5);
  Function_21e106c(v1, v6);
  Function_205eb58((int)v1, 0);
  Function_205ebc0(v1);
  v7 = (int *)Function_205ec04((int)v1);
  if ( v7 )
    Function_5_21df74c(v7);
  return Function_205ec00((int)v1, 0);
}

//----- (021DFBF4) --------------------------------------------------------
int __fastcall Function_21dfbf4(int a1)
{
  uint *v1;
  int v2;
  int v3;
  int *v4;

  v1 = (uint *)a1;
  v2 = Function_205eb98(a1);
  v3 = Function_205ed6c(1u, v2);
  Function_21e106c(v1, v3);
  Function_205eb58((int)v1, 1);
  Function_205ebc0(v1);
  v4 = (int *)Function_205ec04((int)v1);
  if ( v4 )
    Function_5_21df74c(v4);
  Function_205ec00((int)v1, 0);
  return Function_2005748(0x618u);
}

//----- (021DFC3C) --------------------------------------------------------
uint *__fastcall Function_21dfc3c(int a1)
{
  uint *v1;
  int v2;
  int v3;
  int *v4;
  int v5;
  uint v6;
  int v7;
  int v8;

  v1 = (uint *)a1;
  v2 = Function_205eb3c(a1);
  GetSpriteSpriteListFirstSprite(v2);
  v3 = Function_205f108(v1);
  v4 = (int *)Function_205ec04((int)v1);
  if ( v4 )
    Function_5_21df74c(v4);
  Function_205ec00((int)v1, 0);
  if ( Function_205f16c(v1) == 1 )
    GetSpriteFaceDirection((int)v1);
  else
    Function_205ea94((int)v1);
  if ( v3 )
  {
    v5 = Function_5_21f85bc(v1);
    v6 = 25;
  }
  else
  {
    v5 = Function_5_21f261c(v2);
    v6 = 2;
  }
  Function_205ec00((int)v1, v5);
  v7 = Function_205eb98((int)v1);
  v8 = Function_205ed6c(v6, v7);
  Function_21e106c(v1, v8);
  Function_205eb58((int)v1, 2);
  return Function_205ebc0(v1);
}

//----- (021DFCE4) --------------------------------------------------------
uint *__fastcall Function_21dfce4(uint *a1)
{
  return Function_205ef6c(a1, 1);
}

//----- (021DFCF0) --------------------------------------------------------
int __fastcall Function_21dfcf0(int a1)
{
  int v1;
  int v2;
  int v3;

  v1 = a1;
  v2 = Function_205eb98(a1);
  v3 = Function_205ed6c(0x11u, v2);
  return Function_21e106c(v1, v3);
}

//----- (021DFD0C) --------------------------------------------------------
int __fastcall Function_21dfd0c(int a1)
{
  int v1;
  int v2;
  int v3;

  v1 = a1;
  v2 = Function_205eb98(a1);
  v3 = Function_205ed6c(0x13u, v2);
  return Function_21e106c(v1, v3);
}

//----- (021DFD28) --------------------------------------------------------
int __fastcall Function_21dfd28(uint *a1)
{
  int v1;
  uint v2;
  int v3;
  int v4;
  int v5;
  int v6;

  v1 = (int)a1;
  v2 = 20;
  if ( Function_205f108(a1) )
  {
    v2 = 27;
  }
  else
  {
    v3 = Function_205eb3c(v1);
    v4 = GetSpriteSpriteListFirstSprite(v3);
    if ( Function_2071cb4(v4, 2) == 1 )
      v2 = 30;
  }
  v5 = Function_205eb98(v1);
  v6 = Function_205ed6c(v2, v5);
  return Function_21e106c(v1, v6);
}

//----- (021DFD68) --------------------------------------------------------
int __fastcall Function_21dfd68(uint *a1)
{
  int v1;
  uint v2;
  int v3;
  int v4;
  int v5;
  int v6;

  v1 = (int)a1;
  v2 = 21;
  if ( Function_205f108(a1) )
  {
    v2 = 26;
  }
  else
  {
    v3 = Function_205eb3c(v1);
    v4 = GetSpriteSpriteListFirstSprite(v3);
    if ( Function_2071cb4(v4, 2) == 1 )
      v2 = 29;
  }
  v5 = Function_205eb98(v1);
  v6 = Function_205ed6c(v2, v5);
  return Function_21e106c(v1, v6);
}

//----- (021DFDA8) --------------------------------------------------------
int __fastcall Function_21dfda8(int a1)
{
  int v1;
  int v2;
  int v3;

  v1 = a1;
  v2 = Function_205eb98(a1);
  v3 = Function_205ed6c(0x16u, v2);
  return Function_21e106c(v1, v3);
}

//----- (021DFDC4) --------------------------------------------------------
int __fastcall Function_21dfdc4(int a1)
{
  int v1;
  int v2;
  int v3;

  v1 = a1;
  v2 = Function_205eb98(a1);
  v3 = Function_205ed6c(0x17u, v2);
  return Function_21e106c(v1, v3);
}

//----- (021DFDE0) --------------------------------------------------------
BOOL __fastcall Function_21dfde0(int a1, uint *a2, uint a3, int a4)
{
  uint *v4;
  int v5;
  uint v6;
  int v7;

  v4 = a2;
  v5 = a1;
  v6 = a3;
  v7 = a4;
  if ( !a2 )
    ErrorHandler();
  if ( !Function_205eb3c((int)v4) )
    ErrorHandler();
  if ( Function_205ef58(v4) == 1 )
    return Function_21e067c(v5, v4, v7) == 1;
  if ( !Function_205f224((int)v4, v6) )
    return 0;
  if ( v6 == -1 )
    return Function_21dfef4(v5, v4, -1, v7) == 1;
  return Function_21dfe68(v5, v4, v6, v7) == 1;
}

//----- (021DFE68) --------------------------------------------------------
BOOL __fastcall Function_21dfe68(int a1, int a2, int a3, char a4)
{
  int v4;
  int v5;
  int v6;
  char v7;
  int v9;

  v4 = a2;
  v5 = a3;
  v6 = a1;
  v7 = a4;
  v9 = Function_2061434(a2, a3);
  if ( v7 & 4 && ((int (__fastcall *)(int, int))dword_224A59C[0])(v6, v5) == 1 )
    return 1;
  if ( v7 & 1 && Function_21dff1c(v6, v4, v5, v9) == 1 )
    return 1;
  if ( v7 & 2 && Function_21e04a8(v6, v4, v5, v9) == 1 )
    return 1;
  if ( Function_21e032c(v6, v4, v5, v9) == 1 )
    return 1;
  return Function_21e04ec(v6, v4, v5, v9) == 1;
}

//----- (021DFEF4) --------------------------------------------------------
BOOL __fastcall Function_21dfef4(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;
  int v6;

  v3 = a2;
  v4 = a3;
  v5 = a1;
  v6 = Function_2061434(a2, a3);
  return Function_21e04ec(v5, v3, v4, v6) == 1;
}

//----- (021DFF1C) --------------------------------------------------------
int __fastcall Function_21dff1c(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v8;
  int v9;

  v4 = a1;
  v5 = a2;
  v6 = a3;
  if ( a4 != 1 )
    return 0;
  v8 = Function_21e10d4(a2, a3);
  v9 = v8;
  if ( !v8 )
    return 0;
  if ( GetSpriteGraphic(v8) != 84 )
    return 0;
  if ( Function_2063ebc(v9, v6) & 0xFFFFFFFE )
  {
    if ( Function_2071cb4(v4, 9) != 1 )
      return 0;
    if ( !((int (__fastcall *)(int, int))dword_224F240[0])(v9, v6) )
      return 0;
  }
  Function_21dff88(v6, v4, v5, v9);
  return 1;
}

//----- (021DFF88) --------------------------------------------------------
int __fastcall Function_21dff88(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  uint *v8;
  int v9;

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v7 = a4;
  v8 = (uint *)Function_21e1110(24);
  v8[1] = v4;
  v8[2] = v5;
  v8[4] = v7;
  v8[3] = v6;
  OverWorldData_InitUnknownStruct01(v5, (int)Function_21dffbc, (int)v8);
  v9 = LoadVariableAreaAdress_14(*(uint *)(v5 + 12));
  return Function_202cf28(v9, 55);
}

//----- (021DFFBC) --------------------------------------------------------
int __fastcall Function_21dffbc(int a1)
{
  int v1;
  uint *v2;
  uint *v3;
  uint *v4;
  int v5;
  int v6;
  int result;

  v1 = a1;
  v2 = (uint *)GetUnknownStruct01_c(a1);
  v3 = (uint *)Function_205eb3c(v2[3]);
  v4 = (uint *)v2[4];
  switch ( (uchar)*v2 )
  {
    case 0u:
      if ( IsSpriteMovable((uint *)v2[4]) && (IsSpriteMovable(v3) || Function_20613ac(v2[3])) )
      {
        v5 = Function_2065838(v2[1], 8);
        Function_2065638(v4, v5);
        v6 = Function_2065838(v2[1], 32);
        Function_2065638(v3, v6);
        Function_2005748(0x627u);
        ++*v2;
      }
      goto LABEL_15;
    case 1u:
      if ( !Function_2065684((uint *)v2[4]) || !Function_2065684(v3) )
        goto LABEL_15;
      if ( Function_2071cb4(v2[2], 9) != 1 || ((int (__fastcall *)(uint *))dword_224F2B0[0])(v4) != 1 )
      {
        Function_20656ac(v4);
        Function_20656ac(v3);
        ++*v2;
LABEL_12:
        Function_21e1134(v2);
        result = 1;
      }
      else
      {
        v2[5] = ((int (__fastcall *)(uint, int, uint *))dword_224F2BC[0])(v2[2], v1, v4);
        *v2 = 3;
LABEL_15:
        result = 0;
      }
      return result;
    case 2u:
      goto LABEL_12;
    case 3u:
      if ( ((int (__fastcall *)(uint))dword_224F6EC[0])(v2[5]) == 1 )
      {
        Function_20656ac(v4);
        Function_20656ac(v3);
        *v2 = 2;
      }
      goto LABEL_15;
    default:
      goto LABEL_15;
  }
}

//----- (021E00B0) --------------------------------------------------------
uint *__fastcall Function_21e00b0(int a1, int a2, int *a3)
{
  int v3;
  int v4;
  int *v5;
  int v6;
  int v7;
  int v8;
  uint *v9;
  int v10;
  int v11;
  int *v12;
  int v13;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = Function_21e1110(44);
  v7 = v6;
  *(uint *)(v6 + 4) = v4;
  *(uint *)(v6 + 28) = v3;
  v8 = *(uint *)(v3 + 60);
  *(uint *)(v7 + 32) = v8;
  *(uint *)(v7 + 36) = Function_205eb3c(v8);
  v9 = (uint *)(v7 + 12);
  v10 = *v5;
  v11 = v5[1];
  v5 += 2;
  *v9 = v10;
  v9[1] = v11;
  v12 = (int *)(v7 + 20);
  v13 = v5[1];
  *v12 = *v5;
  v12[1] = v13;
  return Function_2050944(*(uint *)(v3 + 16), (int)Function_21e0160, v7);
}

//----- (021E00EC) --------------------------------------------------------
uint *__fastcall Function_5_21e00ec(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  char v6;

  v2 = a2;
  v3 = LoadOverWorldDataAdress(a1);
  v4 = Function_21e1140();
  Function_21e1028(v3, v4, &v6);
  return Function_21e00b0(v3, v2, (int *)&v6);
}

//----- (021E0118) --------------------------------------------------------
int __fastcall Function_21e0118(int a1, uchar a2, uchar a3)
{
  uchar v3;
  uchar v4;
  uint *v5;

  v3 = a3;
  v4 = a2;
  v5 = (uint *)Function_205eb3c(a1);
  if ( Function_205db58(v3) != 1 )
    return 0;
  if ( Function_205defc(v4) != 1 && Function_205def0(v4) != 1 || Function_2062f30(v5) != 1 )
    return 1;
  return 0;
}

//----- (021E0160) --------------------------------------------------------
int __fastcall Function_21e0160(int a1, int a2, int a3, int a4)
{
  int v4;
  uint *v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  bool v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int result;
  int v17;
  int v18;
  int v19;
  int v20;
  int v21;
  int v22;
  int v23;
  int v24;
  int v25;
  int v26;

  v26 = a4;
  v4 = GetUnknownStruct01_c(a1);
  v5 = (uint *)v4;
  switch ( (uchar)v4 )
  {
    case 0:
      if ( !Function_205f108(*(uint **)(v4 + 32)) )
      {
        Function_20553f0(v5[7], 0);
        Function_2055554(v5[7], 0x47Fu, 1u);
      }
      if ( v5[3] == 1 )
      {
        Function_21e103c(v5[7], v5 + 3);
        ++*v5;
      }
      else
      {
        *v5 = 2;
      }
      goto LABEL_21;
    case 1:
      if ( Function_21e1050(v4 + 12) == 1 )
        ++*v5;
      goto LABEL_21;
    case 2:
      if ( Function_205f108(*(uint **)(v4 + 32)) )
      {
        v19 = LoadSpritePositionX(v5[9]);
        v18 = LoadSpritePositionZ(v5[9]) / 2;
        v17 = LoadSpritePositionY(v5[9]);
        Function_205f108((uint *)v5[8]);
        Function_2061674((uint *)v5[8], v5[1], &v19, &v18, &v17);
        v8 = v5[1];
        v7 = Function_5_21f85bc(v5[8]);
      }
      else
      {
        GetSpritePositionX(v5[8]);
        GetWalkPositionXChange(v5[1]);
        GetSpritePositionY(v5[8]);
        GetWalkPositionYChange(v5[1]);
        v6 = v5[1];
        v7 = Function_5_21f261c(v5[9]);
      }
      v5[10] = v7;
      Function_205ec00(v5[8], v5[10]);
      Function_205eb58(v5[8], 2);
      ++*v5;
      goto LABEL_21;
    case 3:
      ++*(uint *)v4;
      goto LABEL_14;
    case 4:
LABEL_14:
      if ( IsSpriteMovable(*(uint **)(v4 + 36)) == 1 )
      {
        v20 = 52;
        v21 = 52;
        v22 = 52;
        v23 = 133;
        v24 = 137;
        v25 = 141;
        v9 = Function_205f108((uint *)v5[8]);
        v10 = Function_2065838(v5[1], *(&v20 + v9));
        Function_2065638((uint *)v5[9], v10);
        ++*v5;
      }
      goto LABEL_21;
    case 5:
      if ( !Function_2065684(*(uint **)(v4 + 36)) )
        goto LABEL_21;
      Function_20656ac((uint *)v5[9]);
      v11 = Function_205f108((uint *)v5[8]) == 0;
      v12 = v5[10];
      if ( v11 )
      {
        Function_21f2838(v12, 1);
        v13 = Function_205eb98(v5[8]);
        v15 = Function_205ed6c(2u, v13);
      }
      else
      {
        Function_5_21f88cc(v12, 2);
        v14 = Function_205eb98(v5[8]);
        v15 = Function_205ed6c(0x19u, v14);
      }
      Function_21e106c(v5[8], v15);
      Function_21e1134(v5);
      result = 1;
      break;
    default:
LABEL_21:
      result = 0;
      break;
  }
  return result;
}

//----- (021E032C) --------------------------------------------------------
int __fastcall Function_21e032c(int a1, int a2, uint a3, int a4)
{
  int v4;
  uint *v5;
  uint v6;
  int v8;
  int v9;
  int v10;

  v4 = a1;
  v5 = (uint *)a2;
  v6 = a3;
  if ( a4 != 1 || Function_205eb74(a2) != 2 )
    return 0;
  v8 = Function_205eb3c((int)v5);
  if ( Function_205f158(v5) )
    v10 = Function_20611fc(v5, v8, v6);
  else
    v10 = Function_2060b7c((int)v5, v8, v6, v9);
  if ( v10 == 32 )
    return 0;
  if ( v10 & 0xFFFFFFDF )
    return 0;
  Function_21e0390(v6, v4, v5);
  return 1;
}

//----- (021E0390) --------------------------------------------------------
uint *__fastcall Function_21e0390(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;
  uint *v6;
  int v7;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = (uint *)Function_21e1110(24);
  v7 = (int)v6;
  v6[1] = v3;
  v6[2] = v4;
  v6[3] = v5;
  v6[4] = Function_205eb3c(v5);
  *(uint *)(v7 + 20) = Function_205ec04(v5);
  return OverWorldData_InitUnknownStruct01(v4, (int)Function_21e03c8, v7);
}

//----- (021E03C8) --------------------------------------------------------
int __fastcall Function_21e03c8(int a1, int a2, int a3, int a4)
{
  uint *v4;
  uint *v5;
  int v6;
  int v7;
  bool v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int *v15;
  int v16;
  int v18;
  int v19;
  int v20;
  int v21;
  int v22;
  int v23;
  int v24;

  v24 = a4;
  v4 = (uint *)GetUnknownStruct01_c(a1);
  v5 = v4;
  v6 = *v4;
  if ( !v6 )
  {
    if ( IsSpriteMovable((uint *)v5[4]) == 1 )
    {
      v18 = 52;
      v19 = 52;
      v20 = 52;
      v21 = 133;
      v22 = 137;
      v23 = 141;
      v7 = Function_205f108((uint *)v5[3]);
      v9 = v7;
      v8 = v7 == 0;
      v10 = v5[5];
      if ( v8 )
      {
        Function_21f2838(v10, 0);
        v11 = Function_205eb98(v5[3]);
        v13 = Function_205ed6c(0, v11);
      }
      else
      {
        Function_5_21f88dc(v10, 2);
        v12 = Function_205eb98(v5[3]);
        v13 = Function_205ed6c(0x18u, v12);
      }
      Function_21e106c(v5[3], v13);
      v14 = Function_2065838(v5[1], *(&v18 + v9));
      Function_2065638((uint *)v5[4], v14);
      ++*v5;
    }
    return 0;
  }
  if ( v6 != 1 || !Function_2065684((uint *)v5[4]) )
    return 0;
  Function_20656ac((uint *)v5[4]);
  v15 = (int *)v5[5];
  if ( v15 )
    Function_5_21df74c(v15);
  Function_205ec00(v5[3], 0);
  Function_205eb58(v5[3], 0);
  v16 = Function_20554a4(v5[2], **(uint **)(v5[2] + 28));
  Function_2055554(v5[2], v16, 1u);
  Function_21e1134(v5);
  return 1;
}

//----- (021E04A8) --------------------------------------------------------
int __fastcall Function_21e04a8(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  uchar v8;

  v4 = a3;
  v5 = a1;
  v6 = a2;
  if ( a3 != 1 || a4 != 1 || Function_205eb74(a2) != 2 )
    return 0;
  v8 = Function_206156c(v6, v4);
  if ( !Function_205ddb4(v8) )
    return 0;
  Function_21e097c(v5, v4);
  return 1;
}

//----- (021E04EC) --------------------------------------------------------
int __fastcall Function_21e04ec(int a1, uint *a2)
{
  int v2;
  int v3;
  int v5;
  int v6;

  v2 = (int)a2;
  v3 = a1;
  if ( Function_205f008(a2) == 1 )
    return 0;
  v5 = Function_205eb3c(v2);
  v6 = (uchar)Function_2062be8(v5);
  if ( Function_205dcf0(v6) != 1 && Function_205dd0c(v6) != 1 )
    return 0;
  Function_21e0534(v3, v2);
  return 1;
}

//----- (021E0534) --------------------------------------------------------
int __fastcall Function_21e0534(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;

  v2 = a1;
  v3 = a2;
  v4 = Function_21e1110(16);
  *(uint *)(v4 + 8) = v2;
  *(uint *)(v4 + 12) = v3;
  OverWorldData_InitUnknownStruct01(v2, (int)Function_21e0560, v4);
  v5 = LoadVariableAreaAdress_14(*(uint *)(v2 + 12));
  return Function_202cf28(v5, 56);
}

//----- (021E0560) --------------------------------------------------------
int __fastcall Function_21e0560(int a1)
{
  uint *v1;
  int *v2;
  uint *v3;
  int v4;
  int v6;
  uchar v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int *v12;

  v1 = (uint *)a1;
  v2 = (int *)GetUnknownStruct01_c(a1);
  v3 = (uint *)Function_205eb3c(v2[3]);
  v4 = *v2;
  if ( *v2 )
  {
    if ( v4 != 1 )
    {
      if ( v4 != 2 )
        return 0;
      goto LABEL_11;
    }
  }
  else
  {
    Function_2005748(0x651u);
    ++*v2;
  }
  if ( !IsSpriteMovable(v3) && !Function_20613ac(v2[3]) )
    return 0;
  if ( v2[1] >= 5 )
  {
    Function_2005748(0x652u);
    Function_205eff0((uint *)v2[3], 1);
    Function_21e1134(v2);
    return 1;
  }
  ++*v2;
LABEL_11:
  v10 = GetSpriteFaceDirection(v2[3]);
  v6 = Function_2061308(v2[3], (ushort)dword_21BF6C4, dword_21BF6C0);
  if ( v6 != -1 && v6 != v10 )
  {
    *v2 = 1;
    ++v2[1];
    v7 = Function_2062be8((int)v3);
    if ( Function_205dd0c(v7) == 1 )
    {
      v11 = LoadOverWorldDataAdress((int)v1);
      if ( ((int (*)(void))dword_22413E4[0])() == 1 )
      {
        Function_205eff0((uint *)v2[3], 1);
        Function_21e1134(v2);
        Function_2050e78(v11, v1, v12);
        return 0;
      }
    }
    if ( v2[1] >= 5 )
    {
      v8 = 48;
      Function_2062ee0(v3, 1);
    }
    else
    {
      v8 = 40;
    }
    v9 = Function_2065838(v6, v8);
    Function_2061550(v2[3], v9, 1);
  }
  return 0;
}

//----- (021E067C) --------------------------------------------------------
BOOL __fastcall Function_21e067c(int a1, int a2)
{
  int v2;
  int v3;
  uint *v4;
  BOOL result;

  v2 = a2;
  v3 = a1;
  v4 = (uint *)Function_205eb3c(a2);
  if ( IsSpriteMovable(v4) )
    result = Function_21e06a8(v3, v2) == 1;
  else
    result = 0;
  return result;
}

//----- (021E06A8) --------------------------------------------------------
int __fastcall Function_21e06a8(int a1, int a2)
{
  int v2;
  int v4;
  int v5;
  int v6;

  v2 = a2;
  if ( Function_205ebb8(a2) < 1 )
    return 0;
  v4 = Function_205ea94(v2);
  v5 = Function_21e10d4(v2, v4);
  v6 = v5;
  if ( !v5 )
    return 0;
  if ( GetSpriteGraphic(v5) == 118 )
  {
    Function_21ec7f0(v6);
    Function_2061af4(v6);
    Function_2005748(0x65Bu);
  }
  return 0;
}

//----- (021E06F8) --------------------------------------------------------
uint *__fastcall Function_21e06f8(int a1, int a2, int *a3)
{
  int v3;
  int v4;
  int *v5;
  int v6;
  int v7;
  int v8;
  uint *v9;
  int v10;
  int v11;
  int *v12;
  int v13;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = Function_21e1110(48);
  v7 = v6;
  *(uint *)(v6 + 4) = v4;
  *(uint *)(v6 + 12) = v3;
  v8 = *(uint *)(v3 + 60);
  *(uint *)(v7 + 16) = v8;
  *(uint *)(v7 + 20) = Function_205eb3c(v8);
  v9 = (uint *)(v7 + 28);
  v10 = *v5;
  v11 = v5[1];
  v5 += 2;
  *v9 = v10;
  v9[1] = v11;
  v12 = (int *)(v7 + 36);
  v13 = v5[1];
  *v12 = *v5;
  v12[1] = v13;
  return Function_2050944(*(uint *)(v3 + 16), (int)Function_21e07a0, v7);
}

//----- (021E0734) --------------------------------------------------------
uint *__fastcall Function_5_21e0734(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  char v6;

  v2 = a2;
  v3 = LoadOverWorldDataAdress(a1);
  v4 = Function_21e1140();
  Function_21e1028(v3, v4, &v6);
  return Function_21e06f8(v3, v2, (int *)&v6);
}

//----- (021E0760) --------------------------------------------------------
int __fastcall Function_21e0760(uchar a1, char a2)
{
  int result;

  switch ( a2 )
  {
    case 0:
    case 1:
      if ( Function_205dc68(a1) != 1 )
        goto LABEL_6;
      result = 1;
      break;
    case 2:
    case 3:
      if ( Function_205dc74(a1) != 1 )
        goto LABEL_6;
      result = 1;
      break;
    default:
LABEL_6:
      result = 0;
      break;
  }
  return result;
}

//----- (021E07A0) --------------------------------------------------------
int __fastcall Function_21e07a0(int a1)
{
  uint *v1;
  int v2;
  int v3;

  v1 = (uint *)GetUnknownStruct01_c(a1);
  do
  {
    v2 = ((int (__fastcall *)(uint *))*(&off_21F9B54 + *v1))(v1);
    v3 = v2;
  }
  while ( v2 == 2 );
  if ( v2 == 1 )
    Function_21e1134(v1);
  return v3;
}

//----- (021E07CC) --------------------------------------------------------
int __fastcall Function_21e07cc(uint *a1)
{
  uint *v1;

  v1 = a1;
  Function_21e103c(a1[3], a1 + 7);
  ++*v1;
  return 0;
}

//----- (021E07E4) --------------------------------------------------------
int __fastcall Function_21e07e4(uint *a1)
{
  uint *v1;

  v1 = a1;
  if ( Function_21e1050(a1 + 7) == 1 )
    ++*v1;
  return 0;
}

//----- (021E07FC) --------------------------------------------------------
int __fastcall Function_21e07fc(uint *a1)
{
  uint *v1;
  int v2;
  int v3;
  int v4;
  int v5;

  v1 = a1;
  v2 = GetSpritePositionX(a1[4]);
  v3 = GetWalkPositionXChange(v1[1]);
  v4 = GetSpritePositionY(v1[4]);
  v5 = GetWalkPositionYChange(v1[1]);
  v1[6] = Function_21f28f4(v1[5], v2 + v3, v4 + v5, v1[1]);
  v1[11] = ((int (__fastcall *)(uint))dword_2248408[329])(v1[3]);
  Function_2005748(0x627u);
  ++*v1;
  return 0;
}

//----- (021E0850) --------------------------------------------------------
int __fastcall Function_21e0850(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  if ( IsSpriteMovable(*(uint **)(a1 + 20)) == 1 )
  {
    v2 = Function_2065838(*(uint *)(v1 + 4), 52);
    Function_2065638(*(uint **)(v1 + 20), v2);
    ++*(uint *)v1;
  }
  return 0;
}

//----- (021E0878) --------------------------------------------------------
int __fastcall Function_21e0878(int a1)
{
  uint *v1;

  v1 = (uint *)a1;
  if ( Function_2065684(*(uint **)(a1 + 20)) == 1 )
  {
    ++*v1;
    Function_21f2974(v1[6], 1);
  }
  return 0;
}

//----- (021E0898) --------------------------------------------------------
int __fastcall Function_21e0898(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  if ( IsSpriteMovable(*(uint **)(a1 + 20)) == 1 )
  {
    v2 = Function_2065838(*(uint *)(v1 + 4), 16);
    Function_2065638(*(uint **)(v1 + 20), v2);
    ++*(uint *)v1;
  }
  return 0;
}

//----- (021E08C0) --------------------------------------------------------
int __fastcall Function_21e08c0(int a1)
{
  uint *v1;
  int result;
  int v3;
  char v4;
  uchar v5;
  int v6;

  v1 = (uint *)a1;
  if ( !Function_2065684(*(uint **)(a1 + 20)) )
    return 0;
  v3 = LoadSpriteFace2Direction(v1[5]);
  v4 = v3;
  v5 = Function_2064238(v1[5], v3);
  if ( Function_21e0760(v5, v4) == 1 )
  {
    *v1 = 5;
    result = 2;
  }
  else
  {
    v6 = Function_2065838(v1[1], 52);
    Function_2065638((uint *)v1[5], v6);
    v1[2] = 0;
    ++*v1;
    Function_21f2974(v1[6], 0);
    ((void (__fastcall *)(uint))dword_2248408[334])(v1[11]);
    result = 0;
    v1[11] = 0;
  }
  return result;
}

//----- (021E0924) --------------------------------------------------------
int __fastcall Function_21e0924(int a1)
{
  int v1;

  v1 = a1;
  if ( !Function_2065684(*(uint **)(a1 + 20)) )
    return 0;
  Function_20656ac(*(uint **)(v1 + 20));
  Function_5_21df74c(*(int **)(v1 + 24));
  return 1;
}

//----- (021E0948) --------------------------------------------------------
uint *__fastcall Function_21e0948(int a1, int a2, int *a3)
{
  int v3;
  int v4;
  int *v5;
  uint *v6;
  uint *v7;
  int v8;
  uint *v9;
  int v10;
  uint *v11;
  int v12;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = (uint *)Function_21e1110(84);
  v6[1] = v4;
  v6[13] = v3;
  v6[14] = *(uint *)(v3 + 60);
  v6[15] = Function_205eb3c(*(uint *)(v3 + 60));
  if ( v5 )
  {
    v7 = v6 + 16;
    v8 = *v5;
    v10 = v5[1];
    v9 = v5 + 2;
    *v7 = v8;
    v7[1] = v10;
    v11 = v6 + 18;
    v12 = v9[1];
    *v11 = *v9;
    v11[1] = v12;
  }
  return v6;
}

//----- (021E097C) --------------------------------------------------------
uint *__fastcall Function_21e097c(int a1, int a2)
{
  int v2;
  uint *v3;

  v2 = a1;
  v3 = Function_21e0948(a1, a2, 0);
  return OverWorldData_InitUnknownStruct01(v2, (int)Function_21e09d4, (int)v3);
}

//----- (021E0998) --------------------------------------------------------
uint *__fastcall Function_5_21e0998(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  uint *v8;
  char v10;
  int v11;

  v11 = a4;
  v4 = a1;
  v5 = a2;
  v6 = LoadOverWorldDataAdress(a1);
  v7 = Function_21e1140();
  Function_21e1028(v6, v7, &v10);
  v8 = Function_21e0948(v6, v5, (int *)&v10);
  return Function_2050944(v4, (int)Function_21e09d4, (int)v8);
}

//----- (021E09D4) --------------------------------------------------------
int __fastcall Function_21e09d4(int a1)
{
  uint *v1;
  int v2;

  v1 = (uint *)GetUnknownStruct01_c(a1);
  do
  {
    if ( v1[1] )
      v2 = ((int (__fastcall *)(uint *))*(&off_21F9AFC + *v1))(v1);
    else
      v2 = ((int (__fastcall *)(uint *))*(&off_21F9B10 + *v1))(v1);
  }
  while ( v2 == 2 );
  if ( v2 != 1 )
    return 0;
  Function_21e1134(v1);
  return 1;
}

//----- (021E0A1C) --------------------------------------------------------
int __fastcall Function_21e0a1c(uint *a1)
{
  uint *v1;
  int result;

  v1 = a1;
  if ( a1[16] == 1 )
  {
    Function_21e103c(a1[13], a1 + 16);
    ++*v1;
    result = 0;
  }
  else
  {
    *a1 = 2;
    result = 1;
  }
  return result;
}

//----- (021E0A44) --------------------------------------------------------
int __fastcall Function_21e0a44(uint *a1)
{
  uint *v1;

  v1 = a1;
  if ( Function_21e1050(a1 + 16) == 1 )
  {
    Function_2005748(0x64Du);
    ++*v1;
  }
  return 0;
}

//----- (021E0A68) --------------------------------------------------------
int __fastcall Function_21e0a68(uint *a1)
{
  uint *v1;
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;
  uint *v7;
  int v9;
  char v10;
  int v11;
  int v12;

  v1 = a1;
  v2 = LoadSpritePositionX(a1[15]);
  v3 = v2 + 2 * GetWalkPositionXChange(0);
  v4 = LoadSpritePositionY(v1[15]);
  v5 = v4 + 2 * GetWalkPositionYChange(0);
  Function_2064450(v3, v5, v1 + 10);
  Function_20644a4(v1[13], v1 + 10);
  v1[3] = v3;
  v1[4] = (v1[11] >> 3) / 4096;
  v1[5] = v5;
  CopySprite70Struct((uint *)v1[15], &v10);
  if ( v12 <= v1[12] )
    ErrorHandler();
  if ( v11 >= v1[11] )
    ErrorHandler();
  v6 = (v1[11] - v11) / 64;
  v9 = (v1[12] - v12) / 64;
  v7 = v1 + 7;
  *v7 = 0;
  v7[1] = v6;
  v1[9] = v9;
  v1[20] = ((int (__fastcall *)(uint))dword_2248408[123])(v1[13]);
  ++*v1;
  return 0;
}

//----- (021E0B24) --------------------------------------------------------
int __fastcall Function_21e0b24(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v7;
  int v8;
  int v9;

  v9 = a4;
  v4 = a1;
  CopySprite70Struct(*(uint **)(a1 + 60), &v7);
  v8 += *(uint *)(v4 + 32);
  if ( v8 > *(uint *)(v4 + 44) )
    v8 = *(uint *)(v4 + 44);
  CopyToSprite70Struct(*(uint **)(v4 + 60), &v7);
  v5 = *(uint *)(v4 + 8) + 1;
  *(uint *)(v4 + 8) = v5;
  if ( v5 >= 32 )
  {
    *(uint *)(v4 + 8) = 0;
    ++*(uint *)v4;
  }
  return 0;
}

//----- (021E0B64) --------------------------------------------------------
int __fastcall Function_21e0b64(int a1, int a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int v7;
  int v8;
  int v9;
  int v10;

  v10 = a4;
  v4 = (uint *)a1;
  CopySprite70Struct(*(uint **)(a1 + 60), &v7);
  v8 += v4[8];
  if ( v8 > v4[11] )
    v8 = v4[11];
  v9 += v4[9];
  if ( v9 < v4[12] )
    v9 = v4[12];
  CopyToSprite70Struct((uint *)v4[15], &v7);
  v5 = v4[2] + 1;
  v4[2] = v5;
  if ( v5 < 64 )
    return 0;
  if ( v9 != v4[12] )
    ErrorHandler();
  if ( v8 != v4[11] )
    ErrorHandler();
  SaveSpritePositionX(v4[15], v4[3]);
  SaveSpritePositionZ(v4[15], v4[4]);
  SaveSpritePositionY(v4[15], v4[5]);
  CopySpritePositionsFromOldToNew(v4[15]);
  ((void (__fastcall *)(uint))dword_2248408[128])(v4[20]);
  return 1;
}

//----- (021E0BEC) --------------------------------------------------------
int __fastcall Function_21e0bec(uint *a1)
{
  uint *v1;
  int result;

  v1 = a1;
  if ( a1[16] == 1 )
  {
    Function_21e103c(a1[13], a1 + 16);
    ++*v1;
    result = 0;
  }
  else
  {
    result = 2;
    *v1 = 2;
  }
  return result;
}

//----- (021E0C10) --------------------------------------------------------
int __fastcall Function_21e0c10(uint *a1)
{
  uint *v1;

  v1 = a1;
  if ( Function_21e1050(a1 + 16) == 1 )
  {
    Function_2005748(0x64Du);
    ++*v1;
  }
  return 0;
}

//----- (021E0C34) --------------------------------------------------------
int __fastcall Function_21e0c34(uint *a1)
{
  uint *v1;
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;
  uint *v7;
  int v9;
  char v10;
  int v11;
  int v12;

  v1 = a1;
  v2 = LoadSpritePositionX(a1[15]);
  v3 = v2 + 2 * GetWalkPositionXChange(1);
  v4 = LoadSpritePositionY(v1[15]);
  v5 = v4 + 2 * GetWalkPositionYChange(1);
  Function_2064450(v3, v5, v1 + 10);
  Function_20644a4(v1[13], v1 + 10);
  v1[6] = 0;
  v1[3] = v3;
  v1[4] = (v1[11] >> 3) / 4096;
  v1[5] = v5;
  CopySprite70Struct((uint *)v1[15], &v10);
  if ( v12 >= v1[12] )
    ErrorHandler();
  if ( v11 <= v1[11] )
    ErrorHandler();
  v6 = (v1[11] - v11) / 64;
  v9 = (v1[12] - v12) / 64;
  v7 = v1 + 7;
  *v7 = 0;
  v7[1] = v6;
  v1[9] = v9;
  v1[20] = ((int (__fastcall *)(uint))dword_2248408[123])(v1[13]);
  ++*v1;
  return 0;
}

//----- (021E0CF4) --------------------------------------------------------
int __fastcall Function_21e0cf4(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v7[2];
  int v8;
  int v9;

  v9 = a4;
  v4 = a1;
  CopySprite70Struct(*(uint **)(a1 + 60), v7);
  v8 += *(uint *)(v4 + 36);
  if ( v8 <= *(uint *)(v4 + 48) )
    *(uint *)(v4 + 24) += *(uint *)(v4 + 36);
  else
    v8 = *(uint *)(v4 + 48);
  CopyToSprite70Struct(*(uint **)(v4 + 60), v7);
  v5 = *(uint *)(v4 + 8) + 1;
  *(uint *)(v4 + 8) = v5;
  if ( v5 >= 32 )
  {
    *(uint *)(v4 + 8) = 0;
    ++*(uint *)v4;
  }
  return 0;
}

//----- (021E0D40) --------------------------------------------------------
int __fastcall Function_21e0d40(int a1, int a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int v7;
  int v8;
  int v9;
  int v10;

  v10 = a4;
  v4 = (uint *)a1;
  CopySprite70Struct(*(uint **)(a1 + 60), &v7);
  v8 += v4[8];
  if ( v8 < v4[11] )
    v8 = v4[11];
  v9 += v4[9];
  if ( v9 <= v4[12] )
    v4[6] += v4[9];
  else
    v9 = v4[12];
  CopyToSprite70Struct((uint *)v4[15], &v7);
  v5 = v4[2] + 1;
  v4[2] = v5;
  if ( v5 < 64 )
    return 0;
  if ( v9 != v4[12] )
    ErrorHandler();
  if ( v8 != v4[11] )
    ErrorHandler();
  SaveSpritePositionX(v4[15], v4[3]);
  SaveSpritePositionZ(v4[15], v4[4]);
  SaveSpritePositionY(v4[15], v4[5]);
  CopySpritePositionsFromOldToNew(v4[15]);
  ((void (__fastcall *)(uint))dword_2248408[128])(v4[20]);
  return 1;
}

//----- (021E0DD4) --------------------------------------------------------
int __fastcall Function_5_21e0dd4(int a1)
{
  int v1;

  v1 = LoadOverWorldDataAdress(a1);
  return Function_21e0de0(v1);
}

//----- (021E0DE0) --------------------------------------------------------
uint *__fastcall Function_21e0de0(int a1)
{
  int v1;
  int *v2;
  int *v3;
  int v4;

  v1 = a1;
  v2 = (int *)Function_21e1110(24);
  v3 = v2;
  *v2 = v1;
  v4 = *(uint *)(v1 + 60);
  v3[1] = v4;
  v3[2] = Function_205eb3c(v4);
  v3[4] = Function_205eb98(v3[1]);
  return Function_2050944(*(uint *)(v1 + 16), (int)Function_21e0e10, (int)v3);
}

//----- (021E0E10) --------------------------------------------------------
int __fastcall Function_21e0e10(int a1)
{
  int v1;
  uint *v2;
  int v3;
  int v4;

  v1 = GetUnknownStruct01_c(a1);
  v2 = (uint *)v1;
  v3 = *(uint *)(v1 + 12);
  if ( v3 )
  {
    if ( v3 == 1 )
    {
      if ( Function_206574c(v2[5]) == 1 )
      {
        v4 = Function_205ed6c(0x12u, v2[4]);
        Function_21e106c(v2[1], v4);
        Function_2065758(v2[5]);
        v2[5] = Malloc_MovementScript(v2[2], (int)dword_21F9C00);
        ++v2[3];
      }
    }
    else if ( v3 == 2 && Function_206574c(v2[5]) == 1 )
    {
      Function_2065758(v2[5]);
      Function_21e1134(v2);
      return 1;
    }
  }
  else
  {
    v2[5] = Malloc_MovementScript(v2[2], (int)dword_21F9B9C);
    ++v2[3];
  }
  return 0;
}

//----- (021E0E94) --------------------------------------------------------
uint __fastcall Function_5_21e0e94(int a1)
{
  int v1;
  int v2;
  int v3;
  uint result;
  int v5;

  v1 = a1;
  v2 = Function_205eb3c(a1);
  v3 = v2;
  result = Function_2062dfc(v2);
  if ( result )
  {
    result = Function_205eb74(v1);
    if ( !result )
    {
      result = GetSpriteGraphic(v3);
      if ( result != 196 && result != 197 )
      {
        result -= 270;
        if ( result > 1 )
        {
          v5 = Function_205eb90(v1);
          Function_5_21dfb54(v1, 64);
          Function_5_21dfb5c(v1);
          result = Function_5_21dfb54(v1, v5);
        }
      }
    }
  }
  return result;
}

//----- (021E0EEC) --------------------------------------------------------
int __fastcall Function_5_21e0eec(int a1)
{
  int v1;
  int v2;
  int v3;
  int result;
  int v5;

  v1 = a1;
  v2 = Function_205eb3c(a1);
  v3 = v2;
  result = Function_2062dfc(v2);
  if ( result )
  {
    result = Function_205eb74(v1);
    if ( !result )
    {
      result = GetSpriteGraphic(v3);
      if ( result == 196 || result == 197 || result == 270 || result == 271 || result == 274 || result == 275 )
      {
        v5 = Function_205eb90(v1);
        Function_5_21dfb54(v1, 1);
        Function_5_21dfb5c(v1);
        result = Function_5_21dfb54(v1, v5);
      }
    }
  }
  return result;
}

//----- (021E0F54) --------------------------------------------------------
uint *__fastcall Function_21e0f54(int a1, int a2)
{
  int v2;
  int v3;
  uint *v5;
  uint *v6;
  uint *v7;
  int v8;

  v2 = a1;
  v3 = *(uint *)(a1 + 60);
  v8 = a2;
  if ( Function_205eb74(*(uint *)(a1 + 60)) )
    return 0;
  v5 = (uint *)Function_205eb3c(v3);
  v6 = (uint *)malloc2(4u, 16);
  *v6 = 0;
  v6[2] = v2;
  v6[3] = v3;
  v6[1] = 0;
  UnsetSpriteFlag_Lock(v5);
  Function_5_21dfb54(v3, v8);
  Function_5_21dfb5c(v3);
  v7 = AddTaskToTaskList1((int)Function_21e0ff0, (int)v6, 0xFFFFu);
  if ( !v7 )
    ErrorHandler();
  return v7;
}

//----- (021E0FC0) --------------------------------------------------------
int __fastcall Function_21e0fc0(int result)
{
  int *v1;
  int v2;
  int v3;
  uint *v4;
  int v5;

  v1 = (int *)result;
  if ( result )
  {
    v2 = Function_201ced0(result);
    v3 = v2;
    v4 = *(uint **)(v2 + 12);
    v5 = Function_205eb98(*(uint *)(v2 + 12));
    Function_205ed6c(0, v5);
    Function_21dfb90(v4);
    free(v3);
    result = Call_RemoveTaskFromTaskList(v1);
  }
  return result;
}

//----- (021E0FF0) --------------------------------------------------------
int __fastcall Function_21e0ff0(int a1, int a2)
{
  int v2;

  v2 = Function_205eb3c(*(uint *)(a2 + 12));
  return Function_2062b68(v2);
}

//----- (021E1000) --------------------------------------------------------
uint *__fastcall Function_5_21e1000(int a1)
{
  return Function_21e0f54(a1, 128);
}

//----- (021E100C) --------------------------------------------------------
int __fastcall Function_5_21e100c(int result)
{
  return Function_21e0fc0(result);
}

//----- (021E1014) --------------------------------------------------------
uint *__fastcall Function_21e1014(int a1)
{
  return Function_21e0f54(a1, 512);
}

//----- (021E1020) --------------------------------------------------------
int __fastcall Function_21e1020(int result)
{
  return Function_21e0fc0(result);
}

//----- (021E1028) --------------------------------------------------------
int __fastcall Function_21e1028(int a1, int a2, uint *a3)
{
  uint *v3;
  int result;

  v3 = a3;
  *a3 = 1;
  a3[2] = a2;
  result = Function_205eb98(*(uint *)(a1 + 60));
  v3[1] = result;
  return result;
}

//----- (021E103C) --------------------------------------------------------
int __fastcall Function_21e103c(int a1, int a2)
{
  int v2;
  int result;

  v2 = a2;
  result = ((int (__fastcall *)(int, uint, uint, uint))dword_2243F88[0])(
             a1,
             0,
             *(uint *)(a2 + 8),
             *(uint *)(a2 + 4));
  *(uint *)(v2 + 12) = result;
  return result;
}

//----- (021E1050) --------------------------------------------------------
int __fastcall Function_21e1050(int a1)
{
  int v1;

  v1 = a1;
  if ( ((int (__fastcall *)(uint))dword_2243FBC[0])(*(uint *)(a1 + 12)) != 1 )
    return 0;
  ((void (__fastcall *)(uint))dword_2243FC8[0])(*(uint *)(v1 + 12));
  return 1;
}

//----- (021E106C) --------------------------------------------------------
int __fastcall Function_21e106c(int a1, int a2)
{
  uint *v2;
  int v3;
  int v4;
  int result;
  int v6;
  int v7;

  v2 = (uint *)a1;
  v3 = a2;
  v4 = Function_205eb3c(a1);
  if ( !Function_205f108(v2) )
    return Function_21ee3fc(v4, v3, 0, 0);
  v6 = GetSpriteSpriteListFirstSprite(v4);
  v7 = ((int (*)(void))dword_224A520[0])();
  result = Function_21ee3fc(v4, v3, Function_21e10c0, v2);
  if ( result )
    result = ((int (__fastcall *)(int, int, int))dword_224A558[0])(v6, result, v7);
  return result;
}

//----- (021E10C0) --------------------------------------------------------
int __fastcall Function_21e10c0(int a1, int a2)
{
  int v2;
  int v3;
  int v4;

  v2 = a2;
  v3 = Function_205eb3c(a1);
  v4 = GetSpriteSpriteListFirstSprite(v3);
  return ((int (__fastcall *)(int, int))dword_224A564[0])(v4, v2);
}

//----- (021E10D4) --------------------------------------------------------
uint *__fastcall Function_21e10d4(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;

  v2 = a2;
  v3 = a1;
  v4 = GetSpritePositionX(a1);
  v5 = GetWalkPositionXChange(v2);
  v6 = GetSpritePositionY(v3);
  v7 = GetWalkPositionYChange(v2);
  v8 = Function_205eb3c(v3);
  v9 = GetSpriteSpriteList(v8);
  return Function_206326c(v9, v4 + v5, v6 + v7, 0);
}

//----- (021E1110) --------------------------------------------------------
int *__fastcall Function_21e1110(int a1)
{
  uint v1;
  int *v2;

  v1 = a1;
  v2 = (int *)malloc2(4u, a1);
  if ( !v2 )
    ErrorHandler();
  Call_FillMemWithValue(v2, 0, v1);
  return v2;
}

//----- (021E1134) --------------------------------------------------------
uint __fastcall Function_21e1134(int a1)
{
  return Function_2018238(4u, a1);
}

//----- (021E1140) --------------------------------------------------------
int *__fastcall Function_21e1140(int a1, int a2)
{
  int v2;
  uint *v3;

  v2 = a2;
  v3 = (uint *)LoadPokePartyAdress(*(uint *)(a1 + 12));
  return GetAdrOfPkmnInParty(v3, v2);
}

//----- (021E1154) --------------------------------------------------------
int __fastcall Function_21e1154(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;

  v2 = a2;
  v3 = a1;
  v4 = Function_205eb3c(a2);
  v5 = (uchar)Function_2062be8(v4);
  if ( Function_205deb4(v5) == 1 )
  {
    v6 = 3;
  }
  else if ( Function_205dec0(v5) == 1 )
  {
    v6 = 2;
  }
  else if ( Function_205decc(v5) == 1 )
  {
    v6 = 0;
  }
  else
  {
    if ( Function_205ded8(v5) != 1 )
      return 0;
    v6 = 1;
  }
  Function_21e11b0(v3, v2, v6);
  return 1;
}

//----- (021E11B0) --------------------------------------------------------
uint *__fastcall Function_21e11b0(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;
  uint *v6;
  int v7;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = (uint *)Function_21e132c(24);
  v7 = (int)v6;
  v6[3] = v3;
  v6[4] = v4;
  *v6 = v5;
  Function_2005748(0x658u);
  return OverWorldData_InitUnknownStruct01(v3, (int)Function_21e120c, v7);
}

//----- (021E11E0) --------------------------------------------------------
int __fastcall Function_21e11e0(char a1)
{
  int result;

  switch ( a1 )
  {
    case 0:
      result = 2;
      break;
    case 1:
      result = 3;
      break;
    case 2:
      result = 1;
      break;
    case 3:
      result = 0;
      break;
    default:
      result = 0;
      break;
  }
  return result;
}

//----- (021E120C) --------------------------------------------------------
int __fastcall Function_21e120c(int a1)
{
  int *v1;
  uint *v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;

  v1 = (int *)GetUnknownStruct01_c(a1);
  v2 = (uint *)Function_205eb3c(v1[4]);
  v3 = (uchar)Function_2062be8((int)v2);
  v4 = v1[2];
  if ( v4 )
  {
    if ( v4 == 1 )
    {
      if ( Function_2061544(v1[4]) )
      {
        v5 = Function_2065838(*v1, 12);
        Function_2061550(v1[4], v5, 1);
        Function_205ea84(v1[4], *v1);
        ++v1[2];
        v1[1] = 7;
      }
    }
    else if ( v4 == 2 )
    {
      v6 = v1[1];
      if ( v6 == 2 || v6 == 4 || v6 == 6 )
      {
        *v1 = Function_21e11e0(*v1);
        Function_205ea84(v1[4], *v1);
      }
      v7 = v1[1] - 1;
      v1[1] = v7;
      if ( !v7 )
      {
        if ( Function_205deb4(v3) == 1 )
        {
          *v1 = 3;
        }
        else if ( Function_205dec0(v3) == 1 )
        {
          *v1 = 2;
        }
        else if ( Function_205decc(v3) == 1 )
        {
          *v1 = 0;
        }
        else if ( Function_205ded8(v3) == 1 )
        {
          *v1 = 1;
        }
        else
        {
          *v1 = Function_21e11e0(*v1);
        }
        if ( Function_2060b7c(v1[4], (int)v2, *v1, v8) )
        {
          UnsetSpriteFlags(v2, 128);
          UnsetSpriteFlags(v2, 256);
          Function_205ea84(v1[4], *v1);
          Function_21e1350(v1);
          Function_20057a4(1624, 0);
          return 1;
        }
        v1[2] = 1;
      }
    }
  }
  else
  {
    SetSpriteFlags(v2, 256);
    ++v1[2];
  }
  return 0;
}

//----- (021E132C) --------------------------------------------------------
int *__fastcall Function_21e132c(int a1)
{
  uint v1;
  int *v2;

  v1 = a1;
  v2 = (int *)malloc2(4u, a1);
  if ( !v2 )
    ErrorHandler();
  Call_FillMemWithValue(v2, 0, v1);
  return v2;
}

//----- (021E1350) --------------------------------------------------------
uint __fastcall Function_21e1350(int a1)
{
  return Function_2018238(4u, a1);
}

//----- (021E135C) --------------------------------------------------------
int __fastcall Function_21e135c(int *a1)
{
  switch ( (uchar)a1[4] )
  {
    case 0u:
      a1[4] = 2;
      break;
    case 1u:
      a1[4] = 3;
      break;
    case 2u:
      a1[4] = 1;
      break;
    case 3u:
      a1[4] = 0;
      break;
    default:
      return Function_205ea84(*(uint *)(*a1 + 60), a1[4]);
  }
  return Function_205ea84(*(uint *)(*a1 + 60), a1[4]);
}

//----- (021E139C) --------------------------------------------------------
int *__fastcall Function_21e139c(int *a1, int a2)
{
  int v2;
  int *v3;
  uint *v4;
  int *result;
  int v6;
  uint v7;
  uint v8;
  uint v9;
  long long v10;
  long long v11;
  int v12;
  int v13;
  int v14;
  uint v15;

  v2 = a2;
  v3 = a1;
  v4 = (uint *)Function_205eb3c(*(uint *)(*(uint *)a2 + 60));
  result = *(int **)(v2 + 8);
  if ( result )
  {
    if ( result != (int *)1 )
      return result;
  }
  else
  {
    *(uint *)(v2 + 8) = 1;
    Function_2005748(0x64Fu);
  }
  if ( (*(uint *)(v2 + 12) >> 31) + __ROR4__((*(uint *)(v2 + 12) << 31) - (*(uint *)(v2 + 12) >> 31), 31) )
    Function_21e135c((int *)v2);
  Function_206309c(v4, &v14);
  v6 = *(uint *)(v2 + 12);
  v7 = dflt(*(uint *)(v2 + 12));
  v9 = v8;
  LODWORD(v10) = dflt(v6 << 11);
  LODWORD(v11) = dadd(4666179573918570906LL, v10);
  v12 = dmul(__PAIR__(v9, v7), v11);
  v15 = dfix(v12, v13);
  Function_20630ac(v4, &v14);
  result = (int *)(*(uint *)(v2 + 12) + 1);
  *(uint *)(v2 + 12) = result;
  if ( result == (int *)20 )
    return Function_200f174(2u, 0, 0, 0, 6, 1, 4);
  if ( (int)result > 20 )
  {
    result = (int *)Function_200f2ac();
    if ( result )
    {
      **(uint **)(v2 + 4) = 1;
      free(v2);
      result = (int *)Call_RemoveTaskFromTaskList(v3);
    }
  }
  return result;
}

//----- (021E1470) --------------------------------------------------------
uint *__fastcall Function_21e1470(int *a1, int *a2, int a3, int a4)
{
  int *v4;
  int *v5;
  uint *result;
  int v7;
  uint *v8;
  uint v9;
  uint v10;
  uint v11;
  uint v12;
  long long v13;
  long long v14;
  int v15;
  int v16;
  uint v17;
  uint v18;
  uint v19;
  uint v20;
  long long v21;
  long long v22;
  int v23;
  int v24;
  int v25;
  int v26;
  uint v27;
  int v28;

  v28 = a4;
  v4 = a2;
  v5 = a1;
  result = (uint *)Function_205eb3c(*(uint *)(*a2 + 60));
  v7 = v4[2];
  v8 = result;
  if ( v7 )
  {
    if ( v7 != 1 )
    {
      if ( v7 == 2 )
      {
        result = (uint *)Function_200f2ac();
        if ( result )
        {
          Function_205ea84(*(uint *)(*v4 + 60), 1);
          *(uint *)v4[1] = 1;
          free((int)v4);
          result = (uint *)Call_RemoveTaskFromTaskList(v5);
        }
      }
      return result;
    }
  }
  else
  {
    UnsetSpriteFlag_Lock(result);
    Function_206309c(v8, &v26);
    v9 = 20 - v4[3];
    v10 = dflt(v9);
    v12 = v11;
    LODWORD(v13) = dflt(v9 << 11);
    LODWORD(v14) = dadd(4666179573918570906LL, v13);
    v15 = dmul(__PAIR__(v12, v10), v14);
    v27 = dfix(v15, v16);
    Function_20630ac(v8, &v26);
    Function_21eccc8(v8);
    Function_2005748(0x64Fu);
    v4[2] = 1;
  }
  if ( ((uint)v4[3] >> 31) + __ROR4__((v4[3] << 31) - ((uint)v4[3] >> 31), 31) )
    Function_21e135c(v4);
  Function_206309c(v8, &v26);
  v17 = 20 - v4[3];
  v18 = dflt(v17);
  v20 = v19;
  LODWORD(v21) = dflt(v17 << 11);
  LODWORD(v22) = dadd(4666179573918570906LL, v21);
  v23 = dmul(__PAIR__(v20, v18), v22);
  v27 = dfix(v23, v24);
  Function_20630ac(v8, &v26);
  v25 = v4[3] + 1;
  v4[3] = v25;
  if ( v25 == 2 )
    Function_200f174(1u, 1, 1, 0, 6, 1, 4);
  result = (uint *)v4[3];
  if ( (int)result > 20 )
  {
    result = (uint *)2;
    v4[2] = 2;
  }
  return result;
}

//----- (021E15A8) --------------------------------------------------------
uint *__fastcall Function_5_21e15a8(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;
  int v6;
  uint *result;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = malloc2(4u, 20);
  MI_CpuFill8((ushort *)v6, 0, 0x14u);
  *(uint *)v6 = v3;
  *(uint *)(v6 + 4) = v5;
  *(uint *)(v6 + 16) = GetSpriteFaceDirection(*(uint *)(v3 + 60));
  if ( v4 )
    result = AddTaskToTaskList1((int)Function_21e139c, v6, 0x64u);
  else
    result = AddTaskToTaskList1((int)Function_21e1470, v6, 0x64u);
  return result;
}

//----- (021E15F4) --------------------------------------------------------
int __fastcall Function_21e15f4(uint a1)
{
  int v1;

  v1 = malloc(a1, 4480);
  Function_5_21e1610();
  return v1;
}

//----- (021E1608) --------------------------------------------------------
uint __fastcall Function_21e1608(int a1)
{
  return free(a1);
}

//----- (021E1610) --------------------------------------------------------
int __fastcall Function_5_21e1610(int a1, int a2, int a3, int a4)
{
  int savedregs;
  uint v5;
  int v6;
  uint *v7;
  uint *v8;
  uint *v9;
  uint *v10;
  int result;

  savedregs = a4;
  v5 = 0;
  v6 = a1;
  do
  {
    v7 = (uint *)(v6 + 140 * v5);
    *(uint *)(v6 + 140 * v5) = 0;
    v7[1] = 0;
    v7[2] = 0;
    v7[3] = 0;
    v8 = v7 + 26;
    *v8 = 0;
    v8[1] = 0;
    v7[28] = 0;
    v9 = (uint *)(v6 + 140 * v5 + 116);
    *v9 = 0;
    v9[1] = 0;
    *(uint *)(v6 + 140 * v5 + 124) = 0;
    v10 = (uint *)(v6 + 140 * v5 + 128);
    *v10 = 0;
    v10[1] = 0;
    *(uint *)(v6 + 140 * v5 + 136) = 0;
    result = (v5 + 1) << 24;
    v5 = (v5 + 1) & 0xFF;
    v7[25] = 0;
  }
  while ( v5 < 0x20 );
  return result;
}

//----- (021E1674) --------------------------------------------------------
int __fastcall Function_5_21e1674(int a1, int a2)
{
  int v2;
  int v3;
  uint *v4;
  uint *v5;
  uint *v6;
  uint *v7;
  int result;

  v2 = a1;
  v3 = a2;
  if ( a1 >= 32 )
    ErrorHandler();
  *(uint *)(v3 + 140 * v2) = 0;
  v4 = (uint *)(v3 + 140 * v2);
  v4[1] = 0;
  v4[2] = 0;
  v4[3] = 0;
  v5 = (uint *)(v3 + 140 * v2 + 104);
  *v5 = 0;
  v5[1] = 0;
  v5[2] = 0;
  v6 = v4 + 29;
  *v6 = 0;
  v6[1] = 0;
  v4[31] = 0;
  v7 = v4 + 32;
  *v7 = 0;
  v7[1] = 0;
  result = 0;
  v4[34] = 0;
  v4[25] = 0;
  return result;
}

//----- (021E16CC) --------------------------------------------------------
uint __fastcall Function_21e16cc(int *a1, int a2, int a3, int *a4, int a5)
{
  int *v5;
  int v6;
  int v7;
  int *v8;
  int *v9;
  int v10;
  int v11;
  uint *v12;
  int v13;
  uint *v14;
  int v15;
  uint *v16;
  uint *v17;
  uint *v18;
  uint *v19;
  uint result;
  uint v21;
  int v22;

  v5 = a1;
  v6 = a2;
  v7 = a3;
  v8 = a4;
  v22 = 0;
  if ( a2 )
  {
    v22 = malloc2(4u, a2);
    Call_FS_ReadFile(v5, v6, v22);
    v21 = u32_div_f(v6, 48);
  }
  else
  {
    v21 = 0;
  }
  v9 = (int *)v22;
  v10 = 0;
  do
  {
    if ( v10 >= v21 )
    {
      *v8 = 0;
      v8[1] = 0;
      v8[3] = 0;
      v17 = v8 + 26;
      *v17 = 0;
      v17[1] = 0;
      v8[28] = 0;
      v18 = v8 + 29;
      *v18 = 0;
      v18[1] = 0;
      v8[31] = 0;
      v19 = v8 + 32;
      *v19 = 0;
      v19[1] = 0;
      v8[34] = 0;
    }
    else
    {
      *v8 = *v9;
      v8[1] = 1;
      v8[3] = 0;
      v11 = v9[2];
      v12 = v8 + 26;
      *v12 = v9[1];
      v12[1] = v11;
      v8[28] = v9[3];
      v13 = v9[5];
      v14 = v8 + 29;
      *v14 = v9[4];
      v14[1] = v13;
      v8[31] = v9[6];
      v15 = v9[8];
      v16 = v8 + 32;
      *v16 = v9[7];
      v16[1] = v15;
      v8[34] = v9[9];
      Function_21e1904(*v8, v7, v8 + 4, v8 + 25);
      if ( !Function_21efaf8(v7, *v8) )
        *v8 = 0;
      Function_21d3be4(*v8, (uint)(v8 + 4), a5);
    }
    ++v10;
    v8 += 35;
    v9 += 12;
  }
  while ( v10 < 32 );
  result = v22;
  if ( v22 )
    result = free(v22);
  return result;
}

//----- (021E17CC) --------------------------------------------------------
int *__fastcall Function_21e17cc(uint *a1, int a2, int a3, int a4, int *a5)
{
  int *v5;
  uint *v6;
  char *v7;
  int v8;
  int v9;
  int v10;
  int *v11;
  int v12;
  int *result;
  int v14;
  int v15;
  uint *v16;
  int v17;
  int v18;
  int v19;
  char v20;
  char v21;
  int v22;
  int v23;
  int v24;
  int v25;

  v25 = a4;
  v5 = dword_21F9C74;
  v18 = a3;
  v19 = a4;
  v6 = a1;
  v17 = a2;
  v7 = &v21;
  v8 = 4;
  do
  {
    v9 = *v5;
    v10 = v5[1];
    v5 += 2;
    *(uint *)v7 = v9;
    *((uint *)v7 + 1) = v10;
    v7 += 8;
    --v8;
  }
  while ( v8 );
  v11 = a5;
  *(uint *)v7 = *v5;
  v12 = 0;
  do
  {
    result = (int *)v11[1];
    if ( result )
    {
      result = (int *)v11[2];
      if ( !result )
      {
        v14 = v11[27];
        v22 = v11[26];
        v23 = v14;
        v24 = v11[28];
        v22 += *v6;
        v24 += v6[2];
        result = (int *)Function_201ced8(v11[25], &v22, (int *)&v21, v11 + 32);
        if ( result )
        {
          v16 = (uint *)Function_21efab4(v17);
          if ( v18 == 1 )
            Function_21d5948(v19, v11[25], 3891, v15);
          Function_21d5790(*v11, v16, &v20);
          if ( *(ushort *)&v20 )
            result = (int *)Function_21e1944(v11[25], &v22, &v21, v11 + 32, v16, *v11);
          else
            result = Function_201ca74(v11 + 4, &v22, (int *)&v21, v11 + 32);
        }
      }
    }
    ++v12;
    v11 += 35;
  }
  while ( v12 < 32 );
  return result;
}

//----- (021E1890) --------------------------------------------------------
int __fastcall Function_5_21e1890(int a1)
{
  return a1 + 116;
}

//----- (021E1894) --------------------------------------------------------
int __fastcall Function_5_21e1894(uint *a1, int a2)
{
  int *v2;
  uint *v3;
  int v4;
  int v5;
  int result;

  v2 = (int *)(a2 + 104);
  v3 = a1;
  v4 = *(uint *)(a2 + 104);
  v5 = *(uint *)(a2 + 108);
  v2 += 2;
  *v3 = v4;
  v3[1] = v5;
  result = *v2;
  v3[2] = *v2;
  return result;
}

//----- (021E18A4) --------------------------------------------------------
int __fastcall Function_5_21e18a4(uint *a1, int *a2)
{
  int *v2;
  uint *v3;
  int v4;
  int v5;
  int result;

  v2 = a2;
  v3 = a1;
  v4 = *a2;
  v5 = a2[1];
  v2 += 2;
  v3 += 26;
  *v3 = v4;
  v3[1] = v5;
  result = *v2;
  v3[2] = *v2;
  return result;
}

//----- (021E18B4) --------------------------------------------------------
int __fastcall Function_5_21e18b4(int result, int a2)
{
  *(uint *)(result + 8) = a2;
  return result;
}

//----- (021E18B8) --------------------------------------------------------
int __fastcall Function_5_21e18b8(int a1)
{
  return *(uint *)a1;
}

//----- (021E18BC) --------------------------------------------------------
int __fastcall Function_5_21e18bc(int a1)
{
  return a1 + 16;
}

//----- (021E18C0) --------------------------------------------------------
int __fastcall Function_5_21e18c0(int a1)
{
  return *(uint *)(a1 + 100);
}

//----- (021E18C4) --------------------------------------------------------
int __fastcall Function_5_21e18c4(int a1, int a2)
{
  return a1 + 140 * a2;
}

//----- (021E18CC) --------------------------------------------------------
uint *__fastcall Function_5_21e18cc(uint *result, int a2)
{
  int v2;

  v2 = 0;
  while ( *result != a2 )
  {
    ++v2;
    result += 35;
    if ( v2 >= 32 )
      return 0;
  }
  return result;
}

//----- (021E18E0) --------------------------------------------------------
int __fastcall Function_5_21e18e0(int a1, int a2)
{
  int v2;
  int v3;
  int v4;

  v2 = a2;
  v3 = a1;
  if ( a2 >= 32 )
    ErrorHandler();
  v4 = v3 + 140 * v2;
  if ( !*(uint *)(v4 + 4) )
    ErrorHandler();
  return v4;
}

//----- (021E1904) --------------------------------------------------------
int (__fastcall *__fastcall Function_21e1904(int a1, int a2, uint *a3, int *a4))(uint *a1, int a2, uint a3, int a4)
{
  uint *v4;
  int *v5;
  int *v6;
  int v7;
  uint *v8;
  int v9;

  v4 = a3;
  v5 = a4;
  v6 = (int *)Function_5_21ef9e8();
  v7 = Function_20b3c0c_GetAdrOfDataPart(*v6);
  if ( v7
    && (v7 == -8 || !*(uchar *)(v7 + 9) ? (v8 = 0) : (v8 = (uint *)(v7 + 8 + *(ushort *)(v7 + 14) + 4)), v8) )
  {
    v9 = v7 + *v8;
  }
  else
  {
    v9 = 0;
  }
  *v5 = v9;
  return Function_20ae608(v4, v9);
}

//----- (021E1944) --------------------------------------------------------
int __fastcall Function_21e1944(int a1, int *a2, int *a3, int a4, uint *a5, int a6)
{
  int v6;
  int *v7;
  int *v8;
  int v9;
  int result;
  uint v11;
  int i;
  int v13;
  int v14;
  int v15;

  v15 = a4;
  v6 = a1;
  v7 = a3;
  v8 = (int *)a4;
  Function_20af4bc(a2);
  MI_Copy36B(v7, dword_21C5B48);
  dword_21C5B88 &= 0xFFFFFF5B;
  Function_20af4ec(v8);
  Function_20af480();
  Function_21d579c(a6, a5, (ushort *)&v15 + 1, &v15);
  v9 = Function_21d57b4((ushort)v15, (int)a5);
  result = HIWORD(v15);
  v11 = 255;
  for ( i = 0; i < HIWORD(v15); result = HIWORD(v15) )
  {
    v13 = *(ushort *)(v9 + 4 * i);
    if ( v11 == v13 )
    {
      v14 = 0;
    }
    else
    {
      v11 = (uchar)v13;
      v14 = 1;
    }
    Function_20b2384(v6, v11, *(ushort *)(v9 + 4 * i + 2), v14);
    i = (i + 1) & 0xFF;
  }
  return result;
}

//----- (021E19CC) --------------------------------------------------------
int __fastcall Function_5_21e19cc(int a1, int a2, int a3, uint *a4, uint *a5, int a6)
{
  int v6;
  uint v7;
  int *v8;
  int v9;
  uint *v10;
  int v11;
  uint *v12;
  uint *v13;

  v6 = a2;
  v7 = 0;
  while ( 1 )
  {
    v8 = (int *)(a1 + 140 * v7);
    if ( !v8[1] )
      break;
    v7 = (v7 + 1) & 0xFF;
    if ( v7 >= 0x20 )
    {
      ErrorHandler();
      return 32;
    }
  }
  v8[1] = 1;
  v9 = a4[1];
  v10 = v8 + 26;
  *v10 = *a4;
  v10[1] = v9;
  v8[28] = a4[2];
  if ( a5 )
  {
    v8[3] = 1;
    v11 = a5[1];
    v12 = v8 + 29;
    *v12 = *a5;
    v12[1] = v11;
    v8[31] = a5[2];
  }
  else
  {
    v8[3] = 0;
  }
  v13 = v8 + 32;
  *v13 = 4096;
  v13[1] = 4096;
  v8[34] = 4096;
  *v8 = a3;
  Function_21e1904(a3, v6, v8 + 4, v8 + 25);
  Function_21d3b24(*v8, 0, 0, (int)(v8 + 4), a6);
  return v7;
}

//----- (021E1A6C) --------------------------------------------------------
int __fastcall Function_21e1a6c(int a1, int a2, int a3, int a4)
{
  int *v4;
  char *v5;
  int v6;
  int v7;
  int v8;
  int v9;
  uint v10;
  int *v11;
  uint *v12;
  int result;
  int v14;
  int v15;
  char v16;
  int v17[9];
  int v18;

  v18 = a4;
  v4 = dword_21F9C98;
  v14 = a1;
  v15 = a2;
  v5 = (char *)v17;
  v6 = 4;
  do
  {
    v7 = *v4;
    v8 = v4[1];
    v4 += 2;
    *(uint *)v5 = v7;
    *((uint *)v5 + 1) = v8;
    v5 += 8;
    --v6;
  }
  while ( v6 );
  v9 = *v4;
  v10 = 0;
  *(uint *)v5 = v9;
  do
  {
    v11 = (int *)(v14 + 140 * v10);
    if ( v11[1] && !v11[2] )
    {
      v12 = (uint *)Function_21efab4(v15);
      Function_21d5790(*v11, v12, &v16);
      if ( v11[3] )
        Function_201e268(v17, v11 + 29);
      if ( *(ushort *)&v16 )
        Function_21e1944(v11[25], v11 + 26, v17, (int)(v11 + 32), v12, *v11);
      else
        Function_201ca74(v11 + 4, v11 + 26, v17, v11 + 32);
    }
    result = (v10 + 1) << 24;
    v10 = (v10 + 1) & 0xFF;
  }
  while ( v10 < 0x20 );
  return result;
}

//----- (021E1B08) --------------------------------------------------------
long long __fastcall Function_21e1b08(uint a1)
{
  long long result;
  uchar *v2;
  int v3;

  result = (uint)malloc(a1, 20);
  v2 = (uchar *)result;
  v3 = 20;
  do
  {
    *v2++ = 0;
    --v3;
  }
  while ( v3 );
  return result;
}

//----- (021E1B20) --------------------------------------------------------
uint __fastcall Function_21e1b20(int a1)
{
  int v1;

  v1 = a1;
  if ( *(uchar *)(a1 + 19) & 0x80 )
    Function_201a8fc(a1);
  return free(v1);
}

//----- (021E1B38) --------------------------------------------------------
int __fastcall Function_5_21e1b38(int result, char a2, short a3)
{
  *(uchar *)(result + 18) = a2;
  *(ushort *)(result + 16) = a3;
  return result;
}

//----- (021E1B40) --------------------------------------------------------
int __fastcall Function_5_21e1b40(int result, char a2)
{
  *(uchar *)(result + 19) = a2 & 0x7F | *(uchar *)(result + 19) & 0x80;
  return result;
}

//----- (021E1B50) --------------------------------------------------------
void Function_5_21e1b50()
{
  ;
}

//----- (021E1B54) --------------------------------------------------------
int __fastcall Function_5_21e1b54(int a1)
{
  return *(uchar *)(a1 + 18);
}

//----- (021E1B58) --------------------------------------------------------
BOOL __fastcall Function_5_21e1b58(int a1)
{
  return (*(uchar *)(a1 + 19) & 0x7F) == 0;
}

//----- (021E1B68) --------------------------------------------------------
int __fastcall Function_5_21e1b68(int result)
{
  int v1;
  int v2;

  v1 = *(uint *)(result + 100);
  v2 = *(uchar *)(v1 + 19) & 0x7F;
  switch ( (uchar)v2 )
  {
    case 1:
      Function_21e1be0();
      result = 127;
      *(uchar *)(v1 + 19) &= 0x80u;
      break;
    case 2:
      result = Function_21e1cb0(result, v2);
      if ( result == 1 )
      {
        result = 127;
        *(uchar *)(v1 + 19) &= 0x80u;
      }
      break;
    case 3:
      result = Function_21e1c70();
      if ( result == 1 )
      {
        result = 127;
        *(uchar *)(v1 + 19) &= 0x80u;
      }
      break;
    case 4:
      Function_21e1c1c();
      result = 127;
      *(uchar *)(v1 + 19) &= 0x80u;
      break;
    default:
      return result;
  }
  return result;
}

//----- (021E1BCC) --------------------------------------------------------
int __fastcall Function_5_21e1bcc(int a1, char a2)
{
  int v2;

  v2 = a1;
  Function_5_21e1b40(*(uint *)(a1 + 100), a2);
  return Function_5_21e1b68(v2);
}

//----- (021E1BE0) --------------------------------------------------------
uint __fastcall Function_21e1be0(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  Function_2019184(*(uint *)(a1 + 8), 3u, 3u, -48);
  v2 = *(uint *)(v1 + 100);
  if ( !(*(uchar *)(v2 + 19) & 0x80) )
  {
    Function_205da1c(*(uint **)(v1 + 8), v2, *(uchar *)(v2 + 18), 3);
    *(uchar *)(*(uint *)(v1 + 100) + 19) |= 0x80u;
  }
  return Function_205da80(
           *(uint *)(v1 + 100),
           *(uchar *)(*(uint *)(v1 + 100) + 18),
           *(ushort *)(*(uint *)(v1 + 100) + 16));
}

//----- (021E1C1C) --------------------------------------------------------
int __fastcall Function_21e1c1c(int a1)
{
  int v1;
  int result;

  v1 = a1;
  result = *(uint *)(a1 + 100);
  if ( *(uchar *)(result + 19) & 0x80 )
  {
    Function_201a8fc(result);
    Function_2019cb8(*(uint *)(v1 + 8), 3, 0, 0, 0x12u, 0x20u, 6u, 0x10u);
    Function_2019448(*(uint **)(v1 + 8), 3u);
    Function_2019184(*(uint *)(v1 + 8), 3u, 3u, 0);
    result = 128;
    *(uchar *)(*(uint *)(v1 + 100) + 19) &= 0x7Fu;
  }
  return result;
}

//----- (021E1C70) --------------------------------------------------------
int __fastcall Function_21e1c70(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  v2 = Function_20192f8(*(uint *)(a1 + 8), 3);
  if ( !v2 )
    return 1;
  if ( v2 <= -48 || v2 >= 0 )
    Function_2019184(*(uint *)(v1 + 8), 3u, 3u, -48);
  Function_2019184(*(uint *)(v1 + 8), 3u, 4u, 16);
  return 0;
}

//----- (021E1CB0) --------------------------------------------------------
int __fastcall Function_21e1cb0(int a1)
{
  int v1;
  int v2;
  int result;

  v1 = a1;
  v2 = Function_20192f8(*(uint *)(a1 + 8), 3);
  if ( v2 == -48 )
  {
    Function_2019cb8(*(uint *)(v1 + 8), 3, 0, 0, 0x12u, 0x20u, 6u, 0x10u);
    Function_2019448(*(uint **)(v1 + 8), 3u);
    Function_2019184(*(uint *)(v1 + 8), 3u, 3u, 0);
    result = 1;
  }
  else
  {
    if ( v2 <= -48 || v2 >= 0 )
      Function_2019184(*(uint *)(v1 + 8), 3u, 3u, 0);
    Function_2019184(*(uint *)(v1 + 8), 3u, 5u, 16);
    result = 0;
  }
  return result;
}

//----- (021E1D20) --------------------------------------------------------
int __fastcall Function_21e1d20(int *a1, int a2)
{
  int v2;
  int *v3;
  uint *v4;
  uint *v5;
  uint *v6;
  int v7;
  int result;

  v2 = *(uint *)(a2 + 12);
  v3 = a1;
  LoadVariableAreaAdress_6(*(uint *)(a2 + 12));
  AddVariableAreaAdress_6_MapData0();
  v5 = v4;
  v6 = (uint *)LoadPokedexDataAdress(v2);
  v3[1] = GetMapName(*v5);
  if ( CheckActPokedex(v6) )
    v7 = Function_2026e48(v6);
  else
    v7 = 0;
  *v3 = v7;
  v3[2] = LoadTrainerDataAdress(v2);
  result = LoadPlayerDataAdress_26(v2);
  v3[3] = result;
  return result;
}

//----- (021E1D6C) --------------------------------------------------------
uint __fastcall Function_21e1d6c(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;

  v2 = a2;
  v3 = a1;
  Function_200b8c8(a1, 0, *(uint *)(a2 + 4));
  v4 = *(uint *)(v2 + 8);
  Function_200b498(v3, 1u);
  v5 = CountBadges(*(uint *)(v2 + 8));
  Function_200b60c(v3, 2u, v5, 1, 0, 1);
  v6 = *(uint *)v2;
  if ( *(uint *)v2 < 100 )
  {
    if ( v6 < 10 )
      v7 = 2;
    else
      v7 = 3;
    v8 = 1;
  }
  else
  {
    v7 = 3;
    v8 = 0;
  }
  Function_200b60c(v3, 3u, v6, v7, v8, 1);
  v9 = Function_202cc58(*(ushort **)(v2 + 12));
  v10 = v9;
  if ( v9 < 100 )
  {
    if ( v9 < 10 )
      v11 = 2;
    else
      v11 = 3;
    v12 = 1;
  }
  else
  {
    v11 = 3;
    v12 = 0;
  }
  Function_200b60c(v3, 4u, v10, v11, v12, 1);
  v13 = Function_202cc5c(*(uint *)(v2 + 12));
  return Function_200b60c(v3, 5u, v13, 2, 2, 1);
}

//----- (021E1E10) --------------------------------------------------------
int __fastcall Function_21e1e10(uint *a1)
{
  int result;

  if ( *a1 )
    result = 10;
  else
    result = 8;
  return result;
}

//----- (021E1E20) --------------------------------------------------------
uint __fastcall Function_21e1e20(int a1)
{
  int v1;
  int v2;
  int v3;
  ushort *v4;
  int v5;
  int *v6;
  ushort *v7;
  int v8;
  ushort *v9;
  int v10;
  int v11;
  uint result;
  uint *v13;
  int v14;
  int v15;

  v1 = a1;
  v2 = Function_2002df8_GetLineHeight(0, 1u);
  v15 = v2 + Function_2002df8_GetLineHeight(0, 3u);
  v3 = 0;
  v4 = Function_200b29c(*(uint **)(v1 + 20), *(ushort ***)(v1 + 24), 0, *(uint *)(v1 + 4));
  Function_201d738_CallInitTextInterpreter(*(uint *)(v1 + 16), 0);
  Function_20237bc_FreeMsg((int)v4, v5);
  v14 = 1;
  v6 = dword_21F9CC0;
  v13 = (uint *)dword_21F9CD0;
  do
  {
    if ( *v13 != 3 || *(uint *)(v1 + 28) )
    {
      v3 += v15;
      v7 = Function_200b1ec_CallMsgDecrypt(*(ushort ***)(v1 + 24), *v13);
      Function_201d738_CallInitTextInterpreter(*(uint *)(v1 + 16), 0);
      Function_20237bc_FreeMsg((int)v7, v8);
      v9 = Function_200b29c(
             *(uint **)(v1 + 20),
             *(ushort ***)(v1 + 24),
             *(v6 - 1),
             *(uint *)(v1 + 4));
      v10 = Function_2002df8_GetLineHeight(0, 2u);
      Function_2002d7c(0, (int)v9, v10);
      Function_201d738_CallInitTextInterpreter(*(uint *)(v1 + 16), 0);
      Function_20237bc_FreeMsg((int)v9, v11);
    }
    ++v6;
    ++v13;
    result = v14 + 1;
    v14 = result;
  }
  while ( result < 5 );
  return result;
}

//----- (021E1F04) --------------------------------------------------------
char *__fastcall Function_5_21e1f04(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  *(uint *)(a1 + 16) = malloc(*(uint *)(a1 + 4), 16);
  Function_201a7e8(
    *(uint **)(v1 + 12),
    *(uint *)(v1 + 16),
    *(uchar *)(v1 + 8),
    1,
    1,
    *(uint *)(v1 + 44),
    *(uint *)(v1 + 48),
    13,
    393);
  Function_200daa4(*(uint **)(v1 + 12), *(uchar *)(v1 + 8), 985, 11, 0, *(uint *)(v1 + 4));
  v2 = Function_2002df8_GetLineHeight(0, 6u);
  Function_201ada4_ClearTextBox(*(uint *)(v1 + 16), v2);
  Function_21e1e20(v1);
  return Function_200dc48(*(uint *)(v1 + 16), 0, 985, 0xBu);
}

//----- (021E1F7C) --------------------------------------------------------
uint __fastcall Function_5_21e1f7c(int a1)
{
  int v1;

  v1 = a1;
  Function_200dc9c(*(uint *)(a1 + 16), 0);
  Function_201a8fc(*(uint *)(v1 + 16));
  return free(*(uint *)(v1 + 16));
}

//----- (021E1F98) --------------------------------------------------------
int *__fastcall Function_5_21e1f98(int a1, uint a2, char a3)
{
  uint v3;
  int v4;
  char v5;
  int v6;
  int *v7;

  v3 = a2;
  v4 = a1;
  v5 = a3;
  v6 = malloc(a2, 52);
  v7 = (int *)v6;
  *(uint *)v6 = v4;
  *(uint *)(v6 + 4) = v3;
  *(uchar *)(v6 + 8) = v5;
  *(uint *)(v6 + 12) = *(uint *)(v4 + 8);
  *(uint *)(v6 + 20) = Function_200b358(v3);
  v7[6] = LoadFromMsgNARC(1, 26, 534, v3);
  Function_21e1d20(v7 + 7, *v7);
  Function_21e1d6c(v7[5], (int)(v7 + 7));
  v7[11] = 13;
  v7[12] = Function_21e1e10(v7 + 7);
  return v7;
}

//----- (021E1FF4) --------------------------------------------------------
uint __fastcall Function_5_21e1ff4(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  Function_200b190(*(ushort **)(a1 + 24));
  Function_200b3f0(*(uint **)(v1 + 20), v2);
  return free(v1);
}

//----- (021E200C) --------------------------------------------------------
BOOL __fastcall Function_5_21e200c(int a1)
{
  int v1;

  v1 = a1;
  Function_21e2028_CopyPlayerPosToMapData();
  return Function_20246e0(*(uint **)(v1 + 12)) == 2;
}

//----- (021E2028) --------------------------------------------------------
int __fastcall Function_21e2028_CopyPlayerPosToMapData(int a1)
{
  int v1;
  int result;

  v1 = a1;
  Function_203a7a8(a1);
  Function_5_21ea714(v1);
  *(uint *)(*(uint *)(v1 + 28) + 8) = GetSpritePositionX(*(uint *)(v1 + 60));
  *(uint *)(*(uint *)(v1 + 28) + 12) = GetSpritePositionY(*(uint *)(v1 + 60));
  *(uint *)(*(uint *)(v1 + 28) + 4) = -1;
  result = GetSpriteFaceDirection(*(uint *)(v1 + 60));
  *(uint *)(*(uint *)(v1 + 28) + 16) = result;
  return result;
}

//----- (021E2064) --------------------------------------------------------
int *__fastcall Function_5_21e2064(int a1)
{
  int v1;
  int *result;
  int v3;

  v1 = a1;
  if ( !a1 )
    return (int *)ErrorHandler();
  result = *(int **)(a1 + 28);
  v3 = *result;
  if ( *result != 332 )
  {
    result = (int *)333;
    if ( v3 != 333 && v3 != 466 )
    {
      result = (int *)Function_2038eb4();
      if ( result != (int *)1 )
        result = (int *)Function_21e2028_CopyPlayerPosToMapData(v1);
    }
  }
  return result;
}

//----- (021E2098) --------------------------------------------------------
int *__fastcall Function_5_21e2098(int *a1)
{
  int *v1;
  uint *v2;
  int *v3;
  int *v4;
  int v5;
  int v6;
  int v7;

  v1 = a1;
  v2 = Function_200679c((int)Function_21e2178, 56, 5u, a1[10]);
  v3 = (int *)Function_201ced0((int)v2);
  v4 = v3 + 1;
  v5 = 5;
  do
  {
    v6 = *v1;
    v7 = v1[1];
    v1 += 2;
    *v4 = v6;
    v4[1] = v7;
    v4 += 2;
    --v5;
  }
  while ( v5 );
  *v4 = *v1;
  v3[13] = (int)v2;
  v3[12] = 0;
  *v3 = Function_20bf00c();
  Function_21e2218(v3 + 1);
  AddTaskToTaskList3((int)Function_21e21b8, (int)v3, 0);
  return v3;
}

//----- (021E20E8) --------------------------------------------------------
int __fastcall Function_5_21e20e8(char ***a1, int a2, int a3, int a4)
{
  char ***v4;
  int v5;
  int result;

  v4 = a1;
  GX_SetGraphicsMode(a2, a3, a4);
  GX_SetBankForLCDC(**v4);
  v5 = (int)(*v4)[1];
  if ( v5 > 10 )
  {
    if ( v5 == 14 )
    {
      MIi_CpuClearFast(0, (uint *)0x6860000, 0x20000u);
      goto LABEL_15;
    }
    goto LABEL_14;
  }
  if ( v5 < 10 )
  {
    if ( v5 <= 6 && v5 >= 2 )
    {
      if ( v5 == 2 )
      {
        MIi_CpuClearFast(0, (uint *)0x6800000, 0x20000u);
        goto LABEL_15;
      }
      if ( v5 == 6 )
      {
        MIi_CpuClearFast(0, (uint *)0x6820000, 0x20000u);
        goto LABEL_15;
      }
    }
LABEL_14:
    GX_SetBankForLCDC(0);
    goto LABEL_15;
  }
  MIi_CpuClearFast(0, (uint *)0x6840000, 0x20000u);
LABEL_15:
  Function_20067d0((int)(*v4)[13]);
  result = 0;
  *v4 = 0;
  return result;
}

//----- (021E2178) --------------------------------------------------------
int *__fastcall Function_21e2178(int a1, uint *a2)
{
  int *result;

  result = (int *)a2[12];
  if ( result )
  {
    result = &REG_DISPCAPCNT;
    REG_DISPCAPCNT = (a2[6] << 24) | (a2[7] << 25) | (a2[5] << 29) | 0x80000000 | (a2[4] << 20) | (a2[8] << 16) | (a2[10] << 8) | a2[9];
  }
  return result;
}

//----- (021E21B8) --------------------------------------------------------
int __fastcall Function_21e21b8(int *a1, int *a2)
{
  int *v2;
  int *v3;
  int v4;

  v2 = a2;
  v3 = a1;
  v4 = a2[1];
  if ( v4 > 10 )
  {
    if ( v4 == 14 )
    {
      GX_SetBankForLCDC((char *)8);
      goto LABEL_15;
    }
    goto LABEL_14;
  }
  if ( v4 < 10 )
  {
    if ( v4 <= 6 && v4 >= 2 )
    {
      if ( v4 == 2 )
      {
        GX_SetBankForLCDC((char *)1);
        goto LABEL_15;
      }
      if ( v4 == 6 )
      {
        GX_SetBankForLCDC((char *)2);
        goto LABEL_15;
      }
    }
LABEL_14:
    GX_SetBankForLCDC(0);
    goto LABEL_15;
  }
  GX_SetBankForLCDC((char *)4);
LABEL_15:
  GX_SetGraphicsMode(v2[1], v2[2], v2[3]);
  v2[12] = 1;
  return Call_RemoveTaskFromTaskList(v3);
}

//----- (021E2218) --------------------------------------------------------
int *__fastcall Function_21e2218(uint *a1)
{
  uint *v1;
  int v2;
  int *result;

  v1 = a1;
  v2 = *a1;
  if ( v2 > 10 )
  {
    if ( v2 == 14 )
      MIi_CpuClearFast(0, (uint *)0x6860000, 0x20000u);
  }
  else if ( v2 < 10 )
  {
    if ( v2 <= 6 && v2 >= 2 )
    {
      if ( v2 == 2 )
      {
        MIi_CpuClearFast(0, (uint *)0x6800000, 0x20000u);
      }
      else if ( v2 == 6 )
      {
        MIi_CpuClearFast(0, (uint *)0x6820000, 0x20000u);
      }
    }
  }
  else
  {
    MIi_CpuClearFast(0, (uint *)0x6840000, 0x20000u);
  }
  result = &REG_DISPCAPCNT;
  REG_DISPCAPCNT = (v1[7] << 16) | (v1[5] << 24) | (v1[6] << 25) | (v1[4] << 29) | 0x80000000 | (v1[3] << 20) | 0x10;
  return result;
}

//----- (021E22B0) --------------------------------------------------------
int **__fastcall Function_21e22b0(int a1, int a2)
{
  int v2;
  int v3;
  int **v4;
  int *v5;
  char *v6;
  int v7;
  int v8;
  int v9;
  char v11;
  int v12;
  int v13;

  v2 = a1;
  v3 = a2;
  Function_201ff0c(2u, 0);
  Function_201ff0c(4u, 0);
  Function_201ff0c(8u, 0);
  Function_20bec9c();
  v4 = (int **)malloc(4u, 4);
  MIi_CpuClear32(0, v4, 4);
  v5 = dword_21F9CE0;
  v6 = &v11;
  v7 = 5;
  do
  {
    v8 = *v5;
    v9 = v5[1];
    v5 += 2;
    *(uint *)v6 = v8;
    *((uint *)v6 + 1) = v9;
    v6 += 8;
    --v7;
  }
  while ( v7 );
  *(uint *)v6 = *v5;
  v12 = v2;
  v13 = v3;
  *v4 = Function_5_21e2098((int *)&v11);
  return v4;
}

//----- (021E2310) --------------------------------------------------------
uint __fastcall Function_21e2310(char ****a1)
{
  int *v1;

  v1 = (int *)a1;
  Function_5_21e20e8(*a1, 1, 0, 1);
  GX_SetBankForBG(4);
  Function_201ff0c(0xEu, 1);
  return Function_2018238(4u, *v1);
}

//----- (021E2338) --------------------------------------------------------
int __fastcall Function_21e2338(int a1, int *a2)
{
  int *v2;
  int v3;
  int result;
  int *v5;
  int *v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  uint *v14;

  v2 = a2;
  v3 = a1;
  result = *a2;
  v5 = (int *)a2[3];
  if ( (uint)*a2 <= 5 )
    JUMPOUT(__CS__, *((short *)&off_21E2356 + result) + 35529560);
  switch ( (uchar)result )
  {
    case 0:
      v6 = (int *)malloc(4u, 32);
      v2[3] = (int)v6;
      Call_FillMemWithValue(v6, 0, 0x20u);
      v7 = v2[3];
      *(uint *)(v7 + 28) = Function_21ddf38();
      result = *v2 + 1;
      *v2 = result;
      break;
    case 1:
      Function_21ddc44(1, 16, -16, a2 + 1, 2);
      result = *v2 + 1;
      *v2 = result;
      break;
    case 2:
      result = a2[1];
      if ( result )
      {
        a2[1] = 0;
        ++*a2;
        Function_21ddf9c((int)a2, (uint *)v5[7], 2, 7, 0, -12288, -49152);
        v8 = *(uint *)(v2[4] + 36);
        *v5 = v8;
        v9 = Function_2020a90(v8);
        result = Function_21dde14(v5 + 1, v9, v9 + 204800, 122880, 6);
      }
      break;
    case 3:
      v10 = Function_21dde74(v5 + 1);
      result = Function_2020a50(v5[1], *v5);
      if ( v10 == 1 )
      {
        ++*v2;
        Function_21de058((int)v2, (uint *)v5[7], 2, 6, -12288, 1044480, 122880);
        v11 = *(uint *)(v2[4] + 36);
        *v5 = v11;
        v12 = Function_2020a90(v11);
        result = Function_21dde14(v5 + 1, v12, v12 - 204800, -1044480, 6);
      }
      break;
    case 4:
      v13 = Function_21dde74(v5 + 1);
      result = Function_2020a50(v5[1], *v5);
      if ( v13 == 1 )
      {
        result = Function_21ddd7c((int)v2);
        if ( result == 1 )
        {
          result = *v2 + 1;
          *v2 = result;
        }
      }
      break;
    case 5:
      SetBrightnessOfBothScreens(0);
      REG_BG0HOFS = 0;
      REG_BG1HOFS = 0;
      REG_BG2HOFS = 0;
      REG_BG3HOFS = 0;
      v14 = (uint *)v2[5];
      if ( v14 )
        *v14 = 1;
      Function_21ddf74(v5[7]);
      result = Function_21ddc28((int)v2, v3);
      break;
    default:
      return result;
  }
  return result;
}

//----- (021E24A8) --------------------------------------------------------
int __fastcall Function_21e24a8(int a1, int *a2)
{
  int *v2;
  int v3;
  int result;
  int *v5;
  int *v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  uint *v14;

  v2 = a2;
  v3 = a1;
  result = *a2;
  v5 = (int *)a2[3];
  if ( (uint)*a2 <= 5 )
    JUMPOUT(__CS__, *((short *)&off_21E24C6 + result) + 35529928);
  switch ( (uchar)result )
  {
    case 0:
      v6 = (int *)malloc(4u, 32);
      v2[3] = (int)v6;
      Call_FillMemWithValue(v6, 0, 0x20u);
      v7 = v2[3];
      *(uint *)(v7 + 28) = Function_21ddf38();
      result = *v2 + 1;
      *v2 = result;
      break;
    case 1:
      Function_21ddc44(1, -16, -16, a2 + 1, 2);
      result = *v2 + 1;
      *v2 = result;
      break;
    case 2:
      result = a2[1];
      if ( result )
      {
        a2[1] = 0;
        ++*a2;
        Function_21ddf9c((int)a2, (uint *)v5[7], 5, 7, 0, -8192, -49152);
        v8 = *(uint *)(v2[4] + 36);
        *v5 = v8;
        v9 = Function_2020a90(v8);
        result = Function_21dde14(v5 + 1, v9, v9 + 204800, 122880, 6);
      }
      break;
    case 3:
      v10 = Function_21dde74(v5 + 1);
      result = Function_2020a50(v5[1], *v5);
      if ( v10 == 1 )
      {
        ++*v2;
        Function_21de058((int)v2, (uint *)v5[7], 5, 6, -8192, 1044480, 122880);
        v11 = *(uint *)(v2[4] + 36);
        *v5 = v11;
        v12 = Function_2020a90(v11);
        result = Function_21dde14(v5 + 1, v12, v12 - 122880, -409600, 6);
      }
      break;
    case 4:
      v13 = Function_21dde74(v5 + 1);
      result = Function_2020a50(v5[1], *v5);
      if ( v13 == 1 )
      {
        result = Function_21ddd7c((int)v2);
        if ( result == 1 )
        {
          result = *v2 + 1;
          *v2 = result;
        }
      }
      break;
    case 5:
      SetBrightnessOfBothScreens(0);
      REG_BG0HOFS = 0;
      REG_BG1HOFS = 0;
      REG_BG2HOFS = 0;
      REG_BG3HOFS = 0;
      v14 = (uint *)v2[5];
      if ( v14 )
        *v14 = 1;
      Function_21ddf74(v5[7]);
      result = Function_21ddc28((int)v2, v3);
      break;
    default:
      return result;
  }
  return result;
}

//----- (021E261C) --------------------------------------------------------
ushort *__fastcall Function_21e261c(int a1, uint *a2)
{
  uint *v2;
  int v3;
  ushort *result;
  int v5;
  uchar *v6;
  int v7;
  uint *v8;

  v2 = a2;
  v3 = a1;
  result = (ushort *)*a2;
  v5 = a2[3];
  if ( *a2 <= 6u )
    JUMPOUT(__CS__, *((short *)&off_21E263A + (uint)result) + 35530300);
  switch ( (uchar)result )
  {
    case 0:
      v6 = (uchar *)malloc(4u, 16);
      v2[3] = v6;
      v7 = 16;
      do
      {
        *v6++ = 0;
        --v7;
      }
      while ( v7 );
      Function_21e28b0(v2[3], 4);
      Function_5_21ef3fc(*(uint *)(*(uint *)(v2[4] + 4) + 28));
      result = (ushort *)(*v2 + 1);
      *v2 = result;
      break;
    case 1:
      Function_21ddc44(1, -16, -16, a2 + 1, 2);
      *(uint *)(v5 + 12) = 10;
      result = (ushort *)(*v2 + 1);
      *v2 = result;
      break;
    case 2:
      result = (ushort *)(*(uint *)(v5 + 12) - 1);
      *(uint *)(v5 + 12) = result;
      if ( (int)result < 0 )
      {
        ++*a2;
        *(uint *)(v5 + 12) = 12;
        result = (ushort *)Function_21e28e4(v5);
      }
      break;
    case 3:
      result = (ushort *)(*(uint *)(v5 + 12) - 1);
      *(uint *)(v5 + 12) = result;
      if ( (int)result < 0 )
      {
        result = (ushort *)(*a2 + 1);
        *a2 = result;
      }
      break;
    case 4:
      Function_200f174(3u, 30, 0, 0, 8, 1, 4);
      result = (ushort *)(*v2 + 1);
      *v2 = result;
      break;
    case 5:
      result = (ushort *)Function_200f2ac();
      if ( result )
      {
        result = (ushort *)(*v2 + 1);
        *v2 = result;
      }
      break;
    case 6:
      Function_21e28cc(a2[3]);
      Function_5_21ef3dc(*(uint *)(*(uint *)(v2[4] + 4) + 28));
      v8 = (uint *)v2[5];
      if ( v8 )
        *v8 = 1;
      Function_21ddc28((int)v2, v3);
      result = SetBrightnessWithValue(1, 0);
      break;
    default:
      return result;
  }
  return result;
}

//----- (021E2748) --------------------------------------------------------
ushort *__fastcall Function_21e2748(int a1, uint *a2)
{
  uint *v2;
  int v3;
  ushort *result;
  int v5;
  uchar *v6;
  int v7;
  uint *v8;

  v2 = a2;
  v3 = a1;
  result = (ushort *)*a2;
  v5 = a2[3];
  if ( *a2 <= 6u )
    JUMPOUT(__CS__, *((short *)&off_21E2766 + (uint)result) + 35530600);
  switch ( (uchar)result )
  {
    case 0:
      v6 = (uchar *)malloc(4u, 16);
      v2[3] = v6;
      v7 = 16;
      do
      {
        *v6++ = 0;
        --v7;
      }
      while ( v7 );
      Function_21e28b0(v2[3], 4);
      Function_5_21ef3fc(*(uint *)(*(uint *)(v2[4] + 4) + 28));
      result = (ushort *)(*v2 + 1);
      *v2 = result;
      break;
    case 1:
      Function_21ddc44(1, 16, -16, a2 + 1, 2);
      *(uint *)(v5 + 12) = 10;
      result = (ushort *)(*v2 + 1);
      *v2 = result;
      break;
    case 2:
      result = (ushort *)(*(uint *)(v5 + 12) - 1);
      *(uint *)(v5 + 12) = result;
      if ( (int)result < 0 )
      {
        ++*a2;
        *(uint *)(v5 + 12) = 12;
        result = (ushort *)Function_21e28e4(v5);
      }
      break;
    case 3:
      result = (ushort *)(*(uint *)(v5 + 12) - 1);
      *(uint *)(v5 + 12) = result;
      if ( (int)result < 0 )
      {
        result = (ushort *)(*a2 + 1);
        *a2 = result;
      }
      break;
    case 4:
      Function_200f174(3u, 30, 0, 0, 8, 1, 4);
      result = (ushort *)(*v2 + 1);
      *v2 = result;
      break;
    case 5:
      result = (ushort *)Function_200f2ac();
      if ( result )
      {
        result = (ushort *)(*v2 + 1);
        *v2 = result;
      }
      break;
    case 6:
      Function_21e28cc(a2[3]);
      Function_5_21ef3dc(*(uint *)(*(uint *)(v2[4] + 4) + 28));
      v8 = (uint *)v2[5];
      if ( v8 )
        *v8 = 1;
      Function_21ddc28((int)v2, v3);
      result = SetBrightnessWithValue(1, 0);
      break;
    default:
      return result;
  }
  return result;
}

//----- (021E2878) --------------------------------------------------------
uint *__fastcall Function_21e2878(int a1)
{
  return AddTaskToTaskList2((int)Function_21e288c, a1, 0x400u);
}

//----- (021E288C) --------------------------------------------------------
int __fastcall Function_21e288c(int a1, int *a2)
{
  uint *v2;
  int result;

  v2 = (uint *)a2;
  if ( (uint)a2[2] >= 2 )
  {
    Function_2013da4(*a2);
    v2[2] = 0;
  }
  Function_2013ddc(*v2);
  result = v2[2] + 1;
  v2[2] = result;
  return result;
}

//----- (021E28B0) --------------------------------------------------------
uint *__fastcall Function_21e28b0(int **a1, uint a2)
{
  int v2;
  uint *result;

  v2 = (int)a1;
  *a1 = Function_2013be0(a2);
  *(uint *)(v2 + 8) = 0;
  result = Function_21e2878(v2);
  *(uint *)(v2 + 4) = result;
  return result;
}

//----- (021E28CC) --------------------------------------------------------
uint __fastcall Function_21e28cc(int **a1)
{
  int **v1;

  v1 = a1;
  Call_RemoveTaskFromTaskList(a1[1]);
  Function_2013d38(*v1);
  return Function_2013d74(*v1);
}

//----- (021E28E4) --------------------------------------------------------
int __fastcall Function_21e28e4(int *a1, char a2, char a3, int a4, int a5, short a6, int a7, int a8, uint a9)
{
  return Function_2013c10(*a1, a2, a3, a4, a5, a6, a7, a8, a9);
}

//----- (021E290C) --------------------------------------------------------
uint __fastcall Function_21e290c(int *a1, int a2)
{
  int v2;
  uint *v3;
  int v4;
  int v5;
  uint v6;
  uint result;

  v2 = a2;
  v3 = (uint *)Function_2013d94(*a1);
  v4 = 0;
  do
  {
    v5 = (short)*v3;
    if ( u32_div_f(v4, v2) & 1 )
      v6 = -65536 * v5;
    else
      v6 = v5 << 16;
    result = v6 >> 16;
    *v3 = result;
    ++v4;
    ++v3;
  }
  while ( v4 < 192 );
  return result;
}

//----- (021E2944) --------------------------------------------------------
ushort *__fastcall Function_21e2944(int a1, uint *a2)
{
  uint *v2;
  int v3;
  ushort *result;
  int *v5;
  uchar *v6;
  int v7;
  int v8;
  int v9;
  uint *v10;

  v2 = a2;
  v3 = a1;
  result = (ushort *)*a2;
  v5 = (int *)a2[3];
  switch ( (uchar)a2 )
  {
    case 0:
      v6 = (uchar *)malloc(4u, 28);
      v2[3] = v6;
      v7 = 28;
      do
      {
        *v6++ = 0;
        --v7;
      }
      while ( v7 );
      result = (ushort *)(*v2 + 1);
      *v2 = result;
      break;
    case 1:
      Function_21ddc44(1, -16, -16, a2 + 1, 2);
      result = (ushort *)(*v2 + 1);
      *v2 = result;
      break;
    case 2:
      if ( a2[1] )
      {
        result = (ushort *)((char *)result + 1);
        *a2 = result;
      }
      break;
    case 3:
      Function_5_21ef3fc(*(uint *)(*(uint *)(a2[4] + 4) + 28));
      Function_200f174(3u, 16, 16, 0, 12, 1, 4);
      v8 = *(uint *)(v2[4] + 36);
      *v5 = v8;
      v9 = Function_2020a90(v8);
      Function_21dde14(v5 + 1, v9, v9 - 1638400, -8192, 12);
      result = (ushort *)(*v2 + 1);
      *v2 = result;
      break;
    case 4:
      Function_21dde74(v5 + 1);
      Function_2020a50(v5[1], *v5);
      result = (ushort *)Function_200f2ac();
      if ( result )
      {
        result = (ushort *)(*v2 + 1);
        *v2 = result;
      }
      break;
    case 5:
      Function_5_21ef3dc(*(uint *)(*(uint *)(a2[4] + 4) + 28));
      v10 = (uint *)v2[5];
      if ( v10 )
        *v10 = 1;
      Function_21ddc28((int)v2, v3);
      result = SetBrightnessWithValue(1, 0);
      break;
    default:
      return result;
  }
  return result;
}

//----- (021E2A4C) --------------------------------------------------------
ushort *__fastcall Function_21e2a4c(int a1, uint *a2)
{
  uint *v2;
  int v3;
  ushort *result;
  int *v5;
  uchar *v6;
  int v7;
  int v8;
  int v9;
  uint *v10;

  v2 = a2;
  v3 = a1;
  result = (ushort *)*a2;
  v5 = (int *)a2[3];
  switch ( (uchar)a2 )
  {
    case 0:
      v6 = (uchar *)malloc(4u, 28);
      v2[3] = v6;
      v7 = 28;
      do
      {
        *v6++ = 0;
        --v7;
      }
      while ( v7 );
      result = (ushort *)(*v2 + 1);
      *v2 = result;
      break;
    case 1:
      Function_21ddc44(1, 16, -16, a2 + 1, 2);
      result = (ushort *)(*v2 + 1);
      *v2 = result;
      break;
    case 2:
      if ( a2[1] )
      {
        result = (ushort *)((char *)result + 1);
        *a2 = result;
      }
      break;
    case 3:
      Function_5_21ef3fc(*(uint *)(*(uint *)(a2[4] + 4) + 28));
      Function_200f174(3u, 16, 16, 0, 12, 1, 4);
      v8 = *(uint *)(v2[4] + 36);
      *v5 = v8;
      v9 = Function_2020a90(v8);
      Function_21dde14(v5 + 1, v9, v9 - 3276800, -20480, 12);
      result = (ushort *)(*v2 + 1);
      *v2 = result;
      break;
    case 4:
      Function_21dde74(v5 + 1);
      Function_2020a50(v5[1], *v5);
      result = (ushort *)Function_200f2ac();
      if ( result )
      {
        result = (ushort *)(*v2 + 1);
        *v2 = result;
      }
      break;
    case 5:
      Function_5_21ef3dc(*(uint *)(*(uint *)(a2[4] + 4) + 28));
      v10 = (uint *)v2[5];
      if ( v10 )
        *v10 = 1;
      Function_21ddc28((int)v2, v3);
      result = SetBrightnessWithValue(1, 0);
      break;
    default:
      return result;
  }
  return result;
}

//----- (021E2B54) --------------------------------------------------------
int __fastcall Function_21e2b54(int a1, int *a2, int a3, int a4)
{
  int *v4;
  int v5;
  int v6;
  int *v7;
  int v8;
  short v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  uint *v16;
  int v17;
  int v18;
  int result;
  int v20;
  int v21;
  int v22;
  char v23;
  int v24;
  int v25;
  char v26;
  int v27;
  int v28;
  int v29;
  int v30;
  int v31;
  int v32;
  int v33;
  int v34;
  int v35[3];
  int v36;

  v36 = a4;
  v4 = a2;
  v20 = a1;
  v5 = *a2;
  v6 = a2[3];
  if ( (uint)*a2 <= 7 )
    JUMPOUT(__CS__, (char *)&off_21E2B72 + *((short *)&off_21E2B72 + v5) + 2);
  switch ( (uchar)a2 )
  {
    case 0:
      v7 = (int *)malloc(4u, 480);
      v4[3] = (int)v7;
      Call_FillMemWithValue(v7, 0, 0x1E0u);
      v6 = v4[3];
      *(uint *)(v6 + 448) = *(uint *)(v4[4] + 36);
      *(uint *)(v6 + 68) = Function_21ddf38();
      Function_21de47c((int **)(v6 + 72), 2, 1, v8);
      Function_21de4cc(v4[8], (int *)(v6 + 72), (int **)(v6 + 388), 0, 1, 5u, 7u, 6u, 600000);
      v21 = 0;
      v9 = 0;
      v10 = v6;
      do
      {
        *(uint *)(v10 + 440) = Function_21de62c((int *)(v6 + 72), v6 + 388, 0x80000, 393216, 0, 0);
        Function_2021cac(*(uint *)(v10 + 440), 0);
        Function_2021f58(*(uint *)(v10 + 440), v9);
        v10 += 4;
        v9 += 2;
        ++v21;
      }
      while ( v21 < 2 );
      Function_201ff0c(0x10u, 1);
      ++*v4;
      break;
    case 1:
      Function_21ddc44(1, -16, -16, a2 + 1, 2);
      ++*v4;
      break;
    case 2:
      if ( a2[1] )
        *a2 = v5 + 1;
      break;
    case 3:
      Function_21dde14((uint *)v6, 41, 4096, 2, 10);
      Function_21de660(v35, *(uint *)v6, *(uint *)v6, *(uint *)v6);
      v11 = 0;
      v12 = v6;
      do
      {
        Function_2021cac(*(uint *)(v12 + 440), 1);
        Function_2021cf8(*(uint *)(v12 + 440), 2);
        Function_2021c70(*(uint **)(v12 + 440), v35);
        ++v11;
        v12 += 4;
      }
      while ( v11 < 2 );
      Function_21ddd80((uint *)(v6 + 24), 0, 0xFFFF, 10);
      ++*v4;
      break;
    case 4:
      v22 = Function_21dde74((uint *)a2[3]);
      Function_21de660(v35, *(uint *)v6, *(uint *)v6, *(uint *)v6);
      Function_21ddd90((uint *)(v6 + 24));
      v13 = 0;
      v14 = v6;
      do
      {
        Function_2021c70(*(uint **)(v14 + 440), v35);
        ++v13;
        v14 += 4;
      }
      while ( v13 < 2 );
      Function_2021c94(*(uint *)(v6 + 440), *(uint *)(v6 + 24));
      Function_2021c94(*(uint *)(v6 + 444), *(ushort *)(v6 + 24) - 256);
      if ( v22 == 1 )
        ++*v4;
      break;
    case 5:
      Function_21ddf9c((int)a2, *(uint **)(v6 + 68), 96, 6, 0, 1044480, 40960);
      Function_2021d6c(*(uint *)(v6 + 440), 1u);
      Function_2021d6c(*(uint *)(v6 + 444), 2u);
      Function_21dde14((uint *)(v6 + 44), 0, 1044480, 40960, 6);
      v15 = Function_2020a90(*(uint *)(v6 + 448));
      Function_21dde14((uint *)(v6 + 452), v15, v15 - 2048000, -40960, 6);
      Function_2021c94(*(uint *)(v6 + 440), 0);
      Function_2021c94(*(uint *)(v6 + 444), 0);
      ++*v4;
      break;
    case 6:
      Function_21dde74((uint *)(v6 + 44));
      Function_21de660(&v26, 0x80000 - *(uint *)(v6 + 44), 393216, 0);
      v32 = *(uint *)&v26;
      v33 = v27;
      v34 = v28;
      Function_21de660(&v23, *(uint *)(v6 + 44) + 0x80000, 393216, 0);
      v29 = *(uint *)&v23;
      v30 = v24;
      v31 = v25;
      Function_2021c50(*(uint **)(v6 + 440), &v32);
      Function_2021c50(*(uint **)(v6 + 444), &v29);
      Function_21dde74((uint *)(v6 + 452));
      Function_2020a50(*(uint *)(v6 + 452), *(uint *)(v6 + 448));
      if ( Function_21ddd7c((int)v4) )
        ++*v4;
      break;
    case 7:
      SetBrightnessOfBothScreens(0);
      v16 = (uint *)v4[5];
      if ( v16 )
        *v16 = 1;
      v17 = 0;
      v18 = v6;
      do
      {
        Function_2021bd4(*(uint *)(v18 + 440));
        ++v17;
        v18 += 4;
      }
      while ( v17 < 2 );
      Function_21de5a4(v6 + 72, (int **)(v6 + 388));
      Function_21de4ac((int **)(v6 + 72));
      Function_21ddf74(*(uint *)(v6 + 68));
      Function_21ddc28((int)v4, v20);
      break;
    default:
      break;
  }
  result = *v4;
  if ( *v4 != 7 )
    result = Function_20219f8(*(uint *)(v6 + 72));
  return result;
}

//----- (021E2EB0) --------------------------------------------------------
int __fastcall Function_21e2eb0(int a1, int *a2)
{
  int *v2;
  int v3;
  int *v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  uint *v10;
  int v11;
  int v12;
  int result;
  int v14;
  char v15;
  int v16;
  int v17;
  char v18;
  int v19;
  int v20;
  char v21;
  int v22;
  int v23;
  char v24;
  int v25;
  int v26;
  int v27;
  int v28;
  int v29;
  int v30;
  int v31;
  int v32;
  int v33;
  int v34;
  int v35;
  int v36;
  int v37;
  int v38;

  v2 = a2;
  v14 = a1;
  v3 = a2[3];
  switch ( (uchar)a2 )
  {
    case 0:
      v4 = (int *)malloc(4u, 452);
      v2[3] = (int)v4;
      Call_FillMemWithValue(v4, 0, 0x1C4u);
      v3 = v2[3];
      *(uint *)(v3 + 420) = *(uint *)(v2[4] + 36);
      *(uint *)(v3 + 40) = Function_21de1cc();
      Function_21de47c((int **)(v3 + 44), 2, 1, v5);
      Function_21de4cc(v2[8], (int *)(v3 + 44), (int **)(v3 + 360), 0, 1, 2u, 4u, 3u, 600000);
      v6 = 0;
      v7 = v3;
      do
      {
        *(uint *)(v7 + 412) = Function_21de62c((int *)(v3 + 44), v3 + 360, 0x80000, 0, 0, 0);
        Function_2021cac(*(uint *)(v7 + 412), 0);
        Function_2021cf8(*(uint *)(v7 + 412), 2);
        ++v6;
        v7 += 4;
      }
      while ( v6 < 2 );
      Function_201ff0c(0x10u, 1);
      ++*v2;
      break;
    case 1:
      Function_21ddc44(1, 16, -16, a2 + 1, 2);
      ++*v2;
      break;
    case 2:
      if ( a2[1] )
        ++*a2;
      break;
    case 3:
      Function_21dddbc((uint *)v3, -786432, 786432, 8);
      Function_2021cac(*(uint *)(v3 + 412), 1);
      Function_2021cac(*(uint *)(v3 + 416), 1);
      Function_21de660(&v24, 0x80000 - *(uint *)v3, 0x40000, 0);
      v36 = *(uint *)&v24;
      v37 = v25;
      v38 = v26;
      Function_21de660(&v21, *(uint *)v3 + 0x80000, 0x80000, 0);
      v33 = *(uint *)&v21;
      v34 = v22;
      v35 = v23;
      Function_2021c50(*(uint **)(v3 + 412), &v36);
      Function_2021c50(*(uint **)(v3 + 416), &v33);
      Function_21ddd80((uint *)(v3 + 20), 0, 131070, 8);
      ++*v2;
      break;
    case 4:
      v8 = Function_21dddcc((uint *)a2[3]);
      Function_21de660(&v18, 0x80000 - *(uint *)v3, 0x40000, 0);
      v30 = *(uint *)&v18;
      v31 = v19;
      v32 = v20;
      Function_21de660(&v15, *(uint *)v3 + 0x80000, 0x80000, 0);
      v27 = *(uint *)&v15;
      v28 = v16;
      v29 = v17;
      Function_2021c50(*(uint **)(v3 + 412), &v30);
      Function_2021c50(*(uint **)(v3 + 416), &v27);
      Function_21ddd90((uint *)(v3 + 20));
      Function_2021c94(*(uint *)(v3 + 412), *(uint *)(v3 + 20));
      Function_2021c94(*(uint *)(v3 + 416), -*(ushort *)(v3 + 20));
      if ( v8 == 1 )
        ++*v2;
      break;
    case 5:
      Function_21de240((int)a2, *(uint **)(v3 + 40), 8, 4096, 4096);
      v9 = Function_2020a90(*(uint *)(v3 + 420));
      Function_21dde14((uint *)(v3 + 424), v9, v9 - 2048000, -40960, 8);
      ++*v2;
      break;
    case 6:
      Function_21dde74((uint *)(v3 + 424));
      Function_2020a50(*(uint *)(v3 + 424), *(uint *)(v3 + 420));
      if ( Function_21ddd7c((int)v2) == 1 )
        ++*v2;
      break;
    case 7:
      SetBrightnessOfBothScreens(0);
      v10 = (uint *)v2[5];
      if ( v10 )
        *v10 = 1;
      v11 = 0;
      v12 = v3;
      do
      {
        Function_2021bd4(*(uint *)(v12 + 412));
        ++v11;
        v12 += 4;
      }
      while ( v11 < 2 );
      Function_21de5a4(v3 + 44, (int **)(v3 + 360));
      Function_21de4ac((int **)(v3 + 44));
      Function_21de218(*(uint *)(v3 + 40));
      Function_21ddc28((int)v2, v14);
      break;
    default:
      break;
  }
  result = *v2;
  if ( *v2 != 7 )
    result = Function_20219f8(*(uint *)(v3 + 44));
  return result;
}

//----- (021E31A4) --------------------------------------------------------
int __fastcall Function_21e31a4(int a1, int *a2, int a3, int a4)
{
  int *v4;
  int v5;
  int v6;
  int *v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  int v20;
  int v21;
  uint *v22;
  int v23;
  int v24;
  int result;
  int v26;
  int v27;
  char v28;
  int v29;
  int v30;
  char v31;
  int v32;
  int v33;
  int v34;
  int v35;
  int v36;
  int v37;
  int v38;
  int v39;
  int v40;

  v40 = a4;
  v4 = a2;
  v26 = a1;
  v5 = *a2;
  v6 = a2[3];
  if ( (uint)*a2 <= 7 )
    JUMPOUT(__CS__, *((short *)&off_21E31C2 + v5) + 35533252);
  switch ( (uchar)v5 )
  {
    case 0:
      v7 = (int *)malloc(4u, 488);
      v4[3] = (int)v7;
      Call_FillMemWithValue(v7, 0, 0x1E8u);
      v6 = v4[3];
      *(uint *)(v6 + 456) = *(uint *)(v4[4] + 36);
      Function_21e28b0((int **)(v6 + 64), 4u);
      *(uint *)(v6 + 484) = 12;
      Function_21de47c((int **)(v6 + 80), 2, 1, v8);
      Function_21de4cc(v4[8], (int *)(v6 + 80), (int **)(v6 + 396), 0, 1, 5u, 7u, 6u, 600000);
      v9 = 0;
      v10 = v6;
      do
      {
        *(uint *)(v10 + 448) = Function_21de62c((int *)(v6 + 80), v6 + 396, 0x80000, 393216, 0, 0);
        Function_2021cac(*(uint *)(v10 + 448), 0);
        Function_2021f58(*(uint *)(v10 + 448), v9++);
        v10 += 4;
      }
      while ( v9 < 2 );
      Function_201ff0c(0x10u, 1);
      ++*v4;
      goto LABEL_36;
    case 1:
      Function_21ddc44(1, -16, -16, a2 + 1, 2);
      ++*v4;
      goto LABEL_36;
    case 2:
      if ( !--*(uint *)(v6 + 484) )
      {
        Function_21e28e4((int *)(v6 + 64), 0, 191, 682, 49152, 800, (int)&REG_BG0HOFS, 0, 4u);
        *(uint *)(v6 + 76) = 1;
      }
      if ( v4[1] )
        ++*v4;
      goto LABEL_36;
    case 3:
      Function_21ddd80((uint *)(v6 + 24), 0, 16, 8);
      G2x_SetBlendAlpha_((int *)&REG_BLDCNT, 0, 15, *(uint *)(v6 + 24), 16 - *(uint *)(v6 + 24));
      v11 = 0;
      v12 = v6;
      do
      {
        Function_2021cac(*(uint *)(v12 + 448), 1);
        Function_2021cf8(*(uint *)(v12 + 448), 2);
        Function_2021fe0(*(uint *)(v12 + 448), 1);
        ++v11;
        v12 += 4;
      }
      while ( v11 < 2 );
      Function_21ddd80((uint *)(v6 + 44), 0, 0xFFFF, 8);
      ++*v4;
      goto LABEL_36;
    case 4:
      v13 = Function_21ddd90((uint *)(v6 + 24));
      REG_BLDALPHA = *(ushort *)(v6 + 24) | ((16 - *(ushort *)(v6 + 24)) << 8);
      v14 = *(uint *)(v6 + 44) & 0xFFFF;
      if ( Function_21ddd90((uint *)(v6 + 44)) )
      {
        Function_2021c94(*(uint *)(v6 + 448), 0);
        Function_2021c94(*(uint *)(v6 + 452), 0);
      }
      else
      {
        Function_2021c94(*(uint *)(v6 + 448), *(uint *)(v6 + 44));
        Function_2021c94(*(uint *)(v6 + 452), v14);
      }
      if ( v13 == 1 )
      {
        v15 = 0;
        REG_BLDCNT = 0;
        v16 = v6;
        do
        {
          Function_2021fe0(*(uint *)(v16 + 448), 0);
          ++v15;
          v16 += 4;
        }
        while ( v15 < 2 );
        ++*v4;
      }
      goto LABEL_36;
    case 5:
      Function_21dde14((uint *)v6, 4096, 41, 410, 8);
      Function_21de660(&v31, *(uint *)v6, *(uint *)v6, *(uint *)v6);
      v37 = *(uint *)&v31;
      v38 = v32;
      v17 = 0;
      v39 = v33;
      v18 = v6;
      do
      {
        Function_2021c70(*(uint **)(v18 + 448), &v37);
        ++v17;
        v18 += 4;
      }
      while ( v17 < 2 );
      v19 = Function_2020a90(*(uint *)(v6 + 456));
      Function_21dde14((uint *)(v6 + 460), v19, v19 - 2048000, -40960, 8);
      Function_200f174(3u, 24, 0, 0, 8, 1, 4);
      ++*v4;
      goto LABEL_36;
    case 6:
      v27 = Function_21dde74((uint *)a2[3]);
      Function_21de660(&v28, *(uint *)v6, *(uint *)v6, *(uint *)v6);
      v34 = *(uint *)&v28;
      v35 = v29;
      v20 = 0;
      v36 = v30;
      v21 = v6;
      do
      {
        Function_2021c70(*(uint **)(v21 + 448), &v34);
        ++v20;
        v21 += 4;
      }
      while ( v20 < 2 );
      Function_21dde74((uint *)(v6 + 460));
      Function_2020a50(*(uint *)(v6 + 460), *(uint *)(v6 + 456));
      if ( v27 == 1 && Function_200f2ac() == 1 )
        ++*v4;
      goto LABEL_36;
    case 7:
      SetBrightnessWithValue(1, 0);
      v22 = (uint *)v4[5];
      if ( v22 )
        *v22 = 1;
      Function_21e28cc((int **)(v6 + 64));
      v23 = 0;
      *(uint *)(v6 + 76) = 0;
      v24 = v6;
      do
      {
        Function_2021bd4(*(uint *)(v24 + 448));
        ++v23;
        v24 += 4;
      }
      while ( v23 < 2 );
      Function_21de5a4(v6 + 80, (int **)(v6 + 396));
      Function_21de4ac((int **)(v6 + 80));
      result = Function_21ddc28((int)v4, v26);
      break;
    default:
LABEL_36:
      if ( *(uint *)(v6 + 76) == 1 )
        Function_21e290c((int *)(v6 + 64), 2);
      result = *v4;
      if ( *v4 != 7 )
        result = Function_20219f8(*(uint *)(v6 + 80));
      break;
  }
  return result;
}

//----- (021E3560) --------------------------------------------------------
int __fastcall Function_21e3560(int a1, int *a2)
{
  int v2;
  int v3;
  int *v4;
  int v5;
  int v6;
  int v7;
  int v8;
  uint *v9;
  int v10;
  int v11;
  int result;
  int *v13;
  uint *v14;
  int v15;
  int v16;
  int *v17;
  int v18;
  int v19;
  int *v20;
  int v21;
  uint *v22;
  short v23;
  int v24;
  int v25;
  int v26;
  char v27;

  v19 = a1;
  v2 = *a2;
  v20 = a2;
  v3 = a2[3];
  if ( (uint)*a2 <= 7 )
    JUMPOUT(__CS__, *((short *)&off_21E3580 + v2) + 35534210);
  switch ( (uchar)v2 )
  {
    case 0:
      v4 = (int *)malloc(4u, 576);
      v20[3] = (int)v4;
      Call_FillMemWithValue(v4, 0, 0x240u);
      v3 = v20[3];
      *(uint *)(v3 + 544) = *(uint *)(v20[4] + 36);
      Function_21e28b0((int **)(v3 + 528), 4u);
      *(uint *)(v3 + 572) = 14;
      Function_21de47c((int **)v3, 3, 1, v5);
      Function_21de4cc(v20[8], (int *)v3, (int **)(v3 + 316), 0, 1, 2u, 4u, 3u, 600000);
      v6 = 0;
      v7 = v3;
      do
      {
        *(uint *)(v7 + 368) = Function_21de62c((int *)v3, v3 + 316, 0, 0, 0, 0);
        Function_2021cac(*(uint *)(v7 + 368), 0);
        Function_2021cf8(*(uint *)(v7 + 368), 2);
        *(uint *)(v7 + 500) = Function_21de6a4(4u);
        ++v6;
        v7 += 4;
      }
      while ( v6 < 3 );
      Function_201ff0c(0x10u, 1);
      *(uint *)(v3 + 524) = Function_201a778(4u, 1);
      Function_201a7e8(*(uint **)(v20[4] + 8), *(uint *)(v3 + 524), 3, 0, 0, 0x20u, 0x20u, 0, 0);
      v23 = 0;
      Function_201972c(3u, (int)&v23, 2, 30);
      Function_201ada4_ClearTextBox(*(uint *)(v3 + 524), 0);
      Function_201a9a4(*(uint *)(v3 + 524));
      ++*v20;
      goto LABEL_29;
    case 1:
      Function_21ddc44(1, 16, -16, a2 + 1, 2);
      ++*v20;
      goto LABEL_29;
    case 2:
      if ( !--*(uint *)(v3 + 572) )
      {
        Function_21e28e4((int *)(v3 + 528), 0, 191, 682, 49152, 800, (int)&REG_BG0HOFS, 0, 4u);
        *(uint *)(v3 + 540) = 1;
      }
      if ( v20[1] )
      {
        *(uint *)(v3 + 572) = 6;
        ++*v20;
      }
      goto LABEL_29;
    case 3:
      if ( --*(uint *)(v3 + 572) < 0 )
      {
        v8 = Function_2020a90(*(uint *)(v3 + 544));
        Function_21dde14((uint *)(v3 + 548), v8, v8 - 2048000, -40960, 16);
        Function_21ddd80((uint *)(v3 + 440), 0, 0xFFFF, 6);
        Function_21ddd80((uint *)(v3 + 380), 231, -32, 6);
        Function_21de6c4(*(uint *)(v3 + 500), 43, 43, 312, 0, 6, *(uint *)(v3 + 524), 86, 64, 15);
        Function_21de660(&v27, 176128, 946176, 0);
        Function_2021c50(*(uint **)(v3 + 368), (int *)&v27);
        Function_2021cac(*(uint *)(v3 + 368), 1);
        *(uint *)(v3 + 512) = 1;
        ++*v20;
        *(uint *)(v3 + 572) = 4;
      }
      goto LABEL_29;
    case 4:
      if ( --*(uint *)(v3 + 572) < 0 )
      {
        Function_21ddd80((uint *)(v3 + 400), 231, -32, 6);
        Function_21ddd80((uint *)(v3 + 460), 0, -65535, 6);
        Function_21de6c4(*(uint *)(v3 + 504), 215, 215, 312, 0, 6, *(uint *)(v3 + 524), 86, 64, 15);
        Function_21de660(&v27, 880640, 946176, 1);
        Function_2021c50(*(uint **)(v3 + 372), (int *)&v27);
        Function_2021cac(*(uint *)(v3 + 372), 1);
        *(uint *)(v3 + 516) = 1;
        ++*v20;
        *(uint *)(v3 + 572) = 2;
      }
      goto LABEL_29;
    case 5:
      if ( --*(uint *)(v3 + 572) < 0 )
      {
        Function_21ddd80((uint *)(v3 + 420), 231, -32, 6);
        Function_21ddd80((uint *)(v3 + 480), 0, 0xFFFF, 6);
        Function_21de6c4(*(uint *)(v3 + 508), 129, 129, 312, 0, 6, *(uint *)(v3 + 524), 86, 64, 15);
        Function_21de660(&v27, 528384, 946176, 2);
        Function_2021c50(*(uint **)(v3 + 376), (int *)&v27);
        Function_2021cac(*(uint *)(v3 + 376), 1);
        *(uint *)(v3 + 520) = 1;
        ++*v20;
      }
      goto LABEL_29;
    case 6:
      Function_21dde74((uint *)(v3 + 548));
      Function_2020a50(*(uint *)(v3 + 548), *(uint *)(v3 + 544));
      if ( !*(uint *)(v3 + 512) && !*(uint *)(v3 + 516) && !*(uint *)(v3 + 520) )
        ++*v20;
      goto LABEL_29;
    case 7:
      SetBrightnessOfBothScreens(0);
      v9 = (uint *)v20[5];
      if ( v9 )
        *v9 = 1;
      Function_21e28cc((int **)(v3 + 528));
      v10 = 0;
      *(uint *)(v3 + 540) = 0;
      v11 = v3;
      do
      {
        Function_2021bd4(*(uint *)(v11 + 368));
        Function_21de6bc(*(uint *)(v11 + 500));
        ++v10;
        v11 += 4;
      }
      while ( v10 < 3 );
      Function_21de5a4(v3, (int **)(v3 + 316));
      Function_21de4ac((int **)v3);
      Function_201acf4(*(uint *)(v3 + 524));
      Function_201a8fc(*(uint *)(v3 + 524));
      Function_201a928(*(uint *)(v3 + 524), 1);
      Function_2019690(3u, 32, 0, 4u);
      Function_2019ebc(*(uint **)(v20[4] + 8), 3u);
      result = Function_21ddc28((int)v20, v19);
      break;
    default:
LABEL_29:
      if ( *(uint *)(v3 + 540) == 1 )
        Function_21e290c((int *)(v3 + 528), 2);
      v21 = 0;
      v13 = (int *)v3;
      v22 = (uint *)(v3 + 380);
      v14 = (uint *)(v3 + 440);
      v15 = v3;
      do
      {
        if ( v13[128] == 1 )
        {
          if ( Function_21de71c(v13[125]) )
            v13[128] = 0;
          Function_21ddd90(v22);
          Function_21ddd90(v14);
          Function_2021c94(v13[92], *(uint *)(v15 + 440));
          v16 = v13[92];
          Function_2021d28();
          v18 = v17[1];
          v24 = *v17;
          v25 = v18;
          v26 = v17[2];
          v25 = *(uint *)(v15 + 380) << 12;
          Function_2021c50((uint *)v13[92], &v24);
        }
        ++v13;
        v22 += 5;
        v14 += 5;
        v15 += 20;
        ++v21;
      }
      while ( v21 < 3 );
      Function_201a9a4(*(uint *)(v3 + 524));
      result = *v20;
      if ( *v20 != 7 )
        result = Function_20219f8(*(uint *)v3);
      break;
  }
  return result;
}

//----- (021E3AD0) --------------------------------------------------------
int __fastcall Function_21e3ad0(int a1, int *a2, int a3, int a4)
{
  int *v4;
  int v5;
  int v6;
  int *v7;
  int v8;
  int v9;
  int v10;
  uint *v11;
  int result;
  char v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19[3];
  int v20;

  v20 = a4;
  v4 = a2;
  v5 = a1;
  v6 = a2[3];
  switch ( (uchar)a2 )
  {
    case 0:
      v7 = (int *)malloc(4u, 496);
      v4[3] = (int)v7;
      Call_FillMemWithValue(v7, 0, 0x1F0u);
      v6 = v4[3];
      *(uint *)(v6 + 464) = *(uint *)(v4[4] + 36);
      Function_21de47c((int **)(v6 + 92), 1, 1, v8);
      Function_21de4cc(v4[8], (int *)(v6 + 92), (int **)(v6 + 408), 0, 1, 2u, 4u, 3u, 600000);
      *(uint *)(v6 + 460) = Function_21de62c((int *)(v6 + 92), v6 + 408, 0x80000, -131072, 0, 0);
      Function_2021cac(*(uint *)(v6 + 460), 0);
      Function_201ff0c(0x10u, 1);
      ++*v4;
      break;
    case 1:
      Function_21ddc44(1, -16, -16, a2 + 1, 2);
      ++*v4;
      break;
    case 2:
      if ( a2[1] )
        ++*a2;
      break;
    case 3:
      Function_21dde14((uint *)v6, 0, 0x100000, 0x2000, 12);
      Function_2021cac(*(uint *)(v6 + 460), 1);
      Function_21dde14((uint *)(v6 + 24), 410, 0x2000, 0, 12);
      Function_21dde14((uint *)(v6 + 48), 410, 0x2000, 0, 12);
      Function_21de660(v19, *(uint *)(v6 + 24), *(uint *)(v6 + 48), 0);
      Function_2021c80(*(uint **)(v6 + 460), v19, 2);
      Function_21ddd80((uint *)(v6 + 72), 0, 0xFFFF, 12);
      ++*v4;
      break;
    case 4:
      v9 = Function_21dde74((uint *)a2[3]);
      Function_21de660(&v13, 0x80000, *(uint *)v6 - 0x20000, 0);
      v16 = *(uint *)&v13;
      v17 = v14;
      v18 = v15;
      Function_2021c50(*(uint **)(v6 + 460), &v16);
      Function_21dde74((uint *)(v6 + 24));
      Function_21dde74((uint *)(v6 + 48));
      Function_21de660(v19, *(uint *)(v6 + 24), *(uint *)(v6 + 48), 0);
      Function_2021c70(*(uint **)(v6 + 460), v19);
      Function_21ddd90((uint *)(v6 + 72));
      Function_2021c94(*(uint *)(v6 + 460), *(uint *)(v6 + 72));
      if ( v9 == 1 )
      {
        Function_2021cac(*(uint *)(v6 + 460), 0);
        ++*v4;
      }
      break;
    case 5:
      Function_5_21ef3fc(*(uint *)(*(uint *)(a2[4] + 4) + 28));
      v10 = Function_2020a90(*(uint *)(v6 + 464));
      Function_21dde14((uint *)(v6 + 468), v10, v10 - 4096000, 40960, 8);
      Function_200f174(3u, 18, 0, 0, 8, 1, 4);
      ++*v4;
      break;
    case 6:
      Function_21dde74((uint *)(v6 + 468));
      Function_2020a50(*(uint *)(v6 + 468), *(uint *)(v6 + 464));
      if ( Function_200f2ac() )
        ++*v4;
      break;
    case 7:
      SetBrightnessWithValue(1, 0);
      Function_5_21ef3dc(*(uint *)(*(uint *)(v4[4] + 4) + 28));
      v11 = (uint *)v4[5];
      if ( v11 )
        *v11 = 1;
      Function_2021bd4(*(uint *)(v6 + 460));
      Function_21de5a4(v6 + 92, (int **)(v6 + 408));
      Function_21de4ac((int **)(v6 + 92));
      Function_21ddc28((int)v4, v5);
      break;
    default:
      break;
  }
  result = *v4;
  if ( *v4 != 7 )
    result = Function_20219f8(*(uint *)(v6 + 92));
  return result;
}

//----- (021E3D8C) --------------------------------------------------------
int __fastcall Function_21e3d8c(int a1, int *a2)
{
  int v2;
  int v3;
  int *v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  uint *v12;
  int v13;
  int v14;
  int v15;
  uint *v16;
  int v17;
  int v18;
  int v19;
  int *v20;
  int v21;
  int result;
  int v23;
  int *v24;
  int v25;
  uint *v26;
  short v27;
  int v28;
  int v29;
  int v30;
  char v31;

  v23 = a1;
  v2 = *a2;
  v24 = a2;
  v3 = a2[3];
  if ( (uint)*a2 <= 9 )
    JUMPOUT(__CS__, (char *)&off_21E3DAC + *((short *)&off_21E3DAC + v2) + 2);
  switch ( (uchar)a2 )
  {
    case 0:
      v4 = (int *)malloc(4u, 552);
      v24[3] = (int)v4;
      Call_FillMemWithValue(v4, 0, 0x228u);
      v3 = v24[3];
      *(uint *)(v3 + 520) = *(uint *)(v24[4] + 36);
      Function_21de47c((int **)v3, 3, 1, v5);
      Function_21de4cc(v24[8], (int *)v3, (int **)(v3 + 316), 0, 1, 2u, 4u, 3u, 600000);
      v6 = 0;
      v7 = v3;
      do
      {
        *(uint *)(v7 + 368) = Function_21de62c((int *)v3, v3 + 316, 0, -32, 0, 0);
        Function_2021cac(*(uint *)(v7 + 368), 0);
        ++v6;
        v7 += 4;
      }
      while ( v6 < 3 );
      Function_201ff0c(0x10u, 1);
      *(uint *)(v3 + 512) = Function_201a778(4u, 1);
      Function_201a7e8(*(uint **)(v24[4] + 8), *(uint *)(v3 + 512), 3, 0, 0, 0x20u, 0x20u, 0, 0);
      v27 = 0;
      Function_201972c(3u, (int)&v27, 2, 30);
      Function_201ada4_ClearTextBox(*(uint *)(v3 + 512), 0);
      Function_201a9a4(*(uint *)(v3 + 512));
      *(uint *)(v3 + 516) = Function_21de8f8(4u);
      ++*v24;
      break;
    case 1:
      Function_21ddc44(1, 16, -16, a2 + 1, 2);
      ++*v24;
      break;
    case 2:
      if ( a2[1] )
      {
        *a2 = v2 + 1;
        *(ushort *)(v3 + 548) = 0;
      }
      break;
    case 3:
      if ( (short)--*(ushort *)(v3 + 548) <= 0 )
      {
        Function_21ddd80((uint *)(v3 + 380), -32, 224, 5);
        Function_21de660(&v31, 0x80000, -131072, 0);
        Function_2021c50(*(uint **)(v3 + 368), (int *)&v31);
        Function_2021cac(*(uint *)(v3 + 368), 1);
        Function_21ddd80((uint *)(v3 + 440), 0, 0xFFFF, 5);
        Function_2021cf8(*(uint *)(v3 + 368), 2);
        *(uint *)(v3 + 500) = 1;
        ++*v24;
        *(ushort *)(v3 + 548) = 1;
      }
      break;
    case 4:
      if ( (short)--*(ushort *)(v3 + 548) <= 0 )
      {
        Function_21ddd80((uint *)(v3 + 400), -32, 224, 5);
        Function_21de660(&v31, 851968, -131072, 0);
        Function_2021c50(*(uint **)(v3 + 372), (int *)&v31);
        Function_2021cac(*(uint *)(v3 + 372), 1);
        Function_21ddd80((uint *)(v3 + 460), 0, -65535, 5);
        Function_2021cf8(*(uint *)(v3 + 372), 2);
        *(uint *)(v3 + 504) = 1;
        ++*v24;
        *(ushort *)(v3 + 548) = 3;
      }
      break;
    case 5:
      if ( (short)--*(ushort *)(v3 + 548) <= 0 )
      {
        Function_21ddd80((uint *)(v3 + 420), -32, 224, 5);
        Function_21de660(&v31, 196608, -131072, 0);
        Function_2021c50(*(uint **)(v3 + 376), (int *)&v31);
        Function_2021cac(*(uint *)(v3 + 376), 1);
        Function_21ddd80((uint *)(v3 + 480), 0, 0xFFFF, 5);
        Function_2021cf8(*(uint *)(v3 + 376), 2);
        *(uint *)(v3 + 508) = 1;
        ++*v24;
      }
      break;
    case 6:
      if ( !*(uint *)(v3 + 500) && !*(uint *)(v3 + 504) && !*(uint *)(v3 + 508) )
      {
        v8 = 0;
        v9 = a2[3];
        do
        {
          Function_2021cac(*(uint *)(v9 + 368), 0);
          ++v8;
          v9 += 4;
        }
        while ( v8 < 3 );
        ++*v24;
      }
      break;
    case 7:
      Function_21de948(*(uint *)(v3 + 516), 1, 1, *(uint *)(v3 + 512), 15);
      v10 = Function_2020a90(*(uint *)(v3 + 520));
      Function_21dde14((uint *)(v3 + 524), v10, v10 - 4096000, 40960, 64);
      ++*v24;
      break;
    case 8:
      v11 = Function_21de988(*(uchar **)(v3 + 516));
      Function_201a9a4(*(uint *)(v3 + 512));
      Function_21dde74((uint *)(v3 + 524));
      Function_2020a50(*(uint *)(v3 + 524), *(uint *)(v3 + 520));
      if ( v11 == 1 )
        ++*v24;
      break;
    case 9:
      SetBrightnessOfBothScreens(0);
      v12 = (uint *)v24[5];
      if ( v12 )
        *v12 = 1;
      v13 = 0;
      v14 = v3;
      do
      {
        Function_2021bd4(*(uint *)(v14 + 368));
        ++v13;
        v14 += 4;
      }
      while ( v13 < 3 );
      Function_21de5a4(v3, (int **)(v3 + 316));
      Function_21de4ac((int **)v3);
      Function_21de928(*(uint *)(v3 + 516));
      Function_201acf4(*(uint *)(v3 + 512));
      Function_201a8fc(*(uint *)(v3 + 512));
      Function_201a928(*(uint *)(v3 + 512), 1);
      Function_2019690(3u, 32, 0, 4u);
      Function_2019ebc(*(uint **)(v24[4] + 8), 3u);
      Function_21ddc28((int)v24, v23);
      break;
    default:
      break;
  }
  v25 = 0;
  v15 = v3;
  v26 = (uint *)(v3 + 380);
  v16 = (uint *)(v3 + 440);
  v17 = v3;
  do
  {
    if ( *(uint *)(v15 + 500) == 1 )
    {
      v18 = Function_21ddd90(v26);
      Function_21ddd90(v16);
      if ( v18 )
        *(uint *)(v15 + 500) = 0;
      v19 = *(uint *)(v15 + 368);
      Function_2021d28();
      v21 = v20[1];
      v28 = *v20;
      v29 = v21;
      v30 = v20[2];
      v29 = *(uint *)(v17 + 380) << 12;
      Function_2021c50(*(uint **)(v15 + 368), &v28);
      Function_2021c94(*(uint *)(v15 + 368), *(uint *)(v17 + 440));
    }
    v15 += 4;
    v26 += 5;
    v16 += 5;
    v17 += 20;
    ++v25;
  }
  while ( v25 < 3 );
  result = *v24;
  if ( *v24 != 9 )
    result = Function_20219f8(*(uint *)v3);
  return result;
}

//----- (021E4260) --------------------------------------------------------
int __fastcall Function_21e4260(int a1, int *a2)
{
  int *v2;
  int v3;
  int v4;
  int v5;
  int *v6;
  int v7;
  int v8;
  int v9;
  uint *v10;
  int result;
  char v12;
  int v13;
  int v14;
  char v15;
  int v16;
  int v17;
  int v18;
  int v19;
  int v20;
  int v21;
  int v22;
  int v23;

  v2 = a2;
  v3 = a1;
  v4 = *a2;
  v5 = a2[3];
  if ( (uint)*a2 <= 7 )
    JUMPOUT(__CS__, (char *)&off_21E427E + *((short *)&off_21E427E + v4) + 2);
  switch ( (uchar)a2 )
  {
    case 0:
      v6 = (int *)malloc(4u, 420);
      v2[3] = (int)v6;
      Call_FillMemWithValue(v6, 0, 0x1A4u);
      v5 = v2[3];
      Function_21de47c((int **)(v2[3] + 44), 1, 1, v7);
      Function_21de4cc(v2[8], (int *)(v5 + 44), (int **)(v5 + 360), 0, 1, 5u, 7u, 6u, 600000);
      *(uint *)(v5 + 412) = Function_21de62c((int *)(v5 + 44), v5 + 360, 0x80000, 393216, 0, 0);
      Function_2021cac(*(uint *)(v5 + 412), 0);
      Function_2021fe0(*(uint *)(v5 + 412), 1);
      Function_201ff0c(0x10u, 1);
      ++*v2;
      break;
    case 1:
      Function_21ddc44(1, 16, -16, a2 + 1, 2);
      ++*v2;
      break;
    case 2:
      if ( a2[1] )
        *a2 = v4 + 1;
      break;
    case 3:
      Function_21ddd80((uint *)a2[3], 0, 16, 12);
      G2x_SetBlendAlpha_((int *)&REG_BLDCNT, 0, 15, *(uint *)v5, 16 - *(uint *)v5);
      Function_2021cac(*(uint *)(v5 + 412), 1);
      ++*v2;
      break;
    case 4:
      v8 = Function_21ddd90((uint *)a2[3]);
      REG_BLDALPHA = ((16 - *(ushort *)v5) << 8) | *(ushort *)v5;
      if ( v8 == 1 )
      {
        REG_BLDCNT = 0;
        Function_2021fe0(*(uint *)(v5 + 412), 0);
        ++*v2;
      }
      break;
    case 5:
      Function_21dde14((uint *)(v5 + 20), 4096, 410, 1, 6);
      Function_2021cf8(*(uint *)(v5 + 412), 2);
      Function_21de660(&v15, *(uint *)(v5 + 20), *(uint *)(v5 + 20), *(uint *)(v5 + 20));
      v21 = *(uint *)&v15;
      v22 = v16;
      v23 = v17;
      Function_2021c70(*(uint **)(v5 + 412), &v21);
      Function_5_21ef3fc(*(uint *)(*(uint *)(v2[4] + 4) + 28));
      Function_200f174(3u, 16, 0, 0, 6, 1, 4);
      ++*v2;
      break;
    case 6:
      v9 = Function_21dde74((uint *)(v5 + 20));
      Function_21de660(&v12, *(uint *)(v5 + 20), *(uint *)(v5 + 20), *(uint *)(v5 + 20));
      v18 = *(uint *)&v12;
      v19 = v13;
      v20 = v14;
      Function_2021c70(*(uint **)(v5 + 412), &v18);
      if ( v9 == 1 && Function_200f2ac() == 1 )
        ++*v2;
      break;
    case 7:
      SetBrightnessWithValue(1, 0);
      Function_5_21ef3dc(*(uint *)(*(uint *)(v2[4] + 4) + 28));
      v10 = (uint *)v2[5];
      if ( v10 )
        *v10 = 1;
      Function_2021bd4(*(uint *)(v5 + 412));
      Function_21de5a4(v5 + 44, (int **)(v5 + 360));
      Function_21de4ac((int **)(v5 + 44));
      Function_21ddc28((int)v2, v3);
      break;
    default:
      break;
  }
  result = *v2;
  if ( *v2 != 7 )
    result = Function_20219f8(*(uint *)(v5 + 44));
  return result;
}

//----- (021E44C0) --------------------------------------------------------
int __fastcall Function_21e44c0(int a1, uint *a2, int a3, int a4)
{
  int v4;
  int v5;
  int *v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  uint *v13;
  int v14;
  uint *v15;
  int v16;
  int v17;
  int result;
  int v19;
  int v20;
  int v21[3];
  int v22;

  v22 = a4;
  v4 = (int)a2;
  v19 = a1;
  v5 = a2[3];
  switch ( (uchar)a2 )
  {
    case 0:
      v6 = (int *)malloc(4u, 432);
      *(uint *)(v4 + 12) = v6;
      Call_FillMemWithValue(v6, 0, 0x1B0u);
      v5 = *(uint *)(v4 + 12);
      Function_21de47c(*(int ***)(v4 + 12), 4, 1, v7);
      Function_21de4cc(*(uint *)(v4 + 32), (int *)v5, (int **)(v5 + 316), 0, 1, 2u, 4u, 3u, 600000);
      v8 = 0;
      v9 = v5;
      do
      {
        *(uint *)(v9 + 368) = Function_21de62c((int *)v5, v5 + 316, 0x80000, 393216, 0, 0);
        Function_2021cac(*(uint *)(v9 + 368), 0);
        ++v8;
        v9 += 4;
      }
      while ( v8 < 4 );
      Function_201ff0c(0x10u, 1);
      ++*(uint *)v4;
      break;
    case 1:
      Function_21ddc44(1, 16, -16, a2 + 1, 2);
      ++*(uint *)v4;
      break;
    case 2:
      if ( a2[1] )
        ++*a2;
      break;
    case 3:
      Function_21dde14((uint *)(v5 + 384), 0, 0x80000, 410, 4);
      Function_21dde14((uint *)(v5 + 408), 0, 655360, 410, 4);
      v10 = 0;
      v11 = v5;
      do
      {
        Function_2021cac(*(uint *)(v11 + 368), 1);
        ++v10;
        v11 += 4;
      }
      while ( v10 < 4 );
      ++*(uint *)v4;
      break;
    case 4:
      v12 = 0;
      v13 = (uint *)(v5 + 384);
      do
      {
        v14 = Function_21dde74(v13);
        ++v12;
        v13 += 6;
        v20 = v14;
      }
      while ( v12 < 2 );
      Function_21de660(v21, 0x80000, 393216 - *(uint *)(v5 + 384), 0);
      Function_2021c50(*(uint **)(v5 + 368), v21);
      Function_21de660(v21, 0x80000, *(uint *)(v5 + 384) + 393216, 0);
      Function_2021c50(*(uint **)(v5 + 372), v21);
      Function_21de660(v21, 0x80000 - *(uint *)(v5 + 408), 393216, 0);
      Function_2021c50(*(uint **)(v5 + 376), v21);
      Function_21de660(v21, *(uint *)(v5 + 408) + 0x80000, 393216, 0);
      Function_2021c50(*(uint **)(v5 + 380), v21);
      if ( v20 == 1 )
        ++*(uint *)v4;
      break;
    case 5:
      Function_5_21ef3fc(*(uint *)(*(uint *)(a2[4] + 4) + 28));
      Function_200f174(3u, 34, 0, 0, 8, 1, 4);
      ++*(uint *)v4;
      break;
    case 6:
      if ( Function_200f2ac() == 1 )
        ++*(uint *)v4;
      break;
    case 7:
      SetBrightnessWithValue(1, 0);
      Function_5_21ef3dc(*(uint *)(*(uint *)(*(uint *)(v4 + 16) + 4) + 28));
      v15 = *(uint **)(v4 + 20);
      if ( v15 )
        *v15 = 1;
      v16 = 0;
      v17 = v5;
      do
      {
        Function_2021bd4(*(uint *)(v17 + 368));
        ++v16;
        v17 += 4;
      }
      while ( v16 < 4 );
      Function_21de5a4(v5, (int **)(v5 + 316));
      Function_21de4ac((int **)v5);
      Function_21ddc28(v4, v19);
      break;
    default:
      break;
  }
  result = *(uint *)v4;
  if ( *(uint *)v4 != 7 )
    result = Function_20219f8(*(uint *)v5);
  return result;
}

//----- (021E4738) --------------------------------------------------------
int __fastcall Function_21e4738(int a1, int *a2)
{
  int v2;
  int v3;
  int *v4;
  int v5;
  int v6;
  int v7;
  int v8;
  uint *v9;
  int v10;
  int v11;
  int v12;
  int *v13;
  int v14;
  int v15;
  int result;
  int v17;
  int v18;
  int v19;
  uint *v20;
  uint *v21;
  uint *v22;
  uint *v23;
  int v24[3];
  char v25;

  v17 = a1;
  v2 = *a2;
  v18 = (int)a2;
  v3 = a2[3];
  if ( (uint)*a2 <= 7 )
    JUMPOUT(__CS__, (char *)&off_21E4758 + *((short *)&off_21E4758 + v2) + 2);
  switch ( (uchar)a2 )
  {
    case 0:
      v4 = (int *)malloc(4u, 976);
      *(uint *)(v18 + 12) = v4;
      Call_FillMemWithValue(v4, 0, 0x3D0u);
      v3 = *(uint *)(v18 + 12);
      Function_21de47c(*(int ***)(v18 + 12), 6, 1, v5);
      Function_21de4cc(*(uint *)(v18 + 32), (int *)v3, (int **)(v3 + 316), 0, 1, 2u, 4u, 3u, 600000);
      v6 = 0;
      v7 = v3;
      do
      {
        *(uint *)(v7 + 368) = Function_21de62c((int *)v3, v3 + 316, 0, 0, 0, 0);
        Function_2021cac(*(uint *)(v7 + 368), 0);
        ++v6;
        v7 += 4;
      }
      while ( v6 < 6 );
      Function_201ff0c(0x10u, 1);
      ++*(uint *)v18;
      break;
    case 1:
      Function_21ddc44(1, -16, -16, a2 + 1, 2);
      ++*(uint *)v18;
      break;
    case 2:
      if ( a2[1] )
      {
        *a2 = v2 + 1;
        *(uint *)(v3 + 968) = 0;
        *(uint *)(v3 + 972) = dword_21F9EAC[8 * *(uint *)(v3 + 968)];
      }
      break;
    case 3:
      if ( --*(uint *)(v3 + 972) < 0 )
      {
        Function_21dde14(
          (uint *)(v3 + 536 + 24 * *(uint *)(v3 + 968)),
          dword_21F9E94[8 * *(uint *)(v3 + 968)],
          dword_21F9E98[8 * *(uint *)(v3 + 968)],
          dword_21F9E9C[8 * *(uint *)(v3 + 968)],
          8);
        Function_21dde14(
          (uint *)(v3 + 680 + 24 * *(uint *)(v3 + 968)),
          dword_21F9EA0[8 * *(uint *)(v3 + 968)],
          dword_21F9EA4[8 * *(uint *)(v3 + 968)],
          dword_21F9EA8[8 * *(uint *)(v3 + 968)],
          8);
        Function_21dde14((uint *)(v3 + 392 + 24 * *(uint *)(v3 + 968)), 0x2000, 41, -1638, 8);
        Function_21ddd80(
          (uint *)(v3 + 824 + 20 * *(uint *)(v3 + 968)),
          0,
          dword_21F9EB0[8 * *(uint *)(v3 + 968)],
          8);
        Function_2021cac(*(uint *)(v3 + 4 * *(uint *)(v3 + 968) + 368), 1);
        Function_21de660(&v25, dword_21F9E94[8 * *(uint *)(v3 + 968)], dword_21F9EA0[8 * *(uint *)(v3 + 968)], 0);
        Function_2021c50(*(uint **)(v3 + 4 * *(uint *)(v3 + 968) + 368), (int *)&v25);
        Function_21de660(v24, 0x2000, 0x2000, 0);
        Function_2021c80(*(uint **)(v3 + 4 * *(uint *)(v3 + 968) + 368), v24, 2);
        *(uint *)(v3 + 4 * (*(uint *)(v3 + 968))++ + 944) = 1;
        v8 = *(uint *)(v3 + 968);
        if ( v8 < 6 )
          *(uint *)(v3 + 972) = dword_21F9EAC[8 * v8];
        else
          ++*(uint *)v18;
      }
      break;
    case 4:
      if ( !*(uint *)(v3 + 964) )
        *a2 = v2 + 1;
      break;
    case 5:
      Function_5_21ef3fc(*(uint *)(*(uint *)(a2[4] + 4) + 28));
      Function_200f174(3u, 34, 0, 0, 12, 1, 4);
      ++*(uint *)v18;
      break;
    case 6:
      if ( Function_200f2ac() )
        ++*(uint *)v18;
      break;
    case 7:
      SetBrightnessWithValue(1, 0);
      Function_5_21ef3dc(*(uint *)(*(uint *)(*(uint *)(v18 + 16) + 4) + 28));
      v9 = *(uint **)(v18 + 20);
      if ( v9 )
        *v9 = 1;
      v10 = 0;
      v11 = v3;
      do
      {
        Function_2021bd4(*(uint *)(v11 + 368));
        ++v10;
        v11 += 4;
      }
      while ( v10 < 6 );
      Function_21de5a4(v3, (int **)(v3 + 316));
      Function_21de4ac((int **)v3);
      Function_21ddc28(v18, v17);
      break;
    default:
      break;
  }
  v19 = 0;
  v23 = (uint *)(v3 + 536);
  v22 = (uint *)(v3 + 680);
  v21 = (uint *)(v3 + 392);
  v12 = v3;
  v20 = (uint *)(v3 + 824);
  v13 = (int *)v3;
  v14 = v3;
  do
  {
    if ( *(uint *)(v12 + 944) == 1 )
    {
      v15 = Function_21dde74(v23);
      Function_21dde74(v22);
      Function_21dde74(v21);
      Function_21ddd90(v20);
      if ( v15 )
      {
        *(uint *)(v12 + 944) = 0;
        Function_2021cac(*(uint *)(v12 + 368), 0);
      }
      Function_21de660(&v25, v13[134], v13[170], 0);
      Function_2021c50(*(uint **)(v12 + 368), (int *)&v25);
      Function_21de660(v24, v13[98], v13[98], 0);
      Function_2021c70(*(uint **)(v12 + 368), v24);
      Function_2021c94(*(uint *)(v12 + 368), *(uint *)(v14 + 824));
    }
    v12 += 4;
    v23 += 6;
    v13 += 6;
    v22 += 6;
    v14 += 20;
    v21 += 6;
    v20 += 5;
    ++v19;
  }
  while ( v19 < 6 );
  result = *(uint *)v18;
  if ( *(uint *)v18 != 7 )
    result = Function_20219f8(*(uint *)v3);
  return result;
}

//----- (021E4B3C) --------------------------------------------------------
int __fastcall Function_21e4b3c(int a1, int *a2)
{
  int *v2;
  int v3;
  int v4;
  int v5;
  int *v6;
  int v7;
  int v8;
  uint *v9;
  int result;
  short v11;

  v2 = a2;
  v3 = a1;
  v4 = *a2;
  v5 = a2[3];
  if ( (uint)*a2 <= 7 )
    JUMPOUT(__CS__, (char *)&off_21E4B5A + *((short *)&off_21E4B5A + v4) + 2);
  switch ( (uchar)a2 )
  {
    case 0:
      v6 = (int *)malloc(4u, 444);
      v2[3] = (int)v6;
      Call_FillMemWithValue(v6, 0, 0x1BCu);
      v5 = v2[3];
      Function_21de47c((int **)(v2[3] + 8), 1, 1, v7);
      Function_21de4cc(v2[8], (int *)(v5 + 8), (int **)(v5 + 324), 1u, 1, 8u, 0xAu, 9u, 600000);
      *(uint *)(v5 + 376) = Function_21de62c((int *)(v5 + 8), v5 + 324, 0x80000, 393216, 0, 0);
      Function_2021cac(*(uint *)(v5 + 376), 0);
      Function_2021fe0(*(uint *)(v5 + 376), 1);
      Function_2021e80(*(uint *)(v5 + 376), 1);
      Function_201ff0c(0x10u, 1);
      *(uint *)(v5 + 4) = Function_21debec(4u);
      *(uint *)v5 = Function_201a778(4u, 1);
      Function_201a7e8(*(uint **)(v2[4] + 8), *(uint *)v5, 3, 0, 0, 0x20u, 0x20u, 0, 0);
      v11 = 0;
      Function_201972c(3u, (int)&v11, 2, 30);
      Function_201ada4_ClearTextBox(*(uint *)v5, 0);
      Function_201a9a4(*(uint *)v5);
      ++*v2;
      break;
    case 1:
      Function_21ddc44(1, 16, -16, a2 + 1, 2);
      ++*v2;
      break;
    case 2:
      if ( a2[1] )
        *a2 = v4 + 1;
      break;
    case 3:
      Function_21ddd80((uint *)(v5 + 400), 0, 16, 15);
      Function_2021cac(*(uint *)(v5 + 376), 1);
      G2x_SetBlendAlpha_((int *)&REG_BLDCNT, 0, 15, *(uint *)(v5 + 400), 16 - *(uint *)(v5 + 400));
      ++*v2;
      break;
    case 4:
      v8 = Function_21ddd90((uint *)(v5 + 400));
      REG_BLDALPHA = *(ushort *)(v5 + 400) | ((16 - *(ushort *)(v5 + 400)) << 8);
      if ( v8 == 1 )
      {
        REG_BLDCNT = 0;
        Function_2021fe0(*(uint *)(v5 + 376), 0);
        ++*v2;
        *(uint *)(v5 + 440) = 16;
      }
      break;
    case 5:
      if ( --*(uint *)(v5 + 440) <= 0 )
      {
        Function_21ddd80((uint *)(v5 + 380), 0, 14, 16);
        Function_21dec38(*(int **)(v5 + 4), 16, *(uint *)v5, 15);
        ++*v2;
      }
      break;
    case 6:
      Function_21ddd90((uint *)(v5 + 380));
      REG_MOSAIC_OBJ = *(uchar *)(v5 + 380) | 16 * *(uchar *)(v5 + 380);
      if ( Function_21decb8(*(uint *)(v5 + 4)) )
        ++*v2;
      Function_201a9a4(*(uint *)v5);
      break;
    case 7:
      SetBrightnessOfBothScreens(0);
      Function_21dec18(*(int **)(v5 + 4));
      v9 = (uint *)v2[5];
      if ( v9 )
        *v9 = 1;
      Function_2021bd4(*(uint *)(v5 + 376));
      Function_21de5a4(v5 + 8, (int **)(v5 + 324));
      Function_21de4ac((int **)(v5 + 8));
      Function_201acf4(*(uint *)v5);
      Function_201a8fc(*(uint *)v5);
      Function_201a928(*(uint *)v5, 1);
      Function_2019690(3u, 32, 0, 4u);
      Function_2019ebc(*(uint **)(v2[4] + 8), 3u);
      REG_MOSAIC_OBJ = 0;
      Function_21ddc28((int)v2, v3);
      break;
    default:
      break;
  }
  result = *v2;
  if ( *v2 != 7 )
    result = Function_20219f8(*(uint *)(v5 + 8));
  return result;
}

//----- (021E4DE0) --------------------------------------------------------
int __fastcall Function_21e4de0(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  short v7;
  short v8;
  short v9;
  int v10;

  v10 = a4;
  v4 = a2;
  v5 = a1;
  Function_2020910(*(ushort *)(a2 + 8), *(uint *)(a1 + 36));
  Function_2020a50(*(uint *)v4, *(uint *)(v5 + 36));
  v7 = *(ushort *)(v4 + 4);
  v8 = *(ushort *)(v4 + 6);
  v9 = 0;
  return Function_20209d4(&v7, *(ushort **)(v5 + 36));
}

//----- (021E4E14) --------------------------------------------------------
int __fastcall Function_21e4e14(int a1, int *a2)
{
  int *v2;
  int v3;
  int result;
  int v5;
  uchar *v6;
  int v7;
  uint v8;
  uint *v9;

  v2 = a2;
  v3 = a1;
  result = *a2;
  v5 = a2[3];
  if ( (uint)*a2 <= 7 )
    JUMPOUT(__CS__, (char *)&off_21E4E32 + *((short *)&off_21E4E32 + result) + 2);
  switch ( (uchar)a2 )
  {
    case 0:
      v6 = (uchar *)malloc(4u, 16);
      v2[3] = (int)v6;
      v7 = 16;
      do
      {
        *v6++ = 0;
        --v7;
      }
      while ( v7 );
      Function_201ff0c(2u, 0);
      Function_201ff0c(4u, 0);
      Function_201ff0c(8u, 0);
      result = *v2 + 1;
      *v2 = result;
      break;
    case 1:
      Function_21ddc44(1, 16, 16, a2 + 1, 1);
      result = *v2 + 1;
      *v2 = result;
      break;
    case 2:
      if ( a2[1] )
        *a2 = ++result;
      break;
    case 3:
      *(uint *)v5 = Function_21e22b0(3, 15);
      *(uint *)(v5 + 8) = 0;
      *(uint *)(v5 + 12) = HIWORD(dword_21F9DD4[2]);
      result = *v2 + 1;
      *v2 = result;
      break;
    case 4:
      result = *(uint *)(v5 + 12) - 1;
      *(uint *)(v5 + 12) = result;
      if ( result < 0 )
      {
        Function_21e4de0(a2[4], (int)&dword_21F9DD4[3 * *(uint *)(v5 + 8)], *(uint *)(v5 + 8), (int)dword_21F9DD4);
        v8 = *(uint *)(v5 + 8) + 1;
        *(uint *)(v5 + 8) = v8;
        if ( v8 < 0x10 )
        {
          result = HIWORD(dword_21F9DD4[3 * v8 + 2]);
          *(uint *)(v5 + 12) = result;
        }
        else
        {
          result = *v2 + 1;
          *v2 = result;
        }
      }
      break;
    case 5:
      Function_200f174(3u, 0, 0, 0x7FFF, 10, 1, 4);
      result = *v2 + 1;
      *v2 = result;
      break;
    case 6:
      result = Function_200f2ac();
      if ( result )
      {
        v2[1] = 0;
        result = *v2 + 1;
        *v2 = result;
      }
      break;
    case 7:
      SetBrightnessWithValue(1, 0x7FFF);
      Function_21e2310((char ****)v5);
      REG_BLDCNT = 0;
      v9 = (uint *)v2[5];
      if ( v9 )
        *v9 = 1;
      Function_21ddc28((int)v2, v3);
      result = (int)SetBrightnessWithValue(1, 0x7FFF);
      break;
    default:
      return result;
  }
  return result;
}

//----- (021E4F7C) --------------------------------------------------------
char *__fastcall Function_21e4f7c(int a1, uint *a2)
{
  uint *v2;
  int v3;
  char *result;
  int v5;
  int *v6;
  int v7;
  int v8;
  int v9;
  int v10;
  uint *v11;

  v2 = a2;
  v3 = a1;
  result = (char *)*a2;
  v5 = a2[3];
  switch ( (uchar)a2 )
  {
    case 0:
      v6 = (int *)malloc(4u, 56);
      v2[3] = v6;
      Call_FillMemWithValue(v6, 0, 0x38u);
      Function_201ff0c(2u, 0);
      Function_201ff0c(4u, 0);
      Function_201ff0c(8u, 0);
      result = (char *)(*v2 + 1);
      *v2 = result;
      break;
    case 1:
      Function_21ddc44(1, 16, 16, a2 + 1, 1);
      result = (char *)(*v2 + 1);
      *v2 = result;
      break;
    case 2:
      if ( a2[1] )
        *a2 = ++result;
      break;
    case 3:
      *(uint *)v5 = Function_21e22b0(5, 13);
      v7 = Function_2020a88(*(uint *)(v2[4] + 36));
      Function_21ddd80((uint *)(v5 + 8), v7, v7 + 256, 40);
      result = (char *)(*v2 + 1);
      *v2 = result;
      break;
    case 4:
      v8 = Function_21ddd90((uint *)(v5 + 8));
      result = (char *)Function_2020910(*(uint *)(v5 + 8), *(uint *)(v2[4] + 36));
      if ( v8 == 1 )
      {
        ++*v2;
        result = (char *)5;
        *(uint *)(v5 + 52) = 5;
      }
      break;
    case 5:
      result = (char *)(*(uint *)(v5 + 52) - 1);
      *(uint *)(v5 + 52) = result;
      if ( (int)result < 0 )
      {
        v9 = Function_2020a90(*(uint *)(a2[4] + 36));
        Function_21dde14((uint *)(v5 + 28), v9, v9 - 9625600, 2048, 8);
        result = (char *)(*v2 + 1);
        *v2 = result;
      }
      break;
    case 6:
      v10 = Function_21dde74((uint *)(v5 + 28));
      result = (char *)Function_2020a50(*(uint *)(v5 + 28), *(uint *)(v2[4] + 36));
      if ( v10 == 1 )
      {
        result = (char *)(*v2 + 1);
        *v2 = result;
      }
      break;
    case 7:
      Function_200f174(3u, 0, 0, 0x7FFF, 60, 1, 4);
      result = (char *)(*v2 + 1);
      *v2 = result;
      break;
    case 8:
      result = (char *)Function_200f2ac();
      if ( result )
      {
        v2[1] = 0;
        result = (char *)(*v2 + 1);
        *v2 = result;
      }
      break;
    case 9:
      SetBrightnessWithValue(1, 0x7FFF);
      Function_21e2310((char ****)v5);
      REG_BLDCNT = 0;
      v11 = (uint *)v2[5];
      if ( v11 )
        *v11 = 1;
      Function_21ddc28((int)v2, v3);
      result = (char *)SetBrightnessWithValue(1, 0x7FFF);
      break;
    default:
      return result;
  }
  return result;
}

//----- (021E5128) --------------------------------------------------------
uint *__fastcall Function_21e5128(ushort *a1, int *a2, int a3, int a4, int a5)
{
  ushort *v5;
  int v6;
  uint *v7;
  int v8;
  uint *result;
  int *v10;
  int v11;
  int v12;

  v5 = a1;
  v6 = 0;
  *a1 = 0;
  v10 = a2;
  v11 = a3;
  v12 = a4;
  a1[1] = 0;
  v7 = a1 + 10;
  do
  {
    v8 = Function_21de62c(v10, v11, v12, a5, 0, 0);
    *((uint *)v5 + 1) = v8;
    Function_2021cac(v8, 0);
    if ( v6 == 3 )
    {
      result = Function_21dddbc(v7, 4096, 4096, 6);
    }
    else
    {
      Function_2021cf8(*((uint *)v5 + 1), 2);
      Function_2021d6c(*((uint *)v5 + 1), 1u);
      result = Function_21dddbc(v7, 0x2000, 4096, 6);
    }
    ++v6;
    v5 += 2;
    v7 += 5;
  }
  while ( v6 < 4 );
  return result;
}

//----- (021E519C) --------------------------------------------------------
int __fastcall Function_21e519c(int a1)
{
  int v1;
  int v2;
  int result;

  v1 = a1;
  v2 = 0;
  do
  {
    result = Function_2021bd4(*(uint *)(v1 + 4));
    ++v2;
    v1 += 4;
  }
  while ( v2 < 4 );
  return result;
}

//----- (021E51B4) --------------------------------------------------------
int __fastcall Function_21e51b4(ushort *a1, int a2, int a3, int a4)
{
  ushort *v4;
  uint *v5;
  ushort *v6;
  ushort *v7;
  int v8;
  int v10;
  int v11;
  int v12[3];
  int v13;

  v13 = a4;
  v4 = a1;
  v10 = 1;
  if ( (short)a1[1] < 4 )
  {
    v10 = 0;
    if ( (short)--*a1 <= 0 )
    {
      *a1 = 3;
      ++a1[1];
    }
  }
  v11 = 0;
  if ( (short)a1[1] > 0 )
  {
    v5 = a1 + 10;
    v6 = a1;
    v7 = a1;
    do
    {
      v8 = Function_21dddcc(v5);
      Function_21de660(v12, *((uint *)v6 + 5), *((uint *)v6 + 5), *((uint *)v6 + 5));
      Function_2021c70(*((uint **)v7 + 1), v12);
      Function_2021cac(*((uint *)v7 + 1), 1);
      if ( !v8 )
        v10 = 0;
      v5 += 5;
      ++v11;
      v6 += 10;
      v7 += 2;
    }
    while ( v11 < (short)v4[1] );
  }
  return v10;
}

//----- (021E5240) --------------------------------------------------------
int __fastcall Function_21e5240(uint a1, uint a2)
{
  uint v2;
  uint v3;
  ushort **v4;
  uint *v5;
  int v6;
  ushort *v7;
  int v8;
  int v9;

  v2 = a2;
  v3 = a1;
  v4 = (ushort **)LoadFromMsgNARC(1, 26, 359, a2);
  v5 = Function_200b358(v2);
  v6 = Function_2023790(128, v2);
  v7 = (ushort *)Function_2023790(128, v2);
  Function_200b1b8_CallMsgDecrypt(v4, 0, v7);
  Function_200ba08((int)v5, 0, v3);
  Function_200c388(v5, v6, (int)v7);
  Function_200b190((ushort *)v4);
  Function_200b3f0(v5, v8);
  Function_20237bc_FreeMsg((int)v7, v9);
  return v6;
}

//----- (021E52A8) --------------------------------------------------------
int __fastcall Function_21e52a8(uint *a1, uint a2, int a3, int a4)
{
  uint *v4;
  uint v5;
  int v6;
  int v7;
  int v8;
  int *v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  uint *v19;
  int result;
  int v21[3];
  int v22;

  v22 = a4;
  v4 = a1;
  v5 = a2;
  v6 = *a1;
  v7 = a3;
  v8 = a1[3];
  if ( *a1 <= 0xFu )
    JUMPOUT(__CS__, (char *)&off_21E52C8 + *((short *)&off_21E52C8 + v6) + 2);
  switch ( (uchar)a3 )
  {
    case 0:
      v9 = (int *)malloc(v5, 664);
      v4[3] = v9;
      Call_FillMemWithValue(v9, 0, 0x298u);
      v8 = v4[3];
      Function_2007130(v4[8], 0xBu, 0, 64, 32, v5);
      Function_201ff0c(4u, 0);
      Function_201a7e8(*(uint **)(v4[4] + 8), v8 + 636, 2, 0, 10, 0x10u, 2u, 2, 1);
      Function_201ada4_ClearTextBox(v8 + 636, 0);
      v10 = Function_21e5240(*(uint *)(v7 + 4), v5);
      Function_201d78c(v8 + 636, 0);
      Function_20237bc_FreeMsg(v10, v11);
      Function_21de47c((int **)(v8 + 68), 8, 3, v12);
      Function_21de4cc(
        v4[8],
        (int *)(v8 + 68),
        (int **)(v8 + 384),
        *(uchar *)(v7 + 12),
        1,
        *(uchar *)(v7 + 13),
        *(uchar *)(v7 + 14),
        *(uchar *)(v7 + 15),
        600000);
      Function_21de4cc(v4[8], (int *)(v8 + 68), (int **)(v8 + 436), 0x33u, 1, 0x34u, 0x35u, 0x36u, 600001);
      *(uint *)(v8 + 488) = Function_21de62c((int *)(v8 + 68), v8 + 384, 1114112, 270336, 0, 0);
      Function_2021cac(*(uint *)(v8 + 488), 0);
      Function_21e5128((ushort *)(v8 + 492), (int *)(v8 + 68), v8 + 436, 294912, 303104);
      Function_21de5d0(*(uint *)(v8 + 488), v5, *(ushort *)(v7 + 8), 14, 0);
      *(uint *)(v8 + 64) = Function_21decec();
      ++*v4;
      goto LABEL_34;
    case 1:
      Function_21ddc44(1, 16, 16, a1 + 1, 1);
      ++*v4;
      goto LABEL_34;
    case 2:
      if ( a1[1] )
        *a1 = v6 + 1;
      goto LABEL_34;
    case 3:
      Function_21de3d0(
        a1[8],
        *(uchar *)(a3 + 18),
        *(uchar *)(a3 + 17),
        *(uchar *)(a3 + 16),
        0,
        1,
        *(uint **)(a1[4] + 8),
        3u);
      *(uint *)(v8 + 652) = 1;
      Function_21ded20((int)v4, *(uint **)(v8 + 64), 6, 8, 16, 31, 23);
      Function_201ff0c(8u, 1);
      ++*v4;
      goto LABEL_34;
    case 4:
      if ( Function_21ddd7c((int)a1) )
      {
        ++*v4;
        Function_21ded04(*(uint *)(v8 + 64));
        *(uint *)(v8 + 660) = 10;
      }
      goto LABEL_34;
    case 5:
      if ( --*(uint *)(v8 + 660) < 0 )
      {
        Function_201ff0c(0x10u, 1);
        if ( Function_21e51b4((ushort *)(v8 + 492), v13, v14, v15) == 1 )
          ++*v4;
      }
      goto LABEL_34;
    case 6:
      Function_21dde14((uint *)v8, 1114112, *(uint *)a3, -262144, 4);
      Function_2021cac(*(uint *)(v8 + 488), 1);
      Function_2021e80(*(uint *)(v8 + 488), 0);
      Function_21de660(v21, *(uint *)v8, 270336, 0);
      Function_2021c50(*(uint **)(v8 + 488), v21);
      ++*v4;
      goto LABEL_34;
    case 7:
      v16 = Function_21dde74((uint *)a1[3]);
      Function_21de660(v21, *(uint *)v8, 270336, 0);
      Function_2021c50(*(uint **)(v8 + 488), v21);
      if ( v16 == 1 )
        ++*v4;
      goto LABEL_34;
    case 8:
      Function_21ddd80((uint *)(v8 + 24), 0, 16, 3);
      *(uint *)(v8 + 660) = 10;
      ++*v4;
      goto LABEL_34;
    case 9:
      if ( --*(uint *)(v8 + 660) < 0 )
      {
        v17 = Function_21ddd90((uint *)(v8 + 24));
        Function_21def8c(v8 + 24);
        if ( v17 == 1 )
        {
          Function_21de5d0(*(uint *)(v8 + 488), v5, *(ushort *)(v7 + 8), 0, 0);
          Function_200ab4c(-14, 33, 1);
          Function_201c63c(*(uint *)(v4[4] + 8), 2, 0, 92 - (*(uint *)v8 >> 12));
          Function_201ff0c(4u, 1);
          Function_2019060(2u, 0);
          ++*v4;
        }
      }
      goto LABEL_34;
    case 0xA:
      Function_21ddd80((uint *)(v8 + 24), 16, 0, 3);
      ++*v4;
      goto LABEL_34;
    case 0xB:
      v18 = Function_21ddd90((uint *)(v8 + 24));
      Function_21def8c(v8 + 24);
      if ( v18 == 1 )
      {
        ++*v4;
        *(uint *)(v8 + 660) = 26;
      }
      goto LABEL_34;
    case 0xC:
      if ( --*(uint *)(v8 + 660) < 0 )
        ++*a1;
      goto LABEL_34;
    case 0xD:
      Function_200f174(3u, 0, 0, 0x7FFF, 15, 1, 4);
      ++*v4;
      goto LABEL_34;
    case 0xE:
      if ( Function_200f2ac() )
        ++*v4;
      goto LABEL_34;
    case 0xF:
      SetBrightnessWithValue(1, 0x7FFF);
      v19 = (uint *)v4[5];
      if ( v19 )
        *v19 = 1;
      Function_2021bd4(*(uint *)(v8 + 488));
      Function_21e519c(v8 + 492);
      Function_21de5a4(v8 + 68, (int **)(v8 + 384));
      Function_21de5a4(v8 + 68, (int **)(v8 + 436));
      Function_21de4ac((int **)(v8 + 68));
      Function_201a8fc(v8 + 636);
      REG_DISPCNT &= 0xFFFF1FFF;
      Function_200ab4c(0, 0, 1);
      Function_2019184(*(uint *)(v4[4] + 8), 2u, 0, 0);
      result = 1;
      break;
    default:
LABEL_34:
      if ( *(uint *)(v8 + 652) == 1 )
      {
        Function_201c63c(*(uint *)(v4[4] + 8), 3, 0, *(uint *)(v8 + 656));
        *(uint *)(v8 + 656) = ((uint)(*(uint *)(v8 + 656) + 30) >> 31)
                              + __ROR4__(
                                  ((*(uint *)(v8 + 656) + 30) << 23)
                                - ((uint)(*(uint *)(v8 + 656) + 30) >> 31),
                                  23);
      }
      if ( *v4 != 15 )
        Function_20219f8(*(uint *)(v8 + 68));
      result = 0;
      break;
  }
  return result;
}

//----- (021E5760) --------------------------------------------------------
int __fastcall Function_21e5760(int a1, uint *a2, int a3, int a4)
{
  int v4;
  int v5;
  int result;

  v4 = (int)a2;
  v5 = a1;
  result = Function_21e52a8(a2, 4u, (int)dword_21F9D34, a4);
  if ( result == 1 )
    result = Function_21ddc28(v4, v5);
  return result;
}

//----- (021E5784) --------------------------------------------------------
int __fastcall Function_21e5784(int a1, uint *a2, int a3, int a4)
{
  int v4;
  int v5;
  int result;

  v4 = (int)a2;
  v5 = a1;
  result = Function_21e52a8(a2, 4u, (int)dword_21F9D48, a4);
  if ( result == 1 )
    result = Function_21ddc28(v4, v5);
  return result;
}

//----- (021E57A8) --------------------------------------------------------
int __fastcall Function_21e57a8(int a1, uint *a2, int a3, int a4)
{
  int v4;
  int v5;
  int result;

  v4 = (int)a2;
  v5 = a1;
  result = Function_21e52a8(a2, 4u, (int)dword_21F9D5C, a4);
  if ( result == 1 )
    result = Function_21ddc28(v4, v5);
  return result;
}

//----- (021E57CC) --------------------------------------------------------
int __fastcall Function_21e57cc(int a1, uint *a2, int a3, int a4)
{
  int v4;
  int v5;
  int result;

  v4 = (int)a2;
  v5 = a1;
  result = Function_21e52a8(a2, 4u, (int)dword_21F9D70, a4);
  if ( result == 1 )
    result = Function_21ddc28(v4, v5);
  return result;
}

//----- (021E57F0) --------------------------------------------------------
int __fastcall Function_21e57f0(int a1, uint *a2, int a3, int a4)
{
  int v4;
  int v5;
  int result;

  v4 = (int)a2;
  v5 = a1;
  result = Function_21e52a8(a2, 4u, (int)dword_21F9D84, a4);
  if ( result == 1 )
    result = Function_21ddc28(v4, v5);
  return result;
}

//----- (021E5814) --------------------------------------------------------
int __fastcall Function_21e5814(int a1, uint *a2, int a3, int a4)
{
  int v4;
  int v5;
  int result;

  v4 = (int)a2;
  v5 = a1;
  result = Function_21e52a8(a2, 4u, (int)dword_21F9D98, a4);
  if ( result == 1 )
    result = Function_21ddc28(v4, v5);
  return result;
}

//----- (021E5838) --------------------------------------------------------
int __fastcall Function_21e5838(int a1, uint *a2, int a3, int a4)
{
  int v4;
  int v5;
  int result;

  v4 = (int)a2;
  v5 = a1;
  result = Function_21e52a8(a2, 4u, (int)dword_21F9DAC, a4);
  if ( result == 1 )
    result = Function_21ddc28(v4, v5);
  return result;
}

//----- (021E585C) --------------------------------------------------------
int __fastcall Function_21e585c(int a1, uint *a2, int a3, int a4)
{
  int v4;
  int v5;
  int result;

  v4 = (int)a2;
  v5 = a1;
  result = Function_21e52a8(a2, 4u, (int)dword_21F9DC0, a4);
  if ( result == 1 )
    result = Function_21ddc28(v4, v5);
  return result;
}

//----- (021E5880) --------------------------------------------------------
int __fastcall Function_21e5880(int a1)
{
  int v1;

  v1 = LoadTrainerDataAdress(*(uint *)(a1 + 12));
  return GetGender(v1);
}

//----- (021E5890) --------------------------------------------------------
int __fastcall Function_21e5890(int *a1, uint a2, int a3, int a4)
{
  int *v4;
  int v5;
  int v6;
  int *v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int result;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  int v20;
  int v21;
  int v22;
  int v23;
  int v24;
  int v25;
  int v26;
  uint *v27;
  int v28;
  int v29;
  uint *v30;
  int v31;
  uint *v32;
  int v33;
  int v34;
  int v35;
  int v36;
  int v37;
  int v38;
  int v39;
  int v40;
  int v41;
  int v42;
  uint *v43;
  int v44;
  uint *v45;
  int v46;
  int *v47;
  uint *v48;
  int v49;
  int v50;
  int v51;
  int **v52;
  uint v53;
  ushort *v54;
  int v55;
  uint v56;
  char v57;
  int v58;
  int v59;
  int v60;

  v4 = a1;
  v5 = *a1;
  v53 = a2;
  v54 = (ushort *)a3;
  v6 = v4[3];
  switch ( (uchar)v5 )
  {
    case 0:
      v7 = (int *)malloc(a2, 784);
      v4[3] = (int)v7;
      Call_FillMemWithValue(v7, 0, 0x310u);
      v8 = v4[3];
      Function_21de47c((int **)(v4[3] + 92), 10, 4, v9);
      if ( Function_21e5880(v4[4]) )
      {
        Function_21de4cc(v4[8], (int *)(v8 + 92), (int **)(v8 + 408), 0x97u, 1, 0x98u, 0x99u, 0x9Au, 600000);
        v10 = 1;
      }
      else
      {
        Function_21de4cc(v4[8], (int *)(v8 + 92), (int **)(v8 + 408), 0x93u, 1, 0x94u, 0x95u, 0x96u, 600000);
        v10 = 0;
      }
      *(uint *)(v8 + 772) = v10;
      Function_21de4cc(v4[8], (int *)(v8 + 92), (int **)(v8 + 460), *v54, 1, *v54 + 1, *v54 + 2, *v54 + 3, 600001);
      Function_21de4cc(
        v4[8],
        (int *)(v8 + 92),
        (int **)(v8 + 512),
        *((uchar *)v54 + 2),
        12,
        0x28u,
        0x29u,
        0x2Au,
        600002);
      Function_21de4cc(v4[8], (int *)(v8 + 92), (int **)(v8 + 564), 0x33u, 1, 0x34u, 0x35u, 0x36u, 600003);
      v11 = *v4 + 1;
      *v4 = v11;
      return Function_21e6140(v11);
    case 1:
      Function_21de660(&v57, 0x2000, 0x2000, 0);
      v55 = v6 + 408;
      v13 = 0;
      v14 = v6;
      do
      {
        if ( v13 >= 3 )
        {
          v15 = v6 + 408 + 52 * (v13 - 1);
          v56 = 1;
        }
        else
        {
          v15 = v55;
          v56 = 0;
        }
        *(uint *)(v14 + 616) = Function_21de62c((int *)(v6 + 92), v15, 0, 0, 0, 0);
        Function_2021cac(*(uint *)(v14 + 616), 0);
        Function_2021d6c(*(uint *)(v14 + 616), v56);
        Function_2021e80(*(uint *)(v14 + 616), 1);
        ++v13;
        v14 += 4;
        v55 += 52;
      }
      while ( v13 < 4 );
      if ( *(uint *)(v6 + 772) )
        Function_21de5d0(*(uint *)(v6 + 616), v53, 0, 14, 0);
      else
        Function_21de5d0(*(uint *)(v6 + 616), v53, 1, 14, 0);
      Function_21de5d0(*(uint *)(v6 + 620), v53, v54[2], 14, 0);
      Function_201ff0c(0x10u, 1);
      Function_21e5128((ushort *)(v6 + 656), (int *)(v6 + 92), v6 + 564, 0x80000, 393216);
      Function_21defa0(v4[4]);
      v16 = *v4 + 1;
      *v4 = v16;
      return Function_21e6140(v16);
    case 2:
      Function_21ddc44(1, 16, 16, v4 + 1, 1);
      v4[2] = 0;
      v17 = *v4 + 1;
      *v4 = v17;
      return Function_21e6140(v17);
    case 3:
      v18 = v4[2] + 1;
      v4[2] = v18;
      if ( v18 == 8 )
        Function_21df038();
      v19 = v4[1];
      if ( !v19 )
        return Function_21e6140(v19);
      v20 = *v4 + 1;
      *v4 = v20;
      return Function_21e6140(v20);
    case 4:
      v19 = Function_21df054();
      if ( v19 != 1 )
        return Function_21e6140(v19);
      Function_21df0cc(v4[8], 0x6Bu);
      G2x_SetBlendAlpha_((int *)&REG_BLDCNT, 1, 30, 0, 8);
      v21 = *v4 + 1;
      *v4 = v21;
      return Function_21e6140(v21);
    case 5:
      Function_21dde14((uint *)v6, -524288, 229376, 327680, 6);
      Function_21de660(&v58, *(uint *)v6, 376832, 0);
      Function_2021c50(*(uint **)(v6 + 616), &v58);
      v59 += 0x4000;
      v58 += 0x10000;
      Function_2021c50(*(uint **)(v6 + 624), &v58);
      Function_2021cac(*(uint *)(v6 + 616), 1);
      Function_2021cac(*(uint *)(v6 + 624), 1);
      Function_21dde14((uint *)(v6 + 48), 1572864, 819200, -327680, 6);
      Function_21de660(&v58, *(uint *)(v6 + 48), 376832, 0);
      Function_2021c50(*(uint **)(v6 + 620), &v58);
      v59 += 0x4000;
      v58 -= 0x10000;
      Function_2021c50(*(uint **)(v6 + 628), &v58);
      Function_2021cac(*(uint *)(v6 + 620), 1);
      Function_2021cac(*(uint *)(v6 + 628), 1);
      Function_2007130(v4[8], 0xBu, 0, 64, 32, v53);
      Function_201ff0c(4u, 0);
      Function_201a7e8(*(uint **)(v4[4] + 8), v6 + 756, 2, 21, 13, 0xBu, 2u, 2, 1);
      Function_201ada4_ClearTextBox(v6 + 756, 0);
      v22 = Function_21e5240(v54[3], v53);
      Function_201d78c(v6 + 756, 0);
      Function_20237bc_FreeMsg(v22, v23);
      v4[1] = 3;
      v24 = *v4 + 1;
      *v4 = v24;
      return Function_21e6140(v24);
    case 6:
      v25 = v4[1];
      if ( v25 <= 0 )
      {
        Function_21e51b4((ushort *)(v6 + 656), a2, a3, a4);
      }
      else
      {
        v26 = v25 - 1;
        v4[1] = v26;
        if ( !v26 )
        {
          Function_21df17c(3u);
          Function_201ff0c(1u, 1);
          Function_201ff0c(4u, 1);
        }
      }
      Function_21dde74((uint *)v6);
      Function_21de660(&v58, *(uint *)v6, 376832, 0);
      v27 = (uint *)(v6 + 632);
      v28 = v59;
      *v27 = v58;
      v27[1] = v28;
      *(uint *)(v6 + 640) = v60;
      Function_2021c50(*(uint **)(v6 + 616), &v58);
      v59 += 0x4000;
      v58 += 0x10000;
      Function_2021c50(*(uint **)(v6 + 624), &v58);
      v29 = Function_21dde74((uint *)(v6 + 48));
      Function_21de660(&v58, *(uint *)(v6 + 48), 376832, 0);
      v30 = (uint *)(v6 + 644);
      v31 = v59;
      *v30 = v58;
      v30[1] = v31;
      *(uint *)(v6 + 652) = v60;
      Function_2021c50(*(uint **)(v6 + 620), &v58);
      v59 += 0x4000;
      v58 -= 0x10000;
      v32 = (uint *)Function_2021c50(*(uint **)(v6 + 628), &v58);
      if ( v29 != 1 )
        goto LABEL_38;
      v33 = *v4 + 1;
      *v4 = v33;
      return Function_21e6140(v33);
    case 7:
      v34 = Function_21e51b4((ushort *)(v6 + 656), a2, a3, a4);
      v32 = (uint *)Function_21df208();
      if ( !v34 || !v32 )
        goto LABEL_38;
      Function_21ddd80((uint *)(v6 + 72), 0, 16, 3);
      Function_21df224();
      v35 = *v4 + 1;
      *v4 = v35;
      return Function_21e6140(v35);
    case 8:
      v36 = Function_21ddd90((uint *)(v6 + 72));
      v32 = Function_21def8c(v6 + 72);
      if ( v36 != 1 )
        goto LABEL_38;
      Function_21de5d0(*(uint *)(v6 + 616), v53, *(uint *)(v6 + 772), 0, 0);
      Function_21de5d0(*(uint *)(v6 + 620), v53, v54[2], 0, 0);
      Function_2021cc8(*(uint *)(v6 + 624), 1);
      Function_2021ce4(*(uint *)(v6 + 624), 0x2000);
      Function_2021cc8(*(uint *)(v6 + 628), 1);
      Function_2021ce4(*(uint *)(v6 + 628), 0x2000);
      Function_21df0cc(v4[8], 0x6Cu);
      v37 = *v4 + 1;
      *v4 = v37;
      result = Function_21e6140(v37);
      break;
    case 9:
      Function_21ddd80((uint *)(v6 + 72), 16, 0, 6);
      Function_21df17c(4u);
      Function_2019060(0, 1);
      v38 = *v4 + 1;
      *v4 = v38;
      result = Function_21e6140(v38);
      break;
    case 0xA:
      v39 = Function_21ddd90((uint *)(v6 + 72));
      v32 = Function_21def8c(v6 + 72);
      if ( v39 == 1 )
      {
        ++*v4;
        v4[1] = 8;
        result = Function_21e6140(8);
      }
      else
      {
LABEL_38:
        result = Function_21e6140(v32);
      }
      break;
    case 0xB:
      v40 = v4[1];
      if ( v40 <= 0 )
      {
        Function_21dde14((uint *)v6, 0, -8192, 0, *(uchar *)(a3 + 3));
        Function_21dde14((uint *)(v6 + 24), 0, -8192, 0, *((uchar *)v54 + 3));
        v4[1] = 0;
        v41 = *v4 + 1;
        *v4 = v41;
      }
      else
      {
        v41 = v40 - 1;
        v4[1] = v41;
      }
      result = Function_21e6140(v41);
      break;
    case 0xC:
      ++v4[1];
      v42 = Function_21dde74((uint *)v6);
      Function_21dde74((uint *)(v6 + 24));
      if ( ((uint)(v4[1] / 2) >> 31) + __ROR4__((v4[1] / 2 << 31) - ((uint)(v4[1] / 2) >> 31), 31) )
        Function_21de660(&v58, *(uint *)(v6 + 632) - *(uint *)v6, *(uint *)(v6 + 636) - *(uint *)(v6 + 24), 0);
      else
        Function_21de660(&v58, *(uint *)(v6 + 632) + *(uint *)v6, *(uint *)(v6 + 636) + *(uint *)(v6 + 24), 0);
      if ( v42 )
      {
        v43 = (uint *)(v6 + 632);
        v44 = v59;
        *v43 = v58;
        v43[1] = v44;
        *(uint *)(v6 + 640) = v60;
      }
      Function_2021c50(*(uint **)(v6 + 616), &v58);
      v59 += 0x4000;
      v58 += 0x10000;
      Function_2021c50(*(uint **)(v6 + 624), &v58);
      if ( ((uint)(v4[1] / 2) >> 31) + __ROR4__((v4[1] / 2 << 31) - ((uint)(v4[1] / 2) >> 31), 31) )
        Function_21de660(&v58, *(uint *)(v6 + 644) + *(uint *)v6, *(uint *)(v6 + 648) + *(uint *)(v6 + 24), 0);
      else
        Function_21de660(&v58, *(uint *)(v6 + 644) - *(uint *)v6, *(uint *)(v6 + 648) - *(uint *)(v6 + 24), 0);
      if ( v42 )
      {
        v45 = (uint *)(v6 + 644);
        v46 = v59;
        *v45 = v58;
        v45[1] = v46;
        *(uint *)(v6 + 652) = v60;
      }
      Function_2021c50(*(uint **)(v6 + 620), &v58);
      v59 += 0x4000;
      v58 -= 0x10000;
      v47 = (int *)Function_2021c50(*(uint **)(v6 + 628), &v58);
      if ( v42 )
      {
        ++*v4;
        Function_201ff0c(4u, 0);
        Function_21dde14((uint *)v6, 0, 786432, 98304, 16);
        Function_21dde14((uint *)(v6 + 24), 0, 786432, 98304, 16);
        v47 = Function_200f174(3u, 0, 0, 0x7FFF, 8, 1, 4);
      }
      result = Function_21e6140(v47);
      break;
    case 0xD:
      Function_21dde74((uint *)v4[3]);
      Function_21dde74((uint *)(v6 + 24));
      Function_21de660(&v58, *(uint *)(v6 + 632) - *(uint *)v6, *(uint *)(v6 + 636) - *(uint *)(v6 + 24), 0);
      Function_2021c50(*(uint **)(v6 + 616), &v58);
      v59 += 0x4000;
      v58 += 0x10000;
      Function_2021c50(*(uint **)(v6 + 624), &v58);
      Function_21de660(&v58, *(uint *)(v6 + 644) + *(uint *)v6, *(uint *)(v6 + 648) + *(uint *)(v6 + 24), 0);
      Function_2021c50(*(uint **)(v6 + 620), &v58);
      v59 += 0x4000;
      v58 -= 0x10000;
      Function_2021c50(*(uint **)(v6 + 628), &v58);
      if ( Function_200f2ac() )
        ++*v4;
      result = ((int (*)(void))Function_21e6140)();
      break;
    case 0xE:
      SetBrightnessWithValue(1, 0x7FFF);
      v48 = (uint *)v4[5];
      if ( v48 )
        *v48 = 1;
      Function_21e519c(v6 + 656);
      Function_201a8fc(v6 + 756);
      v49 = 0;
      v50 = v6;
      do
      {
        Function_2021bd4(*(uint *)(v50 + 616));
        ++v49;
        v50 += 4;
      }
      while ( v49 < 4 );
      v51 = 0;
      v52 = (int **)(v6 + 408);
      do
      {
        Function_21de5a4(v6 + 92, v52);
        ++v51;
        v52 += 13;
      }
      while ( v51 < 4 );
      Function_21de4ac((int **)(v6 + 92));
      Function_21df224();
      Function_21df084();
      REG_BLDCNT = 0;
      result = 1;
      break;
    default:
      JUMPOUT(__CS__, *((short *)&off_21E58B2 + v5) + 35543220);
      return result;
  }
  return result;
}

//----- (021E6140) --------------------------------------------------------
#error "Failed to decompile function. "

//----- (021E6178) --------------------------------------------------------
int __fastcall Function_21e6178(int a1, int *a2, int a3, int a4)
{
  int v4;
  int v5;
  int result;

  v4 = (int)a2;
  v5 = a1;
  result = Function_21e5890(a2, 4u, (int)dword_21F9D0C, a4);
  if ( result == 1 )
    result = Function_21ddc28(v4, v5);
  return result;
}

//----- (021E619C) --------------------------------------------------------
int __fastcall Function_21e619c(int a1, int *a2, int a3, int a4)
{
  int v4;
  int v5;
  int result;

  v4 = (int)a2;
  v5 = a1;
  result = Function_21e5890(a2, 4u, (int)dword_21F9D14, a4);
  if ( result == 1 )
    result = Function_21ddc28(v4, v5);
  return result;
}

//----- (021E61C0) --------------------------------------------------------
int __fastcall Function_21e61c0(int a1, int *a2, int a3, int a4)
{
  int v4;
  int v5;
  int result;

  v4 = (int)a2;
  v5 = a1;
  result = Function_21e5890(a2, 4u, (int)dword_21F9D1C, a4);
  if ( result == 1 )
    result = Function_21ddc28(v4, v5);
  return result;
}

//----- (021E61E4) --------------------------------------------------------
int __fastcall Function_21e61e4(int a1, int *a2, int a3, int a4)
{
  int v4;
  int v5;
  int result;

  v4 = (int)a2;
  v5 = a1;
  result = Function_21e5890(a2, 4u, (int)dword_21F9D24, a4);
  if ( result == 1 )
    result = Function_21ddc28(v4, v5);
  return result;
}

//----- (021E6208) --------------------------------------------------------
int __fastcall Function_21e6208(int a1, int *a2, int a3, int a4)
{
  int v4;
  int v5;
  int result;

  v4 = (int)a2;
  v5 = a1;
  result = Function_21e5890(a2, 4u, (int)dword_21F9D2C, a4);
  if ( result == 1 )
    result = Function_21ddc28(v4, v5);
  return result;
}

//----- (021E622C) --------------------------------------------------------
void __fastcall Function_21e622c(int a1, int a2)
{
  Function_2026218(a1, a2);
  Function_2026220_Dummy();
}

//----- (021E6238) --------------------------------------------------------
int __fastcall Function_21e6238(int a1)
{
  int v1;
  int v2;
  uint v3;
  int v4;

  v1 = 0;
  v2 = a1;
  v3 = 0;
  do
  {
    Function_2026218(v2, v3);
    Function_2026220_Dummy();
    if ( GetBoxPkmnData(v4, 5u, 0) )
      v1 = (v1 + 1) & 0xFF;
    v3 = (v3 + 1) & 0xFF;
  }
  while ( v3 < 2 );
  return v1;
}

//----- (021E6270) --------------------------------------------------------
int __fastcall Function_21e6270(int a1)
{
  int v1;
  uint v2;
  int v3;

  v1 = a1;
  v2 = 0;
  dword_2202120[1] = a1;
  do
  {
    Function_2026218(v1, v2);
    Function_2026220_Dummy();
    if ( !GetBoxPkmnData(v3, 5u, 0) )
      return v2;
    v2 = (v2 + 1) & 0xFF;
  }
  while ( v2 < 2 );
  return -1;
}

//----- (021E62B0) --------------------------------------------------------
int __fastcall Function_21e62b0(int a1)
{
  ushort v1;

  v1 = GetBoxPkmnData(a1, 6u, 0);
  return Function_207d2d0(v1);
}

//----- (021E62C4) --------------------------------------------------------
uint *__fastcall Function_21e62c4(int *a1, int a2, int a3, int a4)
{
  int v4;
  int *v5;
  int v6;
  int *v7;
  uint *v8;
  int v9;
  ushort *v10;
  int v11;
  int v12;
  uint *result;
  uint *v14;
  int v15;
  uint *v16;
  char v17;

  v4 = a3;
  v5 = a1;
  v15 = a2;
  v6 = a4;
  v7 = GetAdrOfPkmnInParty(a1, a2);
  Function_2026224(v4);
  Function_2026220_Dummy();
  v16 = v8;
  LoadTrainerDataAdress(v6);
  Function_2025ef0_Dummy();
  GetPkmnData(v7, 0x75u, (ushort *)&v17);
  Function_2076b10_Dummy();
  if ( Function_21e62b0(v9) )
  {
    Function_2026230_Dummy();
    GetPkmnData(v7, 0xAAu, v10);
  }
  Function_2077618(v7, v16);
  Function_2077adc((int)v16, 0, v11, v12);
  Function_2026258(v4, 0);
  Function_207a080(v5, v15);
  result = (uint *)IsFirstPkmnInPartyWantedSpecies((int)v5, 441);
  if ( !result )
  {
    v14 = (uint *)LoadVariableAreaAdress_16(v6);
    result = Function_202cca8(v14);
  }
  return result;
}

//----- (021E6358) --------------------------------------------------------
uint *__fastcall Function_5_21e6358(int *a1, int a2, int a3, int a4)
{
  int v4;
  int *v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;

  v4 = a4;
  v5 = a1;
  v6 = a2;
  v7 = a3;
  v8 = LoadVariableAreaAdress_14(a4);
  Function_202cf28(v8, 40);
  v9 = Function_21e6270(v7);
  v10 = Function_2026218(v7, v9);
  return Function_21e62c4(v5, v6, v10, v4);
}

//----- (021E638C) --------------------------------------------------------
uint __fastcall Function_21e638c(int a1)
{
  int v1;
  int *v2;
  int *v3;
  int v4;
  int v5;
  int v6;
  int v7;
  uint result;

  v1 = a1;
  v2 = (int *)Function_2026218(a1, 0);
  v3 = (int *)Function_2026218(v1, 1);
  Function_2026220_Dummy();
  v5 = v4;
  Function_2026220_Dummy();
  v7 = v6;
  result = GetBoxPkmnData(v5, 5u, 0);
  if ( !result )
  {
    result = GetBoxPkmnData(v7, 5u, 0);
    if ( result )
    {
      Function_20262a8(v2, v3);
      result = (uint)Function_20262f4(v3);
    }
  }
  return result;
}

//----- (021E63E0) --------------------------------------------------------
int __fastcall Function_21e63e0(int *a1, int a2, int a3, int a4)
{
  int *v4;
  int i;
  int v7;
  ushort v8;
  int v9;

  v4 = a1;
  v7 = 0;
  v9 = 0;
  do
  {
    if ( !Function_2076b14(v4, a2, a3, a4) )
      break;
    v9 = 0;
    for ( i = Function_207727c(v4, &v9, &v8); i; i = Function_207727c(v4, &v9, &v8) )
    {
      if ( i == 0xFFFF )
        Function_2077134((int)v4, v8);
    }
    ++v7;
  }
  while ( v7 < 100 );
  return Function_207418c(v4);
}

//----- (021E6444) --------------------------------------------------------
int __fastcall Function_21e6444(uint *a1, int a2, int *a3)
{
  int v3;
  int *v4;
  int *v5;
  int *v6;
  int *v7;
  int v8;
  int v9;
  int v10;
  int v11;
  ushort *v12;
  uint *v14;
  uint v15;

  v14 = a1;
  v3 = a2;
  v4 = a3;
  v5 = AllocPkmnData(4u);
  Function_2026220_Dummy();
  v7 = v6;
  Function_2026224(v3);
  Function_200b5cc(v4, 0, (int)v7);
  v8 = (ushort)GetBoxPkmnData((int)v7, 5u, 0);
  Function_20774c8(v7, v5);
  if ( GetPkmnData(v5, 0xA1u, 0) != 100 )
  {
    v15 = GetPkmnData(v5, 8u, 0);
    v15 += Function_2026228(v3);
    SetPkmnData((int)v5, 8, (ushort *)&v15);
    Function_21e63e0(v5, v9, v10, v11);
  }
  if ( Function_21e62b0((int)v7) )
  {
    Function_2026230_Dummy();
    SetPkmnData((int)v5, 170, v12);
  }
  CopyPkmnDataToParty(v14, v5);
  ClearPkmnDataStructure1(v7);
  Function_2026258(v3, 0);
  free((int)v5);
  return v8;
}

//----- (021E64F8) --------------------------------------------------------
int __fastcall Function_5_21e64f8(uint *a1, int *a2, int a3, int a4)
{
  int v4;
  uint *v5;
  int *v6;
  int v7;
  int v8;

  v4 = a3;
  v5 = a1;
  v6 = a2;
  v7 = Function_2026218(a3, a4);
  v8 = (ushort)Function_21e6444(v5, v7, v6);
  Function_21e638c(v4);
  return v8;
}

//----- (021E6520) --------------------------------------------------------
int __fastcall Function_21e6520(int *a1, int a2)
{
  int *v2;
  int v3;
  int *v4;
  uint *v5;
  int v6;
  int v7;
  int v8;
  uint v10;

  v2 = a1;
  v3 = a2;
  v4 = AllocPkmnData(4u);
  Function_2076b10_Dummy();
  v6 = (int)v5;
  Function_2077604(v2, v5);
  v10 = GetBoxPkmnData(v6, 8u, 0) + v3;
  SetBoxPkmnData(v6, 8u, (ushort *)&v10, v7);
  v8 = InitPkmnLevel(v6);
  free((int)v4);
  return v8;
}

//----- (021E6568) --------------------------------------------------------
int __fastcall Function_21e6568(int a1)
{
  int v1;
  int v2;
  int *v3;
  int v4;
  int v5;

  v1 = a1;
  Function_2026220_Dummy();
  v3 = (int *)v2;
  v4 = (uchar)InitPkmnLevel(v2);
  v5 = Function_2026228(v1);
  return (uchar)Function_21e6520(v3, v5) - v4;
}

//----- (021E6590) --------------------------------------------------------
int __fastcall Function_21e6590(int a1)
{
  int v1;
  int *v2;
  int *v3;
  int v4;

  v1 = a1;
  Function_2026220_Dummy();
  v3 = v2;
  v4 = Function_2026228(v1);
  return (uchar)Function_21e6520(v3, v4);
}

//----- (021E65B0) --------------------------------------------------------
int __fastcall Function_21e65b0(int a1, int *a2)
{
  int v2;
  int *v3;
  int v4;
  int v5;
  int v6;

  v2 = a1;
  v3 = a2;
  Function_2026220_Dummy();
  v5 = v4;
  v6 = Function_21e6568(v2);
  LOBYTE(v2) = v6;
  Function_200b60c((int)v3, 1u, v6, 3, 0, 1);
  Function_200b5cc(v3, 0, v5);
  return (uchar)v2;
}

//----- (021E65EC) --------------------------------------------------------
int __fastcall Function_21e65ec(int a1, int *a2)
{
  int v2;
  int *v3;
  int v4;
  int v5;
  int v6;
  int v7;

  v2 = a1;
  v3 = a2;
  Function_2026220_Dummy();
  v5 = v4;
  v6 = (ushort)Function_21e6568(v2);
  Function_200b5cc(v3, 0, v5);
  v7 = 100 * (v6 + 1) & 0xFFFF;
  Function_200b60c((int)v3, 1u, v7, 5, 0, 1);
  return v7;
}

//----- (021E6630) --------------------------------------------------------
int __fastcall Function_5_21e6630(int a1, int a2, int *a3)
{
  int *v3;
  int v4;

  v3 = a3;
  v4 = Function_2026218(a1, a2);
  return Function_21e65ec(v4, v3);
}

//----- (021E6640) --------------------------------------------------------
int __fastcall Function_5_21e6640(int a1, int a2, int *a3)
{
  int *v3;
  int v4;
  int v5;
  int result;

  v3 = a3;
  v4 = Function_2026218(a1, a2);
  Function_2026220_Dummy();
  if ( GetBoxPkmnData(v5, 5u, 0) )
    result = Function_21e65b0(v4, v3);
  else
    result = 0;
  return result;
}

//----- (021E6668) --------------------------------------------------------
void __fastcall Function_21e6668(int a1, uint *a2)
{
  uint *v2;
  int v3;
  int v4;
  int v5;

  v2 = a2;
  v3 = a1;
  Function_21e622c(a1, 0);
  *v2 = v4;
  Function_21e622c(v3, 1);
  v2[1] = v5;
}

//----- (021E6684) --------------------------------------------------------
int __fastcall Function_21e6684(int a1)
{
  int v1;
  int *v2;
  int v3;
  int v4;
  int *v5;
  char *v6;
  uint v7;
  int v9;
  char v10[8];
  char v11;

  v9 = -1;
  Function_21e6668(a1, v10);
  v1 = 0;
  v2 = (int *)v10;
  do
  {
    if ( DecidePkmnGender(*v2) == 1 )
      v9 = v1;
    ++v1;
    ++v2;
  }
  while ( v1 < 2 );
  v3 = 0;
  v4 = 0;
  v5 = (int *)v10;
  v6 = &v11;
  do
  {
    v7 = GetBoxPkmnData(*v5, 5u, 0);
    *(uint *)v6 = v7;
    if ( v7 == 132 )
    {
      ++v3;
      v9 = v4;
    }
    ++v4;
    ++v5;
    v6 += 4;
  }
  while ( v4 < 2 );
  if ( v3 == 2 )
    v9 = PRNG() < 0x7FFF;
  if ( GetBoxPkmnData(*(uint *)&v10[4 * v9], 6u, 0) != 229 )
    return -1;
  if ( PRNG() >= 0x7FFF )
    v9 = -1;
  return v9;
}

//----- (021E6720) --------------------------------------------------------
int __fastcall Function_21e6720(int a1)
{
  int v1;
  int v2;
  int v3;
  int result;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;

  v9 = a1;
  v1 = 0;
  v2 = Function_21e6684(a1);
  if ( v2 >= 0 )
  {
    Function_21e622c(v9, v2);
    v6 = GetBoxPkmnData(v5, 0, 0);
    v7 = PkmnData_DivBy25(v6);
    do
    {
      v8 = Function_201d35c();
      if ( v7 == PkmnData_DivBy25(v8) && v8 )
        break;
      ++v1;
    }
    while ( v1 <= 2400 );
    result = Function_2026270(v9, v8);
  }
  else
  {
    v3 = Function_201d35c();
    result = Function_2026270(v9, v3);
  }
  return result;
}

//----- (021E6778) --------------------------------------------------------
int __fastcall Function_21e6778(int result, int a2, int a3, int a4)
{
  int v4;
  char *v5;
  char v6;
  int v7;
  int v8;
  char *v9;
  int v10;
  char v11;
  int v12;

  v12 = a4;
  *(uchar *)(result + a2) = -1;
  v4 = 0;
  v5 = &v11;
  do
  {
    v6 = *(uchar *)(result + v4++);
    *v5++ = v6;
  }
  while ( v4 < 6 );
  v7 = 0;
  v8 = 0;
  v9 = &v11;
  do
  {
    v10 = (uchar)*v9;
    if ( v10 != 255 )
      *(uchar *)(result + v7++) = v10;
    ++v8;
    ++v9;
  }
  while ( v8 < 6 );
  return result;
}

//----- (021E67B0) --------------------------------------------------------
int __fastcall Function_21e67b0(int a1, int a2)
{
  int v2;
  uint v3;
  uint v4;
  uint v5;
  int v6;
  int v7;
  int v8;
  uint v9;
  uint v10;
  uint v11;
  int v12;
  int result;
  int v14;
  ushort v15[2];
  ushort v16[2];
  char v17[4];
  short v18;

  v2 = a1;
  v14 = a2;
  v3 = 0;
  do
  {
    v17[v3] = v3;
    v3 = (v3 + 1) & 0xFF;
  }
  while ( v3 < 6 );
  v4 = 0;
  do
  {
    v5 = PRNG();
    s32_div_f(v5, 6 - v4);
    *((uchar *)&v18 + v4) = v17[v6];
    Function_21e6778((int)v17, v4, v7, v8);
    v4 = (v4 + 1) & 0xFF;
  }
  while ( v4 < 3 );
  v9 = 0;
  do
  {
    v10 = PRNG();
    *((uchar *)v16 + v9) = ((v10 & 0x80000000) != 0) + __ROR4__((v10 << 31) - (v10 >> 31), 31);
    v9 = (v9 + 1) & 0xFF;
  }
  while ( v9 < 3 );
  v11 = 0;
  do
  {
    Function_21e622c(v14, *((uchar *)v16 + v11));
    switch ( *((uchar *)&v18 + v11) )
    {
      case 0:
        LOBYTE(v15[0]) = GetBoxPkmnData(v12, 0x46u, 0);
        SetPkmnData(v2, 70, v15);
        break;
      case 1:
        LOBYTE(v15[0]) = GetBoxPkmnData(v12, 0x47u, 0);
        SetPkmnData(v2, 71, v15);
        break;
      case 2:
        LOBYTE(v15[0]) = GetBoxPkmnData(v12, 0x48u, 0);
        SetPkmnData(v2, 72, v15);
        break;
      case 3:
        LOBYTE(v15[0]) = GetBoxPkmnData(v12, 0x49u, 0);
        SetPkmnData(v2, 73, v15);
        break;
      case 4:
        LOBYTE(v15[0]) = GetBoxPkmnData(v12, 0x4Au, 0);
        SetPkmnData(v2, 74, v15);
        break;
      case 5:
        LOBYTE(v15[0]) = GetBoxPkmnData(v12, 0x4Bu, 0);
        SetPkmnData(v2, 75, v15);
        break;
      default:
        break;
    }
    result = (v11 + 1) << 24;
    v11 = (v11 + 1) & 0xFF;
  }
  while ( v11 < 3 );
  return result;
}

//----- (021E68D8) --------------------------------------------------------
int __fastcall Function_21e68d8(int *a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  uint v6;
  uint v7;
  uint v8;

  v2 = 0;
  v3 = a2;
  v4 = 0;
  v5 = (ushort)GetPkmnData(a1, 5u, 0) + 20000;
  v6 = 0;
  while ( v5 != *((ushort *)&dword_21F9F70[12] + v6 + 1) )
  {
    v6 = (v6 + 1) & 0xFFFF;
    if ( v6 >= 0x775 )
      goto LABEL_5;
  }
  v4 = (v6 + 1) & 0xFFFF;
LABEL_5:
  v7 = 0;
  do
  {
    v8 = *((ushort *)&dword_21F9F70[12] + v4 + v7 + 1);
    if ( v8 > 0x4E20 )
      break;
    *(ushort *)(v3 + 2 * v7) = v8;
    v7 = (v7 + 1) & 0xFFFF;
    v2 = (v2 + 1) & 0xFFFF;
  }
  while ( v7 < 0x10 );
  return (uchar)v2;
}

//----- (021E6948) --------------------------------------------------------
uint __fastcall Function_21e6948(int *a1, int a2, int a3)
{
  int *v3;
  int v4;
  uint v5;
  uint v6;
  uint v7;
  int v8;
  uint v9;
  int v10;
  uint v11;
  uint v12;
  uint v13;
  int v14;
  int v15;
  uint v16;
  int v17;
  int v18;
  uint v19;
  int v20;
  int v22;
  int v23;
  uint v24;
  int v25;
  uint v26;
  int v27;
  int v28;

  v3 = a1;
  v22 = a2;
  v23 = a3;
  v4 = malloc(4u, 180);
  v28 = 0;
  MIi_CpuClearFast(0, (uint *)v4, 0xB4u);
  v27 = (ushort)GetPkmnData(v3, 5u, 0);
  v25 = (ushort)GetPkmnData(v3, 0x70u, 0);
  v26 = Function_2077660(v27, v25, (ushort *)(v4 + 48)) & 0xFFFF;
  v5 = 0;
  do
  {
    *(uint *)(v4 + 4 * v5) = GetBoxPkmnData(v22, v5 + 54, 0);
    *(uint *)(v4 + 4 * v5 + 32) = GetBoxPkmnData(v23, v5 + 54, 0);
    v5 = (v5 + 1) & 0xFFFF;
  }
  while ( v5 < 4 );
  v6 = Function_21e68d8(v3, v4 + 148);
  v7 = 0;
  do
  {
    v8 = *(uint *)(v4 + 4 * v7);
    if ( !v8 )
      break;
    v9 = 0;
    if ( v6 )
    {
      while ( v8 != *(ushort *)(v4 + 2 * v9 + 148) )
      {
        v9 = (v9 + 1) & 0xFFFF;
        if ( v9 >= v6 )
          goto LABEL_10;
      }
      if ( Function_20770c4((int)v3, (ushort)v8) == 0xFFFF )
        Function_2077134((int)v3, *(uint *)(v4 + 4 * v7) & 0xFFFF);
    }
LABEL_10:
    v7 = (v7 + 1) & 0xFFFF;
  }
  while ( v7 < 4 );
  v24 = 0;
  do
  {
    v10 = 4 * v24;
    if ( *(uint *)(v4 + 4 * v24) )
    {
      v11 = 0;
      do
      {
        if ( *(uint *)(v4 + v10) == Function_207d268((v11 + 328) & 0xFFFF)
          && Function_2077fe4(v27, v25, (uchar)v11)
          && Function_20770c4((int)v3, *(uint *)(v4 + v10) & 0xFFFF) == 0xFFFF )
        {
          Function_2077134((int)v3, *(uint *)(v4 + v10) & 0xFFFF);
        }
        v11 = (v11 + 1) & 0xFFFF;
      }
      while ( v11 < 0x64 );
    }
    v24 = (v24 + 1) & 0xFFFF;
  }
  while ( v24 < 4 );
  v12 = 0;
  do
  {
    if ( !*(uint *)(v4 + 4 * v12) )
      break;
    v13 = 0;
    do
    {
      v14 = *(uint *)(v4 + 4 * v12);
      if ( v14 == *(uint *)(v4 + 4 * v13 + 32) && v14 )
      {
        v15 = 4 * v28;
        v28 = (v28 + 1) & 0xFFFF;
        *(uint *)(v4 + v15 + 16) = v14;
      }
      v13 = (v13 + 1) & 0xFFFF;
    }
    while ( v13 < 4 );
    v12 = (v12 + 1) & 0xFFFF;
  }
  while ( v12 < 4 );
  v16 = 0;
  do
  {
    v17 = v4 + 4 * v16;
    v18 = *(uint *)(v17 + 16);
    if ( !v18 )
      break;
    v19 = 0;
    if ( v26 )
    {
      while ( 1 )
      {
        v20 = v4 + 2 * v19;
        if ( *(ushort *)(v20 + 48) )
        {
          if ( *(uint *)(v17 + 16) == *(ushort *)(v20 + 48) )
            break;
        }
        v19 = (v19 + 1) & 0xFFFF;
        if ( v19 >= v26 )
          goto LABEL_36;
      }
      if ( Function_20770c4((int)v3, (ushort)v18) == 0xFFFF )
        Function_2077134((int)v3, *(uint *)(v17 + 16) & 0xFFFF);
    }
LABEL_36:
    v16 = (v16 + 1) & 0xFFFF;
  }
  while ( v16 < 4 );
  return free(v4);
}

//----- (021E6B40) --------------------------------------------------------
int __fastcall Function_5_21e6b40(int a1)
{
  int v1;

  v1 = a1;
  Function_2026270(a1, 0);
  return Function_2026278(v1, 0);
}

//----- (021E6B54) --------------------------------------------------------
int __fastcall Function_21e6b54(int a1, int a2)
{
  uint v2;
  int v3;
  uint v4;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;

  v3 = a1;
  Function_21e6668(a2, &v9);
  v4 = 0;
  while ( v3 != *((ushort *)&dword_21F9F6C + 3 * v4) )
  {
    v4 = (v4 + 1) & 0xFFFF;
    if ( v4 >= 9 )
      goto LABEL_5;
  }
  v2 = v4;
LABEL_5:
  if ( v4 == 9 )
    return v3;
  v6 = (ushort)GetBoxPkmnData(v9, 6u, 0);
  v7 = (ushort)GetBoxPkmnData(v10, 6u, 0);
  v8 = *((ushort *)&dword_21F9F6C + 3 * v2 + 1);
  if ( v6 != v8 && v7 != v8 )
    v3 = *((ushort *)dword_21F9F70 + 3 * v2);
  return v3;
}

//----- (021E6BD0) --------------------------------------------------------
uint __fastcall Function_21e6bd0(int a1, int a2, int a3, int a4)
{
  int v4;
  uint v5;
  uint result;
  int v7;
  int v8;
  int v9;

  v9 = a4;
  v4 = a1;
  Function_21e6668(a2, &v7);
  v5 = GetBoxPkmnData(v7, 6u, 0);
  result = GetBoxPkmnData(v8, 6u, 0);
  if ( v5 == 236 || result == 236 )
  {
    result = Function_20770c4(v4, 344);
    if ( result == 0xFFFF )
      result = Function_2077134(v4, 344);
  }
  return result;
}

//----- (021E6C20) --------------------------------------------------------
int __fastcall Function_21e6c20(int a1, uchar *a2, int a3, int a4)
{
  uchar *v4;
  uint v5;
  short v6;
  int v7;
  char *v8;
  int v9;
  uchar v10;
  int v12;
  char v13[8];
  char v14[4];
  int v15;

  v15 = a4;
  v4 = a2;
  v12 = a1;
  Function_21e6668(a1, v13);
  v5 = 0;
  do
  {
    v6 = GetBoxPkmnData(*(uint *)&v13[4 * v5], 5u, 0);
    v8 = v14;
    *(ushort *)&v14[2 * v5] = v6;
    if ( *(ushort *)&v14[2 * v5] == 132 )
    {
      *v4 = v5 ^ 1;
      v4[1] = v5;
    }
    else if ( DecidePkmnGender(*(uint *)&v13[4 * v5]) == 1 )
    {
      *v4 = v5;
      v4[1] = v5 ^ 1;
    }
    v5 = (v5 + 1) & 0xFFFF;
  }
  while ( v5 < 2 );
  v9 = Function_2076f84(*(ushort *)&v14[2 * *v4], 2 * *v4, (int)v8, v7);
  if ( v9 == 29 )
  {
    if ( Function_2026248(v12) & 0x8000 )
      v9 = 32;
    else
      v9 = 29;
  }
  if ( v9 == 314 )
  {
    if ( Function_2026248(v12) & 0x8000 )
      v9 = 313;
    else
      v9 = 314;
  }
  if ( v9 == 490 )
    v9 = 489;
  if ( *(ushort *)&v14[2 * v4[1]] == 132 && DecidePkmnGender(*(uint *)&v13[4 * *v4]) != 1 )
  {
    v10 = v4[1];
    v4[1] = *v4;
    *v4 = v10;
  }
  return v9;
}

//----- (021E6CF0) --------------------------------------------------------
int InitEggData()
{
  return Function_21e6cf2();
}

//----- (021E6CF2) --------------------------------------------------------
#error "Failed to decompile function. "

//----- (021E6DE8) --------------------------------------------------------
uint Function_21e6de8(int *a1, int a2, int a3, int a4, ...)
{
  int *v4;
  int v5;
  int v6;
  int v7;
  int v8;
  ushort *v9;
  int v10;
  int v12;
  char v13;
  char v14;
  short v15;
  int v16;
  va_list va;

  va_start(va, a4);
  v16 = a4;
  v12 = a2;
  v4 = a1;
  v5 = a3;
  v6 = a4;
  v13 = GetPkmnBaseData1(a2, 0x13u);
  v7 = Function_2026248(v5);
  if ( Function_2026280(v5) && !CheckIfShinyPkmn(v6, v7) )
  {
    v8 = 0;
    do
    {
      v7 = Function_201d30c(v7);
      if ( CheckIfShinyPkmn(v6, v7) )
        break;
      ++v8;
    }
    while ( v8 < 4 );
  }
  InitPkmnData(v4, v12, 1, 32, 1, v7, 0, 0);
  v14 = 0;
  v15 = 4;
  SetPkmnData((int)v4, 155, (ushort *)&v15);
  SetPkmnData((int)v4, 9, (ushort *)&v13);
  SetPkmnData((int)v4, 156, (ushort *)&v14);
  SetPkmnData((int)v4, 112, (ushort *)va);
  v9 = Function_200b32c(0x1EEu, 4u);
  SetPkmnData((int)v4, 119, v9);
  return Function_20237bc_FreeMsg((int)v9, v10);
}

//----- (021E6EA8) --------------------------------------------------------
uint __fastcall Function_5_21e6ea8(int a1, uint *a2, int a3)
{
  int v3;
  int v4;
  int *v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  uchar v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  uint *v20;
  char v21;
  uchar v22[3];

  v3 = a1;
  v20 = a2;
  v4 = a3;
  v5 = AllocPkmnData(4u);
  v8 = Function_21e6c20(v3, v22, v6, v7);
  v9 = Function_21e6b54(v8, v3);
  v10 = GetTrainerID(v4);
  Function_21e622c(v3, v22[0]);
  v12 = GetBoxPkmnData(v11, 0x70u, 0);
  Function_21e6de8(v5, v9, v3, v10, v12);
  Function_21e67b0((int)v5, v3);
  Function_21e622c(v3, v22[1]);
  v14 = v13;
  Function_21e622c(v3, v22[0]);
  Function_21e6948(v5, v14, v15);
  v16 = Function_2017070(1, 0);
  Function_209304c((int)v5, v4, 3u, v16, 4u);
  if ( v9 == 172 )
    Function_21e6bd0((int)v5, v3, v17, v18);
  v21 = 1;
  SetPkmnData((int)v5, 76, (ushort *)&v21);
  CopyPkmnDataToParty(v20, v5);
  Function_5_21e6b40(v3);
  return free((int)v5);
}

//----- (021E6F6C) --------------------------------------------------------
int __fastcall Function_21e6f6c(int a1)
{
  uint *v1;
  int v2;
  int v3;
  int *v4;
  int *v5;
  int v6;

  v1 = (uint *)a1;
  v2 = GetNrOfPkmnInParty(a1);
  v3 = 0;
  if ( v2 <= 0 )
    return 1;
  while ( 1 )
  {
    v4 = GetAdrOfPkmnInParty(v1, v3);
    if ( !GetPkmnData(v4, 0xADu, 0) )
    {
      v5 = GetAdrOfPkmnInParty(v1, v3);
      v6 = (uchar)GetPkmnData(v5, 0xAu, 0);
      if ( v6 == 40 || v6 == 49 )
        break;
    }
    v3 = (v3 + 1) & 0xFF;
    if ( v3 >= v2 )
      return 1;
  }
  return 2;
}

//----- (021E6FC0) --------------------------------------------------------
int __fastcall Function_21e6fc0(ushort *a1, ushort *a2)
{
  int v2;
  int v3;
  ushort *v4;

  v2 = 0;
  do
  {
    v3 = 0;
    v4 = a2;
    do
    {
      if ( *a1 == *v4 )
        return 1;
      ++v3;
      ++v4;
    }
    while ( v3 < 2 );
    ++v2;
    ++a1;
  }
  while ( v2 < 2 );
  return 0;
}

//----- (021E6FF0) --------------------------------------------------------
int __fastcall Function_21e6ff0(int *a1)
{
  int *v1;
  char *v2;
  int *v3;
  char *v4;
  uchar v5;
  int result;
  int *v7;
  uint v8;
  int v9;
  int v10;
  int v11;
  int v12;
  char v13;
  ushort v14;
  char v15;
  short v16;

  v1 = a1;
  v8 = 0;
  v2 = &v13;
  v7 = &v11;
  v3 = &v9;
  v4 = &v15;
  do
  {
    *(ushort *)v2 = GetBoxPkmnData(*v1, 5u, 0);
    *v7 = GetBoxPkmnData(*v1, 7u, 0);
    v5 = GetBoxPkmnData(*v1, 0, 0);
    *v3 = Function_2075dac(*(ushort *)v2, v5);
    ++v3;
    *(ushort *)v4 = GetPkmnBaseData1(*(ushort *)v2, 0x16u);
    *((ushort *)v4 + 1) = GetPkmnBaseData1(*(ushort *)v2, 0x17u);
    ++v1;
    ++v7;
    v2 += 2;
    v4 += 4;
    ++v8;
  }
  while ( v8 < 2 );
  if ( *(ushort *)&v15 == 15 || v16 == 15 )
    return 0;
  if ( *(ushort *)&v15 == 13 && v16 == 13 )
    return 0;
  if ( *(ushort *)&v15 != 13 && v16 != 13 )
  {
    if ( v9 == v10 )
    {
      result = 0;
    }
    else if ( v9 != 2 && v10 != 2 )
    {
      if ( Function_21e6fc0((ushort *)&v15, (ushort *)&v16) )
      {
        if ( *(ushort *)&v13 == v14 )
        {
          if ( v11 == v12 )
            result = 50;
          else
            result = 70;
        }
        else if ( v11 == v12 )
        {
          result = 20;
        }
        else
        {
          result = 50;
        }
      }
      else
      {
        result = 0;
      }
    }
    else
    {
      result = 0;
    }
  }
  else if ( v11 == v12 )
  {
    result = 20;
  }
  else
  {
    result = 50;
  }
  return result;
}

//----- (021E70FC) --------------------------------------------------------
int __fastcall Function_21e70fc(int a1, int a2, int a3, int a4)
{
  int v5[2];
  int v6;

  v6 = a4;
  Function_21e6668(a1, v5);
  return Function_21e6ff0(v5);
}

//----- (021E7110) --------------------------------------------------------
int __fastcall Function_21e7110(int a1)
{
  int v1;
  int v2;
  int v3;
  short *v5;
  uint v6;

  v1 = a1;
  v2 = Function_2055bc4(a1);
  v3 = v2 + 100 * Function_2055bb8(v1);
  if ( Function_2055c40(v1) )
    return 255;
  v5 = &word_21F9F54;
  v6 = 0;
  do
  {
    if ( v3 == (ushort)*v5 )
      return 230;
    ++v6;
    ++v5;
  }
  while ( v6 < 0xC );
  return 255;
}

//----- (021E7154) --------------------------------------------------------
int __fastcall Function_21e7154(int a1, uint *a2, int a3)
{
  uint *v3;
  int v4;
  uint v5;
  int *v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  uint v12;
  uint v13;
  int v14;
  uint v15;
  uint v16;
  int *v17;
  uint v18;
  int v20;
  int v21;
  char v22;
  uint v23;

  v3 = a2;
  v20 = a1;
  v21 = a3;
  Function_21e6668(a1, &v22);
  v4 = 0;
  v5 = 0;
  v6 = (int *)&v22;
  do
  {
    if ( GetBoxPkmnData(*v6, 0xACu, 0) )
    {
      v7 = Function_2026218(v20, v5);
      Function_2026260(v7, 1);
      ++v4;
    }
    ++v5;
    ++v6;
  }
  while ( v5 < 2 );
  if ( !Function_2026234(v20) && v4 == 2 )
  {
    v8 = Function_2026218(v20, 1);
    if ( (uchar)Function_2026228(v8) == 255 )
    {
      v12 = Function_21e70fc(v20, v9, v10, v11);
      v13 = PRNG();
      if ( v12 > u32_div_f(100 * v13, 0xFFFF) )
        Function_21e6720(v20);
    }
  }
  v14 = Function_2026250(v20);
  Function_2026278(v20, v14 + 1);
  if ( v14 + 1 == Function_21e7110(v21) )
  {
    Function_2026278(v20, 0);
    v15 = Function_21e6f6c((int)v3);
    v16 = 0;
    if ( GetNrOfPkmnInParty((int)v3) )
    {
      do
      {
        v17 = GetAdrOfPkmnInParty(v3, v16);
        if ( GetPkmnData(v17, 0x4Cu, 0) && !GetPkmnData(v17, 3u, 0) )
        {
          v18 = GetPkmnData(v17, 9u, 0);
          v23 = v18;
          if ( !v18 )
            return 1;
          if ( v18 < v15 )
            v23 = v18 - 1;
          else
            v23 = v18 - v15;
          SetPkmnData((int)v17, 9, (ushort *)&v23);
        }
        ++v16;
      }
      while ( v16 < GetNrOfPkmnInParty((int)v3) );
    }
  }
  return 0;
}

//----- (021E7278) --------------------------------------------------------
int *__fastcall Function_21e7278(int a1)
{
  uint *v1;
  int v2;
  int v3;
  int *v4;

  v1 = (uint *)a1;
  v2 = GetNrOfPkmnInParty(a1);
  v3 = 0;
  if ( v2 <= 0 )
    return 0;
  while ( 1 )
  {
    v4 = GetAdrOfPkmnInParty(v1, v3);
    if ( GetPkmnData(v4, 0x4Cu, 0) )
    {
      if ( !GetPkmnData(v4, 9u, 0) )
        break;
    }
    if ( ++v3 >= v2 )
      return 0;
  }
  return v4;
}

//----- (021E72BC) --------------------------------------------------------
uint __fastcall Function_5_21e72bc(int a1, int *a2)
{
  int *v2;
  uint result;
  int v4;
  int v5;

  v2 = a2;
  Function_21e6668(a1, &v4);
  if ( GetBoxPkmnData(v4, 5u, 0) )
  {
    Function_200b5cc(v2, 0, v4);
    Function_200b5ec(v2, 2u, v4);
  }
  result = GetBoxPkmnData(v5, 5u, 0);
  if ( result )
    result = Function_200b5cc(v2, 1u, v5);
  return result;
}

//----- (021E7308) --------------------------------------------------------
ushort *__fastcall Function_5_21e7308(int a1, uint a2, uint a3, uint a4, uchar a5, int *a6)
{
  uint v6;
  int v7;
  uint v8;
  int v9;
  int v10;
  int *v11;
  int v12;
  uchar v13;
  int v14;
  int v15;
  uint v17;

  v6 = a2;
  v7 = a1;
  v8 = a3;
  v17 = a4;
  v9 = Function_2026218(a1, a5);
  Function_21e622c(v7, a5);
  v11 = (int *)v10;
  Function_200b5cc(a6, v6, v10);
  v12 = Function_2026228(v9);
  v13 = Function_21e6520(v11, v12);
  Function_200b60c((int)a6, v8, v13, 3, 0, 1);
  v14 = (uchar)GetBoxPkmnData((int)v11, 0x6Fu, 0);
  if ( v14 != 2 )
  {
    v15 = (ushort)GetBoxPkmnData((int)v11, 5u, 0);
    if ( (v15 == 29 || v15 == 32) && !GetBoxPkmnData((int)v11, 0x4Du, 0) )
      v14 = 2;
  }
  return Function_200bcf0((int)a6, v17, v14);
}

//----- (021E73A0) --------------------------------------------------------
int __fastcall Function_5_21e73a0(uint *a1, int a2, int *a3)
{
  int *v3;
  int *v4;
  int v5;

  v3 = a3;
  v4 = GetAdrOfPkmnInParty(a1, a2);
  Function_2076b10_Dummy();
  Function_200b5cc(v3, 0, v5);
  return (ushort)GetPkmnData(v4, 5u, 0);
}

//----- (021E73C8) --------------------------------------------------------
int __fastcall Function_5_21e73c8(int a1)
{
  int v1;
  int result;
  int v3;

  v1 = a1;
  if ( Function_2026234(a1) )
    return 1;
  v3 = Function_21e6238(v1);
  if ( v3 )
    result = (v3 + 1) & 0xFF;
  else
    result = 0;
  return result;
}

//----- (021E73F0) --------------------------------------------------------
int __fastcall Function_21e73f0(uint a1)
{
  if ( a1 > 0x14 )
  {
    if ( a1 > 0x32 )
    {
      if ( a1 == 70 )
        return 0;
    }
    else if ( a1 == 50 )
    {
      return 1;
    }
  }
  else
  {
    if ( a1 >= 0x14 )
      return 2;
    if ( !a1 )
      return 3;
  }
  return 0;
}

//----- (021E7420) --------------------------------------------------------
int __fastcall Function_5_21e7420(int a1, int a2, int a3, int a4)
{
  int v4;

  v4 = Function_21e70fc(a1, a2, a3, a4);
  return Function_21e73f0(v4);
}

//----- (021E742C) --------------------------------------------------------
uint __fastcall Function_21e742c(int *a1, uint a2)
{
  int *v2;
  uint v3;
  int *v4;
  uint v5;
  uint v6;
  uint v7;
  uint v8;
  uint v9;
  uint v10;
  int v11;
  ushort *v13;
  int v14;
  char v15;
  char v16;
  char v17;
  char v18;
  char v19;
  char v20;
  char v21;
  char v22;
  char v23;
  char v24;
  ushort v25;
  short v26;
  short v27;
  int v28;
  char v29[4];
  ushort v30[1];

  v2 = a1;
  v3 = a2;
  v13 = (ushort *)Function_2023790(8, a2);
  v4 = AllocPkmnData(v3);
  v14 = GetPkmnData(v2, 5u, 0) & 0xFFFF;
  v5 = 0;
  do
  {
    v30[v5] = GetPkmnData(v2, v5 + 54, 0);
    v29[v5] = GetPkmnData(v2, v5 + 58, 0);
    v5 = (v5 + 1) & 0xFF;
  }
  while ( v5 < 4 );
  v6 = GetPkmnData(v2, 0, 0);
  v7 = 0;
  do
  {
    *((uchar *)&v27 + v7) = GetPkmnData(v2, v7 + 70, 0);
    v7 = (v7 + 1) & 0xFF;
  }
  while ( v7 < 6 );
  v24 = GetPkmnData(v2, 0xCu, 0);
  v23 = GetPkmnData(v2, 0x7Au, 0);
  v22 = GetPkmnData(v2, 0xBu, 0);
  LOBYTE(v25) = GetPkmnData(v2, 0x9Au, 0);
  v20 = GetPkmnData(v2, 0x6Eu, 0);
  GetPkmnData(v2, 0x91u, v13);
  v18 = GetPkmnData(v2, 0x9Du, 0);
  v28 = GetPkmnData(v2, 7u, 0);
  v19 = GetPkmnData(v2, 0x70u, 0);
  if ( v14 == 490 )
  {
    v8 = GetPkmnData(v2, 0x98u, 0);
    if ( v8 == Function_2017070(2, 1) )
    {
      for ( ; CheckIfShinyPkmn(v28, v6); v6 = Function_201d30c(v6) )
        ;
    }
  }
  InitPkmnData(v4, v14, 1, 32, 1, v6, 0, 0);
  v9 = 0;
  do
  {
    SetPkmnData((int)v4, v9 + 54, &v30[v9]);
    SetPkmnData((int)v4, v9 + 58, (ushort *)&v29[v9]);
    v9 = (v9 + 1) & 0xFF;
  }
  while ( v9 < 4 );
  v10 = 0;
  do
  {
    SetPkmnData((int)v4, v10 + 70, (ushort *)((char *)&v27 + v10));
    v10 = (v10 + 1) & 0xFF;
  }
  while ( v10 < 6 );
  SetPkmnData((int)v4, 12, (ushort *)&v24);
  SetPkmnData((int)v4, 122, (ushort *)&v23);
  SetPkmnData((int)v4, 11, (ushort *)&v22);
  v21 = 120;
  SetPkmnData((int)v4, 9, (ushort *)&v21);
  SetPkmnData((int)v4, 154, &v25);
  SetPkmnData((int)v4, 110, (ushort *)&v20);
  SetPkmnData((int)v4, 145, v13);
  SetPkmnData((int)v4, 157, (ushort *)&v18);
  SetPkmnData((int)v4, 7, (ushort *)&v28);
  SetPkmnData((int)v4, 112, (ushort *)&v19);
  v26 = GetPkmnData(v2, 0x98u, 0);
  v17 = GetPkmnData(v2, 0x92u, 0);
  v16 = GetPkmnData(v2, 0x93u, 0);
  v15 = GetPkmnData(v2, 0x94u, 0);
  SetPkmnData((int)v4, 152, (ushort *)&v26);
  SetPkmnData((int)v4, 146, (ushort *)&v17);
  SetPkmnData((int)v4, 147, (ushort *)&v16);
  SetPkmnData((int)v4, 148, (ushort *)&v15);
  v26 = GetPkmnData(v2, 0x99u, 0);
  v17 = GetPkmnData(v2, 0x95u, 0);
  v16 = GetPkmnData(v2, 0x96u, 0);
  v15 = GetPkmnData(v2, 0x97u, 0);
  SetPkmnData((int)v4, 153, (ushort *)&v26);
  SetPkmnData((int)v4, 149, (ushort *)&v17);
  SetPkmnData((int)v4, 150, (ushort *)&v16);
  SetPkmnData((int)v4, 151, (ushort *)&v15);
  Function_20775ec(v4, v2);
  Function_20237bc_FreeMsg((int)v13, v11);
  return free((int)v4);
}

//----- (021E771C) --------------------------------------------------------
int __fastcall Function_21e771c(int *a1, uint a2)
{
  int *v2;
  ushort v3;
  char v5;
  char v6;
  char v7;
  char v8;
  char v9;

  v8 = 70;
  v7 = 0;
  v6 = 4;
  v2 = a1;
  v5 = 0;
  Function_21e742c(a1, a2);
  SetPkmnData((int)v2, 76, (ushort *)&v8);
  v3 = GetPkmnData(v2, 5u, 0);
  Function_200b274(v3, 0, &v9);
  SetPkmnData((int)v2, 117, (ushort *)&v9);
  SetPkmnData((int)v2, 77, (ushort *)&v7);
  SetPkmnData((int)v2, 155, (ushort *)&v6);
  SetPkmnData((int)v2, 156, (ushort *)&v5);
  return Function_207418c(v2);
}

//----- (021E7790) --------------------------------------------------------
int __fastcall Function_21e7790(int *a1)
{
  int v1;

  v1 = Function_21e6ff0(a1);
  return Function_21e73f0(v1);
}

//----- (021E779C) --------------------------------------------------------
BOOL __fastcall Function_21e779c(uint a1, uint a2, int a3)
{
  int v3;
  uint v4;
  int v5;
  int v6;
  int v7;

  v3 = a3;
  v4 = a2;
  s32_div_f(a1, a3);
  v6 = v5;
  s32_div_f(v4, v3);
  return v6 == v7;
}

//----- (021E77C0) --------------------------------------------------------
BOOL __fastcall Function_21e77c0(uint a1, uint a2, int a3)
{
  int v3;
  uint v4;
  uint v5;

  v3 = a3;
  v4 = a2;
  v5 = s32_div_f(a1, a3);
  return v5 == s32_div_f(v4, v3);
}

//----- (021E77E4) --------------------------------------------------------
int __fastcall Function_21e77e4(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int result;

  v2 = a1;
  v3 = 48 * a2;
  v4 = a1 + 48 * a2;
  if ( *(uint *)(v4 + 20) )
    Function_21e9640(*(uint *)(v4 + 12));
  if ( *(uint *)(v2 + v3 + 24) )
    Function_21ef23c(*(uint *)(v2 + v3 + 16));
  result = v2 + v3;
  *(uint *)(v2 + v3 + 40) = 1;
  return result;
}

//----- (021E7814) --------------------------------------------------------
int __fastcall Function_21e7814(uint *a1)
{
  uint *v1;
  int result;

  v1 = a1;
  if ( a1[4] )
    Function_21e9640(a1[2]);
  if ( v1[5] )
    Function_21ef23c(v1[3]);
  result = 0;
  v1[4] = 0;
  v1[5] = 0;
  return result;
}

//----- (021E7838) --------------------------------------------------------
uint __fastcall Function_21e7838(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int *a9)
{
  int v9;
  int *v10;
  uint result;
  int v12;
  int v13;
  int v14;
  char v15;
  int v16;
  int v17;
  int v18;
  int v19;
  int v20;
  int v21;

  v19 = a2;
  v20 = a3;
  v21 = a4;
  if ( a1 == 1 )
  {
    v9 = 0;
    v10 = a9;
    do
    {
      ++v9;
      *v10 = -1;
      ++v10;
    }
    while ( v9 < 4 );
    if ( a6 == 1 )
    {
      if ( a7 == 1 )
      {
        result = 0;
        *a9 = 0;
      }
      else
      {
        *a9 = 0;
        result = 1;
        a9[2] = 1;
      }
    }
    else
    {
      *a9 = 0;
      result = 1;
      a9[1] = 1;
      if ( a6 >= 2 )
      {
        a9[2] = 2;
        result = 3;
        a9[3] = 3;
      }
    }
  }
  else
  {
    if ( a2 < a4 )
      ErrorHandler();
    if ( v20 < a5 )
      ErrorHandler();
    v12 = (v19 - v21) / 32;
    v13 = (v20 - a5) / 32;
    v14 = Function_21e8abc(v19, v20, v21);
    v15 = Function_5_21e935c(v14, a8);
    v16 = v12 + v13 * a6;
    switch ( v15 )
    {
      case 0:
        a9[3] = v16;
        *a9 = v16 - a6 - 1;
        a9[1] = v16 - a6;
        a9[2] = v16 - 1;
        if ( v12 - 1 < 0 )
        {
          *a9 = -1;
          a9[2] = -1;
        }
        result = v13 - 1;
        if ( v13 - 1 < 0 )
        {
          result = -1;
          a9[1] = -1;
        }
        break;
      case 1:
        a9[2] = v16;
        *a9 = v16 - a6;
        a9[1] = v16 - a6 + 1;
        a9[3] = v16 + 1;
        if ( v12 + 1 >= a6 )
        {
          a9[1] = -1;
          a9[3] = -1;
        }
        result = v13 - 1;
        if ( v13 - 1 < 0 )
        {
          result = -1;
          *a9 = -1;
        }
        break;
      case 2:
        a9[1] = v16;
        v17 = v16 - 1;
        v18 = v16 + a6;
        *a9 = v17;
        a9[2] = v18 - 1;
        a9[3] = v18;
        if ( v12 - 1 < 0 )
        {
          *a9 = -1;
          a9[2] = -1;
        }
        result = a7;
        if ( v13 + 1 > a7 )
        {
          result = -1;
          a9[3] = -1;
        }
        break;
      case 3:
        *a9 = v16;
        a9[1] = v16 + 1;
        a9[2] = v16 + a6;
        a9[3] = v16 + a6 + 1;
        if ( v12 + 1 >= a6 )
        {
          a9[1] = -1;
          a9[3] = -1;
        }
        result = a7;
        if ( v13 + 1 > a7 )
        {
          result = -1;
          *a9 = -1;
        }
        break;
      default:
        result = ErrorHandler();
        break;
    }
  }
  return result;
}

//----- (021E79A8) --------------------------------------------------------
int __fastcall Function_21e79a8(uint *a1)
{
  uint v1;
  uint *v2;
  int v3;
  int result;

  v1 = 0;
  v2 = a1;
  do
  {
    v3 = v1;
    v2[v1 + 36] = malloc(4u, 2156);
    *(uint *)(v2[v1 + 36] + 2148) = 0;
    Function_21eeb84(v1, *v2, v2[v1 + 36] + 2132);
    Function_21eeb90(v1, *v2, v2[v1 + 36] + 2136);
    if ( v2[66] )
      *(uint *)(v2[v3 + 36] + 2152) = 0;
    else
      *(uint *)(v2[v3 + 36] + 2152) = Function_21e15f4(4u);
    *(uint *)(v2[v3 + 36] + 2144) = -1;
    MIi_CpuClearFast(-1, (uint *)v2[v3 + 36], 0x800u);
    result = (v1 + 1) << 24;
    v1 = (v1 + 1) & 0xFF;
  }
  while ( v1 < 4 );
  return result;
}

//----- (021E7A54) --------------------------------------------------------
int __fastcall Function_5_21e7a54(int a1)
{
  uint v1;
  int v2;
  int v3;
  int result;

  v1 = 0;
  v2 = a1;
  do
  {
    v3 = 4 * v1;
    *(uint *)(v2 + 4 * v1 + 144) = malloc(4u, 2156);
    *(uint *)(*(uint *)(v2 + 4 * v1 + 144) + 2148) = 0;
    if ( *(uint *)(v2 + 264) )
      *(uint *)(*(uint *)(v2 + v3 + 144) + 2152) = 0;
    else
      *(uint *)(*(uint *)(v2 + v3 + 144) + 2152) = Function_21e15f4(4u);
    *(uint *)(*(uint *)(v2 + v3 + 144) + 2144) = -1;
    result = (v1 + 1) << 24;
    v1 = (v1 + 1) & 0xFF;
  }
  while ( v1 < 4 );
  return result;
}

//----- (021E7AC4) --------------------------------------------------------
int __fastcall Function_21e7ac4(uint *a1)
{
  uint v1;
  uint *v2;
  int v3;
  int result;

  v1 = 0;
  v2 = a1;
  do
  {
    v3 = v1;
    v2[v1 + 36] = malloc(4u, 2156);
    *(uint *)(v2[v1 + 36] + 2148) = 0;
    Function_21eeb84(v1, *v2, v2[v1 + 36] + 2132);
    if ( v2[66] )
      *(uint *)(v2[v3 + 36] + 2152) = 0;
    else
      *(uint *)(v2[v3 + 36] + 2152) = Function_21e15f4(4u);
    *(uint *)(v2[v3 + 36] + 2144) = -1;
    result = (v1 + 1) << 24;
    v1 = (v1 + 1) & 0xFF;
  }
  while ( v1 < 4 );
  return result;
}

//----- (021E7B4C) --------------------------------------------------------
int __fastcall Function_21e7b4c(uint *a1)
{
  uint v1;
  uint *v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int result;

  v1 = 0;
  v2 = a1;
  do
  {
    *(uint *)(v2[v1 + 36] + 2148) = 0;
    Function_21eeb84(v1, *v2, v2[v1 + 36] + 2132);
    v5 = v2[v1 + 36];
    v6 = *(uint *)(v5 + 2152);
    if ( v6 )
      Function_5_21e1610(v6, v5, v3, v4);
    *(uint *)(v2[v1 + 36] + 2144) = -1;
    result = (v1 + 1) << 24;
    v1 = (v1 + 1) & 0xFF;
  }
  while ( v1 < 4 );
  return result;
}

//----- (021E7BAC) --------------------------------------------------------
uint __fastcall Function_21e7bac(int a1, uint a2, uint *a3)
{
  int v3;
  uint v4;
  uint *v5;
  uint *v6;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( a1 )
  {
    v6 = (uint *)malloc2(4u, 16);
    Function_2006dc8(v3, v4, 0, 16, (int)v6);
  }
  else
  {
    ErrorHandler();
    v6 = (uint *)LoadFromNARC_6(67, v4, 4u, 0, 16);
  }
  *v5 = *v6;
  v5[3] = v6[1];
  v5[1] = v6[2];
  v5[2] = v6[3];
  return free((int)v6);
}

//----- (021E7C00) --------------------------------------------------------
int __fastcall Function_21e7c00(int a1, int a2, uchar *a3, int a4, int a5, int a6, uint *a7)
{
  int v7;
  int result;
  int v9;
  int *v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;

  v18 = a4;
  v7 = a1;
  result = a7[a1 + 6];
  v13 = a2;
  if ( result >= 0 && result < a5 * a4 )
  {
    v9 = Function_2039f74(result, a3);
    result = 0xFFFF;
    if ( v9 != 0xFFFF )
    {
      Function_21e7bac(*(uint *)(a6 + 248), v9, &v14);
      Call_FS_ReadFile(*(int **)(a6 + 248), v14, a7[v7]);
      v10 = *(int **)(a7[v7] + 2152);
      if ( v10 )
        Function_21e16cc(*(int **)(a6 + 248), v17, v13, v10, *(uint *)(a6 + 240));
      ++a7[4];
      v11 = a7[v7];
      v12 = Function_21efa8c(v13);
      a7[2] = Function_21e976c(*(uint *)(a6 + 248), v15, v11 + 2048, v11 + 2132, v12, v11 + 2148, a7 + 4);
      ++a7[5];
      result = Function_21ef1f0(*(uint *)(a6 + 248), v16, *(uint *)(a7[v7] + 2140), a7 + 5, a7[v7] + 2136, a7 + 4);
      a7[3] = result;
    }
  }
  return result;
}

//----- (021E7CD4) --------------------------------------------------------
int __fastcall Function_21e7cd4(int a1, int a2, uchar *a3, int a4, int a5, int a6, int a7)
{
  int v7;
  int v8;
  int result;
  int v10;
  int *v11;
  int v12;
  int v13;
  char v14;
  int v15;
  int v16;
  char v17;

  v7 = a2;
  v8 = 4 * a1;
  result = *(uint *)(a7 + 4 * a1 + 24);
  if ( result >= 0 && result < a5 * a4 )
  {
    v10 = Function_2039f74(result, a3);
    result = 0xFFFF;
    if ( v10 != 0xFFFF )
    {
      Function_21e7bac(*(uint *)(a6 + 248), v10, &v14);
      Call_FS_ReadFile(*(int **)(a6 + 248), 2048, (int)&v17);
      v11 = *(int **)(*(uint *)(a7 + v8) + 2152);
      if ( v11 )
        Function_21e16cc(*(int **)(a6 + 248), v16, v7, v11, *(uint *)(a6 + 240));
      ++*(uint *)(a7 + 16);
      v12 = *(uint *)(a7 + v8);
      v13 = Function_21efa8c(v7);
      result = Function_21e976c(*(uint *)(a6 + 248), v15, v12 + 2048, v12 + 2132, v13, v12 + 2148, a7 + 16);
      *(uint *)(a7 + 8) = result;
    }
  }
  return result;
}

//----- (021E7D98) --------------------------------------------------------
int __fastcall Function_21e7d98(int a1, int a2, uchar *a3, int a4, int a5, int a6, int a7)
{
  int v7;
  int result;
  int v9;
  int v10;
  int v11;
  int v12;
  char v13;
  int v14;
  int v15;

  v7 = 4 * a1;
  result = *(uint *)(a7 + 4 * a1 + 24);
  v9 = a2;
  if ( result >= 0 && result < a5 * a4 )
  {
    v10 = Function_2039f74(result, a3);
    result = 0xFFFF;
    if ( v10 != 0xFFFF )
    {
      Function_21e7bac(*(uint *)(a6 + 248), v10, &v13);
      Call_FS_SeekFile(*(uint **)(a6 + 248), 2048);
      Call_FS_SeekFile(*(uint **)(a6 + 248), v15);
      ++*(uint *)(a7 + 16);
      v11 = *(uint *)(a7 + v7);
      v12 = Function_21efa8c(v9);
      result = Function_21e976c(*(uint *)(a6 + 248), v14, v11 + 2048, v11 + 2132, v12, v11 + 2148, a7 + 16);
      *(uint *)(a7 + 8) = result;
    }
  }
  return result;
}

//----- (021E7E28) --------------------------------------------------------
int __fastcall Function_21e7e28(int result, int a2, int a3, uchar *a4, int a5, int a6, int a7, int *a8)
{
  int v8;
  int v9;
  int v10;
  int v11;
  int *v12;
  int v13;
  int v14;
  int v15;
  int (__fastcall *v16)(int, int, uint);
  int v17;
  int v18;
  int v19;
  int v20;
  int v21;
  int v22;
  uchar *v23;

  v23 = a4;
  v8 = a2;
  v18 = result;
  v17 = a3;
  if ( result >= 0 && result < a5 * a6 )
  {
    v9 = Function_2039f74(result, a4);
    result = 0xFFFF;
    if ( v9 != 0xFFFF )
    {
      Function_21e7bac(a8[62], v9, &v19);
      v10 = 4 * v8;
      v11 = (int)(a8 + 36);
      Call_FS_ReadFile((int *)a8[62], v19, a8[v10 / 4u + 36]);
      v12 = *(int **)(a8[v10 / 4u + 36] + 2152);
      if ( v12 )
        Function_21e16cc((int *)a8[62], v22, v17, v12, a8[60]);
      v13 = *(uint *)(v11 + v10);
      v14 = Function_21efa8c(v17);
      v15 = Function_21e97ac(a8[62], v20, v13 + 2048, v13 + 2132, v14);
      if ( a7 == 1 )
        Function_21d53a4(v15);
      *(uint *)(*(uint *)(v11 + v10) + 2148) = 1;
      Function_21ef158(
        a8[62],
        v21,
        *(uint *)(*(uint *)(v11 + v10) + 2140),
        *(uint *)(*(uint *)(v11 + v10) + 2136));
      *(uint *)(*(uint *)(v11 + v10) + 2144) = v18;
      result = (int)(a8 + 63);
      v16 = (int (__fastcall *)(int, int, uint))a8[63];
      if ( v16 )
        result = v16(a8[64], v18, *(uint *)(*(uint *)(v11 + v10) + 2152));
    }
  }
  return result;
}

//----- (021E7F1C) --------------------------------------------------------
int __fastcall Function_21e7f1c(int result, int a2, int a3, uchar *a4, int a5, int a6, int a7, int a8)
{
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int *v13;
  int v14;
  int v15;
  int v16;
  int v17;
  char v18;
  int v19;
  int v20;
  char v21;

  v17 = a3;
  v8 = result;
  v9 = a2;
  if ( result >= 0 && result < a6 * a5 )
  {
    v10 = Function_2039f74(result, a4);
    result = 0xFFFF;
    if ( v10 != 0xFFFF )
    {
      Function_21e7bac(*(uint *)(a8 + 248), v10, &v18);
      Call_FS_ReadFile(*(int **)(a8 + 248), 2048, (int)&v21);
      v11 = 4 * v9;
      v12 = a8 + 144;
      v13 = *(int **)(*(uint *)(a8 + 144 + v11) + 2152);
      if ( v13 )
        Function_21e16cc(*(int **)(a8 + 248), v20, v17, v13, *(uint *)(a8 + 240));
      v14 = *(uint *)(v12 + v11);
      v15 = Function_21efa8c(v17);
      v16 = Function_21e97ac(*(uint *)(a8 + 248), v19, v14 + 2048, v14 + 2132, v15);
      if ( a7 == 1 )
        Function_21d53a4(v16);
      *(uint *)(*(uint *)(v12 + v11) + 2148) = 1;
      result = 2144;
      *(uint *)(*(uint *)(v12 + v11) + 2144) = v8;
    }
  }
  return result;
}

//----- (021E7FF0) --------------------------------------------------------
int __fastcall Function_21e7ff0(int result, int a2, int a3, uchar *a4, int a5, int a6, int a7, int *a8)
{
  int v8;
  int v9;
  int v10;
  int v11;
  int *v12;
  int (__fastcall *v13)(int, int, uint);
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  uchar *v20;

  v20 = a4;
  v8 = a2;
  v15 = result;
  v14 = a3;
  if ( result >= 0 && result < a5 * a6 )
  {
    v9 = Function_2039f74(result, a4);
    result = 0xFFFF;
    if ( v9 != 0xFFFF )
    {
      Function_21e7bac(a8[62], v9, &v16);
      v10 = 4 * v8;
      v11 = (int)(a8 + 36);
      Call_FS_ReadFile((int *)a8[62], v16, a8[v10 / 4u + 36]);
      v12 = *(int **)(a8[v10 / 4u + 36] + 2152);
      if ( v12 )
        Function_21e16cc((int *)a8[62], v19, v14, v12, a8[60]);
      Call_FS_SeekFile((uint *)a8[62], v17);
      Function_21ef158(
        a8[62],
        v18,
        *(uint *)(*(uint *)(v11 + v10) + 2140),
        *(uint *)(*(uint *)(v11 + v10) + 2136));
      *(uint *)(*(uint *)(v11 + v10) + 2144) = v15;
      result = (int)(a8 + 63);
      v13 = (int (__fastcall *)(int, int, uint))a8[63];
      if ( v13 )
        result = v13(a8[64], v15, *(uint *)(*(uint *)(v11 + v10) + 2152));
    }
  }
  return result;
}

//----- (021E80BC) --------------------------------------------------------
BOOL __fastcall Function_21e80bc(uint *a1)
{
  return !*a1 && !a1[1];
}

//----- (021E80D0) --------------------------------------------------------
int __fastcall Function_21e80d0(int a1, int a2, int a3, int a4, uchar a5, uchar a6, char a7)
{
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v14;
  int v15;
  int v16;

  v7 = a1;
  v14 = a4;
  v8 = a2;
  v16 = a3;
  v9 = 48 * a6;
  v15 = a1 + 44;
  if ( *(uint *)(a1 + 44 + 48 * a6) )
    ErrorHandler();
  *(uint *)(v15 + v9) = 1;
  v10 = v7 + v9;
  *(uchar *)(v7 + v9 + 48) = a7;
  *(uint *)(v10 + 28) = v8;
  *(uint *)(v10 + 32) = v16;
  *(uchar *)(v10 + 36) = v14;
  *(uchar *)(v10 + 37) = a5;
  v11 = v7 + 144;
  v12 = 4 * a5;
  *(uint *)(v10 + 4) = *(uint *)(v7 + 144 + 4 * v14);
  *(uint *)(v10 + 8) = *(uint *)(v7 + 144 + v12);
  *(uchar *)(v10 + 38) = 0;
  *(uint *)(v10 + 40) = 0;
  if ( !*(uchar *)(v7 + 160) )
    *(uint *)(v7 + 180) = 0;
  *(uint *)(*(uint *)(v11 + 4 * v14) + 2144) = v8;
  *(uint *)(*(uint *)(v11 + v12) + 2144) = v16;
  ++*(uchar *)(v7 + 160);
  *(uchar *)(v7 + 161) = (*(uchar *)(v7 + 161) + 1 < 0)
                       + __ROR4__(
                           ((*(uchar *)(v7 + 161) + 1) << 31)
                         - (((uint)*(uchar *)(v7 + 161) + 1) >> 31),
                           31);
  return 1;
}

//----- (021E8188) --------------------------------------------------------
int __fastcall Function_21e8188(int a1, int a2)
{
  int v2;
  int v3;
  uint *v4;
  uint *v5;
  int v6;
  int result;
  uint *v8;
  uint *v9;
  char v10;
  uint v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  uint *v17;
  int v18;
  int v19;
  int v20;
  void (__fastcall *v21)(uint);
  int v22;
  int v23;
  int v24;
  int v25;

  v2 = a2;
  v3 = a2 + 4 + 48 * *(uchar *)(a2 + 162);
  v4 = (uint *)(a2 + 204);
  if ( !*(uint *)(a2 + 260) && *(uint *)(a2 + 236) == 1 )
  {
    if ( *(uint *)(a2 + 228) )
    {
      if ( **(uint **)(a2 + 224) > **(uint **)(a2 + 220) )
        ErrorHandler();
      if ( **(uint **)(v2 + 220) - **(uint **)(v2 + 224) >= 0x10000 )
      {
        Function_5_21e9230(**(uint **)(v2 + 216), *(uint *)(*(uint *)(v2 + 216) + 8), &v25, &v24);
        Function_21e8f90(v25, v24, *(uint *)(v2 + 268), *(uint *)(v2 + 276), v2);
        v5 = *(uint **)(v2 + 216);
        v6 = v5[1];
        *v4 = *v5;
        *(uint *)(v2 + 208) = v6;
        *(uint *)(v2 + 212) = v5[2];
        if ( (*(uint *)(v2 + 212) >> 31) + __ROR4__((*(uint *)(v2 + 212) << 17) - (*(uint *)(v2 + 212) >> 31), 17) )
        {
          result = Function_2038ae0(1);
          if ( result )
            return result;
        }
        if ( (*(uint *)(v2 + 212) >> 31) + __ROR4__((*(uint *)(v2 + 212) << 17) - (*(uint *)(v2 + 212) >> 31), 17) )
          ErrorHandler();
        *(uint *)(v2 + 228) = 0;
        *(uint *)(v2 + 220) = 0;
        *(uint *)(v2 + 224) = 0;
      }
    }
    else
    {
      v8 = *(uint **)(a2 + 216);
      if ( *v4 == *v8 || *(uint *)(a2 + 212) == v8[2] )
      {
        if ( *v4 != *v8 || *(uint *)(a2 + 212) != v8[2] )
        {
          *(uint *)(a2 + 228) = 1;
          v9 = *(uint **)(a2 + 216);
          if ( *v4 == *v9 )
          {
            if ( *(uint *)(a2 + 212) <= *(uint *)(*(uint *)(a2 + 216) + 8) )
            {
              *(uint *)(a2 + 220) = v9 + 2;
              *(uint *)(a2 + 224) = a2 + 212;
              v10 = 2;
            }
            else
            {
              *(uint *)(a2 + 220) = a2 + 212;
              *(uint *)(a2 + 224) = *(uint *)(a2 + 216) + 8;
              v10 = 4;
            }
            *(uchar *)(a2 + 232) = v10;
            if ( (*(uint *)(a2 + 212) >> 31)
               + __ROR4__((*(uint *)(a2 + 212) << 17) - (*(uint *)(a2 + 212) >> 31), 17) )
            {
              result = Function_2038ae0(1);
              if ( result )
                return result;
            }
            if ( (*(uint *)(v2 + 212) >> 31)
               + __ROR4__((*(uint *)(v2 + 212) << 17) - (*(uint *)(v2 + 212) >> 31), 17) )
            {
              ErrorHandler();
            }
          }
          else
          {
            if ( *v4 <= *v9 )
            {
              *(uint *)(a2 + 220) = v9;
              *(uint *)(a2 + 224) = a2 + 204;
              *(uchar *)(a2 + 232) = 1;
            }
            else
            {
              *(uint *)(a2 + 220) = a2 + 204;
              *(uint *)(a2 + 224) = *(uint *)(a2 + 216);
              *(uchar *)(a2 + 232) = 3;
            }
            if ( (*v4 >> 31) + __ROR4__((*v4 << 17) - (*v4 >> 31), 17) )
            {
              result = Function_2038ae0(1);
              if ( result )
                return result;
            }
            if ( (*v4 >> 31) + __ROR4__((*v4 << 17) - (*v4 >> 31), 17) )
              ErrorHandler();
          }
          Function_21e9190(*(uchar *)(v2 + 232), v2);
        }
      }
      else
      {
        ErrorHandler();
      }
    }
  }
  v11 = *(uint *)(v2 + 180);
  if ( v11 <= 3 )
    JUMPOUT(__CS__, *((short *)&off_21E8338 + v11) + 35554106);
  switch ( (uchar)v11 )
  {
    case 0:
      v12 = *(uchar *)(v3 + 34);
      if ( *(uint *)(v2 + 4 * *(uchar *)(v3 + v12 + 32) + 128) != 1 )
      {
        v13 = *(uint *)(v2 + 196);
        v14 = *(uint *)(v2 + 192);
        (*(void (__cdecl **)(int, uint, uint))(*(uint *)(v2 + 244) + 4))(
          v12,
          *(uint *)(v2 + 184),
          *(uint *)(v2 + 188));
      }
      ++*(uchar *)(v3 + 34);
      *(uint *)(v2 + 180) = 1;
      break;
    case 1:
      if ( *(uint *)(v2 + 4 * *(uchar *)(v3 + *(uchar *)(v3 + 34) - 1 + 32) + 128) == 1 )
      {
        Function_21e7814((uint *)v3);
        *(uint *)(v2 + 4 * *(uchar *)(v3 + *(uchar *)(v3 + 34) - 1 + 32) + 128) = 0;
      }
      if ( *(uchar *)(v3 + 34) <= 2u && Function_21e80bc((uint *)(v3 + 16)) == 1 )
      {
        if ( *(uchar *)(v3 + 34) < 2u )
          *(uint *)(v2 + 180) = 0;
        else
          *(uint *)(v3 + 36) = 1;
        v15 = *(uint *)(v3 + 4 * (*(uchar *)(v3 + 34) - 1));
        if ( *(uint *)(v15 + 2148) == 1 )
        {
          v16 = Function_20b3c0c_GetAdrOfDataPart(*(uint *)(v15 + 2132));
          if ( v16
            && (v16 == -8 || !*(uchar *)(v16 + 9) ? (v17 = 0) : (v17 = (uint *)(v16
                                                                                + 8
                                                                                + *(ushort *)(v16 + 14)
                                                                                + 4)),
                v17) )
          {
            v18 = v16 + *v17;
          }
          else
          {
            v18 = 0;
          }
          if ( Function_21efac0(*(uint *)(v2 + 184)) == 1 )
            Function_21d53a4(v18);
        }
        v19 = *(uint *)(v3 + 4 * (*(uchar *)(v3 + 34) - 1));
        v20 = *(uint *)(v19 + 2144);
        if ( v20 >= 0 && v20 < *(uint *)(v2 + 196) * *(uint *)(v2 + 192) )
        {
          v21 = *(void (__fastcall **)(uint))(v2 + 252);
          if ( v21 )
          {
            v22 = *(uint *)(v19 + 2152);
            v21(*(uint *)(v2 + 256));
          }
        }
      }
      break;
    case 3:
      if ( Function_21e80bc((uint *)(v3 + 16)) == 1 )
        *(uchar *)(v2 + 160) = 0;
      break;
    default:
      break;
  }
  if ( *(uchar *)(v2 + 160) )
  {
    result = Function_21e8dac(v2);
    if ( result == 1 )
    {
      *(uint *)(v2 + 48 * *(uchar *)(v2 + 162) + 44) = 0;
      Function_21e8dbc(v2);
      --*(uchar *)(v2 + 160);
      *(uchar *)(v2 + 162) = (*(uchar *)(v2 + 162) + 1 < 0)
                           + __ROR4__(
                               ((*(uchar *)(v2 + 162) + 1) << 31)
                             - (((uint)*(uchar *)(v2 + 162) + 1) >> 31),
                               31);
      if ( *(uchar *)(v2 + 160) )
      {
        v23 = 0;
      }
      else
      {
        *(uchar *)(v2 + 162) = 0;
        *(uchar *)(v2 + 161) = 0;
        v23 = 2;
      }
      *(uint *)(v2 + 180) = v23;
      result = *(uint *)(v2 + 108);
      if ( result == 1 )
      {
        *(uint *)(v2 + 108) = 0;
        Function_21e8dd4(*(uchar *)(v2 + 112), v2);
        result = Function_21e8d50(v2);
      }
    }
  }
  else
  {
    *(uchar *)(v2 + 162) = 0;
    *(uchar *)(v2 + 161) = 0;
    result = 2;
    *(uint *)(v2 + 180) = 2;
  }
  return result;
}

//----- (021E8558) --------------------------------------------------------
uint __fastcall Function_21e8558(int a1, int a2, int a3, int a4, int a5, int a6)
{
  int v6;
  int v7;
  uint result;
  int v9;
  int v10;
  uchar v11;
  int v12;

  v12 = a4;
  v10 = a3;
  v6 = a1;
  v7 = a4;
  v9 = a2;
  if ( *(uint *)(a6 + 108) == 1 )
    ErrorHandler();
  if ( Function_21e8c58(a5, a6, &v11) == 1 )
  {
    Function_21e77e4(a6, v11);
    if ( *(uchar *)(a6 + 160) < 2u )
    {
      result = Function_21e80d0(a6, v6, v9, v10, v7, *(uchar *)(a6 + 161), a5);
    }
    else
    {
      *(uint *)(a6 + 108) = 1;
      *(uint *)(a6 + 116) = v6;
      *(uint *)(a6 + 120) = v9;
      *(uchar *)(a6 + 124) = v10;
      *(uchar *)(a6 + 125) = v7;
      *(uint *)(a6 + 100) = *(uint *)(a6 + 144 + 4 * v10);
      *(uint *)(a6 + 104) = *(uint *)(a6 + 144 + 4 * v7);
      *(uchar *)(a6 + 112) = a5;
      *(uint *)(*(uint *)(a6 + 144 + 4 * v10) + 2144) = v6;
      result = v9;
      *(uint *)(*(uint *)(a6 + 144 + 4 * v7) + 2144) = v9;
    }
  }
  else
  {
    result = Function_21e80d0(a6, v6, v9, v10, v7, *(uchar *)(a6 + 161), a5);
    if ( result != 1 )
      result = ErrorHandler();
  }
  return result;
}

//----- (021E8614) --------------------------------------------------------
uint *__fastcall Function_21e8614(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  uint *result;

  v2 = a2;
  v3 = 4 * a1;
  v4 = a2 + 144;
  *(uint *)(*(uint *)(a2 + 144 + 4 * a1) + 2148) = 0;
  Function_21ef1dc(*(uint *)(*(uint *)(a2 + 144 + 4 * a1) + 2140));
  v7 = *(uint *)(v4 + v3);
  v8 = *(uint *)(v7 + 2152);
  if ( v8 )
    Function_5_21e1610(v8, v7, v5, v6);
  *(uint *)(*(uint *)(v2 + 144 + v3) + 2144) = -1;
  MIi_CpuClearFast(-1, *(uint **)(v2 + 144 + v3), 0x800u);
  result = (uint *)(v2 + v3 + 128);
  *result = 1;
  return result;
}

//----- (021E8668) --------------------------------------------------------
int __fastcall Function_21e8668(int a1, int a2, int a3, int a4, int a5)
{
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int result;
  int v11;

  v5 = a2;
  v6 = a1;
  v7 = a3;
  v8 = a4;
  Function_21e8614(a1, a5);
  Function_21e8614(v5, a5);
  v9 = a5 + 144;
  v5 *= 4;
  result = *(uint *)(a5 + 144 + 4 * v6);
  v11 = *(uint *)(a5 + 144 + v5);
  *(uint *)(v9 + 4 * v6) = *(uint *)(v9 + 4 * v7);
  *(uint *)(v9 + v5) = *(uint *)(v9 + 4 * v8);
  *(uint *)(v9 + 4 * v7) = result;
  *(uint *)(v9 + 4 * v8) = v11;
  return result;
}

//----- (021E86A0) --------------------------------------------------------
uint __fastcall Function_21e86a0(uint a1, uint a2, int a3)
{
  int v3;
  int v4;
  uint v5;
  int v6;
  int v7;
  int v8;
  int v9;
  uint result;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  int v20;
  int v21;
  uchar v22;
  uchar v23;

  v21 = a2;
  v5 = a1;
  v6 = a3;
  if ( a2 <= 4 )
    JUMPOUT(__CS__, *((short *)&off_21E86BE + a2) + 35555008);
  switch ( (uchar)a2 )
  {
    case 1:
      Function_21e8668(0, 2, 1, 3, a3);
      if ( *(uchar *)(v6 + 173) )
      {
        if ( *(uchar *)(v6 + 173) == 2 )
        {
          v17 = *(uint *)(v6 + 192);
          v4 = v5 + 1;
          v3 = v5 + v17 + 1;
          v23 = 1;
          v22 = 3;
          if ( *(uint *)(v6 + 196) * v17 <= (int)(v5 + 1) || !Function_21e77c0(v5 + 1, v5, v17) )
          {
            v4 = -1;
            v3 = -1;
          }
          if ( v3 < 0 || !Function_21e779c(v4, v3, *(uint *)(v6 + 192)) )
            v3 = -1;
        }
      }
      else
      {
        v15 = *(uint *)(v6 + 192);
        v4 = v5 + 1;
        v3 = v5 - v15 + 1;
        v23 = 3;
        v22 = 1;
        if ( *(uint *)(v6 + 196) * v15 <= (int)(v5 + 1) || !Function_21e77c0(v5 + 1, v5, v15) )
        {
          v4 = -1;
          v3 = -1;
        }
        v16 = *(uint *)(v6 + 192);
        if ( *(uint *)(v6 + 196) * v16 <= v3 || !Function_21e779c(v4, v3, v16) )
          v3 = -1;
      }
      result = Function_21e8558(v4, v3, v23, v22, v21, v6);
      break;
    case 2:
      Function_21e8668(0, 1, 2, 3, a3);
      if ( *(uchar *)(v6 + 173) )
      {
        if ( *(uchar *)(v6 + 173) == 1 )
        {
          v19 = *(uint *)(v6 + 192);
          v23 = 2;
          v22 = 3;
          v4 = v5 + v19;
          v20 = *(uint *)(v6 + 196) * v19;
          v3 = v5 + v19 + 1;
          if ( v20 > (int)(v5 + v19) )
          {
            if ( v20 <= v3 || !Function_21e77c0(v5 + v19, v5 + v19 + 1, v19) )
              v3 = -1;
          }
          else
          {
            v4 = -1;
            v3 = -1;
          }
        }
        else
        {
          ErrorHandler();
        }
      }
      else
      {
        v18 = *(uint *)(v6 + 192);
        v23 = 3;
        v22 = 2;
        v4 = v5 + v18;
        v3 = v5 + v18 - 1;
        if ( *(uint *)(v6 + 196) * v18 > (int)(v5 + v18) )
        {
          if ( !Function_21e77c0(v5 + v18, v5 + v18 - 1, v18) )
            v3 = -1;
        }
        else
        {
          v4 = -1;
          v3 = -1;
        }
      }
      result = Function_21e8558(v4, v3, v23, v22, v21, v6);
      break;
    case 3:
      Function_21e8668(1, 3, 0, 2, a3);
      v11 = *(uchar *)(v6 + 173);
      if ( v11 == 1 )
      {
        v12 = *(uint *)(v6 + 192);
        v4 = v5 - 1;
        v3 = v5 - v12 - 1;
        v23 = 2;
        v22 = 0;
        if ( (int)(v5 - 1) < 0 || !Function_21e77c0(v5 - 1, v5, v12) )
        {
          v4 = -1;
          v3 = -1;
        }
        if ( v3 < 0 || !Function_21e779c(v4, v3, *(uint *)(v6 + 192)) )
          v3 = -1;
      }
      else if ( v11 == 3 )
      {
        v13 = *(uint *)(v6 + 192);
        v4 = v5 - 1;
        v3 = v5 + v13 - 1;
        v23 = 0;
        v22 = 2;
        if ( (int)(v5 - 1) < 0 || !Function_21e77c0(v5 - 1, v5, v13) )
        {
          v4 = -1;
          v3 = -1;
        }
        v14 = *(uint *)(v6 + 192);
        if ( *(uint *)(v6 + 196) * v14 <= v3 || !Function_21e779c(v4, v3, v14) )
          v3 = -1;
      }
      else
      {
        ErrorHandler();
      }
      result = Function_21e8558(v4, v3, v23, v22, v21, v6);
      break;
    case 4:
      Function_21e8668(2, 3, 0, 1, a3);
      v7 = *(uchar *)(v6 + 173);
      if ( v7 == 2 )
      {
        v8 = *(uint *)(v6 + 192);
        v4 = v5 - v8;
        v23 = 1;
        v3 = v5 - v8 - 1;
        v22 = 0;
        if ( (int)(v5 - v8) >= 0 )
        {
          if ( v3 < 0 || !Function_21e77c0(v5 - v8, v5 - v8 - 1, v8) )
            v3 = -1;
        }
        else
        {
          v4 = -1;
          v3 = -1;
        }
      }
      else if ( v7 == 3 )
      {
        v9 = *(uint *)(v6 + 192);
        v4 = v5 - v9;
        v23 = 0;
        v3 = v5 - v9 + 1;
        v22 = 1;
        if ( (int)(v5 - v9) >= 0 )
        {
          if ( !Function_21e77c0(v5 - v9, v5 - v9 + 1, v9) )
            v3 = -1;
        }
        else
        {
          v4 = -1;
          v3 = -1;
        }
      }
      else
      {
        ErrorHandler();
      }
      result = Function_21e8558(v4, v3, v23, v22, v21, v6);
      break;
    default:
      result = ErrorHandler();
      break;
  }
  return result;
}

//----- (021E89D0) --------------------------------------------------------
int *__fastcall Function_21e89d0(int a1, int *a2, int a3)
{
  int *v3;
  int v4;
  int v5;
  int *v6;
  char *v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int *result;
  int *v13;
  int v14;
  int v15;
  char v16;
  int v17;
  int v18;
  int v19;
  int v20;
  int v21;
  int v22;

  v3 = a2;
  v4 = 4 * a1;
  v20 = 0;
  v21 = 0;
  v15 = a3;
  v5 = (int)(a2 + 36);
  v22 = 0;
  Function_21e901c(*(uint *)(a2[a1 + 36] + 2144), a2[48], a2[47]);
  v20 += v3[70];
  v21 += v3[71];
  v22 += v3[72];
  if ( *(uint *)(*(uint *)(v5 + v4) + 2148) == 1 )
  {
    v17 = 4096;
    v18 = 4096;
    v6 = dword_21FAEB8;
    v19 = 4096;
    v7 = &v16;
    v8 = 4;
    do
    {
      v9 = *v6;
      v10 = v6[1];
      v6 += 2;
      *(uint *)v7 = v9;
      *((uint *)v7 + 1) = v10;
      v7 += 8;
      --v8;
    }
    while ( v8 );
    *(uint *)v7 = *v6;
    Function_201ca74((uint *)(*(uint *)(v5 + v4) + 2048), &v20, (int *)&v16, &v17);
  }
  v11 = *(uint *)(v5 + v4);
  result = (int *)2148;
  if ( *(uint *)(v11 + 2148) == 1 )
  {
    result = (int *)2152;
    v13 = *(int **)(v11 + 2152);
    if ( v13 )
    {
      v14 = Function_21efac0(v3[46]);
      result = Function_21e17cc(&v20, v3[46], v14, v15, v13);
    }
  }
  return result;
}

//----- (021E8A98) --------------------------------------------------------
uint __fastcall Function_21e8a98(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;
  uint v6;

  v3 = a3;
  v4 = a2;
  v5 = a1;
  u32_div_f(a1, a3);
  return (v6 >> 5) + ((uint)u32_div_f(v5, v3) >> 5) * v4;
}

//----- (021E8ABC) --------------------------------------------------------
int __fastcall Function_21e8abc(int a1, int a2, int a3, int a4, int a5)
{
  return a1 - a3 + (a2 - a4) * a5;
}

//----- (021E8ACC) --------------------------------------------------------
uint __fastcall Function_21e8acc(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;
  uint v6;

  v3 = a3;
  v4 = a2;
  v5 = a1;
  u32_div_f(a1, a3);
  return (v6 >> 5) + ((uint)u32_div_f(v5, v3) >> 5) * v4;
}

//----- (021E8AF0) --------------------------------------------------------
int __fastcall Function_21e8af0(int a1)
{
  switch ( a1 )
  {
    case 0:
      return 3;
    case 1:
      return 2;
    case 2:
      return 1;
  }
  if ( a1 != 3 )
    ErrorHandler();
  return 0;
}

//----- (021E8B1C) --------------------------------------------------------
int __fastcall Function_21e8b1c(char a1, int a2, int a3, uint a4)
{
  int v4;
  int v5;
  int v6;
  int result;
  int v8;

  v4 = a3;
  v5 = a4;
  switch ( a1 )
  {
    case 1:
      s32_div_f(a4, a3);
      if ( v6 + 1 < v4 )
        result = v5 + 1;
      else
        result = v5;
      break;
    case 2:
      result = a4 + a3;
      if ( (int)(a4 + a3) >= 32 * a2 * a3 )
        result = a4;
      break;
    case 3:
      s32_div_f(a4, a3);
      if ( v8 - 1 >= 0 )
        result = v5 - 1;
      else
        result = v5;
      break;
    case 4:
      result = a4 - a3;
      if ( (int)(a4 - a3) < 0 )
        result = a4;
      break;
    default:
      ErrorHandler();
      result = 0;
      break;
  }
  return result;
}

//----- (021E8B84) --------------------------------------------------------
void Function_21e8b84()
{
  ;
}

//----- (021E8BC0) --------------------------------------------------------
uint __fastcall Function_21e8bc0(int a1, int a2, uchar *a3)
{
  int v3;
  int v4;
  uchar *v5;
  int v6;
  int v7;
  uint result;
  int v9;

  v4 = a2;
  v5 = a3;
  Function_21e8b84();
  if ( v4 >= v6 )
  {
    if ( v4 <= v6 )
    {
      result = ErrorHandler();
    }
    else
    {
      v9 = v4 - v6;
      if ( v9 == 1 )
      {
        result = ((uchar)*v5 + 1) << 24;
        v3 = ((uchar)*v5 + 1) & 0xFF;
      }
      else if ( v9 == 2 )
      {
        result = ((uchar)*v5 + 2) << 24;
        v3 = ((uchar)*v5 + 2) & 0xFF;
      }
      else
      {
        result = ErrorHandler();
      }
    }
  }
  else
  {
    v7 = v6 - v4;
    if ( v7 == 1 )
    {
      result = ((uchar)*v5 - 1) << 24;
      v3 = ((uchar)*v5 - 1) & 0xFF;
    }
    else if ( v7 == 2 )
    {
      result = ((uchar)*v5 - 2) << 24;
      v3 = ((uchar)*v5 - 2) & 0xFF;
    }
    else
    {
      result = ErrorHandler();
    }
  }
  *v5 = v3;
  return result;
}

//----- (021E8C24) --------------------------------------------------------
int __fastcall Function_21e8c24(char a1)
{
  int result;

  switch ( a1 )
  {
    case 1:
      result = 3;
      break;
    case 2:
      result = 4;
      break;
    case 3:
      result = 1;
      break;
    case 4:
      result = 2;
      break;
    default:
      ErrorHandler();
      result = 0;
      break;
  }
  return result;
}

//----- (021E8C58) --------------------------------------------------------
int __fastcall Function_21e8c58(char a1, int a2, uchar *a3)
{
  char v3;
  int v4;
  uchar *v5;
  int v6;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = 0;
  do
  {
    if ( *(uint *)(v4 + 44) == 1 && *(uchar *)(v4 + 48) == Function_21e8c24(v3) )
    {
      *v5 = v6;
      return 1;
    }
    ++v6;
    v4 += 48;
  }
  while ( v6 < 2 );
  return 0;
}

//----- (021E8C8C) --------------------------------------------------------
int __fastcall Function_21e8c8c(int a1)
{
  int v1;
  uint *v2;
  int result;

  v1 = a1;
  v2 = (uint *)(a1 + 100);
  if ( *(uint *)(a1 + 48 * *(uchar *)(a1 + 161) + 44) )
    ErrorHandler();
  result = 1;
  *(uint *)(v1 + 48 * *(uchar *)(v1 + 161) + 44) = 1;
  *(uchar *)(v1 + 48 * *(uchar *)(v1 + 161) + 48) = *(uchar *)(v1 + 112);
  *(uint *)(v1 + 48 * *(uchar *)(v1 + 161) + 28) = *(uint *)(v1 + 116);
  *(uint *)(v1 + 48 * *(uchar *)(v1 + 161) + 32) = *(uint *)(v1 + 120);
  *(uchar *)(v1 + 48 * *(uchar *)(v1 + 161) + 36) = *(uchar *)(v1 + 124);
  *(uchar *)(v1 + 48 * *(uchar *)(v1 + 161) + 37) = *(uchar *)(v1 + 125);
  *(uint *)(v1 + 48 * *(uchar *)(v1 + 161) + 4) = *v2;
  *(uint *)(v1 + 48 * *(uchar *)(v1 + 161) + 8) = *(uint *)(v1 + 104);
  *(uchar *)(v1 + 48 * *(uchar *)(v1 + 161) + 38) = 0;
  *(uint *)(v1 + 48 * *(uchar *)(v1 + 161) + 40) = 0;
  return result;
}

//----- (021E8D50) --------------------------------------------------------
uint __fastcall Function_21e8d50(int a1)
{
  int v1;
  uint result;

  v1 = a1;
  if ( *(uchar *)(a1 + 160) >= 2u )
    ErrorHandler();
  if ( Function_21e8c8c(v1) != 1 )
    ErrorHandler();
  *(uint *)(*(uint *)(v1 + 100) + 2144) = *(uint *)(v1 + 116);
  *(uint *)(*(uint *)(v1 + 104) + 2144) = *(uint *)(v1 + 120);
  ++*(uchar *)(v1 + 160);
  result = (((uint)*(uchar *)(v1 + 161) + 1) >> 31)
         + __ROR4__(
             ((*(uchar *)(v1 + 161) + 1) << 31) - (((uint)*(uchar *)(v1 + 161) + 1) >> 31),
             31);
  *(uchar *)(v1 + 161) = result;
  return result;
}

//----- (021E8DAC) --------------------------------------------------------
int __fastcall Function_21e8dac(int a1)
{
  return *(uint *)(a1 + 48 * *(uchar *)(a1 + 162) + 40);
}

//----- (021E8DBC) --------------------------------------------------------
int __fastcall Function_21e8dbc(int result)
{
  uint v1;

  v1 = 0;
  do
  {
    *(uint *)(result + 4 * v1 + 128) = 0;
    v1 = (v1 + 1) & 0xFF;
  }
  while ( v1 < 4 );
  return result;
}

//----- (021E8DD4) --------------------------------------------------------
int __fastcall Function_21e8dd4(int result, uint *a2)
{
  switch ( (uchar)result )
  {
    case 1:
      result = (int)(a2 + 32);
      a2[32] = 1;
      a2[34] = 1;
      break;
    case 2:
      result = (int)(a2 + 32);
      a2[32] = 1;
      a2[33] = 1;
      break;
    case 3:
      result = (int)(a2 + 33);
      a2[33] = 1;
      a2[35] = 1;
      break;
    case 4:
      result = (int)(a2 + 34);
      a2[34] = 1;
      a2[35] = 1;
      break;
    default:
      return result;
  }
  return result;
}

//----- (021E8E28) --------------------------------------------------------
uint __fastcall Function_21e8e28(int *a1, int a2, int a3, int a4, int a5, int a6)
{
  int *v6;
  int v7;
  int v8;
  int v9;
  uint result;
  uint v11;
  int v12;
  char v13[36];

  v6 = a1;
  v7 = a2;
  v8 = a3;
  v9 = a4;
  Function_21e79a8(a1);
  result = Function_21e7838(v6[65], v7, v8, v9, a5, v6[48], v6[49], a6, (int *)v13);
  v11 = 0;
  do
  {
    *(uint *)(v6[v11 + 36] + 2140) = Function_21ef13c(result);
    Function_21ef248(*(uint *)(v6[v11 + 36] + 2140));
    v12 = Function_21efac0(v6[46]);
    Function_21e7e28(*(uint *)&v13[4 * v11], v11, v6[46], (uchar *)v6[47], v6[48], v6[49], v12, v6);
    result = (v11 + 1) << 24;
    v11 = (v11 + 1) & 0xFF;
  }
  while ( v11 < 4 );
  return result;
}

//----- (021E8ECC) --------------------------------------------------------
int __fastcall Function_21e8ecc(uint *a1, int a2, int a3, int a4, int a5, int a6)
{
  int v6;
  int v7;
  int v8;
  int v9;
  uint v10;
  int v11;
  int result;
  char v13[36];

  v6 = (int)a1;
  v7 = a2;
  v8 = a3;
  v9 = a4;
  Function_21e7ac4(a1);
  Function_21e7838(*(uint *)(v6 + 260), v7, v8, v9, a5, *(uint *)(v6 + 192), *(uint *)(v6 + 196), a6, (int *)v13);
  v10 = 0;
  do
  {
    *(uint *)(*(uint *)(v6 + 4 * v10 + 144) + 2140) = 0;
    v11 = Function_21efac0(*(uint *)(v6 + 184));
    Function_21e7f1c(
      *(uint *)&v13[4 * v10],
      v10,
      *(uint *)(v6 + 184),
      *(uchar **)(v6 + 188),
      *(uint *)(v6 + 192),
      *(uint *)(v6 + 196),
      v11,
      v6);
    result = (v10 + 1) << 24;
    v10 = (v10 + 1) & 0xFF;
  }
  while ( v10 < 4 );
  return result;
}

//----- (021E8F60) --------------------------------------------------------
int __fastcall Function_21e8f60(uchar *a1)
{
  int v1;
  uchar *v2;

  v1 = 0;
  a1[162] = 0;
  a1[161] = 0;
  a1[160] = 0;
  v2 = a1;
  do
  {
    *((uint *)v2 + 11) = 0;
    *((uint *)v2 + 10) = 1;
    ++v1;
    v2 += 48;
  }
  while ( v1 < 2 );
  return Function_21e8dbc((int)a1);
}

//----- (021E8F90) --------------------------------------------------------
uint __fastcall Function_21e8f90(int a1, int a2, int a3, int a4, int a5)
{
  uint result;

  if ( *(uint *)(a5 + 260) == 1 )
  {
    if ( *(uint *)(a5 + 192) <= 1 )
      a1 = a3 + 16;
    else
      a1 = a3 + 31;
    if ( *(uint *)(a5 + 196) <= 1 )
      a2 = a4 + 16;
    else
      a2 = a4 + 31;
  }
  *(uint *)(a5 + 168) = Function_21e8abc(a1, a2, a3, a4, *(uint *)(a5 + 200));
  *(uchar *)(a5 + 173) = Function_5_21e935c(*(uint *)(a5 + 168), *(uint *)(a5 + 200));
  *(uchar *)(a5 + 172) = Function_21e8af0(*(uchar *)(a5 + 173));
  result = Function_21e8acc(*(uint *)(a5 + 168), *(uint *)(a5 + 192), *(uint *)(a5 + 200));
  *(uint *)(a5 + 164) = result;
  return result;
}

//----- (021E901C) --------------------------------------------------------
uint __fastcall Function_21e901c(uint result, int a2, uchar *a3, uint *a4)
{
  uchar *v4;
  uint *v5;
  uint v6;
  ushort v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;

  v4 = a3;
  v5 = a4;
  *a4 = 0x100000;
  a4[2] = 0x100000;
  v6 = result;
  v12 = a2;
  if ( result != -1 )
  {
    s32_div_f(result, a2);
    v8 = v7;
    v9 = (ushort)s32_div_f(v6, v12);
    v10 = Function_2039e10(v4);
    v11 = Function_2039e88((int)v4);
    v5[1] = Function_2039e8c((int)v4, v11, v8, v9, v10) << 15;
    *v5 += v8 << 21;
    result = v5[2] + (v9 << 21);
    v5[2] = result;
  }
  return result;
}

//----- (021E9084) --------------------------------------------------------
int __fastcall Function_21e9084(uchar *a1, int a2, int a3, int a4)
{
  int v4;
  uchar *v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v11;
  int v12;

  v11 = a2;
  v5 = a1;
  v12 = a3;
  v6 = a4;
  v7 = malloc(4u, 292);
  MI_CpuFill8((ushort *)v7, 0, 0x124u);
  if ( v6 )
  {
    if ( v6 == 1 )
    {
      *(uint *)(v7 + 244) = &off_21FAE90;
      v4 = 0;
    }
    else
    {
      ErrorHandler();
    }
  }
  else
  {
    *(uint *)(v7 + 244) = &off_21FAE98;
    v4 = 1;
  }
  *(uint *)v7 = Function_21eeac8(v4);
  *(uint *)(v7 + 184) = v11;
  *(uint *)(v7 + 188) = v5;
  *(uint *)(v7 + 192) = Function_2039e10(v5);
  *(uint *)(v7 + 196) = Function_2039e20((int)v5);
  *(uint *)(v7 + 200) = 32 * *(uint *)(v7 + 192);
  *(uint *)(v7 + 240) = v12;
  *(uint *)(v7 + 236) = 1;
  Function_21e8f60((uchar *)v7);
  *(uint *)(v7 + 176) = 0;
  *(uint *)(v7 + 180) = 2;
  *(uint *)(v7 + 248) = LoadFromNARC_8(67, 4u, v8, v9);
  *(uint *)(v7 + 252) = 0;
  return v7;
}

//----- (021E9150) --------------------------------------------------------
uint __fastcall Function_21e9150(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;

  v3 = a1;
  v4 = *(uint *)(a1 + 276);
  v5 = a2;
  v6 = *(uint *)(a1 + 200);
  v7 = *(uint *)(a1 + 268);
  v8 = a3;
  (**(void (__cdecl ***)(int, int))(a1 + 244))(a1, a2);
  return Function_21e8f90(v5, v8, *(uint *)(v3 + 268), *(uint *)(v3 + 276), v3);
}

//----- (021E9190) --------------------------------------------------------
uint __fastcall Function_21e9190(uint a1, int a2)
{
  int v2;
  uint v3;
  int v4;
  uint v5;
  uint result;

  v2 = a2;
  v3 = a1;
  v4 = Function_21e8b1c(a1, *(uint *)(a2 + 196), *(uint *)(a2 + 200), *(uint *)(a2 + 168));
  v5 = Function_21e8a98(v4, *(uint *)(v2 + 192), *(uint *)(v2 + 200));
  result = Function_5_21e935c(v4, *(uint *)(v2 + 200));
  if ( *(uint *)(v2 + 164) == v5 && *(uchar *)(v2 + 173) != result )
  {
    Function_21e86a0(v5, v3, v2);
    result = Function_21e8bc0(v3, *(uchar *)(v2 + 173), (uchar *)(v2 + 172));
  }
  return result;
}

//----- (021E91FC) --------------------------------------------------------
int __fastcall Function_21e91fc(int *a1, int a2)
{
  uint v2;
  int *v3;
  int v4;
  int result;

  v2 = 0;
  v3 = a1;
  v4 = a2;
  do
  {
    if ( *(uint *)(v3[v2 + 36] + 2144) != -1 )
      Function_21e89d0(v2, v3, v4);
    result = (v2 + 1) << 24;
    v2 = (v2 + 1) & 0xFF;
  }
  while ( v2 < 4 );
  return result;
}

//----- (021E9230) --------------------------------------------------------
int __fastcall Function_5_21e9230(int a1, int a2, int *a3, int *a4)
{
  int result;

  *a3 = a1 / 0x10000;
  result = a2 / 0x10000;
  *a4 = a2 / 0x10000;
  return result;
}

//----- (021E924C) --------------------------------------------------------
uint __fastcall Function_21e924c(uint *a1)
{
  uint *v1;
  uint v2;
  uint v3;
  int v4;
  int v5;
  uint result;

  v1 = a1;
  Function_2017acc();
  Function_20a6988();
  Function_20a6cf0();
  v2 = 0;
  do
  {
    Function_21e7814(&v1[12 * v2 + 1]);
    v2 = (v2 + 1) & 0xFF;
  }
  while ( v2 < 2 );
  v3 = 0;
  do
  {
    v4 = v3;
    *(uint *)(v1[v3 + 36] + 2148) = 0;
    Function_21ef1d0(*(uint *)(v1[v3 + 36] + 2140));
    v5 = *(uint *)(v1[v3 + 36] + 2152);
    if ( v5 )
      return Function_21e1608(v5);
    free(v1[v4 + 36]);
    v1[v4 + 36] = 0;
    v3 = (v3 + 1) & 0xFF;
  }
  while ( v3 < 4 );
  v1[45] = 3;
  result = (uint)(v1 + 44);
  v1[44] = 1;
  v1[59] = 0;
  return result;
}

//----- (021E92E4) --------------------------------------------------------
uint __fastcall Function_21e92e4(int a1)
{
  uint *v1;

  v1 = (uint *)a1;
  Call_FS_CloseFile(*(int **)(a1 + 248));
  Function_21eeb48(*v1);
  return free((int)v1);
}

//----- (021E9300) --------------------------------------------------------
BOOL __fastcall Function_21e9300(int a1)
{
  return *(uint *)(a1 + 176) == 1 && !*(uchar *)(a1 + 160);
}

//----- (021E931C) --------------------------------------------------------
int __fastcall Function_5_21e931c(uint *a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  uint *v5;
  int v6;
  int result;

  v2 = a1;
  v3 = a2;
  v4 = a2;
  v6 = a1[1];
  v5 = a1 + 2;
  v4 += 51;
  *v4 = *a1;
  v4[1] = v6;
  result = a1[2];
  v4[2] = *v5;
  v3[54] = v2;
  return result;
}

//----- (021E9338) --------------------------------------------------------
uint *__fastcall Function_5_21e9338(int a1)
{
  uint *result;

  result = (uint *)(a1 + 216);
  *result = 0;
  return result;
}

//----- (021E9340) --------------------------------------------------------
int __fastcall Function_5_21e9340(int a1, int a2, uint *a3)
{
  int result;

  result = *(uint *)(*(uint *)(a2 + 4 * a1 + 144) + 2152);
  *a3 = result;
  return result;
}

//----- (021E9354) --------------------------------------------------------
int __fastcall Function_21e9354(int a1)
{
  return *(uchar *)(a1 + 172);
}

//----- (021E935C) --------------------------------------------------------
int __fastcall Function_5_21e935c(int a1, int a2)
{
  char v2;
  uint v3;
  int v4;
  int result;

  v2 = a1;
  v3 = u32_div_f(a1, a2);
  v4 = (v3 >> 31) + __ROR4__((v3 << 27) - (v3 >> 31), 27);
  if ( (v2 & 0x1F) >= 16 )
  {
    if ( v4 >= 16 )
      result = 3;
    else
      result = 1;
  }
  else if ( v4 >= 16 )
  {
    result = 2;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (021E9390) --------------------------------------------------------
int __fastcall Function_5_21e9390(uint a1, int a2, int a3)
{
  int v3;
  uint v4;
  int result;
  uint v6;
  uint v7;
  int v8;
  int v9;
  uint v10;
  uint v11;
  int v12;
  int v13;
  uint v14;
  uint v15;
  int v16;
  uint v17;
  uint v18;
  int v19;
  uint v20;

  v3 = a3;
  v4 = a1;
  if ( *(uint *)(a3 + 164) == a1 )
    return *(uchar *)(a3 + 172);
  if ( a1 == -1 )
    ErrorHandler();
  v6 = *(uchar *)(v3 + 172);
  if ( v6 <= 3 )
    JUMPOUT(__CS__, (char *)&off_21E93CA + *((short *)&off_21E93CA + v6) + 2);
  switch ( (uchar)v3 )
  {
    case 0x54:
      v7 = *(uint *)(v3 + 164);
      v8 = *(uint *)(v3 + 192);
      if ( v8 == v4 - v7 )
      {
        result = (v6 + 2) & 0xFF;
      }
      else if ( v4 - v7 == 1 && Function_21e77c0(v7, v4, v8) )
      {
        result = (*(uchar *)(v3 + 172) + 1) & 0xFF;
      }
      else
      {
        v9 = *(uint *)(v3 + 192);
        v10 = *(uint *)(v3 + 164);
        if ( v9 + 1 != v4 - v10 || Function_21e77c0(v10, v4, v9) )
          result = 4;
        else
          result = (*(uchar *)(v3 + 172) + 3) & 0xFF;
      }
      break;
    case 0x55:
      v11 = *(uint *)(v3 + 164);
      v12 = *(uint *)(v3 + 192);
      if ( v12 == v4 - v11 )
      {
        result = (v6 + 2) & 0xFF;
      }
      else if ( v11 - v4 == 1 && Function_21e77c0(v11, v4, v12) )
      {
        result = (*(uchar *)(v3 + 172) - 1) & 0xFF;
      }
      else
      {
        v13 = *(uint *)(v3 + 192);
        v14 = *(uint *)(v3 + 164);
        if ( v13 - 1 != v4 - v14 || Function_21e77c0(v14, v4, v13) )
          result = 4;
        else
          result = (*(uchar *)(v3 + 172) + 1) & 0xFF;
      }
      break;
    case 0x56:
      v15 = *(uint *)(v3 + 164);
      v16 = *(uint *)(v3 + 192);
      if ( v16 == v15 - v4 )
      {
        result = (v6 - 2) & 0xFF;
      }
      else if ( v16 - 1 != v15 - v4 || Function_21e77c0(v15, v4, v16) )
      {
        v17 = *(uint *)(v3 + 164);
        if ( v4 - v17 == 1 && Function_21e77c0(v17, v4, *(uint *)(v3 + 192)) )
          result = (*(uchar *)(v3 + 172) + 1) & 0xFF;
        else
          result = 4;
      }
      else
      {
        result = (*(uchar *)(v3 + 172) - 1) & 0xFF;
      }
      break;
    case 0x57:
      v18 = *(uint *)(v3 + 164);
      v19 = *(uint *)(v3 + 192);
      if ( v19 == v18 - v4 )
      {
        result = (v6 - 2) & 0xFF;
      }
      else if ( v19 + 1 != v18 - v4 || Function_21e77c0(v18, v4, v19) )
      {
        v20 = *(uint *)(v3 + 164);
        if ( v20 - v4 == 1 && Function_21e77c0(v20, v4, *(uint *)(v3 + 192)) )
          result = (*(uchar *)(v3 + 172) - 1) & 0xFF;
        else
          result = 4;
      }
      else
      {
        result = (*(uchar *)(v3 + 172) - 3) & 0xFF;
      }
      break;
    default:
      result = 4;
      break;
  }
  return result;
}

//----- (021E9560) --------------------------------------------------------
int __fastcall Function_5_21e9560(int a1, uint a2)
{
  uint v2;
  int v3;

  v2 = a2;
  v3 = a1;
  if ( a2 >= 4 )
    ErrorHandler();
  return *(uint *)(*(uint *)(v3 + 4 * v2 + 144) + 2144);
}

//----- (021E9580) --------------------------------------------------------
BOOL __fastcall Function_5_21e9580(uint *a1, int a2, int a3, uchar *a4)
{
  uint *v4;
  int v5;
  int v6;
  int v7;
  uint v8;
  int v10;
  uint v11;
  uchar *v12;

  v4 = a1;
  v12 = a4;
  v5 = a2 - a1[67];
  v6 = a3 - a1[69];
  v7 = a1[48];
  v8 = v5 / 32 + v6 / 32 * v7;
  if ( v8 >= a1[49] * v7 && Function_2038ae0(1) )
    return 0;
  if ( v8 >= v4[49] * v4[48] )
    ErrorHandler();
  v10 = Function_5_21e935c(v5 + v6 * v4[50], v4[50]);
  v11 = Function_5_21e9390(v8, v10, (int)v4);
  if ( v12 )
    *v12 = v11;
  return v11 <= 3;
}

//----- (021E9610) --------------------------------------------------------
int __fastcall Function_5_21e9610(int a1, int a2)
{
  return *(uint *)(*(uint *)(a1 + 4 * a2 + 144) + 2140);
}

//----- (021E9624) --------------------------------------------------------
int __fastcall Function_5_21e9624(int a1, int a2)
{
  return *(uint *)(a1 + 4 * a2 + 144);
}

//----- (021E9630) --------------------------------------------------------
int __fastcall Function_21e9630(int result, int a2, int a3)
{
  *(uint *)(result + 252) = a2;
  *(uint *)(result + 256) = a3;
  return result;
}

//----- (021E9640) --------------------------------------------------------
int __fastcall Function_21e9640(int a1)
{
  int result;

  result = Function_201ced0(a1);
  *(uint *)(result + 28) = 1;
  return result;
}

//----- (021E964C) --------------------------------------------------------
uint __fastcall Function_21e964c(int *a1, int a2)
{
  int v2;
  int *v3;
  uint result;
  int v5;
  char v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  uint *v12;
  int v13;

  v2 = a2;
  v3 = a1;
  if ( *(uint *)(a2 + 28) == 1 )
    *(uchar *)(a2 + 20) = 5;
  result = *(uchar *)(a2 + 20);
  if ( result <= 5 )
    JUMPOUT(__CS__, *((short *)&off_21E9670 + result) + 35559026);
  switch ( (uchar)result )
  {
    case 0:
      *(uint *)(a2 + 36) = 0;
      v5 = *(uint *)(a2 + 4);
      if ( v5 > 57344 )
      {
        v5 = 57344;
        v6 = 1;
      }
      else
      {
        v6 = 2;
      }
      *(uchar *)(a2 + 20) = v6;
      Call_FS_ReadFile(*(int **)a2, v5, **(uint **)(a2 + 12) + *(uint *)(a2 + 36));
      result = *(uint *)(v2 + 36) + v5;
      *(uint *)(v2 + 36) = result;
      break;
    case 1:
      v7 = *(uint *)(a2 + 36);
      v8 = *(uint *)(a2 + 4) - v7;
      if ( v8 <= 57344 )
      {
        v9 = 1;
      }
      else
      {
        v8 = 57344;
        v9 = 0;
      }
      Call_FS_ReadFile(*(int **)a2, v8, **(uint **)(a2 + 12) + v7);
      if ( v9 )
      {
        result = 2;
        *(uchar *)(v2 + 20) = 2;
      }
      else
      {
        result = *(uint *)(v2 + 36) + v8;
        *(uint *)(v2 + 36) = result;
      }
      break;
    case 2:
      v10 = *(uint *)(a2 + 16);
      if ( v10 && Function_201ca5c(v10) == 1 )
        Function_201cbb0(**(uint **)(v2 + 12), *(uint *)(v2 + 16));
      result = 3;
      *(uchar *)(v2 + 20) = 3;
      break;
    case 3:
      v11 = Function_20b3c0c_GetAdrOfDataPart(**(uint **)(a2 + 12));
      if ( *(uchar *)(v11 + 9) != 1 )
        ErrorHandler();
      if ( v11
        && (v11 == -8 || !*(uchar *)(v11 + 9) ? (v12 = 0) : (v12 = (uint *)(v11
                                                                            + 8
                                                                            + *(ushort *)(v11 + 14)
                                                                            + 4)),
            v12) )
      {
        v13 = v11 + *v12;
      }
      else
      {
        v13 = 0;
      }
      if ( !v13 )
        ErrorHandler();
      Function_20ae608(*(uint **)(v2 + 8), v13);
      **(uint **)(v2 + 24) = 1;
      result = 5;
      *(uchar *)(v2 + 20) = 5;
      break;
    case 5:
      **(uint **)(a2 + 32) = 0;
      free(a2);
      result = Call_RemoveTaskFromTaskList(v3);
      break;
    default:
      return result;
  }
  return result;
}

//----- (021E976C) --------------------------------------------------------
uint *__fastcall Function_21e976c(int a1, int a2, int a3, int a4, int a5, uint *a6, int a7)
{
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;

  v7 = a1;
  v8 = a2;
  v9 = a3;
  v10 = a4;
  v11 = malloc2(4u, 40);
  *(uint *)v11 = v7;
  *(uint *)(v11 + 4) = v8;
  *(uint *)(v11 + 8) = v9;
  *(uint *)(v11 + 12) = v10;
  *(uint *)(v11 + 16) = a5;
  *(uchar *)(v11 + 20) = 0;
  *(uint *)(v11 + 24) = a6;
  *a6 = 0;
  *(uint *)(v11 + 32) = a7;
  *(uint *)(v11 + 28) = 0;
  return AddTaskToTaskList1((int)Function_21e964c, v11, 1u);
}

//----- (021E97AC) --------------------------------------------------------
int __fastcall Function_21e97ac(int *a1, int a2, uint *a3, int *a4, int a5)
{
  int *v5;
  uint *v6;
  int v7;
  uint *v8;
  int v9;

  v5 = a4;
  v6 = a3;
  Call_FS_ReadFile(a1, a2, *a4);
  if ( a5 && Function_201ca5c(a5) == 1 && !Function_201cbb0(*v5, a5) )
    ErrorHandler();
  if ( *(uchar *)(Function_20b3c0c_GetAdrOfDataPart(*v5) + 9) != 1 )
    ErrorHandler();
  v7 = Function_20b3c0c_GetAdrOfDataPart(*v5);
  if ( v7
    && (v7 == -8 || !*(uchar *)(v7 + 9) ? (v8 = 0) : (v8 = (uint *)(v7 + 8 + *(ushort *)(v7 + 14) + 4)), v8) )
  {
    v9 = v7 + *v8;
  }
  else
  {
    v9 = 0;
  }
  if ( !v9 )
    ErrorHandler();
  Function_20ae608(v6, v9);
  return v9;
}

//----- (021E9828) --------------------------------------------------------
int __fastcall Function_5_21e9828(int a1)
{
  return *(uint *)(a1 + 248);
}

//----- (021E9830) --------------------------------------------------------
int __fastcall Function_5_21e9830(uchar *a1, int a2, int a3)
{
  int v3;
  uchar *v4;
  int v5;
  int v6;
  int v7;
  int v8;

  v3 = a2;
  v4 = a1;
  v5 = a3;
  v6 = malloc(4u, 292);
  MI_CpuFill8((ushort *)v6, 0, 0x124u);
  *(uint *)v6 = Function_21eebc0(0);
  *(uint *)(v6 + 184) = v3;
  *(uint *)(v6 + 188) = v4;
  if ( v4 )
  {
    *(uint *)(v6 + 192) = Function_2039e10(v4);
    *(uint *)(v6 + 196) = Function_2039e20((int)v4);
    *(uint *)(v6 + 200) = 32 * *(uint *)(v6 + 192);
  }
  *(uint *)(v6 + 236) = 0;
  Function_21e8f60((uchar *)v6);
  *(uint *)(v6 + 176) = 0;
  *(uint *)(v6 + 180) = 2;
  *(uint *)(v6 + 248) = v5;
  if ( !v5 )
    *(uint *)(v6 + 248) = LoadFromNARC_8(67, 4u, v7, v8);
  return v6;
}

//----- (021E98C8) --------------------------------------------------------
int *__fastcall Function_5_21e98c8(uint *a1, uchar *a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int *result;

  v4 = a1;
  a1[46] = a3;
  v5 = (int)a2;
  a1[47] = a2;
  v6 = a4;
  a1[48] = Function_2039e10(a2);
  v4[49] = Function_2039e20(v5);
  v4[50] = 32 * v4[48];
  v4[59] = 0;
  Function_21e8f60(v4);
  v4[44] = 0;
  v4[45] = 2;
  result = v4 + 62;
  v4[62] = v6;
  if ( !v6 )
  {
    result = LoadFromNARC_8(67, 4u, v7, v8);
    v4[62] = result;
  }
  return result;
}

//----- (021E9938) --------------------------------------------------------
uint __fastcall Function_5_21e9938(uint *a1)
{
  uint v1;
  uint *v2;
  int v3;
  int v4;
  uint result;

  v1 = 0;
  v2 = a1;
  do
  {
    v3 = v1;
    *(uint *)(v2[v1 + 36] + 2148) = 0;
    v4 = *(uint *)(v2[v1 + 36] + 2152);
    if ( v4 )
      return Function_21e1608(v4);
    free(v2[v3 + 36]);
    v2[v3 + 36] = 0;
    v1 = (v1 + 1) & 0xFF;
  }
  while ( v1 < 4 );
  v2[45] = 3;
  result = (uint)(v2 + 44);
  v2[44] = 1;
  v2[59] = 0;
  return result;
}

//----- (021E9998) --------------------------------------------------------
int __fastcall Function_5_21e9998(int a1, int a2, int a3, int a4)
{
  int v4;
  uint v5;
  int v6;
  int result;

  v4 = a1;
  v5 = 0;
  do
  {
    v6 = *(uint *)(*(uint *)(v4 + 4 * v5 + 144) + 2152);
    if ( v6 )
      Function_5_21e1610(v6, a2, a3, a4);
    result = (v5 + 1) << 24;
    v5 = (v5 + 1) & 0xFF;
  }
  while ( v5 < 4 );
  return result;
}

//----- (021E99C4) --------------------------------------------------------
uint __fastcall Function_5_21e99c4(uint *a1)
{
  int v1;

  v1 = (int)a1;
  Function_21eeb48(*a1);
  return free(v1);
}

//----- (021E99D8) --------------------------------------------------------
uint __fastcall Function_5_21e99d8(uint *a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;

  v3 = (int)a1;
  v4 = a1[69];
  v5 = a2;
  v6 = a1[50];
  v7 = a1[67];
  v8 = a3;
  Function_21e9a14(a1, a2);
  return Function_21e8f90(v5, v8, *(uint *)(v3 + 268), *(uint *)(v3 + 276), v3);
}

//----- (021E9A14) --------------------------------------------------------
int __fastcall Function_21e9a14(uint *a1, int a2, int a3, int a4, int a5, int a6)
{
  uint *v6;
  int v7;
  int v8;
  uint v9;
  int v10;
  int result;
  char var24[40];

  v6 = a1;
  v7 = a2;
  v8 = a3;
  Function_21e7ac4(a1);
  Function_21e7838(v6[65], v7, v8, v6[67], v6[69], v6[48], v6[49], a6, (int *)var24);
  v9 = 0;
  do
  {
    *(uint *)(v6[v9 + 36] + 2140) = 0;
    v10 = Function_21efac0(v6[46]);
    Function_21e9b70(*(uint *)&var24[4 * v9], v9, v6[46], v6[47], v6[48], v6[49], v10, v6);
    result = (v9 + 1) << 24;
    v9 = (v9 + 1) & 0xFF;
  }
  while ( v9 < 4 );
  return result;
}

//----- (021E9AAC) --------------------------------------------------------
int __fastcall Function_5_21e9aac(uint *a1, int a2, int a3, int *a4)
{
  uint *v4;
  int v5;
  int v6;
  int *v7;
  int v8;
  int result;

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v7 = a4;
  Function_21e7b4c(a1);
  Function_21e7838(v4[65], v5, v6, v4[67], v4[69], v4[48], v4[49], v4[50], v7);
  v8 = 0;
  do
  {
    result = v4[36];
    ++v8;
    ++v4;
    *(uint *)(result + 2148) = 0;
  }
  while ( v8 < 4 );
  return result;
}

//----- (021E9B10) --------------------------------------------------------
int __fastcall Function_5_21e9b10(uint *a1, int a2, int a3)
{
  uint *v3;
  uchar v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int result;

  v3 = a1;
  v4 = a2;
  v5 = (int)(a1 + 36);
  v6 = 4 * a2;
  v7 = a3;
  *(uint *)(a1[a2 + 36] + 2140) = 0;
  v8 = Function_21efac0(a1[46]);
  Function_21e9b70(v7, v4, v3[46], v3[47], v3[48], v3[49], v8, v3);
  result = 2148;
  *(uint *)(*(uint *)(v5 + v6) + 2148) = 0;
  return result;
}

//----- (021E9B70) --------------------------------------------------------
int __fastcall Function_21e9b70(int result, int a2, int a3, uchar *a4, int a5, int a6, int a7, int a8)
{
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  char v17;
  int v18;
  int v19;

  v8 = result;
  v9 = a2;
  v16 = a3;
  if ( result >= 0 && result < a6 * a5 )
  {
    v10 = Function_2039f74(result, a4);
    Function_21e7bac(*(uint *)(a8 + 248), v10, &v17);
    Call_FS_SeekFile(*(uint **)(a8 + 248), v19 + 2048);
    v11 = 4 * v9;
    v12 = a8 + 144;
    DC_FlushRange(*(uint *)(*(uint *)(a8 + 144 + v11) + 2132), v18);
    v13 = *(uint *)(a8 + 144 + v11);
    v14 = Function_21efa8c(v16);
    v15 = Function_21e97ac(*(int **)(a8 + 248), v18, (uint *)(v13 + 2048), (int *)(v13 + 2132), v14);
    if ( a7 == 1 )
      Function_21d53a4(v15);
    *(uint *)(*(uint *)(v12 + v11) + 2148) = 1;
    result = 2144;
    *(uint *)(*(uint *)(v12 + v11) + 2144) = v8;
  }
  return result;
}

//----- (021E9C0C) --------------------------------------------------------
int __fastcall Function_5_21e9c0c(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int result;

  v2 = a1;
  v3 = a2;
  v4 = 0;
  v5 = a1;
  do
  {
    result = -1;
    if ( *(uint *)(*(uint *)(v5 + 144) + 2144) != -1 )
      result = Function_21e9c40((uchar)v4, v2, v3);
    ++v4;
    v5 += 4;
  }
  while ( v4 < 4 );
  return result;
}

//----- (021E9C40) --------------------------------------------------------
int *__fastcall Function_21e9c40(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int *v6;
  char *v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int *result;
  char v15;
  int v16;
  int v17;
  int v18;
  int v19;
  int v20;
  int v21;
  int v22;

  v22 = a4;
  v4 = a1;
  v5 = a2;
  v19 = 0;
  v20 = 0;
  v21 = 0;
  v16 = 4096;
  v17 = 4096;
  v6 = dword_21FAEDC;
  v18 = 4096;
  v7 = &v15;
  v8 = 4;
  do
  {
    v9 = *v6;
    v10 = v6[1];
    v6 += 2;
    *(uint *)v7 = v9;
    *((uint *)v7 + 1) = v10;
    v7 += 8;
    --v8;
  }
  while ( v8 );
  v11 = *v6;
  v12 = 4 * v4;
  *(uint *)v7 = v11;
  Function_21e901c(
    *(uint *)(*(uint *)(v5 + 144 + 4 * v4) + 2144),
    *(uint *)(v5 + 192),
    *(uchar **)(v5 + 188),
    &v19);
  v19 += *(uint *)(v5 + 280);
  v20 += *(uint *)(v5 + 284);
  v21 += *(uint *)(v5 + 288);
  v13 = *(uint *)(v5 + 144 + v12);
  result = (int *)2148;
  if ( *(uint *)(v13 + 2148) == 1 )
    result = Function_201ca74((uint *)(v13 + 2048), &v19, (int *)&v15, &v16);
  return result;
}

//----- (021E9CD8) --------------------------------------------------------
int __fastcall Function_5_21e9cd8(int a1)
{
  int v1;
  int v2;
  uint *v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int result;

  v1 = a1;
  v2 = 0;
  v3 = (uint *)(a1 + 4);
  do
  {
    Function_21e7814(v3);
    ++v2;
    v3 += 12;
  }
  while ( v2 < 2 );
  v4 = 0;
  v5 = v1;
  v6 = 0;
  do
  {
    v7 = *(uint *)(v5 + 144);
    ++v4;
    v5 += 4;
    *(uint *)(v7 + 2148) = 0;
  }
  while ( v4 < 4 );
  *(uint *)(v1 + 180) = 3;
  *(uint *)(v1 + 176) = 1;
  *(uint *)(v1 + 236) = 0;
  do
  {
    result = MIi_CpuClearFast(-1, *(uint **)(v1 + 144), 0x800u);
    ++v6;
    v1 += 4;
  }
  while ( v6 < 4 );
  return result;
}

//----- (021E9D3C) --------------------------------------------------------
int __fastcall Function_5_21e9d3c(ushort *a1, int a2, uint *a3, uint *a4, int a5, int a6)
{
  ushort *v6;
  int v7;
  uint *v8;
  int v9;
  int v10;
  int *v11;
  uint *v12;
  int v13;
  int v14;
  int v15;
  uint *v16;
  int v17;
  int v18;
  uint *v19;
  int v20;
  int *v21;
  int *v22;
  int v23;
  int v24;
  int v25;
  int *v26;
  int *v27;
  int v28;
  int v29;
  int v30;
  uint *v31;
  int v32;
  int v33;
  int v34;
  char *v35;
  int v36;
  int *v37;
  int v38;
  int result;
  int v40;
  uint *v41;
  int v42;
  char v43;

  v6 = a1;
  v7 = (int)a4;
  v40 = a2;
  v41 = a3;
  Function_21eec24(*a3, *a4);
  Function_2039d90(v6, *(ushort **)(v7 + 188));
  v8 = v41;
  v9 = 0;
  v10 = v7;
  do
  {
    v11 = v8 + 1;
    v12 = (uint *)(v10 + 4);
    v13 = 6;
    do
    {
      v14 = *v11;
      v15 = v11[1];
      v11 += 2;
      *v12 = v14;
      v12[1] = v15;
      v12 += 2;
      --v13;
    }
    while ( v13 );
    v8 += 12;
    v10 += 48;
    ++v9;
  }
  while ( v9 < 2 );
  v16 = v41;
  v17 = 0;
  v18 = v7;
  do
  {
    ++v17;
    *(uint *)(v18 + 128) = v16[32];
    ++v16;
    v18 += 4;
  }
  while ( v17 < 4 );
  v19 = v41;
  *(uchar *)(v7 + 160) = *((uchar *)v41 + 160);
  v20 = v7;
  *(uchar *)(v7 + 161) = *((uchar *)v41 + 161);
  *(uchar *)(v7 + 162) = *((uchar *)v41 + 162);
  *(uint *)(v7 + 164) = v41[41];
  *(uint *)(v7 + 168) = v41[42];
  *(uchar *)(v7 + 172) = *((uchar *)v41 + 172);
  *(uchar *)(v7 + 173) = *((uchar *)v41 + 173);
  v42 = 0;
  do
  {
    v21 = (int *)(v19[36] + 2048);
    v22 = (int *)(*(uint *)(v20 + 144) + 2048);
    v23 = 10;
    do
    {
      v24 = *v21;
      v25 = v21[1];
      v21 += 2;
      *v22 = v24;
      v22[1] = v25;
      v22 += 2;
      --v23;
    }
    while ( v23 );
    *v22 = *v21;
    *(uint *)(*(uint *)(v20 + 144) + 2132) = *(uint *)(v19[36] + 2132);
    *(uint *)(*(uint *)(v20 + 144) + 2148) = *(uint *)(v19[36] + 2148);
    *(uint *)(*(uint *)(v20 + 144) + 2144) = *(uint *)(v19[36] + 2144);
    ++v19;
    v20 += 4;
    ++v42;
  }
  while ( v42 < 4 );
  *(uint *)(v7 + 184) = v40;
  *(uint *)(v7 + 192) = v41[48];
  *(uint *)(v7 + 196) = v41[49];
  v26 = v41 + 51;
  v27 = (int *)(v7 + 204);
  *(uint *)(v7 + 200) = 32 * v41[48];
  v28 = 4;
  do
  {
    v29 = *v26;
    v30 = v26[1];
    v26 += 2;
    *v27 = v29;
    v27[1] = v30;
    v27 += 2;
    --v28;
  }
  while ( v28 );
  *v27 = *v26;
  *(uint *)(v7 + 260) = v41[65];
  *(uint *)(v7 + 268) = v41[67];
  *(uint *)(v7 + 272) = v41[68];
  *(uint *)(v7 + 276) = v41[69];
  v31 = (uint *)(v7 + 280);
  v32 = v41[71];
  *v31 = v41[70];
  v31[1] = v32;
  *(uint *)(v7 + 288) = v41[72];
  Function_21e8f90(a5, a6, *(uint *)(v7 + 268), *(uint *)(v7 + 276), v7);
  v33 = 0;
  *(uint *)(v7 + 176) = 0;
  v34 = v7;
  *(uint *)(v7 + 180) = v41[45];
  v35 = &v43;
  do
  {
    *(uint *)v35 = *(uint *)(*(uint *)(v34 + 144) + 2144);
    v35 += 4;
    Function_21ef248(*(uint *)(*(uint *)(v34 + 144) + 2140));
    ++v33;
    v34 += 4;
  }
  while ( v33 < 4 );
  v36 = 0;
  v37 = (int *)&v43;
  do
  {
    v38 = Function_21efac0(*(uint *)(v7 + 184));
    result = Function_21e7ff0(
               *v37,
               (uchar)v36++,
               *(uint *)(v7 + 184),
               *(uchar **)(v7 + 188),
               *(uint *)(v7 + 192),
               *(uint *)(v7 + 196),
               v38,
               (int *)v7);
    ++v37;
  }
  while ( v36 < 4 );
  return result;
}

//----- (021E9F98) --------------------------------------------------------
int __fastcall Function_5_21e9f98(uint *a1, uint *a2)
{
  uint *v2;
  uint *v3;
  int v4;
  int *v5;
  uint *v6;
  int v7;
  int v8;
  int v9;
  uint *v10;
  uint *v11;
  int v12;
  uint *v13;
  uint *v14;
  int v15;
  int *v16;
  int *v17;
  int v18;
  int v19;
  int v20;
  int *v21;
  int *v22;
  int v23;
  int v24;
  int v25;
  uint *v26;
  int v27;
  int result;
  uint *v29;
  uint *v30;

  v29 = a1;
  v30 = a2;
  Function_21eec24(*a2, *a1);
  Function_2039d90((ushort *)v30[47], (ushort *)v29[47]);
  v2 = v30;
  v3 = v29;
  v4 = 0;
  do
  {
    v5 = v2 + 1;
    v6 = v3 + 1;
    v7 = 6;
    do
    {
      v8 = *v5;
      v9 = v5[1];
      v5 += 2;
      *v6 = v8;
      v6[1] = v9;
      v6 += 2;
      --v7;
    }
    while ( v7 );
    ++v4;
    v2 += 12;
    v3 += 12;
  }
  while ( v4 < 2 );
  v10 = v30;
  v11 = v29;
  v12 = 0;
  do
  {
    ++v12;
    v11[32] = v10[32];
    ++v10;
    ++v11;
  }
  while ( v12 < 4 );
  v13 = v30;
  v14 = v29;
  *((uchar *)v29 + 160) = *((uchar *)v30 + 160);
  v15 = 0;
  *((uchar *)v29 + 161) = *((uchar *)v30 + 161);
  *((uchar *)v29 + 162) = *((uchar *)v30 + 162);
  v29[41] = v30[41];
  v29[42] = v30[42];
  *((uchar *)v29 + 172) = *((uchar *)v30 + 172);
  *((uchar *)v29 + 173) = *((uchar *)v30 + 173);
  do
  {
    v16 = (int *)(v13[36] + 2048);
    v17 = (int *)(v14[36] + 2048);
    v18 = 10;
    do
    {
      v19 = *v16;
      v20 = v16[1];
      v16 += 2;
      *v17 = v19;
      v17[1] = v20;
      v17 += 2;
      --v18;
    }
    while ( v18 );
    ++v15;
    *v17 = *v16;
    *(uint *)(v14[36] + 2132) = *(uint *)(v13[36] + 2132);
    *(uint *)(v14[36] + 2148) = *(uint *)(v13[36] + 2148);
    *(uint *)(v14[36] + 2144) = *(uint *)(v13[36] + 2144);
    ++v13;
    ++v14;
  }
  while ( v15 < 4 );
  v29[46] = v30[46];
  v21 = v30 + 51;
  v22 = v29 + 51;
  v29[48] = v30[48];
  v23 = 4;
  v29[49] = v30[49];
  v29[50] = 32 * v30[48];
  do
  {
    v24 = *v21;
    v25 = v21[1];
    v21 += 2;
    *v22 = v24;
    v22[1] = v25;
    v22 += 2;
    --v23;
  }
  while ( v23 );
  *v22 = *v21;
  v29[65] = v30[65];
  v29[67] = v30[67];
  v29[68] = v30[68];
  v29[69] = v30[69];
  v26 = v29 + 70;
  v27 = v30[71];
  *v26 = v30[70];
  v26[1] = v27;
  v29[72] = v30[72];
  v29[44] = 0;
  result = (int)(v29 + 45);
  v29[45] = v30[45];
  return result;
}

//----- (021EA174) --------------------------------------------------------
int __fastcall Function_5_21ea174(int a1, int a2)
{
  int v2;
  int v3;
  uint *v4;
  uint *v5;
  int v6;
  int result;
  uint *v8;
  uint *v9;
  char v10;
  uint v11;
  int v12;
  int v13;
  int v14;
  uint *v15;
  int v16;
  void (__fastcall *v17)(uint);
  int v18;
  int v19;
  int v20;
  int v21;
  int v22;
  int v23;

  v2 = a2;
  v3 = a2 + 4 + 48 * *(uchar *)(a2 + 162);
  v4 = (uint *)(a2 + 204);
  if ( !*(uint *)(a2 + 260) && *(uint *)(a2 + 236) == 1 )
  {
    if ( *(uint *)(a2 + 228) )
    {
      if ( **(uint **)(a2 + 224) > **(uint **)(a2 + 220) )
        ErrorHandler();
      if ( **(uint **)(v2 + 220) - **(uint **)(v2 + 224) >= 0x10000 )
      {
        Function_5_21e9230(**(uint **)(v2 + 216), *(uint *)(*(uint *)(v2 + 216) + 8), &v23, &v22);
        Function_21e8f90(v23, v22, *(uint *)(v2 + 268), *(uint *)(v2 + 276), v2);
        v5 = *(uint **)(v2 + 216);
        v6 = v5[1];
        *v4 = *v5;
        *(uint *)(v2 + 208) = v6;
        *(uint *)(v2 + 212) = v5[2];
        if ( (*(uint *)(v2 + 212) >> 31) + __ROR4__((*(uint *)(v2 + 212) << 17) - (*(uint *)(v2 + 212) >> 31), 17) )
        {
          result = Function_2038ae0(1);
          if ( result )
            return result;
        }
        if ( (*(uint *)(v2 + 212) >> 31) + __ROR4__((*(uint *)(v2 + 212) << 17) - (*(uint *)(v2 + 212) >> 31), 17) )
          ErrorHandler();
        *(uint *)(v2 + 228) = 0;
        *(uint *)(v2 + 220) = 0;
        *(uint *)(v2 + 224) = 0;
      }
    }
    else
    {
      v8 = *(uint **)(a2 + 216);
      if ( *v4 == *v8 || *(uint *)(a2 + 212) == v8[2] )
      {
        if ( *v4 != *v8 || *(uint *)(a2 + 212) != v8[2] )
        {
          *(uint *)(a2 + 228) = 1;
          v9 = *(uint **)(a2 + 216);
          if ( *v4 == *v9 )
          {
            if ( *(uint *)(a2 + 212) <= *(uint *)(*(uint *)(a2 + 216) + 8) )
            {
              *(uint *)(a2 + 220) = v9 + 2;
              *(uint *)(a2 + 224) = a2 + 212;
              v10 = 2;
            }
            else
            {
              *(uint *)(a2 + 220) = a2 + 212;
              *(uint *)(a2 + 224) = *(uint *)(a2 + 216) + 8;
              v10 = 4;
            }
            *(uchar *)(a2 + 232) = v10;
            if ( (*(uint *)(a2 + 212) >> 31)
               + __ROR4__((*(uint *)(a2 + 212) << 17) - (*(uint *)(a2 + 212) >> 31), 17) )
            {
              result = Function_2038ae0(1);
              if ( result )
                return result;
            }
            if ( (*(uint *)(v2 + 212) >> 31)
               + __ROR4__((*(uint *)(v2 + 212) << 17) - (*(uint *)(v2 + 212) >> 31), 17) )
            {
              ErrorHandler();
            }
          }
          else
          {
            if ( *v4 <= *v9 )
            {
              *(uint *)(a2 + 220) = v9;
              *(uint *)(a2 + 224) = a2 + 204;
              *(uchar *)(a2 + 232) = 1;
            }
            else
            {
              *(uint *)(a2 + 220) = a2 + 204;
              *(uint *)(a2 + 224) = *(uint *)(a2 + 216);
              *(uchar *)(a2 + 232) = 3;
            }
            if ( (*v4 >> 31) + __ROR4__((*v4 << 17) - (*v4 >> 31), 17) )
            {
              result = Function_2038ae0(1);
              if ( result )
                return result;
            }
            if ( (*v4 >> 31) + __ROR4__((*v4 << 17) - (*v4 >> 31), 17) )
              ErrorHandler();
          }
          Function_21e9190(*(uchar *)(v2 + 232), v2);
        }
      }
      else
      {
        ErrorHandler();
      }
    }
  }
  v11 = *(uint *)(v2 + 180);
  if ( v11 <= 3 )
    JUMPOUT(__CS__, *((short *)&off_21EA324 + v11) + 35562278);
  switch ( (uchar)v11 )
  {
    case 0:
      v12 = *(uchar *)(v3 + 34);
      if ( *(uint *)(v2 + 4 * *(uchar *)(v3 + v12 + 32) + 128) != 1 )
        Function_21e7d98(
          v12,
          *(uint *)(v2 + 184),
          *(uchar **)(v2 + 188),
          *(uint *)(v2 + 192),
          *(uint *)(v2 + 196),
          v2,
          v3);
      ++*(uchar *)(v3 + 34);
      *(uint *)(v2 + 180) = 1;
      break;
    case 1:
      if ( *(uint *)(v2 + 4 * *(uchar *)(v3 + *(uchar *)(v3 + 34) - 1 + 32) + 128) == 1 )
      {
        Function_21e7814((uint *)v3);
        *(uint *)(v2 + 4 * *(uchar *)(v3 + *(uchar *)(v3 + 34) - 1 + 32) + 128) = 0;
      }
      if ( *(uchar *)(v3 + 34) <= 2u && Function_21e80bc((uint *)(v3 + 16)) == 1 )
      {
        if ( *(uchar *)(v3 + 34) < 2u )
          *(uint *)(v2 + 180) = 0;
        else
          *(uint *)(v3 + 36) = 1;
        v13 = *(uint *)(v3 + 4 * (*(uchar *)(v3 + 34) - 1));
        if ( *(uint *)(v13 + 2148) == 1 )
        {
          v14 = Function_20b3c0c_GetAdrOfDataPart(*(uint *)(v13 + 2132));
          if ( v14
            && (v14 == -8 || !*(uchar *)(v14 + 9) ? (v15 = 0) : (v15 = (uint *)(v14
                                                                                + 8
                                                                                + *(ushort *)(v14 + 14)
                                                                                + 4)),
                v15) )
          {
            v16 = v14 + *v15;
          }
          else
          {
            v16 = 0;
          }
          if ( Function_21efac0(*(uint *)(v2 + 184)) == 1 )
            Function_21d53a4(v16);
        }
        v17 = *(void (__fastcall **)(uint))(v2 + 252);
        if ( v17 )
        {
          v18 = *(uint *)(v3 + 4 * (*(uchar *)(v3 + 34) - 1));
          v19 = *(uint *)(v18 + 2144);
          if ( v19 >= 0 && v19 < *(uint *)(v2 + 196) * *(uint *)(v2 + 192) )
          {
            v20 = *(uint *)(v18 + 2152);
            v17(*(uint *)(v2 + 256));
          }
        }
      }
      break;
    case 3:
      if ( Function_21e80bc((uint *)(v3 + 16)) == 1 )
        *(uchar *)(v2 + 160) = 0;
      break;
    default:
      break;
  }
  if ( *(uchar *)(v2 + 160) )
  {
    result = Function_21e8dac(v2);
    if ( result == 1 )
    {
      *(uint *)(v2 + 48 * *(uchar *)(v2 + 162) + 44) = 0;
      Function_21e8dbc(v2);
      --*(uchar *)(v2 + 160);
      *(uchar *)(v2 + 162) = (*(uchar *)(v2 + 162) + 1 < 0)
                           + __ROR4__(
                               ((*(uchar *)(v2 + 162) + 1) << 31)
                             - (((uint)*(uchar *)(v2 + 162) + 1) >> 31),
                               31);
      if ( *(uchar *)(v2 + 160) )
      {
        v21 = 0;
      }
      else
      {
        *(uchar *)(v2 + 162) = 0;
        *(uchar *)(v2 + 161) = 0;
        v21 = 2;
      }
      *(uint *)(v2 + 180) = v21;
      result = *(uint *)(v2 + 108);
      if ( result == 1 )
      {
        *(uint *)(v2 + 108) = 0;
        Function_21e8dd4(*(uchar *)(v2 + 112), (uint *)v2);
        result = Function_21e8d50(v2);
      }
    }
  }
  else
  {
    *(uchar *)(v2 + 162) = 0;
    *(uchar *)(v2 + 161) = 0;
    result = 2;
    *(uint *)(v2 + 180) = 2;
  }
  return result;
}

//----- (021EA540) --------------------------------------------------------
int __fastcall Function_5_21ea540(uint *a1, uchar *a2, int a3)
{
  uint *v3;
  int v4;
  int result;

  v3 = a1;
  a1[46] = a3;
  v4 = (int)a2;
  a1[47] = a2;
  a1[48] = Function_2039e10(a2);
  v3[49] = Function_2039e20(v4);
  v3[50] = 32 * v3[48];
  Function_21e8f60(v3);
  v3[44] = 0;
  result = 2;
  v3[45] = 2;
  return result;
}

//----- (021EA58C) --------------------------------------------------------
int __fastcall Function_5_21ea58c(int *a1, int a2, int a3, int *a4)
{
  int *v4;
  int v5;
  int result;

  v4 = a1;
  Function_21e7838(a1[65], a2, a3, a1[67], a1[69], a1[48], a1[49], a1[50], a4);
  v5 = 0;
  do
  {
    result = v4[36];
    ++v5;
    ++v4;
    *(uint *)(result + 2148) = 0;
  }
  while ( v5 < 4 );
  return result;
}

//----- (021EA5E0) --------------------------------------------------------
int __fastcall Function_5_21ea5e0(int *a1, int a2, int a3)
{
  int *v3;
  uchar v4;
  int v5;
  int v6;
  int v7;
  int v8;

  v3 = a1;
  v4 = a2;
  v5 = (int)(a1 + 36);
  v6 = 4 * a2;
  *(uint *)(a1[a2 + 36] + 2148) = 0;
  v7 = a3;
  Function_21eeb84((uchar)a2, *a1, a1[a2 + 36] + 2132);
  Function_21eeb90(v4, *v3, *(uint *)(v5 + v6) + 2136);
  *(uint *)(*(uint *)(v5 + v6) + 2144) = -1;
  MIi_CpuClearFast(-1, *(uint **)(v5 + v6), 0x800u);
  Function_21ef248(*(uint *)(*(uint *)(v5 + v6) + 2140));
  v8 = Function_21efac0(v3[46]);
  return Function_21e7e28(v7, v4, v3[46], (uchar *)v3[47], v3[48], v3[49], v8, v3);
}

//----- (021EA678) --------------------------------------------------------
uint *__fastcall Function_5_21ea678(uint *result, int a2, int a3, int a4)
{
  result[67] = a2;
  result[68] = a3;
  result[69] = a4;
  result[70] = a2 << 16;
  result[71] = a3 << 16;
  result[72] = a4 << 16;
  return result;
}

//----- (021EA6A4) --------------------------------------------------------
int __fastcall Function_5_21ea6a4(int result, int a2)
{
  *(uint *)(result + 260) = a2;
  return result;
}

//----- (021EA6AC) --------------------------------------------------------
int __fastcall Function_5_21ea6ac(int a1)
{
  return *(uint *)(a1 + 268);
}

//----- (021EA6B4) --------------------------------------------------------
int __fastcall Function_5_21ea6b4(int a1)
{
  return *(uint *)(a1 + 276);
}

//----- (021EA6BC) --------------------------------------------------------
int __fastcall Function_5_21ea6bc(uint *a1, uint *a2)
{
  uint *v2;
  uint *v3;
  int v4;
  int result;

  v2 = a2;
  v4 = a1[71];
  v3 = a1 + 72;
  *v2 = a1[70];
  v2[1] = v4;
  result = a1[72];
  v2[2] = *v3;
  return result;
}

//----- (021EA6D0) --------------------------------------------------------
int __fastcall Function_5_21ea6d0(int result, int a2)
{
  *(uint *)(result + 264) = a2;
  return result;
}

//----- (021EA6D8) --------------------------------------------------------
uint *__fastcall Function_5_21ea6d8(int a1, int a2)
{
  uint *result;

  result = (uint *)(a1 + 188);
  *result = a2;
  return result;
}

//----- (021EA6E0) --------------------------------------------------------
int __fastcall Function_5_21ea6e0(int a1, int a2, int a3)
{
  int v3;
  int result;

  v3 = *(uint *)(a1 + 4 * a2 + 144);
  result = 2148;
  *(uint *)(v3 + 2148) = a3;
  return result;
}

//----- (021EA6F4) --------------------------------------------------------
uint __fastcall Function_5_21ea6f4(int a1, int a2, int a3)
{
  return Function_21e8f90(a2, a3, *(uint *)(a1 + 268), *(uint *)(a1 + 276), a1);
}

//----- (021EA714) --------------------------------------------------------
int __fastcall Function_5_21ea714(int a1)
{
  int result;

  result = *(uint *)(a1 + 4);
  if ( result )
  {
    result = *(uint *)(result + 20);
    if ( result )
      result = ((int (*)(void))dword_2253D7C[0])();
  }
  return result;
}

//----- (021EA728) --------------------------------------------------------
int __fastcall Function_21ea728(uint *a1)
{
  uint *v1;
  uchar *v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int result;

  v1 = a1;
  v2 = (uchar *)LoadVariableAreaAdress_5(a1[3]);
  v3 = LoadFlagAdress(v1[3]);
  if ( !Function_20567e0(v2) || Function_206ae2c(v3) )
  {
    LoadOverlay(24, 2, v4, v5);
    result = ((int (__fastcall *)(uint))dword_2253CE0[0])(v1[2]);
  }
  else
  {
    LoadOverlay(25, 2, v4, v5);
    v6 = Function_200a914(1);
    result = ((int (__fastcall *)(uint *, int, uint, uint, int))dword_2253CE8[0])(
               v1,
               v1[1] + 20,
               v1[3],
               v1[2],
               v6);
  }
  return result;
}

//----- (021EA790) --------------------------------------------------------
int __fastcall Function_21ea790(uint *a1)
{
  uint *v1;
  uchar *v2;
  int v3;
  int result;

  v1 = a1;
  v2 = (uchar *)LoadVariableAreaAdress_5(a1[3]);
  v3 = LoadFlagAdress(v1[3]);
  if ( !Function_20567e0(v2) || Function_206ae2c(v3) )
    result = ((int (__fastcall *)(uint))byte_2253DA4)(v1[2]);
  else
    result = ((int (__fastcall *)(uint))dword_2253D5C[0])(*(uint *)(v1[1] + 20));
  return result;
}

//----- (021EA7CC) --------------------------------------------------------
int __fastcall Function_21ea7cc(uint *a1)
{
  uint *v1;
  uchar *v2;
  int v3;
  int v4;
  int v5;
  int v7;
  int v8;
  int v9;

  v1 = a1;
  v2 = (uchar *)LoadVariableAreaAdress_5(a1[3]);
  v3 = LoadFlagAdress(v1[3]);
  if ( !Function_20567e0(v2) || Function_206ae2c(v3) )
  {
    if ( ((int (__fastcall *)(uint))dword_2253DB4[0])(v1[2]) )
    {
      UnloadOverlay(24, v7, v8, v9);
      return 1;
    }
  }
  else if ( ((int (__fastcall *)(uint))dword_2253D70[0])(*(uint *)(v1[1] + 20)) )
  {
    *(uint *)(v1[1] + 20) = 0;
    UnloadOverlay(25, 0, v4, v5);
    return 1;
  }
  return 0;
}

//----- (021EA830) --------------------------------------------------------
int __fastcall Function_21ea830(int a1, int a2, int a3, int a4)
{
  int v4;

  v4 = a1;
  LoadOverlay(24, 2, a3, a4);
  return ((int (__fastcall *)(uint))dword_2253CE0[0])(*(uint *)(v4 + 8));
}

//----- (021EA854) --------------------------------------------------------
int __fastcall Function_21ea854(int a1)
{
  int v1;
  int v2;
  int v3;

  if ( !((int (__fastcall *)(uint))dword_2253DB4[0])(*(uint *)(a1 + 8)) )
    return 0;
  UnloadOverlay(24, v1, v2, v3);
  return 1;
}

//----- (021EA874) --------------------------------------------------------
int __fastcall Function_21ea874(uint *a1)
{
  uint *v1;
  int v2;
  ushort *v4;
  uchar v5;

  v1 = a1;
  v2 = LoadVariableAreaAdress_1d(a1[13]);
  Function_202aed8(v2, 0);
  if ( !Function_20391dc(v1[13], v1 + 19, 4u) )
    return 1;
  v1[35] = 0;
  v4 = (ushort *)LoadPlayerDataAdress(v1[13]);
  v5 = Function_2027b50(v4);
  Function_200dd0c(*(uint **)(v1[12] + 8), 3u, 482, 10, v5, 4);
  Function_200daa4(*(uint **)(v1[12] + 8), 3u, 985, 11, 0, 4);
  v1[18] = 1;
  return 0;
}

//----- (021EA8F0) --------------------------------------------------------
int __fastcall Function_21ea8f0(int *a1)
{
  int *v1;
  int v2;
  int *v3;
  int result;
  int v5;
  int v6;
  int v7;

  v1 = a1;
  a1[35] = -1;
  v2 = 0;
  if ( Function_2035e18() > 0 )
  {
    v3 = v1;
    while ( v3[19] != 2 )
    {
      ++v3;
      if ( ++v2 >= Function_2035e18() )
        goto LABEL_6;
    }
    v1[35] = v2;
    v1[v2 + 19] = 0;
  }
LABEL_6:
  if ( v1[35] == -1 )
    return 1;
  v5 = LoadVariableAreaAdressItemList(v1[13]);
  if ( CheckItem(v5, 0x1B5u, 1u, 4u) == 1 )
  {
    Function_2032ee8(v1[35]);
    Function_200b498(v1[14], 0);
    Function_21eae78(v1, 57);
    v1[18] = 2;
    result = 0;
  }
  else
  {
    v6 = LoadVariableAreaAdress_1d(v1[13]);
    v7 = 0;
    while ( Function_202af78(v6, v7) )
    {
      if ( ++v7 >= 32 )
        goto LABEL_14;
    }
    Function_2039298(v1[13], v1[35], v7, 4u, 0);
LABEL_14:
    v1[18] = 1;
    result = 0;
  }
  return result;
}

//----- (021EA9BC) --------------------------------------------------------
int __fastcall Function_21ea9bc(uint *a1)
{
  uint *v1;

  v1 = a1;
  if ( !Function_201d724(a1[16] & 0xFF) )
  {
    v1[17] = Function_2002100(*(uint **)(v1[12] + 8), (uchar *)dword_21FAF00, 985, 11, 4u);
    v1[18] = 3;
  }
  return 0;
}

//----- (021EA9F8) --------------------------------------------------------
int __fastcall Function_21ea9f8(int *a1)
{
  int *v1;
  int v2;
  int result;
  int v4;
  int v5;

  v1 = a1;
  v2 = Function_2002114(a1[17], 4u);
  if ( v2 == -1 )
    return 0;
  if ( v2 )
    goto LABEL_13;
  v4 = LoadVariableAreaAdress_1d(v1[13]);
  v5 = 0;
  while ( Function_202af78(v4, v5) )
  {
    if ( ++v5 >= 32 )
      goto LABEL_8;
  }
  Function_2039298(v1[13], v1[35], v5, 4u, 0);
LABEL_8:
  if ( v5 != 32 )
  {
LABEL_13:
    v1[18] = 1;
    result = 0;
  }
  else
  {
    Function_21eae78(v1, 58);
    v1[18] = 4;
    result = 0;
  }
  return result;
}

//----- (021EAA6C) --------------------------------------------------------
int __fastcall Function_21eaa6c(uint *a1)
{
  uint *v1;

  v1 = a1;
  if ( !Function_201d724(a1[16] & 0xFF) )
  {
    v1[17] = Function_2002100(*(uint **)(v1[12] + 8), (uchar *)dword_21FAF00, 985, 11, 4u);
    v1[18] = 5;
  }
  return 0;
}

//----- (021EAAA8) --------------------------------------------------------
int __fastcall Function_21eaaa8(int *a1)
{
  int *v1;
  int v2;
  int v4;

  v1 = a1;
  v2 = Function_2002114(a1[17], 4u);
  if ( v2 == -1 )
    return 0;
  if ( v2 )
  {
    Function_2032ee8(v1[35]);
    Function_200b498(v1[14], 0);
    Function_21eae78(v1, 59);
    v4 = 6;
  }
  else
  {
    v4 = 8;
  }
  v1[18] = v4;
  return 0;
}

//----- (021EAAEC) --------------------------------------------------------
int __fastcall Function_21eaaec(uint *a1)
{
  uint *v1;

  v1 = a1;
  if ( !Function_201d724(a1[16] & 0xFF) )
  {
    v1[17] = Function_2002100(*(uint **)(v1[12] + 8), (uchar *)dword_21FAF00, 985, 11, 4u);
    v1[18] = 7;
  }
  return 0;
}

//----- (021EAB28) --------------------------------------------------------
int __fastcall Function_21eab28(int a1)
{
  int v1;
  int v2;
  int v4;

  v1 = a1;
  v2 = Function_2002114(*(uint *)(a1 + 68), 4u);
  if ( v2 == -1 )
    return 0;
  if ( v2 )
  {
    Function_21eae78(v1, 58);
    v4 = 4;
  }
  else
  {
    v4 = 12;
  }
  *(uint *)(v1 + 72) = v4;
  return 0;
}

//----- (021EAB58) --------------------------------------------------------
int __fastcall Function_21eab58(int a1)
{
  uint **v1;
  int v2;
  int v3;
  int v4;
  short v5;
  int v6;
  ushort *v7;
  int v8;
  int v9;
  int v11;
  int (*v12)();
  int v13;
  uint **v14;
  short v15;
  short v16;
  int v17;
  int v18;
  uint **v19;

  v1 = (uint **)a1;
  v2 = LoadVariableAreaAdress_1d(*(uint *)(a1 + 52));
  v3 = v2;
  v4 = Function_202af94(v2);
  v5 = v4;
  *v1 = Function_2013a04(v4 + 1, 4u);
  Function_201a7e8((uint *)v1[12][2], (int)(v1 + 8), 3, 19, 1, 0xCu, 0xAu, 13, 427);
  Function_200dc48((int)(v1 + 8), 1, 985, 0xBu);
  v6 = 0;
  do
  {
    if ( Function_202af78(v3, v6) )
    {
      v7 = (ushort *)Function_202aef0(v3, v6);
      Function_2023d28((ushort *)v1[2], v7);
      Function_2013a6c(*v1, (int)v1[2], v6, v8);
    }
    ++v6;
  }
  while ( v6 < 32 );
  Function_2013a4c(*v1, (ushort **)v1[15], 0xBu, -2);
  v11 = 0;
  v12 = 0;
  v13 = 0;
  v14 = 0;
  v17 = 268437504;
  v18 = 8388655;
  v19 = 0;
  v15 = v5 + 1;
  v16 = 5;
  v11 = (int)*v1;
  v14 = v1 + 8;
  v19 = v1;
  v12 = Function_21eaf90;
  v1[1] = (uint *)Function_200112c(&v11, 0, 0, 4u);
  Function_201a954((int)(v1 + 8), v9);
  v1[18] = (uint *)9;
  return 0;
}

//----- (021EAC44) --------------------------------------------------------
int __fastcall Function_21eac44(int a1)
{
  int v1;
  int v2;
  int v4;
  int *v5;
  ushort *v6;

  v1 = a1;
  v2 = Function_2001288(*(uint *)(a1 + 4));
  if ( v2 == -2 )
  {
    Function_2005748(0x5DCu);
    Function_2032ee8(*(uint *)(v1 + 140));
    Function_200b498(*(uint *)(v1 + 56), 0);
    Function_21eae78(v1, 59);
    *(uint *)(v1 + 72) = 6;
  }
  else
  {
    if ( v2 == -1 )
      return 0;
    Function_2005748(0x5DCu);
    *(uint *)(v1 + 144) = v2;
    v4 = LoadVariableAreaAdress_1d(*(uint *)(v1 + 52));
    v5 = AllocTrainerData(4u);
    v6 = (ushort *)Function_202aef0(v4, v2);
    Function_2025ec0(v5, v6);
    Function_200b498(*(uint *)(v1 + 56), 0);
    free((int)v5);
    Function_21eae78(v1, 60);
    *(uint *)(v1 + 72) = 10;
  }
  Function_200dc9c(v1 + 32, 0);
  Function_201a8fc(v1 + 32);
  Function_2001384(*(uint *)(v1 + 4), 0, 0);
  Function_2013a3c(*(int **)v1);
  return 0;
}

//----- (021EACFC) --------------------------------------------------------
int __fastcall Function_21eacfc(uint *a1)
{
  uint *v1;

  v1 = a1;
  if ( !Function_201d724(a1[16] & 0xFF) )
  {
    v1[17] = Function_2002100(*(uint **)(v1[12] + 8), (uchar *)dword_21FAF00, 985, 11, 4u);
    v1[18] = 11;
  }
  return 0;
}

//----- (021EAD38) --------------------------------------------------------
int __fastcall Function_21ead38(int *a1)
{
  int *v1;
  int v2;
  int v3;
  int v5;
  int v6;
  uint v7;
  int v8;
  uint v9;
  int v10;

  v1 = a1;
  v2 = LoadVariableAreaAdress_1d(a1[13]);
  v3 = Function_2002114(v1[17], 4u);
  if ( v3 == -1 )
    return 0;
  if ( v3 )
  {
    Function_2032ee8(v1[35]);
    Function_200b498(v1[14], 0);
    Function_21eae78(v1, 59);
    v10 = 6;
  }
  else
  {
    v5 = LoadVariableAreaAdress_17(v1[13]);
    Function_2030788(v5, v1[36], v6, v7);
    Function_202afd4(v2, v1[36], v8, v9);
    Function_2039298(v1[13], v1[35], 31, 4u, 0);
    v10 = 1;
  }
  v1[18] = v10;
  return 0;
}

//----- (021EADB4) --------------------------------------------------------
int __fastcall Function_21eadb4(int a1)
{
  int v1;
  int *v2;
  int result;

  v1 = a1;
  v2 = (int *)GetUnknownStruct01_c(a1);
  LoadOverWorldDataAdress(v1);
  switch ( (uchar)v2[18] )
  {
    case 0u:
      if ( Function_21ea874(v2) )
        v2[18] = 12;
      goto LABEL_17;
    case 1u:
      if ( Function_21ea8f0(v2) )
        v2[18] = 12;
      goto LABEL_17;
    case 2u:
      Function_21ea9bc(v2);
      goto LABEL_17;
    case 3u:
      Function_21ea9f8(v2);
      goto LABEL_17;
    case 4u:
      Function_21eaa6c(v2);
      goto LABEL_17;
    case 5u:
      Function_21eaaa8(v2);
      goto LABEL_17;
    case 6u:
      Function_21eaaec(v2);
      goto LABEL_17;
    case 7u:
      Function_21eab28((int)v2);
      goto LABEL_17;
    case 8u:
      Function_21eab58((int)v2);
      goto LABEL_17;
    case 9u:
      Function_21eac44((int)v2);
      goto LABEL_17;
    case 0xAu:
      Function_21eacfc(v2);
      goto LABEL_17;
    case 0xBu:
      Function_21ead38(v2);
      goto LABEL_17;
    case 0xCu:
      Function_21eaf1c(v2);
      free((int)v2);
      Function_203d140();
      result = 1;
      break;
    default:
LABEL_17:
      result = 0;
      break;
  }
  return result;
}

//----- (021EAE78) --------------------------------------------------------
int __fastcall Function_21eae78(int a1, uint a2)
{
  int v2;
  uint v3;
  ushort *v4;
  ushort *v5;
  int result;

  v2 = a1;
  v3 = a2;
  if ( Function_201a7cc(a1 + 16) )
    Function_201a8fc(v2 + 16);
  Function_200b1b8_CallMsgDecrypt(*(ushort ***)(v2 + 60), v3, *(ushort **)(v2 + 8));
  Function_200c388(*(uint **)(v2 + 56), *(uint *)(v2 + 12), *(uint *)(v2 + 8));
  Function_205d8f4(*(uint **)(*(uint *)(v2 + 48) + 8), v2 + 16, 3);
  v4 = (ushort *)LoadPlayerDataAdress(*(uint *)(*(uint *)(v2 + 48) + 12));
  Function_205d944(v2 + 16, v4);
  v5 = (ushort *)LoadPlayerDataAdress(*(uint *)(*(uint *)(v2 + 48) + 12));
  result = Function_205d994(v2 + 16, *(uint *)(v2 + 12), v5, 1);
  *(uint *)(v2 + 64) = result;
  return result;
}

//----- (021EAEE0) --------------------------------------------------------
int __fastcall Function_21eaee0(ushort *a1)
{
  uint *v1;
  int result;

  v1 = a1;
  MI_CpuFill8(a1, 0, 0x94u);
  v1[14] = Function_200b358(4u);
  v1[15] = LoadFromMsgNARC(0, 26, 675, 4u);
  v1[3] = Function_2023790(110, 4u);
  result = Function_2023790(110, 4u);
  v1[2] = result;
  return result;
}

//----- (021EAF1C) --------------------------------------------------------
uint __fastcall Function_21eaf1c(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  uint result;

  v1 = a1;
  Function_200b190(*(ushort **)(a1 + 60));
  Function_200b3f0(*(uint **)(v1 + 56), v2);
  Function_20237bc_FreeMsg(*(uint *)(v1 + 12), v3);
  Function_20237bc_FreeMsg(*(uint *)(v1 + 8), v4);
  result = Function_201a7cc(v1 + 16);
  if ( result )
    result = Function_201a8fc(v1 + 16);
  return result;
}

//----- (021EAF50) --------------------------------------------------------
uint *__fastcall Function_5_21eaf50(int a1)
{
  int v1;
  int v2;
  int v3;
  uint *result;

  v1 = a1;
  v2 = *(uint *)(a1 + 16);
  v3 = malloc2(0xBu, 148);
  Function_21eaee0((ushort *)v3);
  *(uint *)(v3 + 48) = v1;
  *(uint *)(v3 + 52) = *(uint *)(v1 + 12);
  *(uint *)(v3 + 72) = 0;
  if ( v2 )
    result = Function_2050944(v2, (int)Function_21eadb4, v3);
  else
    result = OverWorldData_InitUnknownStruct01(v1, (int)Function_21eadb4, v3);
  return result;
}

//----- (021EAF90) --------------------------------------------------------
int __fastcall Function_21eaf90(int a1, int a2, int a3)
{
  int result;

  if ( !a3 )
    result = Function_2005748(0x5DCu);
  return result;
}

//----- (021EAFA4) --------------------------------------------------------
int __fastcall Function_5_21eafa4(uint *a1, uint a2, uint a3, int *a4)
{
  int *v4;
  uint *v5;
  uint v6;
  uint v7;
  int v8;
  int v9;
  int v10;
  uint v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int result;
  int v18;
  int v19;
  int v20;
  int v21;
  int v22;
  int v23[3];
  char v24;
  int v25;
  int v26;
  int v27;
  int v28;

  v4 = a4;
  v5 = a1;
  v6 = a2;
  v25 = 0;
  v7 = a3;
  Function_2020aac(&v27, a4[20]);
  v20 = 0;
  v21 = 0;
  v22 = -4096;
  if ( v7 >= 0x60 )
    v8 = -(ushort)s32_div_f(((v7 - 96) & 0xFF) * *(ushort *)v4, 96);
  else
    LOWORD(v8) = s32_div_f(((96 - v7) & 0xFF) * *(ushort *)v4, 96);
  v9 = (ushort)v8;
  if ( v6 >= 0x80 )
  {
    v12 = *((ushort *)v4 + 1) * ((v6 - 128) & 0xFF);
    v11 = -65536 * ((v12 + ((uint)(v12 >> 6) >> 25)) << 9 >> 16);
  }
  else
  {
    v10 = ((128 - v6) & 0xFF) * *((ushort *)v4 + 1);
    v11 = (v10 + ((uint)(v10 >> 6) >> 25)) << 9;
  }
  v13 = v11 >> 16;
  Function_20bbc30(&v24, SLOWORD(Unknown_20f983c[v9 >> 4]), *((short *)Unknown_20f983c + 2 * (v9 >> 4) + 1));
  MTX_MultVec43(&v20, (int *)&v24, v23);
  sub_20BBC50(&v24, SLOWORD(Unknown_20f983c[v13 >> 4]), *((short *)Unknown_20f983c + 2 * (v13 >> 4) + 1));
  MTX_MultVec43(v23, (int *)&v24, v23);
  MTX_MultVec43(v23, v4 + 8, v23);
  v14 = VEC_DotProduct(v4 + 4, v23);
  v15 = FX_Div(v4[7], v14);
  Function_20bd628(-v15, v23, v4 + 1, &v18);
  v26 = v28 + v19;
  v16 = v25;
  *v5 = v27 + v18;
  v5[1] = v16;
  result = v26;
  v5[2] = v26;
  return result;
}

//----- (021EB0C8) --------------------------------------------------------
int Function_5_21eb0c8()
{
  int v0;

  v0 = malloc(4u, 96);
  Function_21eb0e0();
  return v0;
}

//----- (021EB0E0) --------------------------------------------------------
int __fastcall Function_21eb0e0(ushort *a1, ushort *a2)
{
  ushort *v2;
  int v3;
  int v4;
  int v5;
  int v6;
  uint *v7;
  int result;
  ushort v9;
  char v10;
  char v11;
  int v12;
  int v13;
  int v14;

  v2 = a1;
  v3 = (int)a2;
  Function_2020a94(&v9, a2);
  *v2 = Function_2020a88(v3);
  v4 = FX_Div(
         SLOWORD(Unknown_20f983c[(int)*v2 >> 4]),
         *((short *)Unknown_20f983c + 2 * ((int)*v2 >> 4) + 1));
  v5 = s32_div_f(4 * v4, 3);
  v2[1] = Function_20bd964(v5);
  v12 = 0;
  v13 = 4096;
  v14 = 0;
  Function_2020abc(&v11, v3);
  Function_2020aac(&v10, v3);
  VEC_Subtract(&v11, &v10, (uint *)v2 + 1);
  v6 = v13;
  v7 = v2 + 8;
  *v7 = v12;
  v7[1] = v6;
  *((uint *)v2 + 6) = v14;
  *((uint *)v2 + 7) = VEC_DotProduct(&v12, (int *)v2 + 1);
  result = Function_20bbc30(
             v2 + 16,
             SLOWORD(Unknown_20f983c[(int)v9 >> 4]),
             *((short *)Unknown_20f983c + 2 * ((int)v9 >> 4) + 1));
  *((uint *)v2 + 20) = v3;
  return result;
}

//----- (021EB184) --------------------------------------------------------
int __fastcall Function_5_21eb184(int *a1)
{
  int *v1;
  int result;

  v1 = a1;
  result = *a1;
  if ( result )
  {
    if ( !result )
      ErrorHandler();
    free(*v1);
    result = 0;
    *v1 = 0;
  }
  return result;
}

//----- (021EB1A0) --------------------------------------------------------
int __fastcall Function_5_21eb1a0(int a1)
{
  int v1;
  int v2;
  int result;

  v1 = a1;
  v2 = GetSpriteGraphic(a1);
  if ( v2 > 263 )
  {
    if ( v2 > 271 )
    {
      if ( v2 <= 273 )
      {
        if ( v2 < 273 && v2 != 272 )
          goto LABEL_49;
        return *(uint *)(Function_2062af0(v1) + 4);
      }
      if ( v2 > 274 )
      {
        if ( v2 == 275 )
          return *(uint *)(Function_2062af0(v1) + 4);
      }
      else if ( v2 == 274 )
      {
        return *(uint *)(Function_2062af0(v1) + 4);
      }
    }
    else
    {
      if ( v2 >= 271 )
        return *(uint *)(Function_2062af0(v1) + 4);
      if ( v2 <= 268 )
      {
        if ( v2 < 268 )
        {
          if ( v2 == 264 )
            return *(uint *)(Function_2062af0(v1) + 4);
          goto LABEL_49;
        }
        return *(uint *)(Function_2062af0(v1) + 4);
      }
      if ( v2 > 269 )
      {
        if ( v2 == 270 )
          return *(uint *)(Function_2062af0(v1) + 4);
      }
      else if ( v2 == 269 )
      {
        return *(uint *)(Function_2062af0(v1) + 4);
      }
    }
  }
  else
  {
    if ( v2 >= 263 )
      return *(uint *)(Function_2062af0(v1) + 4);
    if ( v2 <= 152 )
    {
      if ( v2 < 152 )
      {
        if ( v2 <= 21 )
        {
          if ( v2 < 21 && v2 )
            goto LABEL_49;
          return *(uint *)(Function_2062af0(v1) + 4);
        }
        if ( v2 <= 100 )
        {
          if ( v2 >= 97 )
          {
            if ( v2 == 97 || v2 == 98 )
              return *(uint *)(Function_2062af0(v1) + 4);
            if ( v2 == 100 )
              return 0;
          }
          goto LABEL_49;
        }
        if ( v2 != 151 )
          goto LABEL_49;
      }
      return Function_21ecb80(v1);
    }
    if ( v2 > 176 )
    {
      if ( v2 > 177 )
      {
        switch ( (uchar)v2 + 78 )
        {
          case 0:
          case 1:
          case 2:
          case 3:
          case 8:
          case 9:
          case 10:
          case 11:
          case 18:
          case 19:
          case 20:
          case 21:
          case 22:
          case 23:
          case 32:
          case 33:
          case 34:
            return *(uint *)(Function_2062af0(v1) + 4);
          case 17:
            return *(uint *)(Function_2062af0(v1) + 4);
          default:
            goto LABEL_49;
        }
        goto LABEL_49;
      }
      if ( v2 == 177 )
        return *(uint *)(Function_2062af0(v1) + 4);
    }
    else
    {
      if ( v2 >= 176 )
        return *(uint *)(Function_2062af0(v1) + 4);
      if ( v2 == 153 )
        return Function_21ecb80(v1);
    }
  }
LABEL_49:
  if ( (*(uint *)(Function_5_21ecd04(v1) + 4) & 0xF) == 1 )
    result = *(uint *)(Function_2062af0(v1) + 4);
  else
    result = 0;
  return result;
}

//----- (021EB2EC) --------------------------------------------------------
int __fastcall Function_21eb2ec(int a1)
{
  int v1;
  int *v2;
  int *v3;
  int result;

  v1 = a1;
  v2 = Function_2062acc(a1, 16);
  v3 = v2;
  *((uchar *)v2 + 2) = -1;
  Function_21ecf04(v1, v2 + 1);
  result = v3[1];
  if ( result )
    result = Function_2062b68(v1);
  return result;
}

//----- (021EB314) --------------------------------------------------------
int __fastcall Function_21eb314(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  v2 = Function_2062af0(a1);
  return Function_21ecfa4(v1, v2 + 4);
}

//----- (021EB328) --------------------------------------------------------
uint *__fastcall Function_21eb328(int a1)
{
  uint *v1;
  int v2;

  v1 = (uint *)a1;
  v2 = Function_2062af0(a1);
  if ( *(uint *)(v2 + 4) )
    Function_5_21ed01c();
  Function_21ecfa4(v1, v2 + 4);
  return SetSpriteFlags(v1, 0x200000);
}

//----- (021EB354) --------------------------------------------------------
uint *__fastcall Function_21eb354(int a1)
{
  uint *v1;
  int v2;
  uint *result;

  v1 = (uint *)a1;
  v2 = Function_2062af0(a1);
  result = (uint *)Function_5_21edd94(v1);
  if ( result != (uint *)1 )
  {
    if ( !*(uint *)(v2 + 4) )
      Function_21ecf04(v1, v2 + 4);
    result = *(uint **)(v2 + 4);
    if ( result )
    {
      Function_5_21ed03c();
      Function_5_21edeb4(v1, *(uint *)(v2 + 4));
      result = UnsetSpriteFlags(v1, 0x200000);
    }
  }
  return result;
}

//----- (021EB398) --------------------------------------------------------
int __fastcall Function_21eb398(int a1)
{
  int v1;
  int v2;
  int result;
  int v4;
  int v5;
  int v6;

  v1 = a1;
  v2 = *(uint *)(Function_2062af0(a1) + 4);
  v5 = Function_2062af0(v1);
  result = Function_5_21edd94(v1);
  if ( result != 1 && v2 )
  {
    v6 = LoadSpriteFaceDirection(v1);
    v4 = GetSpritea0(v1);
    if ( v4 >= 9 )
      ErrorHandler();
    (*((void (__fastcall **)(int, int, int, int))&loc_21FF3D4 + v4))(v1, v2, v5, v6);
    *(uchar *)(v5 + 2) = v6;
    *(uchar *)(v5 + 3) = GetSpritea0(v1);
    Function_5_21edeb4(v1, v2);
    result = Function_21ec6c0(v1, v2);
  }
  return result;
}

//----- (021EB40C) --------------------------------------------------------
int __fastcall Function_21eb40c(int a1)
{
  int v1;
  int v2;
  int result;
  int v4;

  v1 = a1;
  v2 = Function_2062af0(a1);
  result = Function_5_21edd94(v1);
  if ( result != 1 )
  {
    v4 = *(uint *)(v2 + 4);
    if ( v4 )
    {
      Function_5_21edeb4(v1, v4);
      result = Function_21ec6c0(v1, v4);
    }
  }
  return result;
}

//----- (021EB438) --------------------------------------------------------
int __fastcall Function_21eb438(int a1)
{
  int v1;
  int v2;
  int result;
  int v4;

  v1 = a1;
  v2 = Function_2062af0(a1);
  result = Function_5_21edd94(v1);
  if ( result != 1 )
  {
    v4 = *(uint *)(v2 + 4);
    if ( v4 )
    {
      if ( !Function_5_21ecd38(v1) )
        Function_2021368(v4, 4096);
      Function_5_21edeb4(v1, v4);
      result = Function_21ec6c0(v1, v4);
    }
  }
  return result;
}

//----- (021EB478) --------------------------------------------------------
int __fastcall Function_21eb478(int a1, uint a2, int a3, int a4)
{
  uint v4;
  short v5;

  v4 = a2;
  if ( a4 == *(char *)(a3 + 2) )
  {
    Function_21ec668(a2);
  }
  else
  {
    v5 = Function_21edf18(a4);
    Function_2021344(v4, v5);
    Function_20213a4(v4, 0);
  }
  return Function_2021368(v4, 0);
}

//----- (021EB4AC) --------------------------------------------------------
int __fastcall Function_21eb4ac(int a1, uint a2, int a3, int a4)
{
  int v4;
  uint v5;
  short v6;
  int result;

  v4 = a1;
  v5 = a2;
  if ( a4 != *(char *)(a3 + 2) )
  {
    v6 = Function_21edf18(a4);
    Function_2021344(v5, v6);
    Function_20213a4(v5, 0);
  }
  result = Function_5_21ecd38(v4);
  if ( !result )
    result = Function_2021368(v5, 2048);
  return result;
}

//----- (021EB4E8) --------------------------------------------------------
int __fastcall Function_21eb4e8(int a1, uint a2, int a3, int a4)
{
  int v4;
  uint v5;
  short v6;
  int result;

  v4 = a1;
  v5 = a2;
  if ( a4 != *(char *)(a3 + 2) )
  {
    v6 = Function_21edf18(a4);
    Function_2021344(v5, v6);
    Function_20213a4(v5, 0);
  }
  result = Function_5_21ecd38(v4);
  if ( !result )
    result = Function_2021368(v5, 4096);
  return result;
}

//----- (021EB524) --------------------------------------------------------
int __fastcall Function_21eb524(int a1, uint a2, int a3, int a4)
{
  int v4;
  uint v5;
  short v6;
  int result;

  v4 = a1;
  v5 = a2;
  if ( a4 != *(char *)(a3 + 2) )
  {
    v6 = Function_21edf18(a4);
    Function_2021344(v5, v6);
    Function_20213a4(v5, 0);
  }
  result = Function_5_21ecd38(v4);
  if ( !result )
    result = Function_2021368(v5, 0x2000);
  return result;
}

//----- (021EB560) --------------------------------------------------------
int __fastcall Function_21eb560(int a1, uint a2, int a3, int a4)
{
  int v4;
  uint v5;
  short v6;
  int result;

  v4 = a1;
  v5 = a2;
  if ( a4 != *(char *)(a3 + 2) )
  {
    v6 = Function_21edf18(a4);
    Function_2021344(v5, v6);
    Function_20213a4(v5, 0);
  }
  result = Function_5_21ecd38(v4);
  if ( !result )
    result = Function_2021368(v5, 0x4000);
  return result;
}

//----- (021EB59C) --------------------------------------------------------
int __fastcall Function_21eb59c(int a1, uint a2, short *a3, int a4)
{
  int v4;
  short *v5;
  uint v6;
  short v7;
  int result;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;

  v16 = a4;
  v4 = a1;
  v5 = a3;
  v6 = a2;
  if ( a4 != *((char *)a3 + 2) )
  {
    v7 = Function_21edf18(a4);
    Function_2021344(v6, v7);
    Function_20213a4(v6, 0);
    *v5 = 0;
  }
  if ( *((uchar *)v5 + 3) != 6 )
    *v5 = 0;
  result = Function_5_21ecd38(v4);
  if ( !result )
  {
    v9 = 4096;
    v10 = 4096;
    v11 = 0x2000;
    v12 = 4096;
    v13 = 4096;
    v14 = 0x2000;
    v15 = 0;
    Function_2021368(v6, *(&v9 + *v5));
    result = 0;
    if ( !*(&v9 + ++*v5) )
      *v5 = 0;
  }
  return result;
}

//----- (021EB620) --------------------------------------------------------
int __fastcall Function_21eb620(int a1, uint a2, short *a3, int a4)
{
  int v4;
  short *v5;
  uint v6;
  short v7;
  int result;
  int v9;
  int v10;
  int v11;
  int v12;

  v4 = a1;
  v5 = a3;
  v6 = a2;
  if ( a4 != *((char *)a3 + 2) )
  {
    v7 = Function_21edf18(a4);
    Function_2021344(v6, v7);
    Function_20213a4(v6, 0);
    *v5 = 0;
  }
  if ( *((uchar *)v5 + 3) != 7 )
    *v5 = 0;
  result = Function_5_21ecd38(v4);
  if ( !result )
  {
    v9 = 12288;
    v10 = 0x2000;
    v11 = 12288;
    v12 = 0;
    Function_2021368(v6, *(&v9 + *v5));
    result = 0;
    if ( !*(&v9 + ++*v5) )
      *v5 = 0;
  }
  return result;
}

//----- (021EB69C) --------------------------------------------------------
int __fastcall Function_21eb69c(int a1, uint a2, short *a3, int a4)
{
  int v4;
  short *v5;
  uint v6;
  short v7;
  int result;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;

  v4 = a1;
  v5 = a3;
  v6 = a2;
  if ( a4 != *((char *)a3 + 2) )
  {
    v7 = Function_21edf18(a4);
    Function_2021344(v6, v7);
    Function_20213a4(v6, 0);
    *v5 = 0;
  }
  if ( *((uchar *)v5 + 3) != 8 )
    *v5 = 0;
  result = Function_5_21ecd38(v4);
  if ( !result )
  {
    v9 = 0x2000;
    v10 = 4096;
    v11 = 4096;
    v12 = 4096;
    v13 = 4096;
    v14 = 4096;
    v15 = 4096;
    v16 = 0;
    Function_2021368(v6, *(&v9 + *v5));
    result = 0;
    if ( !*(&v9 + ++*v5) )
      *v5 = 0;
  }
  return result;
}

//----- (021EB720) --------------------------------------------------------
int __fastcall Function_21eb720(int a1)
{
  int v1;
  int v2;
  int result;
  int v4;
  int v5;
  int v6;

  v1 = a1;
  v2 = *(uint *)(Function_2062af0(a1) + 4);
  v5 = Function_2062af0(v1);
  result = Function_5_21edd94(v1);
  if ( result != 1 && v2 )
  {
    v6 = LoadSpriteFaceDirection(v1);
    v4 = GetSpritea0(v1);
    if ( v4 >= 10 )
      ErrorHandler();
    ((void (__fastcall *)(int, int, int, int))*(&off_21FF420 + v4))(v1, v2, v5, v6);
    *(uchar *)(v5 + 2) = v6;
    *(uchar *)(v5 + 3) = GetSpritea0(v1);
    Function_5_21edeb4(v1, v2);
    result = Function_21ec6c0(v1, v2);
  }
  return result;
}

//----- (021EB794) --------------------------------------------------------
int __fastcall Function_21eb794(int a1, uint a2, int a3, int a4)
{
  uint v4;
  short v5;

  v4 = a2;
  if ( a4 == *(char *)(a3 + 2) && *(uchar *)(a3 + 3) != 9 )
  {
    Function_21ec668(a2);
  }
  else
  {
    v5 = Function_21edf18(a4);
    Function_2021344(v4, v5);
    Function_20213a4(v4, 0);
  }
  return Function_2021368(v4, 0);
}

//----- (021EB7D0) --------------------------------------------------------
int __fastcall Function_21eb7d0(int a1, uint a2, int a3)
{
  int v3;

  v3 = a2;
  if ( *(uchar *)(a3 + 3) != 9 )
  {
    Function_2021344(a2, 4);
    Function_20213a4(v3, 0);
  }
  return Function_2021368(v3, 4096);
}

//----- (021EB7F8) --------------------------------------------------------
int __fastcall Function_21eb7f8(int a1)
{
  int v1;
  int *v2;
  int *v3;
  uint v4;
  int result;

  v1 = a1;
  v2 = Function_2062acc(a1, 16);
  v3 = v2;
  *(uchar *)v2 = -1;
  v4 = PRNG();
  *((uchar *)v3 + 2) = ((v4 & 0x80000000) != 0) + __ROR4__((v4 << 28) - (v4 >> 31), 28);
  Function_21ecf04(v1, v3 + 1);
  result = v3[1];
  if ( result )
    result = Function_2062b68(v1);
  return result;
}

//----- (021EB834) --------------------------------------------------------
int __fastcall Function_21eb834(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  v2 = Function_2062af0(a1);
  return Function_21ecfa4(v1, v2 + 4);
}

//----- (021EB848) --------------------------------------------------------
uint *__fastcall Function_21eb848(int a1)
{
  uint *v1;
  int v2;

  v1 = (uint *)a1;
  v2 = Function_2062af0(a1);
  if ( *(uint *)(v2 + 4) )
    Function_5_21ed01c();
  Function_21ecfa4(v1, v2 + 4);
  return SetSpriteFlags(v1, 0x200000);
}

//----- (021EB874) --------------------------------------------------------
uint *__fastcall Function_21eb874(int a1)
{
  uint *v1;
  int v2;
  uint *result;

  v1 = (uint *)a1;
  v2 = Function_2062af0(a1);
  result = (uint *)Function_5_21edd94(v1);
  if ( result != (uint *)1 )
  {
    if ( !*(uint *)(v2 + 4) )
      Function_21ecf04(v1, v2 + 4);
    result = *(uint **)(v2 + 4);
    if ( result )
    {
      Function_5_21ed03c();
      Function_5_21edeb4(v1, *(uint *)(v2 + 4));
      result = UnsetSpriteFlags(v1, 0x200000);
    }
  }
  return result;
}

//----- (021EB8B8) --------------------------------------------------------
int __fastcall Function_21eb8b8(int a1)
{
  int v1;
  int v2;
  uchar *v3;
  int result;
  char v5;
  uint v6;

  v1 = a1;
  v2 = *(uint *)(Function_2062af0(a1) + 4);
  v3 = (uchar *)Function_2062af0(v1);
  result = Function_5_21edd94(v1);
  if ( result != 1 && v2 )
  {
    v5 = LoadSpriteFaceDirection(v1);
    GetSpritea0(v1);
    if ( v3[2] )
    {
      --v3[2];
      Function_2021368(v2, 0);
    }
    else
    {
      Function_2021368(v2, 4096);
      if ( (char)++v3[1] >= 32 )
      {
        v3[1] = 0;
        v6 = PRNG();
        v3[2] = ((v6 & 0x80000000) != 0) + __ROR4__((v6 << 28) - (v6 >> 31), 28);
      }
    }
    *v3 = v5;
    v3[3] = GetSpritea0(v1);
    Function_5_21edeb4(v1, v2);
    result = Function_21ec6c0(v1, v2);
  }
  return result;
}

//----- (021EB944) --------------------------------------------------------
int __fastcall Function_21eb944(int a1)
{
  int v1;
  uint v2;
  int v3;
  int result;
  uint v5;
  BOOL v6;
  BOOL v7;

  v1 = a1;
  v2 = *(uint *)(Function_2062af0(a1) + 4);
  v3 = Function_2062af0(v1);
  result = Function_5_21edd94(v1);
  if ( result != 1 && v2 )
  {
    v5 = LoadSpriteFaceDirection(v1);
    if ( GetSpritea0(v1) )
    {
      v6 = v5 > 1;
      if ( v6 != Function_2021358(v2) )
      {
        Function_2021344(v2, v6);
        Function_20213a4(v2, 0);
      }
      Function_2021368(v2, 4096);
    }
    else
    {
      v7 = v5 > 1;
      if ( v7 != Function_2021358(v2) || !*(uchar *)(v3 + 3) )
      {
        Function_2021344(v2, v7);
        Function_20213a4(v2, 0);
        Function_2021368(v2, 0);
      }
      Function_2021368(v2, 0);
    }
    *(uchar *)(v3 + 2) = v5;
    *(uchar *)(v3 + 3) = GetSpritea0(v1);
    Function_5_21edeb4(v1, v2);
    result = Function_21ec6c0(v1, v2);
  }
  return result;
}

//----- (021EBA0C) --------------------------------------------------------
int __fastcall Function_21eba0c(int a1)
{
  int v1;
  int *v2;
  int *v3;
  int result;

  v1 = a1;
  v2 = Function_2062acc(a1, 16);
  v3 = v2;
  *(uchar *)v2 = -1;
  Function_21ecf04(v1, v2 + 1);
  result = v3[1];
  if ( result )
    result = Function_2062b68(v1);
  return result;
}

//----- (021EBA34) --------------------------------------------------------
int __fastcall Function_21eba34(int a1, int a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int v7;
  int v8;
  int v9;
  int v10;

  v10 = a4;
  v7 = 0;
  v8 = 0;
  v4 = (uint *)a1;
  v9 = 0;
  v5 = Function_2062af0(a1);
  Function_21ecfa4(v4, v5 + 4);
  return Function_2063088(v4, &v7);
}

//----- (021EBA60) --------------------------------------------------------
uint *__fastcall Function_21eba60(int a1)
{
  uint *v1;
  int v2;

  v1 = (uint *)a1;
  v2 = Function_2062af0(a1);
  if ( *(uint *)(v2 + 4) )
    Function_5_21ed01c();
  Function_21ecfa4(v1, v2 + 4);
  return SetSpriteFlags(v1, 0x200000);
}

//----- (021EBA8C) --------------------------------------------------------
uint *__fastcall Function_21eba8c(int a1)
{
  uint *v1;
  int v2;
  uint *result;

  v1 = (uint *)a1;
  v2 = Function_2062af0(a1);
  result = (uint *)Function_5_21edd94(v1);
  if ( result != (uint *)1 )
  {
    if ( !*(uint *)(v2 + 4) )
      Function_21ecf04(v1, v2 + 4);
    result = *(uint **)(v2 + 4);
    if ( result )
    {
      Function_5_21ed03c();
      Function_5_21edeb4(v1, *(uint *)(v2 + 4));
      result = UnsetSpriteFlags(v1, 0x200000);
    }
  }
  return result;
}

//----- (021EBAD0) --------------------------------------------------------
int __fastcall Function_21ebad0(int a1)
{
  int v1;
  int v2;
  int result;
  int v4;
  uchar *v5;
  int v6;

  v1 = a1;
  v2 = *(uint *)(Function_2062af0(a1) + 4);
  v5 = (uchar *)Function_2062af0(v1);
  result = Function_5_21edd94(v1);
  if ( result != 1 && v2 )
  {
    v6 = LoadSpriteFaceDirection(v1);
    v4 = GetSpritea0(v1);
    if ( v4 >= 10 )
      ErrorHandler();
    ((void (__fastcall *)(int, int, uchar *, int))*(&off_21FF3F8 + v4))(v1, v2, v5, v6);
    *v5 = v6;
    v5[2] = GetSpritea0(v1);
    Function_5_21edeb4(v1, v2);
    result = Function_21ec6c0(v1, v2);
  }
  return result;
}

//----- (021EBB44) --------------------------------------------------------
int __fastcall Function_21ebb44(int a1, uint a2, char *a3, int a4)
{
  char *v4;
  uint v5;
  short v6;
  int result;
  int v8;
  int v9;

  v4 = a3;
  v5 = a2;
  if ( a4 == *a3 )
  {
    if ( a3[2] == 9 )
    {
      v8 = a3[3] & 0xFE;
      result = v8 | 1;
      a3[3] = v8 | 1;
    }
    else if ( (a3[3] & 1) == 1 )
    {
      v9 = Function_21edf18(a4);
      Function_21ec69c(v5, v9);
      result = 1;
      v4[3] &= 0xFEu;
    }
    else
    {
      result = Function_21ec668(a2);
    }
  }
  else
  {
    v6 = Function_21edf18(a4);
    Function_2021344(v5, v6);
    Function_20213a4(v5, 0);
    result = 1;
    v4[3] &= 0xFEu;
  }
  return result;
}

//----- (021EBBB4) --------------------------------------------------------
int __fastcall Function_21ebbb4(int a1, uint a2, char *a3, int a4)
{
  int v4;
  char *v5;
  uint v6;
  short v7;
  int v8;
  int result;
  int v10;

  v4 = a1;
  v5 = a3;
  v6 = a2;
  if ( a4 == *a3 )
  {
    if ( a3[2] == 9 )
    {
      v8 = a3[3] & 0xFE;
      result = v8 | 1;
      a3[3] = v8 | 1;
      return result;
    }
    if ( (a3[3] & 1) == 1 )
    {
      v10 = Function_21edf18(a4);
      Function_21ec69c(v6, v10);
      v5[3] &= 0xFEu;
    }
  }
  else
  {
    v7 = Function_21edf18(a4);
    Function_2021344(v6, v7);
    Function_20213a4(v6, 0);
  }
  result = Function_5_21ecd38(v4);
  if ( !result )
    result = Function_2021368(v6, 2048);
  return result;
}

//----- (021EBC28) --------------------------------------------------------
int __fastcall Function_21ebc28(int a1, uint a2, char *a3, int a4)
{
  int v4;
  uint v5;
  short v6;
  int v7;
  int result;

  v4 = a1;
  v5 = a2;
  if ( a4 == *a3 )
  {
    if ( a3[2] == 9 )
    {
      v7 = Function_21edf18(a4);
      Function_21ec69c(v5, v7);
    }
  }
  else
  {
    v6 = Function_21edf18(a4);
    Function_2021344(v5, v6);
    Function_20213a4(v5, 0);
  }
  result = Function_5_21ecd38(v4);
  if ( !result )
    result = Function_2021368(v5, 4096);
  return result;
}

//----- (021EBC7C) --------------------------------------------------------
int __fastcall Function_21ebc7c(int a1, uint a2, char *a3, int a4)
{
  int v4;
  uint v5;
  short v6;
  int v7;
  int result;

  v4 = a1;
  v5 = a2;
  if ( a4 == *a3 )
  {
    if ( a3[2] == 9 )
    {
      v7 = Function_21edf18(a4);
      Function_21ec69c(v5, v7);
    }
  }
  else
  {
    v6 = Function_21edf18(a4);
    Function_2021344(v5, v6);
    Function_20213a4(v5, 0);
  }
  result = Function_5_21ecd38(v4);
  if ( !result )
    result = Function_2021368(v5, 0x2000);
  return result;
}

//----- (021EBCD0) --------------------------------------------------------
int __fastcall Function_21ebcd0(int a1, uint a2, char *a3, int a4)
{
  int v4;
  uint v5;
  short v6;
  int v7;
  int result;

  v4 = a1;
  v5 = a2;
  if ( a4 == *a3 )
  {
    if ( a3[2] == 9 )
    {
      v7 = Function_21edf18(a4);
      Function_21ec69c(v5, v7);
    }
  }
  else
  {
    v6 = Function_21edf18(a4);
    Function_2021344(v5, v6);
    Function_20213a4(v5, 0);
  }
  result = Function_5_21ecd38(v4);
  if ( !result )
    result = Function_2021368(v5, 0x4000);
  return result;
}

//----- (021EBD24) --------------------------------------------------------
int __fastcall Function_21ebd24(int a1, uint a2, char *a3, int a4)
{
  int v4;
  char *v5;
  uint v6;
  short v7;
  int v8;
  int result;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;

  v17 = a4;
  v4 = a1;
  v5 = a3;
  v6 = a2;
  if ( a4 == *a3 )
  {
    if ( a3[2] == 9 )
    {
      v8 = Function_21edf18(a4);
      Function_21ec69c(v6, v8);
    }
  }
  else
  {
    v7 = Function_21edf18(a4);
    Function_2021344(v6, v7);
    Function_20213a4(v6, 0);
    v5[1] = 0;
  }
  if ( v5[2] != 6 )
    v5[1] = 0;
  result = Function_5_21ecd38(v4);
  if ( !result )
  {
    v10 = 4096;
    v11 = 4096;
    v12 = 0x2000;
    v13 = 4096;
    v14 = 4096;
    v15 = 0x2000;
    v16 = 0;
    Function_2021368(v6, *(&v10 + v5[1]));
    result = *(&v10 + ++v5[1]);
    if ( !result )
    {
      result = 0;
      v5[1] = 0;
    }
  }
  return result;
}

//----- (021EBDC4) --------------------------------------------------------
int __fastcall Function_21ebdc4(int a1, uint a2, char *a3, int a4)
{
  int v4;
  char *v5;
  uint v6;
  short v7;
  int v8;
  int result;
  int v10;
  int v11;
  int v12;
  int v13;

  v4 = a1;
  v5 = a3;
  v6 = a2;
  if ( a4 == *a3 )
  {
    if ( a3[2] == 9 )
    {
      v8 = Function_21edf18(a4);
      Function_21ec69c(v6, v8);
    }
  }
  else
  {
    v7 = Function_21edf18(a4);
    Function_2021344(v6, v7);
    Function_20213a4(v6, 0);
    v5[1] = 0;
  }
  if ( v5[2] != 7 )
    v5[1] = 0;
  result = Function_5_21ecd38(v4);
  if ( !result )
  {
    v10 = 12288;
    v11 = 0x2000;
    v12 = 12288;
    v13 = 0;
    Function_2021368(v6, *(&v10 + v5[1]));
    result = *(&v10 + ++v5[1]);
    if ( !result )
    {
      result = 0;
      v5[1] = 0;
    }
  }
  return result;
}

//----- (021EBE5C) --------------------------------------------------------
int __fastcall Function_21ebe5c(int a1, uint a2, char *a3, int a4)
{
  int v4;
  char *v5;
  uint v6;
  short v7;
  int v8;
  int result;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;

  v4 = a1;
  v5 = a3;
  v6 = a2;
  if ( a4 == *a3 )
  {
    if ( a3[2] == 9 )
    {
      v8 = Function_21edf18(a4);
      Function_21ec69c(v6, v8);
    }
  }
  else
  {
    v7 = Function_21edf18(a4);
    Function_2021344(v6, v7);
    Function_20213a4(v6, 0);
    v5[1] = 0;
  }
  if ( v5[2] != 8 )
    v5[1] = 0;
  result = Function_5_21ecd38(v4);
  if ( !result )
  {
    v10 = 0x2000;
    v11 = 4096;
    v12 = 4096;
    v13 = 4096;
    v14 = 4096;
    v15 = 4096;
    v16 = 4096;
    v17 = 0;
    Function_2021368(v6, *(&v10 + v5[1]));
    result = *(&v10 + ++v5[1]);
    if ( !result )
    {
      result = 0;
      v5[1] = 0;
    }
  }
  return result;
}

//----- (021EBEFC) --------------------------------------------------------
int __fastcall Function_21ebefc(int a1, uint a2, char *a3, int a4)
{
  int v4;
  uint v5;
  short v6;
  int v7;
  int result;

  v4 = a1;
  v5 = a2;
  if ( a4 == *a3 )
  {
    if ( a3[2] != 9 )
    {
      v7 = Function_21edf24(a4);
      Function_21ec674(v5, v7, 4);
    }
  }
  else
  {
    v6 = Function_21edf24(a4);
    Function_2021344(v5, v6);
    Function_20213a4(v5, 0);
  }
  result = Function_5_21ecd38(v4);
  if ( !result )
    result = Function_2021368(v5, 4096);
  return result;
}

//----- (021EBF50) --------------------------------------------------------
int __fastcall Function_21ebf50(int a1)
{
  int v1;
  uchar *v2;
  int result;
  int v4;
  int v5;
  int v6;

  v1 = a1;
  v4 = *(uint *)(Function_2062af0(a1) + 4);
  v2 = (uchar *)Function_2062af0(v1);
  result = Function_5_21edd94(v1);
  if ( result != 1 )
  {
    result = v4;
    if ( v4 )
    {
      v6 = LoadSpriteFaceDirection(v1);
      v5 = GetSpritea0(v1);
      if ( v5 >= 11 )
        ErrorHandler();
      if ( !v2[2] && v5 != (char)v2[2] && !(v2[3] & 1) )
        *v2 = -1;
      ((void (__fastcall *)(int, int, uchar *, int))*(&off_21FF448 + v5))(v1, v4, v2, v6);
      *v2 = v6;
      v2[2] = v5;
      Function_5_21edeb4(v1, v4);
      result = Function_21ec6c0(v1, v4);
    }
  }
  return result;
}

//----- (021EBFDC) --------------------------------------------------------
int __fastcall Function_21ebfdc(int a1, uint a2, char *a3, int a4)
{
  char *v4;
  uint v5;
  int v6;
  int result;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;

  v13 = a4;
  v4 = a3;
  v5 = a2;
  v9 = 6;
  v10 = 7;
  v11 = 8;
  v12 = 9;
  v6 = *(&v9 + a4);
  if ( a4 == *a3 )
  {
    if ( a3[2] )
    {
      v8 = a3[3] & 0xFE;
      result = v8 | 1;
      a3[3] = v8 | 1;
    }
    else if ( (a3[3] & 1) == 1 )
    {
      Function_2021344(v5, v6);
      Function_20213a4(v5, 0);
      result = 1;
      v4[3] &= 0xFEu;
    }
    else
    {
      result = Function_2021368(v5, 4096);
    }
  }
  else
  {
    Function_2021344(v5, v6);
    Function_20213a4(v5, 0);
    result = 1;
    v4[3] &= 0xFEu;
  }
  return result;
}

//----- (021EC068) --------------------------------------------------------
int __fastcall Function_21ec068(int a1, uint a2, char *a3, int a4)
{
  int v4;
  uint v5;
  char *v6;
  int v7;
  int v8;
  int result;

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v7 = a4;
  v8 = Function_21edf30(a4);
  if ( v7 != *v6 || v6[2] )
  {
    Function_2021344(v5, v8);
    Function_20213a4(v5, 0);
  }
  else if ( v6[2] == 9 )
  {
    if ( v8 != Function_2021358(v5) )
    {
      Function_2021344(v5, v8);
      Function_20213a4(v5, 0);
    }
  }
  else
  {
    Function_2021344(v5, v8);
    Function_20213a4(v5, 0);
  }
  result = Function_5_21ecd38(v4);
  if ( !result )
    result = Function_2021368(v5, 2048);
  return result;
}

//----- (021EC0E4) --------------------------------------------------------
int __fastcall Function_21ec0e4(int a1, uint a2, char *a3, int a4)
{
  int v4;
  uint v5;
  char *v6;
  int v7;
  int v8;
  int result;

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v7 = a4;
  v8 = Function_21edf30(a4);
  if ( v7 == *v6 )
  {
    if ( v6[2] == 10 )
    {
      if ( v8 != Function_2021358(v5) )
      {
        Function_2021344(v5, v8);
        Function_20213a4(v5, 0);
      }
    }
    else
    {
      Function_2021344(v5, v8);
      Function_20213a4(v5, 0);
    }
  }
  else
  {
    Function_2021344(v5, v8);
    Function_20213a4(v5, 0);
  }
  result = Function_5_21ecd38(v4);
  if ( !result )
    result = Function_2021368(v5, 4096);
  return result;
}

//----- (021EC15C) --------------------------------------------------------
int __fastcall Function_21ec15c(int a1)
{
  int v1;
  int v2;
  int result;
  int v4;
  uchar *v5;
  int v6;

  v1 = a1;
  v2 = *(uint *)(Function_2062af0(a1) + 4);
  result = Function_2062af0(v1);
  v5 = (uchar *)result;
  if ( v2 )
  {
    result = Function_5_21edd94(v1);
    if ( result != 1 )
    {
      v6 = LoadSpriteFaceDirection(v1);
      v4 = GetSpritea0(v1);
      if ( v4 >= 4 )
        ErrorHandler();
      ((void (__fastcall *)(int, int, uchar *, int))*(&off_21FF31C + v4))(v1, v2, v5, v6);
      Function_21ec374(v1, v2, v6);
      *v5 = v6;
      v5[2] = GetSpritea0(v1);
      Function_5_21edeb4(v1, v2);
      result = Function_21ec6c0(v1, v2);
    }
  }
  return result;
}

//----- (021EC1D8) --------------------------------------------------------
int __fastcall Function_21ec1d8(int a1, uint a2, char *a3, int a4)
{
  int v4;
  int v5;

  v4 = a2;
  if ( a4 != *a3 || a3[2] )
  {
    Function_2021344(a2, dword_21FF34C[a4]);
    Function_20213a4(v4, 61440);
  }
  v5 = Function_20213d4(v4) - 4096;
  if ( v5 < 0 )
    v5 = 0;
  Function_20213a4(v4, v5);
  return Function_2021368(v4, 0);
}

//----- (021EC228) --------------------------------------------------------
int __fastcall Function_21ec228(int a1, uint a2, char *a3, int a4)
{
  int v4;

  v4 = a2;
  if ( a4 != *a3 || a3[2] != 1 )
  {
    Function_2021344(a2, dword_21FF34C[a4]);
    Function_20213a4(v4, 0);
  }
  return Function_2021368(v4, 4096);
}

//----- (021EC260) --------------------------------------------------------
int __fastcall Function_21ec260(int a1, uint a2, char *a3, int a4)
{
  char *v4;
  int v5;
  int v6;
  int v7;
  uint v8;

  v4 = a3;
  v5 = a2;
  if ( a4 != *a3 || a3[2] != 2 )
  {
    Function_2021344(a2, dword_21FF34C[a4]);
    Function_20213a4(v5, 61440);
    v4[3] &= 1u;
  }
  v6 = Function_20213d4(v5);
  v7 = (uchar)v4[3];
  v8 = (uint)(v7 << 24) >> 25;
  if ( v8 )
  {
    if ( v8 == 1 )
    {
      v6 += 4096;
      if ( v6 >= 61440 )
      {
        v4[3] = v7 & 1 | 4;
        v4[1] = 0;
      }
    }
    else if ( v8 == 2 && ++v4[1] >= 30 )
    {
      v4[1] = 0;
      v4[3] &= 1u;
    }
  }
  else
  {
    v6 -= 4096;
    if ( v6 <= 40960 )
      v4[3] = v7 & 1 | 2;
  }
  Function_20213a4(v5, v6);
  return Function_2021368(v5, 0);
}

//----- (021EC324) --------------------------------------------------------
int __fastcall Function_21ec324(int a1, uint a2, char *a3, int a4)
{
  int v4;
  int v5;

  v4 = a2;
  if ( a4 != *a3 || a3[2] != 3 )
  {
    Function_2021344(a2, dword_21FF34C[a4]);
    Function_20213a4(v4, 61440);
  }
  v5 = Function_20213d4(v4) - 4096;
  if ( v5 < 0 )
    v5 = 0;
  Function_20213a4(v4, v5);
  return Function_2021368(v4, 0);
}

//----- (021EC374) --------------------------------------------------------
int __fastcall Function_21ec374(uint *a1, int a2)
{
  uint *v2;
  int v3;
  int v4;
  int v5;
  int v7;
  int v8;
  int v9;

  v2 = a1;
  v7 = 0;
  v8 = 0;
  v9 = 0;
  v3 = Function_2021394(a2);
  v4 = v3 + ((uint)(v3 >> 11) >> 20);
  v5 = v3 / 4096;
  switch ( (uchar)v4 )
  {
    case 1:
      if ( v5 >= 24 )
        v9 = 24576;
      break;
    case 2:
      if ( v5 >= 40 )
        v7 = -20480;
      else
        v7 = 4096;
      break;
    case 3:
      if ( v5 >= 56 )
        v7 = 20480;
      else
        v7 = -4096;
      break;
    default:
      return Function_2063088(v2, &v7);
  }
  return Function_2063088(v2, &v7);
}

//----- (021EC3F0) --------------------------------------------------------
int __fastcall Function_21ec3f0(int a1)
{
  int v1;
  uint v2;
  uchar *v3;
  int result;
  int v5;
  int v6;
  short v7;

  v1 = a1;
  v2 = *(uint *)(Function_2062af0(a1) + 4);
  v3 = (uchar *)Function_2062af0(v1);
  result = Function_5_21edd94(v1);
  if ( result != 1 )
  {
    if ( v2 )
    {
      v5 = LoadSpriteFaceDirection(v1);
      v6 = v5;
      *v3 = v5;
      v3[2] = GetSpritea0(v1);
      v7 = Function_21edf18(v6);
      Function_2021344(v2, v7);
      Function_20213a4(v2, 0);
      Function_2021368(v2, 0);
      Function_5_21edeb4(v1, v2);
      result = Function_21ec6c0(v1, v2);
    }
  }
  return result;
}

//----- (021EC454) --------------------------------------------------------
int __fastcall Function_21ec454(int a1)
{
  int v1;
  uint v2;
  uchar *v3;
  int result;

  v1 = a1;
  v2 = *(uint *)(Function_2062af0(a1) + 4);
  v3 = (uchar *)Function_2062af0(v1);
  result = Function_5_21edd94(v1);
  if ( result != 1 && v2 )
  {
    *v3 = LoadSpriteFaceDirection(v1);
    v3[2] = GetSpritea0(v1);
    if ( Function_2021358(v2) )
    {
      Function_2021344(v2, 0);
      Function_20213a4(v2, 0);
    }
    Function_2021368(v2, 4096);
    Function_5_21edeb4(v1, v2);
    result = Function_21ec6c0(v1, v2);
  }
  return result;
}

//----- (021EC4BC) --------------------------------------------------------
int __fastcall Function_21ec4bc(int a1)
{
  int v1;
  uint v2;
  uchar *v3;
  int result;
  char v5;

  v1 = a1;
  v2 = *(uint *)(Function_2062af0(a1) + 4);
  v3 = (uchar *)Function_2062af0(v1);
  result = Function_5_21edd94(v1);
  if ( result != 1 && v2 )
  {
    v5 = LoadSpriteFaceDirection(v1);
    if ( GetSpritea0(v1) )
    {
      if ( Function_2021358(v2) )
      {
        Function_2021344(v2, 0);
        Function_20213a4(v2, 0);
      }
      Function_2021368(v2, 4096);
    }
    else
    {
      if ( Function_2021358(v2) != 1 )
      {
        Function_2021344(v2, 1);
        Function_20213a4(v2, 0);
      }
      Function_2021368(v2, 4096);
    }
    *v3 = v5;
    v3[2] = GetSpritea0(v1);
    Function_5_21edeb4(v1, v2);
    result = Function_21ec6c0(v1, v2);
  }
  return result;
}

//----- (021EC554) --------------------------------------------------------
int __fastcall Function_21ec554(int a1)
{
  int v1;
  uint v2;
  char *v3;
  int result;
  int v5;
  char v6;
  short v7;

  v1 = a1;
  v2 = *(uint *)(Function_2062af0(a1) + 4);
  v3 = (char *)Function_2062af0(v1);
  result = Function_5_21edd94(v1);
  if ( result != 1 && v2 )
  {
    v5 = LoadSpriteFaceDirection(v1);
    v6 = v5;
    if ( v5 != *v3 )
    {
      v7 = Function_21edf18(v5);
      Function_2021344(v2, v7);
      Function_20213a4(v2, 0);
    }
    Function_2021368(v2, 4096);
    Function_5_21edeb4(v1, v2);
    Function_21ec6c0(v1, v2);
    *v3 = v6;
    result = GetSpritea0(v1);
    v3[2] = result;
  }
  return result;
}

//----- (021EC5C0) --------------------------------------------------------
int __fastcall Function_21ec5c0(int a1)
{
  int v1;
  uint v2;
  uchar *v3;
  int result;
  int v5;
  char v6;

  v1 = a1;
  v2 = *(uint *)(Function_2062af0(a1) + 4);
  v3 = (uchar *)Function_2062af0(v1);
  result = Function_5_21edd94(v1);
  if ( result != 1 && v2 )
  {
    v6 = LoadSpriteFaceDirection(v1);
    v5 = GetSpritea0(v1);
    if ( v5 != (char)v3[2] )
    {
      if ( v5 )
        Function_2021344(v2, 1);
      else
        Function_2021344(v2, 0);
      Function_20213a4(v2, 0);
    }
    Function_2021368(v2, 4096);
    *v3 = v6;
    v3[2] = v5;
    Function_5_21edeb4(v1, v2);
    result = Function_21ec6c0(v1, v2);
  }
  return result;
}

//----- (021EC638) --------------------------------------------------------
int __fastcall Function_21ec638(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;

  v2 = a1;
  v3 = a2;
  v4 = Function_20213d4(a1) / 4096;
  s32_div_f(v4, v3);
  Function_20213a4(v2, (v4 - v5) << 12);
  return Function_2021368(v2, 0);
}

//----- (021EC668) --------------------------------------------------------
int __fastcall Function_21ec668(int a1)
{
  return Function_21ec638(a1, 8);
}

//----- (021EC674) --------------------------------------------------------
int __fastcall Function_21ec674(int a1, short a2, int a3)
{
  short v3;
  uint v4;
  int v5;

  v3 = a2;
  v4 = a1;
  Function_21ec638(a1, a3);
  v5 = Function_20213d4(v4);
  Function_2021344(v4, v3);
  return Function_20213a4(v4, v5);
}

//----- (021EC69C) --------------------------------------------------------
int __fastcall Function_21ec69c(int a1, short a2)
{
  uint v2;
  short v3;
  int v4;

  v2 = a1;
  v3 = a2;
  Function_21ec668(a1);
  v4 = Function_20213d4(v2);
  Function_2021344(v2, v3);
  return Function_20213a4(v2, v4);
}

//----- (021EC6C0) --------------------------------------------------------
uint __fastcall Function_21ec6c0(uint *a1, uint a2)
{
  char v2;
  uint v3;
  uint *v4;

  v2 = 1;
  v3 = a2;
  v4 = a1;
  if ( CheckSpriteFlags(a1, 512) == 1 )
    v2 = 0;
  if ( CheckSpriteFlags(v4, 4096) == 1 && !CheckSpriteFlags(v4, 0x2000) )
    v2 = 0;
  return Function_2021320(v3, v2);
}

//----- (021EC700) --------------------------------------------------------
uint __fastcall Function_21ec700(int a1, uint *a2)
{
  int *v2;
  uint *v3;
  int v4;
  uint *v5;
  uint v6;
  uint v7;
  uint result;

  v2 = &dword_21FB51C;
  v3 = a2;
  v4 = 91;
  do
  {
    if ( v4 == a1 )
    {
      v5 = (uint *)(v2 + 1);
      v6 = *v5;
      v7 = v5[1];
      v5 += 2;
      *v3 = v6;
      v3[1] = v7;
      result = *v5;
      v3[2] = *v5;
      return result;
    }
    v2 += 4;
    v4 = *v2;
  }
  while ( *v2 != 0xFFFF );
  return ErrorHandler();
}

//----- (021EC734) --------------------------------------------------------
int __fastcall Function_21ec734(int a1)
{
  int v1;
  int *v2;
  int v3;
  int result;
  char v5;

  v1 = a1;
  v2 = Function_2062acc(a1, 4);
  v3 = Function_2062924(v1);
  Function_21ec700(v3, (uint *)&v5);
  result = Function_21f121c(v1, &v5);
  *v2 = result;
  return result;
}

//----- (021EC75C) --------------------------------------------------------
void Function_21ec75c()
{
  ;
}

//----- (021EC760) --------------------------------------------------------
int *__fastcall Function_21ec760(int a1)
{
  int **v1;
  int **v2;
  int *result;

  v1 = (int **)Function_2062af0(a1);
  v2 = v1;
  result = *v1;
  if ( result )
  {
    Function_5_21df74c(result);
    result = 0;
    *v2 = 0;
  }
  return result;
}

//----- (021EC778) --------------------------------------------------------
int *__fastcall Function_21ec778(int a1)
{
  int **v1;
  int **v2;
  int *result;

  v1 = (int **)Function_2062af0(a1);
  v2 = v1;
  result = *v1;
  if ( result )
  {
    Function_5_21df74c(result);
    result = 0;
    *v2 = 0;
  }
  return result;
}

//----- (021EC790) --------------------------------------------------------
int __fastcall Function_21ec790(int a1)
{
  int v1;
  int *v2;
  int v3;
  int result;
  char v5;

  v1 = a1;
  v2 = (int *)Function_2062af0(a1);
  v3 = Function_2062924(v1);
  Function_21ec700(v3, (uint *)&v5);
  result = Function_21f121c(v1, &v5);
  *v2 = result;
  return result;
}

//----- (021EC7B8) --------------------------------------------------------
int __fastcall Function_21ec7b8(int a1)
{
  int v1;
  int *v2;
  int result;

  v1 = a1;
  v2 = Function_2062acc(a1, 4);
  result = Function_21f2438(v1);
  *v2 = result;
  return result;
}

//----- (021EC7D0) --------------------------------------------------------
int __fastcall Function_21ec7d0(int a1)
{
  int v1;
  int *v2;
  int result;

  v1 = a1;
  v2 = (int *)Function_2062af0(a1);
  if ( *v2 )
    ErrorHandler();
  result = Function_21f2438(v1);
  *v2 = result;
  return result;
}

//----- (021EC7F0) --------------------------------------------------------
int __fastcall Function_21ec7f0(int a1)
{
  uint *v1;
  int result;

  v1 = (uint *)Function_2062af0(a1);
  Function_21f247c(*v1);
  result = 0;
  *v1 = 0;
  return result;
}

//----- (021EC804) --------------------------------------------------------
uint __fastcall Function_21ec804(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;

  v2 = a2;
  v3 = Function_20213f4(a1);
  Function_20b2d8c(v3, 1, 2031616);
  return Function_20b3764(v3, *(uint *)(v2 + 16), v4, v5);
}

//----- (021EC824) --------------------------------------------------------
int __fastcall Function_21ec824(int a1)
{
  int v1;
  int *v2;
  int v3;
  int result;

  v1 = a1;
  v2 = Function_2062acc(a1, 20);
  v3 = (int)v2;
  *((uchar *)v2 + 2) = -1;
  Function_21ecf04(v1, v2 + 1);
  result = *(uint *)(v3 + 4);
  if ( result )
  {
    Function_2021444(result, (int)Function_21ec804, v3);
    result = Function_2062b68(v1);
  }
  return result;
}

//----- (021EC858) --------------------------------------------------------
int __fastcall Function_21ec858(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  v2 = Function_2062af0(a1);
  return Function_21ecfa4(v1, v2 + 4);
}

//----- (021EC86C) --------------------------------------------------------
uint *__fastcall Function_21ec86c(int a1)
{
  uint *v1;
  int v2;

  v1 = (uint *)a1;
  v2 = Function_2062af0(a1);
  if ( *(uint *)(v2 + 4) )
    Function_5_21ed01c();
  Function_21ecfa4(v1, v2 + 4);
  return SetSpriteFlags(v1, 0x200000);
}

//----- (021EC898) --------------------------------------------------------
int __fastcall Function_21ec898(int a1)
{
  uint *v1;
  int v2;
  int result;

  v1 = (uint *)a1;
  v2 = Function_2062af0(a1);
  result = Function_5_21edd94(v1);
  if ( result != 1 )
  {
    if ( !*(uint *)(v2 + 4) )
      Function_21ecf04(v1, v2 + 4);
    result = *(uint *)(v2 + 4);
    if ( result )
    {
      Function_5_21ed03c();
      Function_5_21edeb4(v1, *(uint *)(v2 + 4));
      UnsetSpriteFlags(v1, 0x200000);
      result = Function_2021444(*(uint *)(v2 + 4), (int)Function_21ec804, v2);
    }
  }
  return result;
}

//----- (021EC8EC) --------------------------------------------------------
uint __fastcall Function_21ec8ec(int a1)
{
  uint *v1;
  int v2;
  uint result;
  uint v4;
  uint v5;

  v1 = (uint *)a1;
  v2 = Function_2062af0(a1);
  result = Function_5_21edd94(v1);
  if ( result != 1 )
  {
    v4 = *(uint *)(v2 + 4);
    if ( v4 )
    {
      v5 = *(uint *)(v2 + 16);
      if ( v5 < 0x1F )
        *(uint *)(v2 + 16) = v5 + 1;
      if ( !Function_5_21ecd38(v1) )
        Function_2021368(v4, 4096);
      Function_5_21edeb4(v1, v4);
      result = Function_21ec6c0(v1, v4);
    }
  }
  return result;
}

//----- (021EC938) --------------------------------------------------------
int __fastcall Function_21ec938(int a1)
{
  int v1;
  int *v2;
  int result;

  v1 = a1;
  v2 = Function_2062acc(a1, 20);
  Function_21ecf04(v1, v2 + 2);
  result = v2[2];
  if ( result )
    result = Function_2062b68(v1);
  return result;
}

//----- (021EC95C) --------------------------------------------------------
int __fastcall Function_21ec95c(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  v2 = Function_2062af0(a1);
  return Function_21ecfa4(v1, v2 + 8);
}

//----- (021EC970) --------------------------------------------------------
uint *__fastcall Function_21ec970(int a1)
{
  uint *v1;
  int v2;

  v1 = (uint *)a1;
  v2 = Function_2062af0(a1);
  if ( *(uint *)(v2 + 8) )
    Function_5_21ed01c();
  Function_21ecfa4(v1, v2 + 8);
  return SetSpriteFlags(v1, 0x200000);
}

//----- (021EC9A0) --------------------------------------------------------
uint *__fastcall Function_21ec9a0(int a1)
{
  uint *v1;
  int v2;
  uint *result;

  v1 = (uint *)a1;
  v2 = Function_2062af0(a1);
  result = (uint *)Function_5_21edd94(v1);
  if ( result != (uint *)1 )
  {
    if ( !*(uint *)(v2 + 8) )
      Function_21ecf04(v1, v2 + 8);
    result = *(uint **)(v2 + 8);
    if ( result )
    {
      Function_5_21ed03c();
      Function_5_21edeb4(v1, *(uint *)(v2 + 8));
      result = UnsetSpriteFlags(v1, 0x200000);
    }
  }
  return result;
}

//----- (021EC9E8) --------------------------------------------------------
uint __fastcall Function_21ec9e8(int a1)
{
  uint *v1;
  int *v2;
  uint result;
  uint v4;
  int *v5;
  char *v6;
  int v7;
  int v8;
  int v9;
  char v10[64];
  int v11;
  int v12;

  v1 = (uint *)a1;
  v2 = (int *)Function_2062af0(a1);
  result = Function_5_21edd94(v1);
  if ( result != 1 )
  {
    v4 = v2[2];
    if ( v4 )
    {
      if ( !Function_5_21ecd38(v1) )
        Function_2021368(v4, 4096);
      v5 = &dword_21FF474;
      v6 = v10;
      v7 = 8;
      do
      {
        v8 = *v5;
        v9 = v5[1];
        v5 += 2;
        *(uint *)v6 = v8;
        *((uint *)v6 + 1) = v9;
        v6 += 8;
        --v7;
      }
      while ( v7 );
      Function_2063078(v1, &v11);
      if ( v12 == v2[1] )
      {
        v12 = *(uint *)&v10[4 * (*v2 >> 1)];
        *v2 = (*v2 + 1) & 0x1F;
        v2[1] = v12;
        Function_2063088(v1, &v11);
      }
      Function_5_21edeb4(v1, v4);
      result = Function_21ec6c0(v1, v4);
    }
  }
  return result;
}

//----- (021ECA70) --------------------------------------------------------
int __fastcall Function_21eca70(uint *a1, int a2, int a3, int a4)
{
  uint *v4;
  int v6;
  int v7;
  int v8;
  int v9;

  v9 = a4;
  v4 = a1;
  Function_21ecb90();
  v6 = 0;
  v7 = 0;
  v8 = 0;
  return Function_20630ac(v4, &v6);
}

//----- (021ECA90) --------------------------------------------------------
int __fastcall Function_21eca90(int a1)
{
  int v1;
  int v2;
  int result;

  v1 = a1;
  v2 = *(uint *)Function_2062af0(a1);
  result = Function_5_21edd94(v1);
  if ( result != 1 )
  {
    if ( v2 )
    {
      Function_21ecba4(v1);
      result = Function_2021368(v2, 4096);
    }
  }
  return result;
}

//----- (021ECABC) --------------------------------------------------------
int Function_21ecabc()
{
  return Function_21ecc0c();
}

//----- (021ECAC4) --------------------------------------------------------
uint *__fastcall Function_21ecac4(int a1)
{
  uint *v1;
  uint *v2;

  v1 = (uint *)a1;
  v2 = (uint *)Function_2062af0(a1);
  if ( *v2 )
    Function_5_21ed01c();
  Function_21ecfa4(v1, v2);
  return SetSpriteFlags(v1, 0x200000);
}

//----- (021ECAF0) --------------------------------------------------------
uint *__fastcall Function_21ecaf0(int a1)
{
  uint *v1;
  uint *v2;
  uint *result;

  v1 = (uint *)a1;
  v2 = (uint *)Function_2062af0(a1);
  result = (uint *)Function_5_21edd94(v1);
  if ( result != (uint *)1 )
  {
    if ( !*v2 )
      Function_21ecf04(v1, v2);
    result = (uint *)*v2;
    if ( *v2 )
    {
      Function_5_21ed03c();
      Function_5_21edeb4(v1, (uint *)*v2);
      result = UnsetSpriteFlags(v1, 0x200000);
    }
  }
  return result;
}

//----- (021ECB34) --------------------------------------------------------
int __fastcall Function_21ecb34(uint *a1, int a2, int a3, int a4)
{
  uint *v4;
  int v6;
  int v7;
  int v8;
  int v9;

  v9 = a4;
  v4 = a1;
  Function_21ecb90();
  v7 = 98304;
  v6 = 0;
  v8 = 0;
  return Function_20630ac(v4, &v6);
}

//----- (021ECB58) --------------------------------------------------------
int __fastcall Function_21ecb58(int a1)
{
  int v1;
  int v2;
  int result;

  v1 = a1;
  v2 = *(uint *)Function_2062af0(a1);
  result = Function_5_21edd94(v1);
  if ( result != 1 )
  {
    if ( v2 )
      result = Function_21ecba4(v1);
  }
  return result;
}

//----- (021ECB78) --------------------------------------------------------
int Function_21ecb78()
{
  return Function_21ecc0c();
}

//----- (021ECB80) --------------------------------------------------------
int __fastcall Function_21ecb80(int a1)
{
  int v1;

  v1 = Function_2062af0(a1);
  return Function_21ecb8c(v1);
}

//----- (021ECB8C) --------------------------------------------------------
int __fastcall Function_21ecb8c(int a1)
{
  return *(uint *)a1;
}

//----- (021ECB90) --------------------------------------------------------
int __fastcall Function_21ecb90(int a1)
{
  int v1;
  int *v2;

  v1 = a1;
  v2 = Function_2062acc(a1, 12);
  return Function_21ecf04(v1, v2);
}

//----- (021ECBA4) --------------------------------------------------------
int __fastcall Function_21ecba4(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  v2 = *(uint *)Function_2062af0(a1);
  Function_5_21edeb4(v1, v2);
  Function_2021368(v2, 4096);
  return Function_21ecbcc(v1, v2);
}

//----- (021ECBCC) --------------------------------------------------------
uint __fastcall Function_21ecbcc(uint *a1, uint a2)
{
  char v2;
  uint v3;
  uint *v4;

  v2 = 1;
  v3 = a2;
  v4 = a1;
  if ( CheckSpriteFlags(a1, 512) == 1 )
    v2 = 0;
  if ( CheckSpriteFlags(v4, 4096) == 1 && !CheckSpriteFlags(v4, 0x2000) )
    v2 = 0;
  return Function_2021320(v3, v2);
}

//----- (021ECC0C) --------------------------------------------------------
int __fastcall Function_21ecc0c(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  v2 = Function_2062af0(a1);
  return Function_21ecfa4(v1, v2);
}

//----- (021ECC20) --------------------------------------------------------
uint *__fastcall Function_21ecc20(uint *a1, int a2, int a3, int a4, int a5)
{
  int v5;
  uint *v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;

  v5 = a2;
  v6 = a1;
  v7 = a3;
  v8 = a4;
  if ( MaskBitsInSpriteList0(a1, 1) )
    ErrorHandler();
  LoadMModelIntoRAM(v6);
  v9 = GetNrOfSpritesInList((int)v6);
  v10 = GetSpriteListc((int)v6) - 1;
  v11 = GetSpriteListAdr18((int)v6);
  Function_21ece40(v11, v6, v9, v10, v5, v7, v8, a5);
  return SetBitsInSpriteList0(v6, 1);
}

//----- (021ECC78) --------------------------------------------------------
int __fastcall Function_21ecc78(uint *a1)
{
  uint *v1;
  int v2;

  v1 = a1;
  if ( Function_2062ca8(a1) != 1 )
    ErrorHandler();
  v2 = GetSpriteListAdr18((int)v1);
  Function_21ece94(v2);
  UnsetBitsInSpriteList0(v1, 1);
  return FS_CloseFile_MModel(v1);
}

//----- (021ECCA4) --------------------------------------------------------
int __fastcall LoadMModelIntoRAM(int a1, int a2, int a3, int a4)
{
  int v4;
  int *v5;

  v4 = a1;
  v5 = LoadFromNARC_8(81, 4u, a3, a4);
  return SetSpriteListNARCFileHandlerOfMModel(v4, (int)v5);
}

//----- (021ECCBC) --------------------------------------------------------
uint __fastcall FS_CloseFile_MModel(int a1)
{
  int *v1;

  v1 = (int *)GetSpriteListNARCFileHandlerOfMModel(a1);
  return Call_FS_CloseFile(v1);
}

//----- (021ECCC8) --------------------------------------------------------
int __fastcall Function_21eccc8(int a1)
{
  uint *v1;
  uint *v2;
  int result;

  v1 = (uint *)a1;
  v2 = (uint *)GetSpriteSpriteList(a1);
  result = MaskBitsInSpriteList0(v2, 4);
  if ( !result )
  {
    result = MaskSpriteFlags(v1, 0x4000);
    if ( result )
    {
      if ( !CheckSpriteFlag_Lock(v1) || (result = IsSetSpriteFlags10(v1)) != 0 )
        result = Function_2062b68((int)v1);
    }
  }
  return result;
}

//----- (021ECD04) --------------------------------------------------------
int __fastcall Function_5_21ecd04(int a1)
{
  int v1;

  v1 = GetSpriteGraphic(a1);
  return Function_21ecd10(v1);
}

//----- (021ECD10) --------------------------------------------------------
int *__fastcall Function_21ecd10(int a1)
{
  int *v1;

  v1 = &dword_21FC194;
  do
  {
    if ( *v1 == a1 )
      return v1;
    v1 += 2;
  }
  while ( *v1 != 0xFFFF );
  ErrorHandler();
  return 0;
}

//----- (021ECD38) --------------------------------------------------------
BOOL __fastcall Function_5_21ecd38(uint *a1)
{
  uint *v1;
  BOOL result;

  v1 = a1;
  if ( CheckSpriteFlag_Lock(a1) != 1 || IsSetSpriteFlags10(v1) )
    result = MaskSpriteFlags(v1, 256) != 0;
  else
    result = 1;
  return result;
}

//----- (021ECD68) --------------------------------------------------------
int __fastcall LoadFileFromMModel(int a1, uint a2, int a3)
{
  uint v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;

  v3 = a2;
  v4 = a3;
  v5 = GetSpriteListNARCFileHandlerOfMModel(a1);
  v8 = Function_2006d84_GetFilesize(v5, v3, v6, v7);
  if ( v4 == 1 )
    v9 = malloc(4u, v8);
  else
    v9 = malloc2(4u, v8);
  v10 = v9;
  LoadFileFromNARCFileHandler(v5, v3, v9);
  return v10;
}

//----- (021ECDA0) --------------------------------------------------------
int __fastcall Function_21ecda0(uint *a1, uint *a2, int a3, int a4)
{
  uint *v4;
  uint *v5;
  int result;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;

  v19 = a4;
  v4 = a2;
  v5 = a1;
  CopySprite70Struct(a1, &v16);
  Function_2063078(v5, &v13);
  Function_206309c(v5, &v10);
  Function_20630bc(v5, &v7);
  *v4 = v7 + v10 + v16 + v13;
  v4[1] = v8 + v11 + v17 + v14;
  result = v9 + v12 + v18 + v15;
  v4[2] = result;
  return result;
}

//----- (021ECDFC) --------------------------------------------------------
int __fastcall Function_5_21ecdfc(uint *a1, int a2)
{
  uint *v2;
  int result;

  v2 = a1;
  ChangeSpriteFaceDirection_WithCheck(a1, a2);
  result = CheckSpriteFlag_4000(v2);
  if ( result == 1 )
    result = Function_2062b68((int)v2);
  return result;
}

//----- (021ECE18) --------------------------------------------------------
uint *__fastcall Function_21ece18(uint *a1)
{
  uint *v1;

  v1 = a1;
  Function_2062d64(a1, 1);
  return SetSpriteFlags(v1, 0x100000);
}

//----- (021ECE30) --------------------------------------------------------
void Function_21ece30()
{
  ;
}

//----- (021ECE34) --------------------------------------------------------
void Function_21ece34()
{
  ;
}

//----- (021ECE38) --------------------------------------------------------
void Function_21ece38()
{
  ;
}

//----- (021ECE3C) --------------------------------------------------------
void Function_21ece3c()
{
  ;
}

//----- (021ECE40) --------------------------------------------------------
int __fastcall Function_21ece40(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8)
{
  int v8;
  int v9;

  v8 = a3;
  v9 = a1;
  *(uint *)(a1 + 260) = a2;
  Function_21eddac();
  Function_21ee320(v9, v8, a8);
  Function_21ed224(v9);
  Function_21ed0a4(v9, v8);
  return Function_21ed4e4(v9, a7, &dword_21FAF50, &dword_21FAF48);
}

//----- (021ECE94) --------------------------------------------------------
int __fastcall Function_21ece94(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  Function_21ee3c4();
  Function_21ed0f0(v1);
  v2 = LoadSpriteList_18_e0(v1);
  Function_21eddd4(v2);
  return Function_21ed2ac(v1);
}

//----- (021ECEB4) --------------------------------------------------------
int __fastcall Function_5_21eceb4(int a1, uint *a2, int a3)
{
  uint *v3;
  int v4;
  int v5;
  int v6;
  int result;
  int v8;

  v3 = a2;
  v4 = a3;
  v5 = a1;
  *a2 = 0;
  v8 = Function_21edea8(a1);
  v6 = Function_21ed82c();
  if ( v6 )
  {
    if ( (uint)(v6 - 3) > 1 )
      *v3 = Function_21ecf1c(v5, v4);
    else
      Function_21ee228(v8, v5, v3, v4);
    result = v6;
  }
  else
  {
    Function_21ed060(v5, v3, v4);
    result = 0;
  }
  return result;
}

//----- (021ECF04) --------------------------------------------------------
int __fastcall Function_21ecf04(int a1, uint *a2)
{
  int v2;
  uint *v3;
  int v4;

  v2 = a1;
  v3 = a2;
  v4 = GetSpriteGraphic(a1);
  return Function_5_21eceb4(v2, v3, v4);
}

//----- (021ECF1C) --------------------------------------------------------
int __fastcall Function_21ecf1c(uint *a1, int a2)
{
  uint *v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  char v12;

  v2 = a1;
  v3 = a2;
  v4 = Function_21edea8(a1);
  v5 = LoadSpriteList_18_e0(v4);
  Function_21eda0c(v4, v3);
  v8 = Function_21ed110(v4, v3);
  if ( !v8 )
    ErrorHandler();
  Function_21ecda0(v2, &v12, v6, v7);
  v9 = Function_21edd50(v3);
  v10 = Function_21edddc(v5, v8, &v12, v9);
  if ( !v10 )
    ErrorHandler();
  return v10;
}

//----- (021ECF70) --------------------------------------------------------
int __fastcall Function_21ecf70(int a1, int *a2, int a3)
{
  int *v3;
  int v4;
  int v5;
  int v6;
  int result;
  int v8;

  v3 = a2;
  v4 = a1;
  v5 = a3;
  Function_20211fc(*a2);
  *v3 = 0;
  v6 = GetSpriteSpriteList(v4);
  result = Function_21ed1c8(v6, v4, v5);
  if ( !result )
  {
    v8 = Function_21edea8(v4);
    result = Function_21ed184(v8, v5);
  }
  return result;
}

//----- (021ECFA4) --------------------------------------------------------
int __fastcall Function_21ecfa4(int a1, int *a2)
{
  int *v2;
  int v3;
  int result;
  int v5;

  v2 = a2;
  v3 = a1;
  Function_21ed094();
  result = *v2;
  if ( *v2 )
  {
    v5 = GetSpriteGraphic(v3);
    if ( IsValueSpriteBerrytree(v5) == 1 )
      v5 = Function_2067800(v3);
    result = Function_21ecf70(v3, v2, v5);
  }
  return result;
}

//----- (021ECFD8) --------------------------------------------------------
int __fastcall Function_5_21ecfd8(int a1, int *a2, int a3)
{
  int *v3;
  int v4;
  int v5;
  int result;
  int v7;
  int v8;

  v3 = a2;
  v4 = a1;
  v5 = a3;
  Function_21ed094();
  if ( *v3 )
  {
    Function_20211fc(*v3);
    *v3 = 0;
  }
  result = 0xFFFF;
  if ( v5 != 0xFFFF )
  {
    v7 = GetSpriteSpriteList(v4);
    result = Function_21ed1c8(v7, v4, v5);
    if ( !result )
    {
      v8 = Function_21edea8(v4);
      result = Function_21ed184(v8, v5);
    }
  }
  return result;
}

//----- (021ED01C) --------------------------------------------------------
int __fastcall Function_5_21ed01c(int a1, ushort *a2)
{
  int v2;
  ushort *v3;
  int result;

  v2 = a1;
  v3 = a2;
  *a2 = Function_2021334(a1);
  v3[1] = Function_2021358(v2);
  result = Function_2021394(v2);
  *((uint *)v3 + 1) = result;
  return result;
}

//----- (021ED03C) --------------------------------------------------------
uint __fastcall Function_5_21ed03c(uint a1, ushort *a2)
{
  ushort *v2;
  uint v3;

  v2 = a2;
  v3 = a1;
  Function_2021320(a1, *a2);
  Function_2021344(v3, v2[1]);
  return Function_2021380(v3, *((uint *)v2 + 1));
}

//----- (021ED060) --------------------------------------------------------
int __fastcall Function_21ed060(uint *a1, int *a2, int a3)
{
  int v3;
  uint *v4;
  int *v5;
  int v6;
  int result;

  v3 = a3;
  v4 = a1;
  v5 = a2;
  v6 = Function_21edea8(a1);
  if ( Function_21ed3a4() )
    return Function_21ee228(v6, v4, v5, v3);
  result = Function_21ecf1c(v4, v3);
  *v5 = result;
  return result;
}

//----- (021ED094) --------------------------------------------------------
int __fastcall Function_21ed094(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  v2 = Function_21edea8(a1);
  return Function_21ee264(v2, v1);
}

//----- (021ED0A4) --------------------------------------------------------
int __fastcall Function_21ed0a4(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  uint *v5;
  int result;

  v2 = a2;
  v3 = a1;
  v4 = malloc(4u, 40 * a2);
  *(uint *)(v3 + 228) = v4;
  if ( !v4 )
    ErrorHandler();
  v5 = (uint *)malloc(4u, 8 * v2);
  *(uint *)(v3 + 244) = v5;
  if ( !v5 )
    ErrorHandler();
  result = 0xFFFF;
  do
  {
    *v5 = 0xFFFF;
    v5[1] = v4;
    v5 += 2;
    v4 += 40;
    --v2;
  }
  while ( v2 );
  return result;
}

//----- (021ED0F0) --------------------------------------------------------
uint __fastcall Function_21ed0f0(int a1)
{
  int v1;

  v1 = a1;
  Function_21ed1a4();
  Function_2018238(4u, *(uint *)(v1 + 228));
  return Function_2018238(4u, *(uint *)(v1 + 244));
}

//----- (021ED110) --------------------------------------------------------
int __fastcall Function_21ed110(int a1, int a2)
{
  uint *v2;
  int v3;
  uint *v4;
  int v5;
  int v7;

  v2 = *(uint **)(a1 + 244);
  v3 = *(uint *)(a1 + 4);
  v4 = *(uint **)(a1 + 244);
  v5 = *(uint *)(a1 + 4);
  do
  {
    if ( *v4 == a2 )
      return v4[1];
    v4 += 2;
    --v5;
  }
  while ( v5 );
  do
  {
    if ( *v2 == 0xFFFF )
    {
      *v2 = a2;
      v7 = v2[1];
      Function_21ede3c();
      return v2[1];
    }
    v2 += 2;
    --v3;
  }
  while ( v3 );
  return 0;
}

//----- (021ED150) --------------------------------------------------------
int __fastcall Function_21ed150(int a1, int a2, uint *a3)
{
  int v3;
  uint *v4;
  int v5;
  uint *v6;
  int v7;
  int *v8;
  int v9;
  int v10;
  int v11;

  v3 = a2;
  v4 = a3;
  v5 = GetSpriteListAdr18(a1);
  v6 = *(uint **)(v5 + 244);
  v7 = *(uint *)(v5 + 4);
  while ( *v6 != v3 )
  {
    v6 += 2;
    if ( !--v7 )
      return 0;
  }
  v8 = (int *)v6[1];
  v9 = 5;
  do
  {
    v10 = *v8;
    v11 = v8[1];
    v8 += 2;
    *v4 = v10;
    v4[1] = v11;
    v4 += 2;
    --v9;
  }
  while ( v9 );
  return 1;
}

//----- (021ED184) --------------------------------------------------------
int __fastcall Function_21ed184(int a1, int a2)
{
  int *v2;
  int v3;
  int result;

  v2 = *(int **)(a1 + 244);
  v3 = *(uint *)(a1 + 4);
  while ( 1 )
  {
    result = *v2;
    if ( *v2 == a2 )
      break;
    v2 += 2;
    if ( !--v3 )
      return result;
  }
  result = 0xFFFF;
  *v2 = 0xFFFF;
  return result;
}

//----- (021ED1A4) --------------------------------------------------------
int __fastcall Function_21ed1a4(int a1)
{
  uint *v1;
  int v2;
  int result;

  v1 = *(uint **)(a1 + 244);
  v2 = *(uint *)(a1 + 4);
  result = 0xFFFF;
  do
  {
    if ( *v1 != 0xFFFF )
      *v1 = 0xFFFF;
    v1 += 2;
    --v2;
  }
  while ( v2 );
  return result;
}

//----- (021ED1C8) --------------------------------------------------------
int __fastcall Function_21ed1c8(int a1, uint *a2, int a3)
{
  int v3;
  uint *v4;
  int v5;
  int v6;
  int v7;
  uint *v9;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = GetNrOfSpritesInList(a1);
  v9 = (uint *)GetSpriteList_124_1(v3);
  do
  {
    if ( v9 != v4 && CheckSpriteFlag_Locked(v9) == 1 )
    {
      v7 = GetSpriteGraphic((int)v9);
      if ( IsValueSpriteBerrytree(v7) == 1 )
        v7 = Function_2067800((int)v9);
      if ( v7 != 0xFFFF && v7 == v5 )
        return 1;
    }
    GetAdrOfNextSprite(&v9);
    --v6;
  }
  while ( v6 );
  return 0;
}

//----- (021ED224) --------------------------------------------------------
int __fastcall Function_21ed224(int a1, int a2, int a3, int a4, int a5, int a6, int a7)
{
  int v7;
  int v8;
  int v9;
  int v10;
  int **v11;

  v7 = a2;
  v8 = a1;
  v9 = a3;
  v10 = a4;
  *(uint *)(a1 + 248) = Function_21f067c(4, 64, v7 << 12, v7);
  Function_21ed558(v8);
  Function_21edcc4(v8, v9);
  Function_21edccc(v8, v7 - v9);
  *(uint *)(v8 + 252) = Function_21f067c(4, 65, v10 << 7, v10);
  Function_21ed694(v8);
  Function_21edcd4(v8, a5);
  Function_21edcdc(v8, v10 - a5);
  v11 = Function_2022bd8(a6, 4u);
  Function_21edca8(v8, v11);
  Function_21ed7d0(v8);
  Function_21edce4(v8, a7);
  return Function_21edcec(v8, a6 - a7);
}

//----- (021ED2AC) --------------------------------------------------------
uint __fastcall Function_21ed2ac(int a1)
{
  int v1;
  int *v2;

  v1 = a1;
  Function_21f06d8(*(uint *)(a1 + 248));
  Function_21f06d8(*(uint *)(v1 + 252));
  v2 = (int *)Function_5_21edcb0(v1);
  return Function_2022c1c(v2);
}

//----- (021ED2D0) --------------------------------------------------------
uint *__fastcall Function_21ed2d0(int a1, int a2, uint *a3)
{
  do
  {
    if ( *a3 == a1 )
      return a3;
    a3 += 2;
  }
  while ( *a3 != a2 );
  return 0;
}

//----- (021ED2E8) --------------------------------------------------------
int __fastcall Function_21ed2e8(int a1, int a2, int a3, int a4, uint *a5)
{
  int v5;
  int v6;
  int v7;
  int v8;
  uint *v10;
  int v11;

  v5 = a2;
  v6 = a3;
  v7 = a1;
  v8 = a4;
  if ( Function_21f0770(a2, a3) == 1 )
    return 0;
  v10 = Function_21ed2d0(v6, v8, a5);
  if ( !v10 )
    ErrorHandler();
  v11 = GetSpriteListNARCFileHandlerOfMModel(*(uint *)(v7 + 260));
  Function_21f0784(v5, v6, v11, v10[1], 0);
  return 1;
}

//----- (021ED334) --------------------------------------------------------
int __fastcall Function_21ed334(int a1, int a2, int a3, uint *a4)
{
  int v4;
  int v5;
  int v6;
  uint *v7;
  int result;
  uint *v9;

  v4 = a1;
  v5 = a3;
  v6 = a2;
  v7 = a4;
  if ( !Function_2022c40(*(int **)(a1 + 240), a3) )
    return 0;
  if ( Function_21edff0(v4, v5) )
    return 1;
  v9 = Function_21ed2d0(v5, 0xFFFF, v7);
  if ( v9 )
    result = Function_21edf3c(v4, v5, v9[1], v6) != 1;
  else
    result = 2;
  return result;
}

//----- (021ED390) --------------------------------------------------------
int __fastcall Function_21ed390(int a1, int a2)
{
  return Function_21ed334(a1, 0, a2, &dword_21FC9B4);
}

//----- (021ED3A4) --------------------------------------------------------
int __fastcall Function_21ed3a4(int a1, int a2)
{
  return Function_21ed334(a1, 1, a2, &dword_21FC9B4);
}

//----- (021ED3B8) --------------------------------------------------------
int __fastcall Function_21ed3b8(int a1, int *a2)
{
  int *v2;
  int v3;
  int v4;
  int result;

  v2 = a2;
  v3 = a1;
  v4 = *a2;
  result = 0xFFFF;
  if ( v4 != 0xFFFF )
  {
    do
    {
      result = Function_21ed390(v3, v4);
      ++v2;
      v4 = *v2;
    }
    while ( *v2 != 0xFFFF );
  }
  return result;
}

//----- (021ED3DC) --------------------------------------------------------
int __fastcall Function_21ed3dc(int a1, int a2)
{
  int v2;
  int v3;

  v2 = a1;
  v3 = a2;
  Function_21edc98(a1);
  Function_21ed2e8(v2, *(uint *)(v2 + 248), v3, 0xFFFF, &dword_21FB484);
  return Function_21ed56c(v2, v3);
}

//----- (021ED40C) --------------------------------------------------------
int __fastcall Function_21ed40c(int a1, int a2)
{
  int v2;
  int v3;

  v2 = a1;
  v3 = a2;
  Function_21edc98(a1);
  Function_21ed2e8(v2, *(uint *)(v2 + 248), v3, 0xFFFF, &dword_21FB484);
  return Function_21ed5b4(v2, v3);
}

//----- (021ED43C) --------------------------------------------------------
int __fastcall Function_21ed43c(int a1, int *a2)
{
  int *v2;
  int v3;
  int v4;
  int result;

  v2 = a2;
  v3 = a1;
  v4 = *a2;
  result = 0xFFFF;
  if ( v4 != 0xFFFF )
  {
    do
    {
      result = Function_21ed3dc(v3, v4);
      ++v2;
      v4 = *v2;
    }
    while ( *v2 != 0xFFFF );
  }
  return result;
}

//----- (021ED460) --------------------------------------------------------
int __fastcall Function_21ed460(int a1, int a2)
{
  int v2;
  int v3;

  v2 = a1;
  v3 = a2;
  Function_21edca0(a1);
  Function_21ed2e8(v2, *(uint *)(v2 + 252), v3, 0xFFFF, &dword_21FB5BC);
  return Function_21ed6a8(v2, v3);
}

//----- (021ED490) --------------------------------------------------------
int __fastcall Function_21ed490(int a1, int a2)
{
  int v2;
  int v3;

  v2 = a1;
  v3 = a2;
  Function_21edca0(a1);
  Function_21ed2e8(v2, *(uint *)(v2 + 252), v3, 0xFFFF, &dword_21FB5BC);
  return Function_21ed6f0(v2, v3);
}

//----- (021ED4C0) --------------------------------------------------------
int __fastcall Function_21ed4c0(int a1, int *a2)
{
  int *v2;
  int v3;
  int v4;
  int result;

  v2 = a2;
  v3 = a1;
  v4 = *a2;
  result = 0xFFFF;
  if ( v4 != 0xFFFF )
  {
    do
    {
      result = Function_21ed460(v3, v4);
      ++v2;
      v4 = *v2;
    }
    while ( *v2 != 0xFFFF );
  }
  return result;
}

//----- (021ED4E4) --------------------------------------------------------
int __fastcall Function_21ed4e4(int a1, int *a2, int *a3, int *a4)
{
  int v4;
  int *v5;
  int *v6;

  v4 = a1;
  v5 = a3;
  v6 = a4;
  Function_21ed3b8(a1, a2);
  Function_21ed43c(v4, v5);
  return Function_21ed4c0(v4, v6);
}

//----- (021ED504) --------------------------------------------------------
uint *__fastcall Function_21ed504(uint *result, int a2, int a3)
{
  do
  {
    *result = a2;
    ++result;
    --a3;
  }
  while ( a3 );
  return result;
}

//----- (021ED50C) --------------------------------------------------------
int __fastcall Function_21ed50c(uint *a1, int a2, int a3, int a4)
{
  do
  {
    if ( *a1 == a3 )
    {
      *a1 = a2;
      return 1;
    }
    ++a1;
    --a4;
  }
  while ( a4 );
  return 0;
}

//----- (021ED528) --------------------------------------------------------
int __fastcall Function_21ed528(uint *a1, int a2, int a3)
{
  do
  {
    if ( *a1 == a2 )
      return 1;
    ++a1;
    --a3;
  }
  while ( a3 );
  return 0;
}

//----- (021ED53C) --------------------------------------------------------
int __fastcall Function_21ed53c(uint *a1, int a2, int a3, int a4)
{
  do
  {
    if ( *a1 == a2 )
    {
      *a1 = a3;
      return 1;
    }
    ++a1;
    --a4;
  }
  while ( a4 );
  return 0;
}

//----- (021ED558) --------------------------------------------------------
uint *Function_21ed558()
{
  uint *v0;

  v0 = (uint *)Function_21edcbc();
  return Function_21ed504(v0, 0xFFFF, 8);
}

//----- (021ED56C) --------------------------------------------------------
uint __fastcall Function_21ed56c(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  uint *v5;
  uint result;

  v2 = a1;
  v3 = a2;
  v4 = Function_21edcc8();
  v5 = (uint *)Function_21edcbc(v2);
  result = Function_21ed50c(v5, v3, 0xFFFF, v4);
  if ( !result )
    result = ErrorHandler();
  return result;
}

//----- (021ED598) --------------------------------------------------------
int __fastcall Function_21ed598(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  uint *v5;

  v2 = a1;
  v3 = a2;
  v4 = Function_21edcc8();
  v5 = (uint *)Function_21edcbc(v2);
  return Function_21ed528(v5, v3, v4);
}

//----- (021ED5B4) --------------------------------------------------------
uint __fastcall Function_21ed5b4(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;
  uint result;

  v2 = a1;
  v3 = a2;
  v4 = Function_21edcbc(a1);
  v5 = 4 * Function_21edcc8(v2);
  v6 = Function_21edcd0(v2);
  result = Function_21ed50c((uint *)(v4 + v5), v3, 0xFFFF, v6);
  if ( !result )
    result = ErrorHandler();
  return result;
}

//----- (021ED5E8) --------------------------------------------------------
int __fastcall Function_21ed5e8(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;

  v2 = a1;
  v3 = a2;
  v4 = Function_21edcbc(a1);
  v5 = 4 * Function_21edcc8(v2);
  v6 = Function_21edcd0(v2);
  return Function_21ed528((uint *)(v4 + v5), v3, v6);
}

//----- (021ED610) --------------------------------------------------------
int __fastcall Function_21ed610(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;

  v2 = a1;
  v3 = a2;
  v4 = Function_21edcbc(a1);
  v5 = 4 * Function_21edcc8(v2);
  v6 = Function_21edcd0(v2);
  return Function_21ed53c((uint *)(v4 + v5), v3, 0xFFFF, v6);
}

//----- (021ED63C) --------------------------------------------------------
int __fastcall Function_21ed63c(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int *v5;
  int v6;
  int result;
  int v8;

  v2 = a2;
  v3 = a1;
  Function_21edc98(a2);
  v4 = Function_21edcbc(v2);
  v5 = (int *)(v4 + 4 * Function_21edcc8(v2));
  v6 = Function_21edcd0(v2);
  do
  {
    result = 0xFFFF;
    if ( *v5 != 0xFFFF )
    {
      result = Function_21edab4(v3);
      if ( !result )
      {
        v8 = *v5;
        Function_21f0740(*(uint *)(v2 + 248));
        result = 0xFFFF;
        *v5 = 0xFFFF;
      }
    }
    ++v5;
    --v6;
  }
  while ( v6 );
  return result;
}

//----- (021ED694) --------------------------------------------------------
uint *Function_21ed694()
{
  uint *v0;

  v0 = (uint *)Function_21edcc0();
  return Function_21ed504(v0, 0xFFFF, 8);
}

//----- (021ED6A8) --------------------------------------------------------
uint __fastcall Function_21ed6a8(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  uint *v5;
  uint result;

  v2 = a1;
  v3 = a2;
  v4 = Function_21edcd8();
  v5 = (uint *)Function_21edcc0(v2);
  result = Function_21ed50c(v5, v3, 0xFFFF, v4);
  if ( !result )
    result = ErrorHandler();
  return result;
}

//----- (021ED6D4) --------------------------------------------------------
int __fastcall Function_21ed6d4(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  uint *v5;

  v2 = a1;
  v3 = a2;
  v4 = Function_21edcd8();
  v5 = (uint *)Function_21edcc0(v2);
  return Function_21ed528(v5, v3, v4);
}

//----- (021ED6F0) --------------------------------------------------------
uint __fastcall Function_21ed6f0(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;
  uint result;

  v2 = a1;
  v3 = a2;
  v4 = Function_21edcc0(a1);
  v5 = 4 * Function_21edcd8(v2);
  v6 = Function_21edce0(v2);
  result = Function_21ed50c((uint *)(v4 + v5), v3, 0xFFFF, v6);
  if ( !result )
    result = ErrorHandler();
  return result;
}

//----- (021ED724) --------------------------------------------------------
int __fastcall Function_21ed724(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;

  v2 = a1;
  v3 = a2;
  v4 = Function_21edcc0(a1);
  v5 = 4 * Function_21edcd8(v2);
  v6 = Function_21edce0(v2);
  return Function_21ed528((uint *)(v4 + v5), v3, v6);
}

//----- (021ED74C) --------------------------------------------------------
int __fastcall Function_21ed74c(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;

  v2 = a1;
  v3 = a2;
  v4 = Function_21edcc0(a1);
  v5 = 4 * Function_21edcd8(v2);
  v6 = Function_21edce0(v2);
  return Function_21ed53c((uint *)(v4 + v5), v3, 0xFFFF, v6);
}

//----- (021ED778) --------------------------------------------------------
int __fastcall Function_21ed778(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int *v5;
  int v6;
  int result;
  int v8;

  v2 = a2;
  v3 = a1;
  Function_21edca0(a2);
  v4 = Function_21edcc0(v2);
  v5 = (int *)(v4 + 4 * Function_21edcd8(v2));
  v6 = Function_21edce0(v2);
  do
  {
    result = 0xFFFF;
    if ( *v5 != 0xFFFF )
    {
      result = Function_21edb3c(v3);
      if ( !result )
      {
        v8 = *v5;
        Function_21f0740(*(uint *)(v2 + 252));
        result = 0xFFFF;
        *v5 = 0xFFFF;
      }
    }
    ++v5;
    --v6;
  }
  while ( v6 );
  return result;
}

//----- (021ED7D0) --------------------------------------------------------
uint *Function_21ed7d0()
{
  uint *v0;

  v0 = (uint *)Function_21edcb8();
  return Function_21ed504(v0, 0xFFFF, 32);
}

//----- (021ED7E4) --------------------------------------------------------
uint __fastcall Function_21ed7e4(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  uint *v5;
  uint result;

  v2 = a1;
  v3 = a2;
  v4 = Function_21edce8();
  v5 = (uint *)Function_21edcb8(v2);
  result = Function_21ed50c(v5, v3, 0xFFFF, v4);
  if ( !result )
    result = ErrorHandler();
  return result;
}

//----- (021ED810) --------------------------------------------------------
int __fastcall Function_21ed810(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  uint *v5;

  v2 = a1;
  v3 = a2;
  v4 = Function_21edce8();
  v5 = (uint *)Function_21edcb8(v2);
  return Function_21ed528(v5, v3, v4);
}

//----- (021ED82C) --------------------------------------------------------
int __fastcall Function_21ed82c(int a1, int a2)
{
  int v2;
  int v3;

  v2 = a1;
  v3 = a2;
  if ( Function_21ed810(a1, a2) == 1 )
    return 1;
  if ( Function_21ed924(v2, v3) == 1 )
    return 2;
  return Function_21edff0(v2, v3);
}

//----- (021ED858) --------------------------------------------------------
uint __fastcall Function_21ed858(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;
  uint result;

  v2 = a1;
  v3 = a2;
  v4 = Function_21edcb8(a1);
  v5 = 4 * Function_21edce8(v2);
  v6 = Function_21edcf0(v2);
  result = Function_21ed50c((uint *)(v4 + v5), v3, 0xFFFF, v6);
  if ( !result )
    result = ErrorHandler();
  return result;
}

//----- (021ED88C) --------------------------------------------------------
int __fastcall Function_21ed88c(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;

  v2 = a1;
  v3 = a2;
  v4 = Function_21edcb8(a1);
  v5 = 4 * Function_21edce8(v2);
  v6 = Function_21edcf0(v2);
  return Function_21ed53c((uint *)(v4 + v5), v3, 0xFFFF, v6);
}

//----- (021ED8B8) --------------------------------------------------------
int __fastcall Function_21ed8b8(int a1, int a2)
{
  int v2;
  int v3;
  int *v4;
  int v5;
  int v6;
  int result;
  int v8;
  int *v9;

  v2 = a2;
  v8 = a1;
  v9 = (int *)Function_5_21edcb0(a2);
  v3 = Function_21edcb8(v2);
  v4 = (int *)(v3 + 4 * Function_21edce8(v2));
  v5 = Function_21edcf0(v2);
  do
  {
    v6 = *v4;
    result = 0xFFFF;
    if ( *v4 != 0xFFFF )
    {
      result = Function_21eda54(v8, *v4, 0);
      if ( !result )
      {
        Function_2022d38(v9, v6);
        Function_21edfbc(v2, v6);
        Function_21ee170(v2, v6);
        result = 0xFFFF;
        *v4 = 0xFFFF;
      }
    }
    ++v4;
    --v5;
  }
  while ( v5 );
  return result;
}

//----- (021ED924) --------------------------------------------------------
int __fastcall Function_21ed924(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;

  v2 = a1;
  v3 = a2;
  v4 = Function_21edcb8(a1);
  v5 = 4 * Function_21edce8(v2);
  v6 = Function_21edcf0(v2);
  return Function_21ed528((uint *)(v4 + v5), v3, v6);
}

//----- (021ED94C) --------------------------------------------------------
int __fastcall Function_21ed94c(int a1, int a2)
{
  int v2;
  int v3;

  v2 = a1;
  v3 = a2;
  if ( Function_21ed810(a1, a2) == 1 )
    return 0;
  if ( Function_21ed924(v2, v3) == 1 )
    return 1;
  return 2;
}

//----- (021ED974) --------------------------------------------------------
int __fastcall Function_21ed974(int a1, int a2)
{
  int v2;
  int v3;

  v2 = a1;
  v3 = a2;
  if ( Function_21ed598(a1, a2) == 1 )
    return 0;
  if ( Function_21ed5e8(v2, v3) == 1 )
    return 1;
  return 2;
}

//----- (021ED99C) --------------------------------------------------------
int __fastcall Function_21ed99c(int a1, int a2)
{
  int v2;
  int v3;

  v2 = a1;
  v3 = a2;
  if ( Function_21ed6d4(a1, a2) == 1 )
    return 0;
  if ( Function_21ed724(v2, v3) == 1 )
    return 1;
  return 2;
}

//----- (021ED9C4) --------------------------------------------------------
int __fastcall Function_21ed9c4(int a1, int a2)
{
  int v2;
  int v3;
  int result;

  v2 = a1;
  v3 = a2;
  result = Function_21ed82c(a1, a2);
  if ( !result )
    result = Function_21ed3a4(v2, v3);
  return result;
}

//----- (021ED9DC) --------------------------------------------------------
int __fastcall Function_21ed9dc(int a1, int a2)
{
  int v2;
  int v3;
  int result;

  v2 = a1;
  v3 = a2;
  result = Function_21ed974(a1, a2);
  if ( result == 2 )
    result = Function_21ed40c(v2, v3);
  return result;
}

//----- (021ED9F4) --------------------------------------------------------
int __fastcall Function_21ed9f4(int a1, int a2)
{
  int v2;
  int v3;
  int result;

  v2 = a1;
  v3 = a2;
  result = Function_21ed99c(a1, a2);
  if ( result == 2 )
    result = Function_21ed490(v2, v3);
  return result;
}

//----- (021EDA0C) --------------------------------------------------------
int __fastcall Function_21eda0c(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;

  v2 = a2;
  v3 = a1;
  v4 = Function_21edd2c(a2);
  Function_21ed9dc(v3, v4);
  v5 = Function_21edd38(v2);
  Function_21ed9f4(v3, v5);
  return Function_21ed9c4(v3, v2);
}

//----- (021EDA38) --------------------------------------------------------
int __fastcall Function_5_21eda38(int a1, int a2)
{
  int v2;
  int v3;

  v2 = a1;
  v3 = a2;
  Function_21ed63c(a1, a2);
  Function_21ed778(v2, v3);
  return Function_21ed8b8(v2, v3);
}

//----- (021EDA54) --------------------------------------------------------
int __fastcall Function_21eda54(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v9;
  int v10;
  int v11;

  v11 = a4;
  v4 = a2;
  v5 = a3;
  v10 = 0;
  v9 = 0;
  v6 = a1;
  if ( Function_20625b0(a1, &v9, &v10, 1) != 1 )
    return 0;
  while ( 1 )
  {
    if ( !v5 || v5 != v9 )
    {
      v7 = GetSpriteGraphic(v9);
      if ( IsValueSpriteBerrytree(v7) == 1 )
        v7 = Function_2067800(v9);
      if ( v7 == v4 )
        break;
    }
    if ( Function_20625b0(v6, &v9, &v10, 1) != 1 )
      return 0;
  }
  return 1;
}

//----- (021EDAB4) --------------------------------------------------------
int __fastcall Function_21edab4(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v9;
  int v10;
  int v11;

  v11 = a4;
  v4 = a2;
  v5 = a3;
  v10 = 0;
  v9 = 0;
  v6 = a1;
  if ( Function_20625b0(a1, &v9, &v10, 1) != 1 )
    return 0;
  while ( 1 )
  {
    if ( !v5 || v5 != v9 )
    {
      v7 = GetSpriteGraphic(v9);
      if ( v7 != 0xFFFF && (*(uint *)(Function_5_21ecd04(v9) + 4) & 0xF) == 1 )
      {
        if ( IsValueSpriteBerrytree(v7) == 1 )
          v7 = Function_2067800(v9);
        if ( v7 != 0xFFFF && v4 == Function_21edd2c(v7) )
          break;
      }
    }
    if ( Function_20625b0(v6, &v9, &v10, 1) != 1 )
      return 0;
  }
  return 1;
}

//----- (021EDB3C) --------------------------------------------------------
int __fastcall Function_21edb3c(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v9;
  int v10;
  int v11;

  v11 = a4;
  v5 = a2;
  v6 = a3;
  v10 = 0;
  v9 = 0;
  v7 = a1;
  if ( Function_20625b0(a1, &v9, &v10, 1) != 1 )
    return 0;
  while ( 1 )
  {
    if ( (!v6 || v9 != v6) && v4 != 0xFFFF && (*(uint *)(Function_5_21ecd04(v9) + 4) & 0xF) == 1 )
    {
      v4 = GetSpriteGraphic(v9);
      if ( IsValueSpriteBerrytree(v4) == 1 )
        v4 = Function_2067800(v9);
      if ( v4 != 0xFFFF && v5 == Function_21edd38(v4) )
        break;
    }
    if ( Function_20625b0(v7, &v9, &v10, 1) != 1 )
      return 0;
  }
  return 1;
}

//----- (021EDBC4) --------------------------------------------------------
int __fastcall Function_21edbc4(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int result;
  int v10;
  int *v11;
  int v12;
  int v13;

  v3 = a2;
  v4 = a1;
  v5 = a3;
  v6 = GetSpriteListAdr18(a1);
  v12 = Function_21edd2c(v3);
  if ( Function_21ed974(v6, v12) == 1 && !Function_21edab4(v4, v12, v5, v7) )
  {
    Function_21f0740(*(uint *)(v6 + 248));
    Function_21ed610(v6, v12);
  }
  v13 = Function_21edd38(v3);
  if ( Function_21ed99c(v6, v13) == 1 && !Function_21edb3c(v4, v13, v5, v8) )
  {
    Function_21f0740(*(uint *)(v6 + 252));
    Function_21ed74c(v6, v13);
  }
  result = Function_21ed94c(v6, v3);
  if ( result == 1 )
  {
    result = Function_21eda54(v4, v3, v5, v10);
    if ( !result )
    {
      v11 = (int *)Function_5_21edcb0(v6);
      Function_2022d38(v11, v3);
      Function_21ed88c(v6, v3);
      Function_21edfbc(v6, v3);
      result = Function_21ee170(v6, v3);
    }
  }
  return result;
}

//----- (021EDC84) --------------------------------------------------------
uint *__fastcall Function_21edc84(int a1, int a2)
{
  uint *result;

  result = (uint *)(a1 + 224);
  *result = a2;
  return result;
}

//----- (021EDC8C) --------------------------------------------------------
int __fastcall LoadSpriteList_18_e0(int a1)
{
  return *(uint *)(a1 + 224);
}

//----- (021EDC94) --------------------------------------------------------
int __fastcall Function_21edc94(int result, int a2)
{
  *(uint *)(result + 4) = a2;
  return result;
}

//----- (021EDC98) --------------------------------------------------------
int __fastcall Function_21edc98(int a1)
{
  return *(uint *)(a1 + 232);
}

//----- (021EDCA0) --------------------------------------------------------
int __fastcall Function_21edca0(int a1)
{
  return *(uint *)(a1 + 236);
}

//----- (021EDCA8) --------------------------------------------------------
uint *__fastcall Function_21edca8(int a1, int a2)
{
  uint *result;

  result = (uint *)(a1 + 240);
  *result = a2;
  return result;
}

//----- (021EDCB0) --------------------------------------------------------
int __fastcall Function_5_21edcb0(int a1)
{
  return *(uint *)(a1 + 240);
}

//----- (021EDCB8) --------------------------------------------------------
int __fastcall Function_21edcb8(int a1)
{
  return a1 + 96;
}

//----- (021EDCBC) --------------------------------------------------------
int __fastcall Function_21edcbc(int a1)
{
  return a1 + 32;
}

//----- (021EDCC0) --------------------------------------------------------
int __fastcall Function_21edcc0(int a1)
{
  return a1 + 64;
}

//----- (021EDCC4) --------------------------------------------------------
int __fastcall Function_21edcc4(int result, int a2)
{
  *(uint *)(result + 8) = a2;
  return result;
}

//----- (021EDCC8) --------------------------------------------------------
int __fastcall Function_21edcc8(int a1)
{
  return *(uint *)(a1 + 8);
}

//----- (021EDCCC) --------------------------------------------------------
int __fastcall Function_21edccc(int result, int a2)
{
  *(uint *)(result + 12) = a2;
  return result;
}

//----- (021EDCD0) --------------------------------------------------------
int __fastcall Function_21edcd0(int a1)
{
  return *(uint *)(a1 + 12);
}

//----- (021EDCD4) --------------------------------------------------------
int __fastcall Function_21edcd4(int result, int a2)
{
  *(uint *)(result + 16) = a2;
  return result;
}

//----- (021EDCD8) --------------------------------------------------------
int __fastcall Function_21edcd8(int a1)
{
  return *(uint *)(a1 + 16);
}

//----- (021EDCDC) --------------------------------------------------------
int __fastcall Function_21edcdc(int result, int a2)
{
  *(uint *)(result + 20) = a2;
  return result;
}

//----- (021EDCE0) --------------------------------------------------------
int __fastcall Function_21edce0(int a1)
{
  return *(uint *)(a1 + 20);
}

//----- (021EDCE4) --------------------------------------------------------
int __fastcall Function_21edce4(int result, int a2)
{
  *(uint *)(result + 24) = a2;
  return result;
}

//----- (021EDCE8) --------------------------------------------------------
int __fastcall Function_21edce8(int a1)
{
  return *(uint *)(a1 + 24);
}

//----- (021EDCEC) --------------------------------------------------------
int __fastcall Function_21edcec(int result, int a2)
{
  *(uint *)(result + 28) = a2;
  return result;
}

//----- (021EDCF0) --------------------------------------------------------
int __fastcall Function_21edcf0(int a1)
{
  return *(uint *)(a1 + 28);
}

//----- (021EDCF4) --------------------------------------------------------
int __fastcall Call_LoadFileFromMModel(int a1, uint a2, int a3)
{
  return LoadFileFromMModel(*(uint *)(a1 + 260), a2, a3);
}

//----- (021EDD04) --------------------------------------------------------
int *__fastcall Function_21edd04(int a1)
{
  int *v1;

  v1 = &dword_21FD77C;
  do
  {
    if ( *v1 == a1 )
      return v1;
    v1 += 4;
  }
  while ( *v1 != 0xFFFF );
  ErrorHandler();
  return 0;
}

//----- (021EDD2C) --------------------------------------------------------
int __fastcall Function_21edd2c(int a1)
{
  return Function_21edd04(a1)[1];
}

//----- (021EDD38) --------------------------------------------------------
int __fastcall Function_21edd38(int a1)
{
  return Function_21edd04(a1)[2];
}

//----- (021EDD44) --------------------------------------------------------
int __fastcall Function_21edd44(int a1)
{
  return Function_21edd04(a1)[3];
}

//----- (021EDD50) --------------------------------------------------------
int __fastcall Function_21edd50(int a1)
{
  int v1;
  int *v2;

  v1 = Function_21edd2c(a1);
  v2 = &dword_21FAF40;
  do
  {
    if ( *v2 == v1 )
      return 0;
    ++v2;
  }
  while ( *v2 != 0xFFFF );
  return 1;
}

//----- (021EDD78) --------------------------------------------------------
uint *__fastcall Function_21edd78(uint *a1, int a2)
{
  uint *result;

  if ( a2 == 1 )
    result = SetSpriteFlags(a1, 0x400000);
  else
    result = UnsetSpriteFlags(a1, 0x400000);
  return result;
}

//----- (021EDD94) --------------------------------------------------------
BOOL __fastcall Function_5_21edd94(uint *a1)
{
  return MaskSpriteFlags(a1, 0x400000) != 0;
}

//----- (021EDDAC) --------------------------------------------------------
int __fastcall Function_21eddac(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  uint *v6;
  int v8;
  int v9;
  int v10;

  v10 = a4;
  v4 = a1;
  v5 = a2;
  v9 = 4;
  v8 = a2;
  v6 = Function_2020c44((int)&v8);
  Function_21edc84(v4, (int)v6);
  return Function_21edc94(v4, v5);
}

//----- (021EDDD4) --------------------------------------------------------
int __fastcall Function_21eddd4(uchar *a1)
{
  return Function_2020ccc(a1);
}

//----- (021EDDDC) --------------------------------------------------------
uint __fastcall Function_21edddc(int a1, int a2, int *a3, int a4)
{
  int v4;
  int v5;
  int v6;
  uint v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  int v20;
  int v21;

  v21 = a4;
  v13 = a1;
  v14 = a2;
  v4 = a4;
  v5 = a3[1];
  v15 = *a3;
  v16 = v5;
  v17 = a3[2];
  v18 = 4096;
  v19 = 4096;
  v20 = 4096;
  v6 = Function_202119c((uint **)&v13);
  v7 = v6;
  if ( v6 )
  {
    Function_2021320(v6, 0);
    Function_2021344(v7, 0);
    Function_20213a4(v7, 0);
    v8 = Function_20213f4(v7);
    Function_20b37a4(v8, v4, v9, v10);
    v11 = Function_20213f4(v7);
    Function_21d53a4(v11);
  }
  return v7;
}

//----- (021EDE3C) --------------------------------------------------------
int __fastcall Function_21ede3c(int a1, int a2, uint *a3)
{
  int v3;
  int v4;
  uint *v5;
  int v6;
  int v7;
  uint *v8;
  uint *v9;
  int *v10;
  int result;

  v3 = a2;
  v4 = a1;
  v5 = a3;
  v6 = Function_21edd2c(a2);
  *v5 = Function_21f075c(*(uint *)(v4 + 248), v6);
  v7 = Function_21edd38(v3);
  v8 = (uint *)Function_21f075c(*(uint *)(v4 + 252), v7);
  Function_2024184(v8, v5 + 3);
  v9 = (uint *)Function_5_21edcb0(v4);
  v10 = (int *)Function_2022d98(v9, v3);
  v5[1] = Function_2022df4(v10);
  v5[7] = Function_2022ef4((int)v10);
  v5[8] = Function_2022f04((int)v10);
  v5[9] = Function_2022f14((int)v10);
  result = Function_21edd44(v3);
  v5[2] = result;
  return result;
}

//----- (021EDEA8) --------------------------------------------------------
int __fastcall Function_21edea8(int a1)
{
  int v1;

  v1 = GetSpriteSpriteList(a1);
  return GetSpriteListAdr18(v1);
}

//----- (021EDEB4) --------------------------------------------------------
int __fastcall Function_5_21edeb4(uint *a1, uint *a2, int a3, int a4)
{
  uint *v4;
  char v6;
  int v7;
  int v8;

  v8 = a4;
  v4 = a2;
  Function_21ecda0(a1, &v6, a3, a4);
  v7 += 24576;
  Function_20212a8(v4, &v6);
  return 0;
}

//----- (021EDED8) --------------------------------------------------------
uint __fastcall Function_5_21eded8(uint *a1, uint a2)
{
  char v2;
  uint v3;
  uint *v4;

  v2 = 1;
  v3 = a2;
  v4 = a1;
  if ( CheckSpriteFlags(a1, 512) == 1 )
    v2 = 0;
  if ( CheckSpriteFlags(v4, 4096) == 1 && !CheckSpriteFlags(v4, 0x2000) )
    v2 = 0;
  return Function_2021320(v3, v2);
}

//----- (021EDF18) --------------------------------------------------------
int __fastcall Function_21edf18(int a1)
{
  return dword_21FF4C0[a1];
}

//----- (021EDF24) --------------------------------------------------------
int __fastcall Function_21edf24(int a1)
{
  return dword_21FF4D0[a1];
}

//----- (021EDF30) --------------------------------------------------------
int __fastcall Function_21edf30(int a1)
{
  return dword_21FF4E0[a1];
}

//----- (021EDF3C) --------------------------------------------------------
int __fastcall Function_21edf3c(int a1, uint a2, uint a3, uint a4)
{
  int v4;
  short *v5;
  uint v6;
  uint v7;
  int v8;
  int v9;
  uint *v10;
  int result;
  int v12;
  uint v13;

  v4 = a1;
  v5 = *(short **)(a1 + 256);
  v6 = a2;
  v7 = a3;
  v13 = a4;
  if ( v5[2] < v5[1] && Function_2020d50(*(uint *)(a1 + 224)) != 1 )
  {
    v12 = Call_LoadFileFromMModel(v4, v7, 0);
    Function_21ee0e8(v4, v6, v12, v13);
    ++v5[2];
    result = 1;
  }
  else
  {
    v8 = 0;
    v9 = *v5;
    v10 = (uint *)*((uint *)v5 + 3);
    if ( v9 <= 0 )
    {
LABEL_7:
      ErrorHandler();
      result = 0;
    }
    else
    {
      while ( v10[3] )
      {
        ++v8;
        v10 += 4;
        if ( v8 >= v9 )
          goto LABEL_7;
      }
      v10[3] = *(uint *)(v4 + 240);
      v10[2] = v13;
      v10[1] = v6;
      *v10 = v7;
      result = 0;
    }
  }
  return result;
}

//----- (021EDFBC) --------------------------------------------------------
short *__fastcall Function_21edfbc(int a1, short *a2)
{
  short *result;
  int v3;
  int v4;
  int v5;

  result = *(short **)(a1 + 256);
  v3 = 0;
  v4 = *result;
  v5 = *((uint *)result + 3);
  if ( v4 > 0 )
  {
    while ( 1 )
    {
      result = *(short **)(v5 + 4);
      if ( result == a2 )
      {
        result = *(short **)(v5 + 12);
        if ( result )
          break;
      }
      ++v3;
      v5 += 16;
      if ( v3 >= v4 )
        return result;
    }
    result = 0;
    *(uint *)(v5 + 12) = 0;
  }
  return result;
}

//----- (021EDFF0) --------------------------------------------------------
int __fastcall Function_21edff0(int a1, int a2)
{
  short *v2;
  int v3;
  int v4;
  uint *v5;
  int result;

  v2 = *(short **)(a1 + 256);
  v3 = 0;
  v4 = *v2;
  v5 = (uint *)*((uint *)v2 + 3);
  if ( v4 <= 0 )
    return 0;
  while ( v5[1] != a2 || !v5[3] )
  {
    ++v3;
    v5 += 4;
    if ( v3 >= v4 )
      return 0;
  }
  if ( v5[2] )
    result = 4;
  else
    result = 3;
  return result;
}

//----- (021EE030) --------------------------------------------------------
BOOL __fastcall Function_21ee030(int a1, int a2)
{
  short *v2;
  int v3;
  uint *v4;
  BOOL result;
  int v6;
  int v7;
  int v8;
  int v9;
  uint *v10;
  int v11;
  int v12;
  uint *v13;
  int v14;
  uint *v15;
  int v16;
  int v17;

  v17 = a2;
  v2 = *(short **)(a2 + 256);
  v3 = 0;
  v4 = (uint *)*((uint *)v2 + 3);
  result = Function_2020d50(*(uint *)(a2 + 224));
  if ( result != 1 )
  {
    while ( v2[2] < v2[1] && v3 < *v2 )
    {
      if ( v4[3] )
      {
        v6 = Call_LoadFileFromMModel(v17, *v4, 0);
        Function_21ee0e8(v17, v4[1], v6, v4[2]);
        v4[3] = 0;
        ++v2[2];
      }
      v4 += 4;
      ++v3;
    }
    v7 = 0;
    v8 = *v2;
    v9 = *((uint *)v2 + 3);
    if ( v8 - 1 > 0 )
    {
      v10 = (uint *)*((uint *)v2 + 3);
      do
      {
        if ( !v10[3] )
        {
          v11 = v7 + 1;
          if ( v7 + 1 < v8 )
          {
            v12 = v9 + 16 * v11;
            while ( !*(uint *)(v12 + 12) )
            {
              ++v11;
              v12 += 16;
              if ( v11 >= v8 )
                goto LABEL_16;
            }
            v13 = (uint *)(v9 + 16 * v11);
            v14 = v13[1];
            *v10 = *v13;
            v10[1] = v14;
            v15 = v10 + 2;
            v16 = v13[3];
            *v15 = v13[2];
            v15[1] = v16;
            v13[3] = 0;
          }
        }
LABEL_16:
        v8 = *v2;
        ++v7;
        v10 += 4;
      }
      while ( v7 < v8 - 1 );
    }
    result = 0;
    v2[2] = 0;
  }
  return result;
}

//----- (021EE0E8) --------------------------------------------------------
uint __fastcall Function_21ee0e8(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  uint result;

  v4 = a1;
  v5 = a2;
  v6 = a4;
  if ( !Function_2022c9c(*(uint **)(a1 + 240), a3, a2, 1, 4u) )
    ErrorHandler();
  Function_21ee134(v4, v5);
  if ( v6 )
    result = Function_21ed858(v4, v5);
  else
    result = Function_21ed7e4(v4, v5);
  return result;
}

//----- (021EE134) --------------------------------------------------------
uint __fastcall Function_21ee134(int a1, int a2)
{
  short *v2;
  uint *v3;
  int v4;
  int v5;
  uint result;

  v2 = *(short **)(a1 + 256);
  v3 = (uint *)*((uint *)v2 + 4);
  v4 = 0;
  v2[3] = 1;
  v5 = *v2;
  if ( v5 <= 0 )
    return ErrorHandler();
  while ( v3[2] )
  {
    ++v4;
    v3 += 3;
    if ( v4 >= v5 )
      return ErrorHandler();
  }
  v3[2] = *(uint *)(a1 + 240);
  v3[1] = a2;
  result = 0;
  *v3 = 0;
  v2[3] = 0;
  return result;
}

//----- (021EE170) --------------------------------------------------------
int __fastcall Function_21ee170(int a1, int a2)
{
  short *v2;
  uint *v3;
  int v4;
  int v5;
  int result;

  v2 = *(short **)(a1 + 256);
  v3 = (uint *)*((uint *)v2 + 4);
  v4 = 0;
  v2[3] = 1;
  v5 = *v2;
  if ( v5 > 0 )
  {
    while ( !v3[2] || v3[1] != a2 )
    {
      ++v4;
      v3 += 3;
      if ( v4 >= v5 )
        goto LABEL_6;
    }
    v3[2] = 0;
    *v3 = 0;
  }
LABEL_6:
  result = 0;
  v2[3] = 0;
  return result;
}

//----- (021EE1AC) --------------------------------------------------------
int __fastcall Function_21ee1ac(int a1, int a2)
{
  short *v2;
  int result;
  int v4;
  uint *v5;
  uint *v6;

  v2 = *(short **)(a2 + 256);
  result = (ushort)v2[3];
  if ( result != 1 )
  {
    v4 = 0;
    result = *v2;
    v5 = (uint *)*((uint *)v2 + 4);
    if ( result > 0 )
    {
      do
      {
        if ( !*v5 )
        {
          v6 = (uint *)v5[2];
          if ( v6 )
          {
            Function_2022e38(v6, v5[1]);
            *v5 = 1;
          }
        }
        result = *v2;
        ++v4;
        v5 += 3;
      }
      while ( v4 < result );
    }
  }
  return result;
}

//----- (021EE1E8) --------------------------------------------------------
int __fastcall Function_21ee1e8(int a1, int a2)
{
  short *v2;
  int v3;
  uint *v4;
  uint *v5;
  int result;

  v2 = *(short **)(a2 + 256);
  v3 = 0;
  v4 = (uint *)*((uint *)v2 + 4);
  for ( v2[3] = 1; v3 < *v2; v4 += 3 )
  {
    if ( *v4 == 1 )
    {
      v5 = (uint *)v4[2];
      if ( v5 )
      {
        Function_2022ea0(v5, v4[1]);
        *v4 = 0;
        v4[2] = 0;
      }
    }
    ++v3;
  }
  result = 0;
  v2[3] = 0;
  return result;
}

//----- (021EE228) --------------------------------------------------------
uint *__fastcall Function_21ee228(int a1, uint *a2, int a3, int a4)
{
  short *v4;
  int v5;
  int v6;
  uint *v7;

  v4 = *(short **)(a1 + 256);
  v5 = 0;
  v6 = *v4;
  v7 = (uint *)*((uint *)v4 + 2);
  if ( v6 <= 0 )
    return (uint *)ErrorHandler();
  while ( v7[1] )
  {
    ++v5;
    v7 += 3;
    if ( v5 >= v6 )
      return (uint *)ErrorHandler();
  }
  v7[1] = a2;
  v7[2] = a3;
  *v7 = a4;
  *(uint *)v7[2] = 0;
  return Function_21edd78(a2, 1);
}

//----- (021EE264) --------------------------------------------------------
short *__fastcall Function_21ee264(int a1, short *a2)
{
  short *result;
  int v3;
  int v4;
  int v5;

  result = *(short **)(a1 + 256);
  v3 = 0;
  v4 = *result;
  v5 = *((uint *)result + 2);
  if ( v4 > 0 )
  {
    while ( 1 )
    {
      result = *(short **)(v5 + 4);
      if ( result == a2 )
        break;
      ++v3;
      v5 += 12;
      if ( v3 >= v4 )
        return result;
    }
    result = 0;
    *(uint *)(v5 + 4) = 0;
    *(uint *)(v5 + 8) = 0;
  }
  return result;
}

//----- (021EE294) --------------------------------------------------------
int __fastcall Function_21ee294(int a1)
{
  int v1;
  short *v2;
  int v3;
  int result;
  int v5;

  v1 = a1;
  v2 = *(short **)(a1 + 256);
  v3 = 0;
  result = *v2;
  v5 = *((uint *)v2 + 2);
  if ( result > 0 )
  {
    do
    {
      if ( *(uint *)(v5 + 4) )
        Function_21ee2d0(v1, v5);
      result = *v2;
      ++v3;
      v5 += 12;
    }
    while ( v3 < result );
  }
  return result;
}

//----- (021EE2C4) --------------------------------------------------------
int __fastcall Function_21ee2c4(int a1, int a2)
{
  return Function_21ee294(a2);
}

//----- (021EE2D0) --------------------------------------------------------
int __fastcall Function_21ee2d0(int a1, int *a2)
{
  int *v2;
  int result;
  bool v4;
  int v5;

  v2 = a2;
  result = Function_21ed94c(a1, *a2);
  if ( result != 2 )
  {
    *(uint *)v2[2] = Function_21ecf1c((uint *)v2[1], *v2);
    if ( !*(uint *)v2[2] )
      ErrorHandler();
    Function_21edd78((uint *)v2[1], 0);
    v4 = CheckSpriteFlags((uint *)v2[1], 0x200000) == 1;
    v5 = v2[1];
    if ( v4 )
      Function_2062ba4(v5);
    else
      Function_2062b68(v5);
    result = 0;
    v2[1] = 0;
    v2[2] = 0;
  }
  return result;
}

//----- (021EE320) --------------------------------------------------------
uint *__fastcall Function_21ee320(int a1, int a2, short a3)
{
  short v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  uint *result;
  short v10;
  int v11;
  int v12;

  v3 = a2;
  v4 = a1;
  v5 = 12 * a2;
  v11 = 16 * a2;
  v12 = 40 * a2 + 40;
  v10 = a3;
  v6 = malloc(4u, v12);
  if ( !v6 )
    ErrorHandler();
  Call_FillMemWithValue((int *)v6, 0, v12);
  *(ushort *)v6 = v3;
  *(ushort *)(v6 + 2) = v10;
  *(uint *)(v6 + 8) = v6 + 40;
  v7 = v6 + 40 + v5;
  *(uint *)(v6 + 12) = v7;
  *(uint *)(v6 + 16) = v7 + v11;
  *(uint *)(v4 + 256) = v6;
  v8 = GetSpriteListc(*(uint *)(v4 + 260));
  *(uint *)(v6 + 24) = AddTaskToTaskList1((int)Function_21ee030, v4, v8 + 1);
  *(uint *)(v6 + 28) = AddTaskToTaskList1((int)Function_21ee2c4, v4, v8 + 2);
  *(uint *)(v6 + 32) = AddTaskToTaskList2((int)Function_21ee1ac, v4, 0xFFu);
  result = AddTaskToTaskList3((int)Function_21ee1e8, v4, 0xFFu);
  *(uint *)(v6 + 36) = result;
  return result;
}

//----- (021EE3C4) --------------------------------------------------------
int __fastcall Function_21ee3c4(int a1)
{
  int v1;
  int v2;
  int result;

  v1 = a1;
  v2 = *(uint *)(a1 + 256);
  *(ushort *)(v2 + 6) = 1;
  Call_RemoveTaskFromTaskList(*(int **)(v2 + 24));
  Call_RemoveTaskFromTaskList(*(int **)(v2 + 28));
  Call_RemoveTaskFromTaskList(*(int **)(v2 + 32));
  Call_RemoveTaskFromTaskList(*(int **)(v2 + 36));
  free(v2);
  result = 256;
  *(uint *)(v1 + 256) = 0;
  return result;
}

//----- (021EE3FC) --------------------------------------------------------
int __fastcall Function_21ee3fc(uint *a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;

  v4 = (int)a1;
  v5 = a2;
  v6 = a3;
  v7 = a4;
  if ( Function_5_21edd94(a1) != 1 && Function_5_21eb1a0(v4) )
    return Function_21ee454(v4, v5, v6, v7);
  v8 = GetSpriteGraphic(v4);
  v9 = GetSpriteSpriteList(v4);
  Function_2061b48(v4);
  Function_21edbc4(v9, v8, v4);
  Function_2061ab4(v4, v5);
  return 0;
}

//----- (021EE454) --------------------------------------------------------
int __fastcall Function_21ee454(int a1, int a2, int a3, int a4)
{
  uint *v4;
  int *v5;
  int v6;
  int v7;
  int *v8;
  int v9;
  int v10;
  int *v11;
  int v12;
  uint *v13;
  int *v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int *v19;
  int v20;
  int v21;
  uint v22;
  int v23;
  short v24;
  int v25;
  int v26;
  int v27;
  int v28;
  int v29;
  int v30;
  int v31;
  uint *v32;
  int v34;
  int v35;
  int v36;
  int v37;
  int v38;
  int v39;
  int v40;
  int v41;
  char v42;
  int v43;
  int v44;
  int v45;
  int v46;

  v46 = a4;
  v4 = (uint *)a1;
  v34 = a2;
  v35 = a3;
  v36 = a4;
  v40 = Function_21edea8(a1);
  v39 = LoadSpriteList_18_e0(v40);
  v38 = Function_5_21eb1a0((int)v4);
  v5 = (int *)malloc2(4u, 96);
  Call_FillMemWithValue(v5, 0, 0x60u);
  *v5 = v34;
  v5[20] = (int)v4;
  v6 = GetSpriteGraphic((int)v4);
  v7 = Function_21edd2c(v6);
  v8 = &dword_21FB484;
  do
  {
    v9 = *v8;
    if ( *v8 == v7 )
      break;
    v8 += 2;
    v9 = *v8;
  }
  while ( *v8 != 0xFFFF );
  if ( v9 == 0xFFFF )
    ErrorHandler();
  v5[2] = Call_LoadFileFromMModel(v40, v8[1], 0);
  v10 = Function_21edd38(v6);
  v11 = &dword_21FB5BC;
  do
  {
    v12 = *v11;
    if ( *v11 == v10 )
      break;
    v11 += 2;
    v12 = *v11;
  }
  while ( *v11 != 0xFFFF );
  if ( v12 == 0xFFFF )
    ErrorHandler();
  v13 = (uint *)Call_LoadFileFromMModel(v40, v11[1], 0);
  v5[3] = (int)v13;
  Function_2024184(v13, v5 + 5);
  v14 = &dword_21FC9B4;
  do
  {
    v15 = *v14;
    if ( *v14 == v6 )
      break;
    v14 += 2;
    v15 = *v14;
  }
  while ( *v14 != 0xFFFF );
  if ( v15 == 0xFFFF )
    ErrorHandler();
  v16 = Call_LoadFileFromMModel(v40, v14[1], 0);
  v5[4] = v16;
  v17 = Function_20b3c1c_GetTexOffsets(v16);
  v18 = Function_21edd44(v6);
  Function_2021284(v5 + 10, v5[2], v17, v18, v5 + 5);
  v19 = (int *)Function_20212c0(v38);
  v20 = v19[1];
  v43 = *v19;
  v44 = v20;
  v45 = v19[2];
  v21 = Function_21edd50(v6);
  v22 = Function_21edddc(v39, (int)(v5 + 10), &v43, v21);
  v5[9] = v22;
  if ( !v22 )
    ErrorHandler();
  v41 = v5[9];
  v23 = Function_2021310(v38);
  Function_20212fc(v5[9], v23);
  v24 = Function_2021358(v38);
  Function_2021344(v5[9], v24);
  v25 = Function_20213d4(v38);
  Function_20213a4(v5[9], v25);
  v26 = Function_2021394(v38);
  Function_2021380(v5[9], v26);
  Function_2021368(v5[9], 0);
  Function_2021320(v5[9], 1);
  Function_2021414(v5[9], v27, v28);
  if ( IsSetSpriteFlags1000000(v4) == 1 )
  {
    v37 = Function_2062758((int)v4, 2);
    v29 = (uchar)Function_2064238((int)v4, 1);
    if ( Function_205df9c(v29) == 1 )
      v30 = 2;
    else
      v30 = Function_205de5c(v29) != 1;
    CopySprite70Struct(v4, &v42);
    v31 = Function_21df578((int)v4);
    v5[21] = Function_21f1ba4(v31, v5 + 10, v5[9], &v42, v30, v37);
  }
  Function_2061b48((int)v4);
  Function_21edbc4(*(uint *)(v40 + 260), v6, (int)v4);
  Function_2061ab4((int)v4, v34);
  GetSpriteListc(*(uint *)(v40 + 260));
  v32 = AddTaskToTaskList3((int)Function_21ee698, (int)v5, 0xFFu);
  if ( !v32 )
    ErrorHandler();
  Function_21ee698(v32, v5);
  if ( !Function_2021404(v5[9]) )
    return 0;
  v5[22] = v36;
  v5[23] = v35;
  return v41;
}

//----- (021EE698) --------------------------------------------------------
int __fastcall Function_21ee698(int *a1, int a2)
{
  int *v2;
  int v3;
  int result;
  uint *v5;
  void (__fastcall *v6)(uint, uint);
  int *v7;
  void (__fastcall *v8)(uint, uint);
  int *v9;

  v2 = a1;
  v3 = a2;
  result = *(short *)(a2 + 4);
  v5 = *(uint **)(a2 + 80);
  if ( *(ushort *)(a2 + 4) )
  {
    if ( result == 1 )
    {
      result = Function_5_21edd94(*(uint **)(a2 + 80));
      if ( !result )
      {
        v8 = *(void (__fastcall **)(uint, uint))(v3 + 92);
        if ( v8 )
          v8(*(uint *)(v3 + 88), *(uint *)(v3 + 36));
        v9 = *(int **)(v3 + 84);
        if ( v9 )
          Function_207136c(v9);
        Function_20211fc(*(uint *)(v3 + 36));
        free(*(uint *)(v3 + 8));
        free(*(uint *)(v3 + 12));
        free(*(uint *)(v3 + 16));
        free(v3);
        result = Call_RemoveTaskFromTaskList(v2);
      }
    }
  }
  else if ( CheckSpriteFlag_Locked(*(uint **)(a2 + 80)) && Function_5_21edd94(v5) )
  {
    result = GetSpriteGraphic((int)v5);
    if ( *(uint *)v3 != result )
    {
      result = *(short *)(v3 + 4) + 1;
      *(ushort *)(v3 + 4) = result;
    }
  }
  else
  {
    v6 = *(void (__fastcall **)(uint, uint))(v3 + 92);
    if ( v6 )
      v6(*(uint *)(v3 + 88), *(uint *)(v3 + 36));
    v7 = *(int **)(v3 + 84);
    if ( v7 )
      Function_207136c(v7);
    Function_20211fc(*(uint *)(v3 + 36));
    free(*(uint *)(v3 + 8));
    free(*(uint *)(v3 + 12));
    free(*(uint *)(v3 + 16));
    free(v3);
    result = Call_RemoveTaskFromTaskList(v2);
  }
  return result;
}

//----- (021EE75C) --------------------------------------------------------
int __fastcall Function_21ee75c(int a1, int a2, uint *a3)
{
  int result;

  result = 0;
  *a3 = 0;
  a3[1] = 0;
  return result;
}

//----- (021EE764) --------------------------------------------------------
void Function_21ee764()
{
  ;
}

//----- (021EE768) --------------------------------------------------------
int __fastcall Function_21ee768(int a1, int a2, int *a3)
{
  int v3;
  int *v4;
  int v5;
  int v6;
  int v7;
  int result;
  int v9;
  int v10;

  v3 = a2;
  v4 = a3;
  v5 = GetSpritePositionX(*(uint *)(a2 + 60));
  v7 = GetSpritePositionY(*(uint *)(v3 + 60));
  if ( *v4 != v5 || (result = v4[1], result != v7) )
  {
    *v4 = v5;
    v4[1] = v7;
    v9 = Function_2054f94(v3, v5, v7, v6);
    if ( Function_205dd84(v9) )
    {
      v10 = 0;
    }
    else
    {
      result = Function_205dd78(v9);
      if ( !result )
        return result;
      v10 = 1;
    }
    result = Function_21d4d78(v5, v7, v10, v3);
  }
  return result;
}

//----- (021EE7C0) --------------------------------------------------------
uint *__fastcall Function_21ee7c0(int a1)
{
  return Function_5_21d1b6c(*(uint **)(*(uint *)(a1 + 4) + 4), (int)&dword_21FF4F0);
}

//----- (021EE7D4) --------------------------------------------------------
uint __fastcall Function_21ee7d4(int *a1)
{
  int *v1;
  int v2;
  uint v3;
  uint v4;
  uint v5;
  uint v6;
  uint v7;

  v1 = a1;
  v2 = (ushort)GetPkmnData(a1, 0, 0);
  v3 = GetPkmnData(v1, 0x46u, 0) & 0xF;
  v4 = GetPkmnData(v1, 0x47u, 0) & 0xF;
  v5 = GetPkmnData(v1, 0x48u, 0) & 0xF;
  v6 = GetPkmnData(v1, 0x49u, 0) & 0xF;
  v7 = GetPkmnData(v1, 0x4Au, 0) & 0xF;
  return (((GetPkmnData(v1, 0x4Bu, 0) & 0xF ^ v7) * v6 ^ (v2 >> 8)) & 0xFFFF)
       + ((((uchar)v2 ^ (v4 ^ v5) * v3) << 8) & 0xFFFFFF);
}

//----- (021EE880) --------------------------------------------------------
int __fastcall Function_21ee880(uint a1)
{
  uint v1;

  v1 = 1;
  do
  {
    if ( a1 < LOWORD(dword_21FF508[2 * v1 + 1]) )
      return (v1 - 1) & 0xFF;
    v1 = (v1 + 1) & 0xFF;
  }
  while ( v1 < 0xF );
  return v1;
}

//----- (021EE8A8) --------------------------------------------------------
void __fastcall Function_21ee8a8(int a1, uint a2)
{
  int v2;
  uint v3;
  int *v4;
  int v5;
  int v6;
  int v7;
  int v8;
  long long v9;
  long long v10;
  long long v11;

  v2 = a1;
  v3 = a2;
  v4 = (int *)Function_2098700(4u);
  Function_209872c((int)v4, 0, 4u);
  v5 = Function_2098808(v4, v2);
  Function_20987bc(v4);
  Function_2098718((int)v4);
  v6 = 2 * Function_21ee880(v3);
  v7 = LOWORD(dword_21FF50C[v6]);
  v8 = *(ushort *)(v6 * 4 + 35648778);
  ll_udiv();
  v10 = v9;
  LODWORD(v9) = v5;
  v11 = LOWORD(dword_21FF508[v6]);
  HIDWORD(v9) = HIDWORD(v11);
  ll_mul(v9, v11 + v10);
  ll_udiv();
}

//----- (021EE920) --------------------------------------------------------
int __fastcall Function_5_21ee920(int a1, int a2)
{
  int v2;
  int v3;
  uint *v4;
  int v5;
  ushort v6;
  int v7;
  int v8;
  int v9;
  ushort v10;
  int v11;
  int v12;
  int v13;
  uint v14;
  int v15;
  uint v16;
  int *v18;

  v2 = a1;
  v3 = a2;
  v4 = (uint *)LoadPokePartyAdress(*(uint *)(a1 + 12));
  v18 = GetAdrOfPkmnInParty(v4, v3);
  v5 = (ushort)GetPkmnData(v18, 5u, 0);
  v6 = Function_21ee7d4(v18);
  Function_21ee8a8(v5, v6);
  v8 = v7;
  v9 = LoadFlagAdress(*(uint *)(v2 + 12));
  v10 = Function_206b0b4(v9);
  Function_21ee8a8(v5, v10);
  v12 = v11;
  v13 = u32_div_f(1000 * v8, 254);
  v14 = u32_div_f(v13 + 5, 10);
  v15 = u32_div_f(1000 * v12, 254);
  v16 = u32_div_f(v15 + 5, 10);
  if ( v14 == v16 )
    return 1;
  if ( v14 <= v16 )
    return 0;
  Function_206dc6c(v2, v8, v18);
  return 2;
}

//----- (021EE9BC) --------------------------------------------------------
int __fastcall Function_5_21ee9bc(int a1, int a2)
{
  int v2;
  int v3;
  uint *v4;
  int *v5;
  short v6;
  int v7;

  v2 = a1;
  v3 = a2;
  v4 = (uint *)LoadPokePartyAdress(*(uint *)(a1 + 12));
  v5 = GetAdrOfPkmnInParty(v4, v3);
  v6 = Function_21ee7d4(v5);
  v7 = LoadFlagAdress(*(uint *)(v2 + 12));
  return Function_206b0c4(v7, v6);
}

//----- (021EE9E8) --------------------------------------------------------
uint __fastcall Function_21ee9e8(int a1, uint a2, uint a3, int a4, ushort a5)
{
  uint v5;
  uint v6;
  int v7;
  int *v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;

  v5 = a2;
  v6 = a3;
  v7 = a4;
  v8 = (int *)ScriptHandler_GetSomeScriptAddresses(a1, 0xFu);
  Function_21ee8a8(v7, a5);
  v10 = u32_div_f(1000 * v9, 254);
  v11 = u32_div_f(v10 + 5, 10);
  v12 = v11;
  v13 = u32_div_f(v11, 10);
  Function_200b60c(*v8, v5, v13, 3, 0, 1);
  u32_div_f(v12, 10);
  return Function_200b60c(*v8, v6, v14, 1, 0, 1);
}

//----- (021EEA54) --------------------------------------------------------
uint __fastcall Function_5_21eea54(int a1, uint a2, uint a3, int a4)
{
  int v4;
  uint v5;
  uint v6;
  int v7;
  int v8;
  ushort v9;

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v7 = a4;
  v8 = LoadFlagAdress(*(uint *)(a1 + 12));
  v9 = Function_206b0b4(v8);
  return Function_21ee9e8(v4, v5, v6, v7, v9);
}

//----- (021EEA84) --------------------------------------------------------
uint __fastcall Function_5_21eea84(int a1, uint a2, uint a3, int a4)
{
  int v4;
  uint v5;
  int v6;
  uint v7;
  uint *v8;
  int *v9;
  int v10;
  ushort v11;

  v4 = a1;
  v5 = a3;
  v6 = a4;
  v7 = a2;
  v8 = (uint *)LoadPokePartyAdress(*(uint *)(a1 + 12));
  v9 = GetAdrOfPkmnInParty(v8, v6);
  v10 = (ushort)GetPkmnData(v9, 5u, 0);
  v11 = Function_21ee7d4(v9);
  return Function_21ee9e8(v4, v7, v5, v10, v11);
}

//----- (021EEAC8) --------------------------------------------------------
int __fastcall Function_21eeac8(int a1)
{
  int v1;
  int v2;
  uint v3;
  int v4;
  int v6;
  int v7;

  v1 = a1;
  v2 = malloc(4u, 36);
  Call_FillMemWithValue((int *)v2, 0, 0x24u);
  *(ushort *)v2 = 1;
  if ( v1 )
    *(ushort *)(v2 + 2) = 2;
  v3 = 0;
  do
  {
    v4 = v2 + 4 * v3;
    *(uint *)(v4 + 4) = &dword_2202120[15360 * v3 + 2];
    if ( !&dword_2202120[15360 * v3 + 2] )
      return 0;
    if ( v1 )
    {
      v6 = malloc(4u, 36864);
      *(uint *)(v4 + 20) = v6;
      if ( !v6 )
        return 0;
      v7 = 36864;
    }
    else
    {
      *(uint *)(v4 + 20) = 0;
      v7 = 0;
    }
    Function_21eeb9c(v3, 61440, v7, v2);
    v3 = (v3 + 1) & 0xFF;
  }
  while ( v3 < 4 );
  return v2;
}

//----- (021EEB48) --------------------------------------------------------
uint __fastcall Function_21eeb48(ushort *a1)
{
  ushort *v1;
  int v2;
  ushort *v3;
  int v4;

  v1 = a1;
  v2 = 0;
  v3 = a1;
  do
  {
    if ( *v1 == 2 )
      free(*((uint *)v3 + 1));
    *((uint *)v3 + 1) = 0;
    v4 = *((uint *)v3 + 5);
    if ( v4 )
    {
      if ( v1[1] == 2 )
        free(v4);
      *((uint *)v3 + 5) = 0;
    }
    ++v2;
    v3 += 2;
  }
  while ( v2 < 4 );
  return free((int)v1);
}

//----- (021EEB84) --------------------------------------------------------
int __fastcall Function_21eeb84(int a1, int a2, uint *a3)
{
  int result;

  result = *(uint *)(a2 + 4 * a1 + 4);
  *a3 = result;
  return result;
}

//----- (021EEB90) --------------------------------------------------------
int __fastcall Function_21eeb90(int a1, int a2, uint *a3)
{
  int result;

  result = *(uint *)(a2 + 4 * a1 + 20);
  *a3 = result;
  return result;
}

//----- (021EEB9C) --------------------------------------------------------
ushort *__fastcall Function_21eeb9c(int a1, uint a2, uint a3, int a4)
{
  int v4;
  int v5;
  uint v6;

  v4 = a4;
  v5 = 4 * a1;
  v6 = a3;
  MI_CpuFill8(*(ushort **)(a4 + 4 * a1 + 4), 0, a2);
  return MI_CpuFill8(*(ushort **)(v4 + v5 + 20), 0, v6);
}

//----- (021EEBC0) --------------------------------------------------------
int __fastcall Function_21eebc0(int a1)
{
  int v1;
  int v2;
  uint v3;
  ushort *v4;
  ushort *v5;
  int v7;

  v1 = a1;
  v7 = malloc(4u, 36);
  Call_FillMemWithValue((int *)v7, 0, 0x24u);
  *(ushort *)v7 = 2;
  if ( v1 )
    *(ushort *)(v7 + 2) = 2;
  v2 = v7;
  v3 = 0;
  do
  {
    v4 = (ushort *)malloc(4u, 61440);
    *(uint *)(v2 + 4) = v4;
    MI_CpuFill8(v4, 0, 0xF000u);
    if ( v1 == 1 )
    {
      v5 = (ushort *)malloc(4u, 36864);
      *(uint *)(v2 + 20) = v5;
      MI_CpuFill8(v5, 0, 0x9000u);
    }
    ++v3;
    v2 += 4;
  }
  while ( v3 < 4 );
  return v7;
}

//----- (021EEC24) --------------------------------------------------------
int __fastcall Function_21eec24(uint *a1, int a2)
{
  uint *v2;
  int v3;
  int *v4;
  short *v5;
  int v6;
  int v7;
  int v8;
  int v9;
  short *v10;
  int result;
  short v12;

  v2 = a1;
  v3 = a2;
  v4 = a1;
  v5 = &v12;
  v6 = 4;
  do
  {
    v7 = *v4;
    v8 = v4[1];
    v4 += 2;
    *(uint *)v5 = v7;
    *((uint *)v5 + 1) = v8;
    v5 += 4;
    --v6;
  }
  while ( v6 );
  v9 = 0;
  *(uint *)v5 = *v4;
  v10 = &v12;
  *(ushort *)v2 = *(ushort *)v3;
  *(ushort *)v3 = v12;
  do
  {
    ++v9;
    v2[1] = *(uint *)(v3 + 4);
    result = *((uint *)v10 + 1);
    ++v2;
    *(uint *)(v3 + 4) = result;
    v3 += 4;
    v10 += 2;
  }
  while ( v9 < 4 );
  return result;
}

//----- (021EEC68) --------------------------------------------------------
BOOL __fastcall Function_21eec68(uint *a1, uint *a2, uint *a3)
{
  uint *v3;
  uint *v4;
  uint *v5;
  uint *v6;
  int v7;
  BOOL result;

  if ( *a1 > *a2 )
  {
    v3 = a2;
    v4 = a1;
  }
  else
  {
    v3 = a1;
    v4 = a2;
  }
  if ( a1[1] > a2[1] )
  {
    v5 = a2 + 1;
    v6 = a1 + 1;
  }
  else
  {
    v5 = a1 + 1;
    v6 = a2 + 1;
  }
  result = 0;
  if ( *v3 <= *a3 && *a3 <= *v4 )
  {
    v7 = a3[1];
    if ( *v5 <= v7 && v7 <= *v6 )
      result = 1;
  }
  return result;
}

//----- (021EECB8) --------------------------------------------------------
int __fastcall Function_21eecb8(uint *a1, int a2, uint *a3)
{
  int v3;
  int v4;
  int v5;
  int v6;
  int *v7;
  int v8;
  int result;

  v3 = 8 * a2;
  v4 = a1[4];
  v5 = 8 * *(ushort *)(*a1 + 8 * a2);
  v6 = *(uint *)(v4 + v5 + 4);
  *a3 = *(uint *)(v4 + v5);
  a3[1] = v6;
  v7 = (int *)(a1[4] + 8 * *(ushort *)(*a1 + v3 + 2));
  v8 = *v7;
  result = v7[1];
  a3[2] = v8;
  a3[3] = result;
  return result;
}

//----- (021EECE8) --------------------------------------------------------
int __fastcall Function_21eece8(uint *a1, int a2, uint *a3)
{
  uint *v3;
  int v4;
  int result;

  v3 = (uint *)(a1[5] + 12 * *(ushort *)(*a1 + 8 * a2 + 4));
  v4 = v3[1];
  *a3 = *v3;
  a3[1] = v4;
  result = v3[2];
  a3[2] = result;
  return result;
}

//----- (021EED08) --------------------------------------------------------
int __fastcall Function_21eed08(uint *a1, int a2, uint *a3)
{
  int result;

  result = *(uint *)(a1[1] + 4 * *(ushort *)(*a1 + 8 * a2 + 6));
  *a3 = result;
  return result;
}

//----- (021EED20) --------------------------------------------------------
uint *__fastcall Function_21eed20(uint *result)
{
  int v1;

  v1 = 0;
  do
  {
    *result = 0;
    result[1] = -1;
    result[2] = -1;
    ++v1;
    result += 3;
  }
  while ( v1 < 10 );
  return result;
}

//----- (021EED38) --------------------------------------------------------
int __fastcall Function_21eed38(int a1, int a2, int a3, ushort *a4)
{
  int result;
  int v5;
  int v6;
  int i;

  if ( !a2 )
    return 0;
  if ( a2 == 1 )
  {
    *a4 = 0;
    result = 1;
  }
  else
  {
    v5 = a2 - 1;
    v6 = 0;
    for ( i = v5 / 2; ; i = (i + v5) / 2 )
    {
      while ( *(uint *)(a1 + 8 * i) > a3 )
      {
        if ( v5 - 1 <= v6 )
        {
          *a4 = i;
          return 1;
        }
        v5 = i;
        i = (v6 + i) / 2;
      }
      if ( v6 + 1 >= v5 )
        break;
      v6 = i;
    }
    *a4 = i + 1;
    result = 1;
  }
  return result;
}

//----- (021EED9C) --------------------------------------------------------
int __fastcall Function_5_21eed9c(int a1, int a2, int a3, int a4, uint *a5)
{
  uint *v5;
  int result;
  int v7;
  int v8;
  int v9;
  int v10;
  int *v11;
  int v12;
  long long v13;
  int v14;
  int v15;
  long long v16;
  int v17;
  int v18;
  int i;
  int v20;
  int v21;
  int v22;
  int v23;
  int v24;
  uint v25;
  uint v26;
  ushort v27[2];
  int v28;
  int v29;
  int v30;
  int v31;
  int v32;
  int v33;
  char v34;
  char v35;
  int v36[30];
  int v37;

  v37 = a4;
  v22 = a1;
  v5 = (uint *)a4;
  if ( !*(uint *)(a4 + 24) )
    return 0;
  v29 = a2;
  v30 = a3;
  v7 = 0;
  Function_21eed20(v36);
  v8 = v5[2];
  if ( !Function_21eed38(v5[2], v5[7] & 0xFFFF, v30, v27) )
    return 0;
  v9 = v8 + 8 * v27[0];
  v25 = *(ushort *)(v9 + 4);
  v10 = *(ushort *)(v9 + 6);
  v26 = 0;
  if ( v25 )
  {
    v11 = v36;
    v24 = 2 * v10;
    do
    {
      v12 = *(ushort *)(2 * v26 + v24 + v5[3]);
      Function_21eecb8(v5, v12, &v34);
      if ( Function_21eec68(&v34, &v35, &v29) == 1 )
      {
        Function_21eece8(v5, v12, &v31);
        Function_21eed08(v5, v12, &v28);
        v13 = ll_mul(v31, v29);
        v14 = v13;
        LODWORD(v13) = v33;
        v15 = HIDWORD(v13);
        HIDWORD(v13) = v33 >> 31;
        v16 = ll_mul(v13, v30);
        *v11 = FX_Div(
                 -(v28
                 + (((uint)(v14 + 2048) >> 12) | ((__CFADD__(v14, 2048) + v15) << 20))
                 + (((uint)(v16 + 2048) >> 12) | ((__CFADD__((uint)v16, 2048) + HIDWORD(v16)) << 20))),
                 v32);
        ++v7;
        v11 += 3;
        if ( v7 >= 10 )
          break;
      }
      v26 = (v26 + 1) & 0xFFFF;
    }
    while ( v26 < v25 );
  }
  if ( v7 <= 1 )
  {
    if ( v7 == 1 )
    {
      *a5 = v36[0];
      result = 1;
    }
    else if ( v7 )
    {
      *a5 = v36[0];
      result = 1;
    }
    else
    {
      result = 0;
    }
  }
  else
  {
    v23 = 0;
    v17 = Function_201e198(v22, v36[0]);
    v18 = v17 - Function_201e190(v22, v36[0]);
    for ( i = 1; i < v7; i = (i + 1) & 0xFFFF )
    {
      v20 = Function_201e198(v22, v36[3 * i]);
      v21 = v20 - Function_201e190(v22, v36[3 * i]);
      if ( v18 > v21 )
      {
        v18 = v21;
        v23 = i;
      }
    }
    *a5 = v36[3 * v23];
    result = 1;
  }
  return result;
}

//----- (021EEF34) --------------------------------------------------------
int __fastcall Function_21eef34(int *a1, uint *a2, int a3, int a4)
{
  int *v4;
  int v5;
  char v7;
  int v8;

  v8 = a4;
  v4 = a1;
  v5 = (int)a2;
  MIi_CpuClear32(0, a2, 24);
  Call_FS_ReadFile(v4, 4, (int)&v7);
  Call_FS_ReadFile(v4, 2, v5);
  Call_FS_ReadFile(v4, 2, v5 + 4);
  Call_FS_ReadFile(v4, 2, v5 + 8);
  Call_FS_ReadFile(v4, 2, v5 + 12);
  Call_FS_ReadFile(v4, 2, v5 + 16);
  return Call_FS_ReadFile(v4, 2, v5 + 20);
}

//----- (021EEF98) --------------------------------------------------------
uint __fastcall Function_21eef98(uint *a1, uint *a2, uint *a3)
{
  uint *v3;
  uint *v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  uint result;

  v3 = a1;
  v4 = a3;
  a2[4] = *a3;
  v5 = 8 * *v3;
  a2[5] = *v4 + v5;
  v6 = v5 + 12 * v3[1];
  a2[1] = *v4 + v6;
  v7 = v6 + 4 * v3[2];
  *a2 = *v4 + v7;
  v8 = v7 + 8 * v3[3];
  a2[2] = *v4 + v8;
  v9 = v8 + 8 * v3[4];
  a2[3] = *v4 + v9;
  result = 36864;
  if ( v9 + 2 * v3[5] > 36864 )
    result = ErrorHandler();
  return result;
}

//----- (021EEFF8) --------------------------------------------------------
int __fastcall Function_21eeff8(int *a1, int a2, uint *a3)
{
  return Call_FS_ReadFile(a1, 8 * *a3, *(uint *)(a2 + 16));
}

//----- (021EF008) --------------------------------------------------------
int __fastcall Function_21ef008(int *a1, int a2, int a3)
{
  return Call_FS_ReadFile(a1, 12 * *(uint *)(a3 + 4), *(uint *)(a2 + 20));
}

//----- (021EF01C) --------------------------------------------------------
int __fastcall Function_21ef01c(int *a1, int a2, int a3)
{
  return Call_FS_ReadFile(a1, 4 * *(uint *)(a3 + 8), *(uint *)(a2 + 4));
}

//----- (021EF02C) --------------------------------------------------------
int __fastcall Function_21ef02c(int *a1, int *a2, int a3)
{
  return Call_FS_ReadFile(a1, 8 * *(uint *)(a3 + 12), *a2);
}

//----- (021EF03C) --------------------------------------------------------
int __fastcall Function_21ef03c(int *a1, int a2, int a3)
{
  return Call_FS_ReadFile(a1, 8 * *(uint *)(a3 + 16), *(uint *)(a2 + 8));
}

//----- (021EF04C) --------------------------------------------------------
int __fastcall Function_21ef04c(int *a1, int a2, int a3)
{
  return Call_FS_ReadFile(a1, 2 * *(uint *)(a3 + 20), *(uint *)(a2 + 12));
}

//----- (021EF05C) --------------------------------------------------------
int __fastcall Function_21ef05c(int *a1, int a2, int a3, int a4)
{
  int v4;
  int *v5;
  int result;

  v4 = a2;
  v5 = a1;
  if ( *(uint *)(a2 + 116) == 1 )
    *(uchar *)(a2 + 104) = 2;
  result = *(uchar *)(a2 + 104);
  if ( *(uchar *)(a2 + 104) )
  {
    if ( result == 1 )
    {
      Function_21eeff8(*(int **)(a2 + 124), *(uint *)(a2 + 112), (uint *)(a2 + 76));
      Function_21ef008(*(int **)(v4 + 124), *(uint *)(v4 + 112), v4 + 76);
      Function_21ef01c(*(int **)(v4 + 124), *(uint *)(v4 + 112), v4 + 76);
      Function_21ef02c(*(int **)(v4 + 124), *(int **)(v4 + 112), v4 + 76);
      Function_21ef03c(*(int **)(v4 + 124), *(uint *)(v4 + 112), v4 + 76);
      result = Function_21ef04c(*(int **)(v4 + 124), *(uint *)(v4 + 112), v4 + 76);
      a3 = 1;
    }
    else if ( result == 2 )
    {
      **(uint **)(a2 + 120) = 0;
      free(a2);
      return Call_RemoveTaskFromTaskList(v5);
    }
  }
  else
  {
    result = **(uint **)(a2 + 132);
    if ( result )
    {
      a3 = 0;
    }
    else
    {
      Function_21eef34(*(int **)(a2 + 124), (uint *)(a2 + 76), a3, a4);
      *(uint *)(*(uint *)(v4 + 112) + 28) = *(uint *)(v4 + 92);
      result = Function_21eef98((uint *)(v4 + 76), *(uint **)(v4 + 112), (uint *)(v4 + 108));
      a3 = 1;
    }
  }
  if ( a3 == 1 )
  {
    result = (uchar)++*(uchar *)(v4 + 104);
    if ( result == 2 )
    {
      result = *(uint *)(v4 + 112);
      *(uint *)(result + 24) = 1;
    }
  }
  return result;
}

//----- (021EF13C) --------------------------------------------------------
uint *Function_21ef13c()
{
  uint *result;

  result = (uint *)malloc(4u, 32);
  result[4] = 0;
  result[5] = 0;
  *result = 0;
  result[2] = 0;
  result[3] = 0;
  result[6] = 0;
  result[7] = 0;
  return result;
}

//----- (021EF158) --------------------------------------------------------
int Function_21ef158(int *a1, int a2, int *a3, ...)
{
  int *v3;
  int *v4;
  uint *v5;
  int v6;
  int v7;
  int result;
  int varg_r3;
  va_list varg_r3a;
  va_list va1;

  va_start(va1, a3);
  va_start(varg_r3a, a3);
  varg_r3 = va_arg(va1, uint);
  v3 = a1;
  v4 = a3;
  v5 = (uint *)malloc2(4u, 24);
  Function_21eef34(v3, v5, v6, v7);
  v4[7] = v5[4];
  Function_21eef98(v5, v4, (int *)varg_r3a);
  Function_21eeff8(v3, (int)v4, v5);
  Function_21ef008(v3, (int)v4, (int)v5);
  Function_21ef01c(v3, (int)v4, (int)v5);
  Function_21ef02c(v3, v4, (int)v5);
  Function_21ef03c(v3, (int)v4, (int)v5);
  Function_21ef04c(v3, (int)v4, (int)v5);
  free((int)v5);
  result = 1;
  v4[6] = 1;
  return result;
}

//----- (021EF1D0) --------------------------------------------------------
int __fastcall Function_21ef1d0(int result)
{
  if ( result )
    result = free(result);
  return result;
}

//----- (021EF1DC) --------------------------------------------------------
uint *__fastcall Function_21ef1dc(uint *result)
{
  if ( result )
  {
    result[6] = 0;
    result[4] = 0;
    result[5] = 0;
    *result = 0;
    result[2] = 0;
    result[3] = 0;
  }
  return result;
}

//----- (021EF1F0) --------------------------------------------------------
uint *__fastcall Function_21ef1f0(int a1, int a2, int a3, int a4, uint *a5, int a6)
{
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;

  v6 = a1;
  v7 = a2;
  v8 = a3;
  v9 = a4;
  v10 = malloc2(4u, 136);
  *(uchar *)(v10 + 104) = 0;
  *(uint *)(v10 + 124) = v6;
  *(uint *)(v10 + 128) = v7;
  *(uint *)(v10 + 112) = v8;
  *(uint *)(v10 + 120) = v9;
  *(uint *)(v10 + 116) = 0;
  *(uint *)(v10 + 100) = 0;
  *(uint *)(v10 + 72) = 0;
  *(uint *)(v10 + 108) = *a5;
  *(uint *)(v10 + 132) = a6;
  return AddTaskToTaskList1((int)Function_21ef05c, v10, 1u);
}

//----- (021EF23C) --------------------------------------------------------
int __fastcall Function_21ef23c(int a1)
{
  int result;

  result = Function_201ced0(a1);
  *(uint *)(result + 116) = 1;
  return result;
}

//----- (021EF248) --------------------------------------------------------
int __fastcall Function_21ef248(int result)
{
  *(uint *)(result + 24) = 0;
  return result;
}

//----- (021EF250) --------------------------------------------------------
BOOL __fastcall Function_21ef250(int a1, int a2, int *a3)
{
  int v4;
  int v5;
  int v6;
  int v7;

  if ( !a3[5] )
    return 0;
  v4 = *a3;
  v5 = a3[1];
  v6 = *a3 + a3[2] - 1;
  v7 = v5 + a3[3] - 1;
  return v4 <= a1 && a1 <= v6 && v5 <= a2 && a2 <= v7;
}

//----- (021EF28C) --------------------------------------------------------
uint *__fastcall Function_21ef28c(uint a1, uint a2)
{
  uint v2;
  uint v3;
  uint *v4;
  uint v5;

  v2 = a2;
  v3 = a1;
  v4 = (uint *)malloc(a2, 8);
  v4[1] = malloc(v2, 24 * v3);
  v5 = 0;
  *v4 = v3;
  if ( v3 )
  {
    do
    {
      *(uint *)(v4[1] + 24 * v5 + 20) = 0;
      v5 = (v5 + 1) & 0xFF;
    }
    while ( v5 < v3 );
  }
  return v4;
}

//----- (021EF2CC) --------------------------------------------------------
int __fastcall Function_5_21ef2cc(int a1, int a2, int a3, int a4, int a5, int a6, int a7)
{
  int result;

  *(uint *)(*(uint *)(a7 + 4) + 24 * a1) = a2;
  *(uint *)(*(uint *)(a7 + 4) + 24 * a1 + 4) = a3;
  *(uint *)(*(uint *)(a7 + 4) + 24 * a1 + 8) = a4;
  *(uint *)(*(uint *)(a7 + 4) + 24 * a1 + 12) = a5;
  *(uint *)(*(uint *)(a7 + 4) + 24 * a1 + 16) = a6;
  result = *(uint *)(a7 + 4) + 24 * a1;
  *(uint *)(result + 20) = 1;
  return result;
}

//----- (021EF300) --------------------------------------------------------
uint __fastcall Function_21ef300(int a1)
{
  int v1;

  v1 = a1;
  free(*(uint *)(a1 + 4));
  return free(v1);
}

//----- (021EF314) --------------------------------------------------------
int __fastcall Function_5_21ef314(int a1, int a2, int *a3, uchar *a4)
{
  int v4;
  int v5;
  int *v6;
  int v7;
  uchar *v9;

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v9 = a4;
  if ( !a4 )
    ErrorHandler();
  v7 = 0;
  if ( *v6 <= 0 )
    return 0;
  while ( !Function_21ef250(v4, v5, (int *)(v6[1] + 24 * v7)) )
  {
    v7 = (v7 + 1) & 0xFF;
    if ( v7 >= *v6 )
      return 0;
  }
  *v9 = v7;
  return 1;
}

//----- (021EF35C) --------------------------------------------------------
int __fastcall Function_5_21ef35c(int a1, uint *a2)
{
  uint *v2;
  int v3;

  v2 = a2;
  v3 = a1;
  if ( a1 >= *a2 )
    ErrorHandler();
  if ( !*(uint *)(v2[1] + 24 * v3 + 20) )
    ErrorHandler();
  return *(uint *)(v2[1] + 24 * v3 + 16);
}

//----- (021EF388) --------------------------------------------------------
int __fastcall Function_5_21ef388(int a1, int a2, uint *a3)
{
  uint *v3;
  int v4;
  int v5;
  int result;

  v3 = a3;
  v4 = a1;
  v5 = a2;
  if ( a1 >= *a3 )
    ErrorHandler();
  result = v3[1] + 24 * v4;
  *(uint *)(result + 16) = v5;
  return result;
}

//----- (021EF3A8) --------------------------------------------------------
int __fastcall Function_21ef3a8(uint a1)
{
  int v1;

  v1 = malloc(a1, 28);
  Function_21ef444();
  return v1;
}

//----- (021EF3BC) --------------------------------------------------------
uint *__fastcall Function_21ef3bc(uint *result)
{
  int v1;

  v1 = (int)result;
  if ( result )
  {
    if ( *result == 1 )
      Function_5_21ef3fc(result);
    Function_21ef444(v1);
    result = (uint *)free(v1);
  }
  return result;
}

//----- (021EF3DC) --------------------------------------------------------
int __fastcall Function_5_21ef3dc(int a1)
{
  uint *v1;
  int result;

  v1 = (uint *)a1;
  if ( Function_20177bc((int (__fastcall *)(uint))Function_21ef47c, a1) != 1 )
    ErrorHandler();
  result = 1;
  *v1 = 1;
  return result;
}

//----- (021EF3FC) --------------------------------------------------------
int __fastcall Function_5_21ef3fc(uint *a1)
{
  uint *v1;
  int result;

  v1 = a1;
  if ( Function_20177bc(0, 0) != 1 )
    ErrorHandler();
  result = 0;
  *v1 = 0;
  return result;
}

//----- (021EF418) --------------------------------------------------------
uint *__fastcall Function_21ef418(int a1, int a2, int a3)
{
  int v3;
  int v4;
  uint *v5;

  v3 = a2;
  v4 = a3;
  v5 = (uint *)Function_21ef49c();
  if ( !v5 )
    ErrorHandler();
  if ( v5 )
  {
    v5[1] = v4;
    v5[2] = v3;
    *v5 = 1;
  }
  return v5;
}

//----- (021EF43C) --------------------------------------------------------
int Function_21ef43c()
{
  return Function_21ef46c();
}

//----- (021EF444) --------------------------------------------------------
int __fastcall Function_21ef444(uint *a1)
{
  uchar *v1;
  int v2;
  int v3;
  int v4;
  int v5;
  int result;

  v1 = a1;
  v2 = 28;
  v3 = 0;
  do
  {
    *v1++ = 0;
    --v2;
  }
  while ( v2 );
  v4 = 0;
  *a1 = 0;
  v5 = (int)(a1 + 1);
  do
  {
    result = Function_21ef46c(v5, v3);
    ++v4;
    v5 += 12;
  }
  while ( v4 < 2 );
  return result;
}

//----- (021EF46C) --------------------------------------------------------
uint *__fastcall Function_21ef46c(uint *result)
{
  *result = 0;
  result[2] = Function_21ef498;
  result[1] = 0;
  return result;
}

//----- (021EF47C) --------------------------------------------------------
int __fastcall Function_21ef47c(int a1)
{
  int v1;
  int v2;
  int v3;
  int result;

  v1 = a1;
  v2 = 0;
  v3 = a1 + 4;
  do
  {
    result = (*(int (__fastcall **)(int, uint))(v1 + 12))(v3, *(uint *)(v1 + 8));
    ++v2;
    v1 += 12;
    v3 += 12;
  }
  while ( v2 < 2 );
  return result;
}

//----- (021EF498) --------------------------------------------------------
void Function_21ef498()
{
  ;
}

//----- (021EF49C) --------------------------------------------------------
int __fastcall Function_21ef49c(int a1)
{
  int v1;
  int v2;

  v1 = 0;
  v2 = a1;
  do
  {
    if ( !*(uint *)(v2 + 4) )
      return a1 + 4 + 12 * v1;
    ++v1;
    v2 += 12;
  }
  while ( v1 < 2 );
  return 0;
}

//----- (021EF4BC) --------------------------------------------------------
int *__fastcall Function_21ef4bc(uint a1, int a2)
{
  int v2;
  uint v3;
  int *v4;

  v2 = a2;
  v3 = a1;
  v4 = (int *)malloc(a1, 808);
  Call_FillMemWithValue(v4, 0, 0x328u);
  *v4 = 0;
  v4[195] = (int)Function_2013b10(v3, (int)(v4 + 3), (int)(v4 + 99));
  v4[196] = v2;
  return v4;
}

//----- (021EF4F8) --------------------------------------------------------
uint __fastcall Function_21ef4f8(uint *a1)
{
  int v1;

  v1 = (int)a1;
  if ( *a1 == 1 )
    Function_21ef710();
  Function_2013b40(*(uint *)(v1 + 780));
  return free(v1);
}

//----- (021EF518) --------------------------------------------------------
int __fastcall Function_21ef518(uint *a1)
{
  uint *v1;

  v1 = a1;
  if ( *a1 )
    ErrorHandler();
  v1[197] = Function_21ef418(v1[196], (int)Function_21ef6c0, (int)v1);
  v1[199] = AddTaskToTaskList1((int)Function_21ef5a8, (int)v1, 0x400u);
  v1[200] = AddTaskToTaskList2((int)Function_21ef6b0, (int)v1, 0x400u);
  v1[201] = AddTaskToTaskList2((int)Function_21ef6e4, (int)v1, 0x400u);
  Call_FillMemWithValue(v1 + 3, 0, 0x180u);
  Call_FillMemWithValue(v1 + 99, 0, 0x180u);
  *v1 = 1;
  v1[2] = 0;
  return Function_2005748(0x610u);
}

//----- (021EF5A8) --------------------------------------------------------
int __fastcall Function_21ef5a8(int a1, uint *a2)
{
  uint *v2;
  int result;
  int v4;
  int v5;

  v2 = a2;
  result = a2[2];
  switch ( (uchar)result )
  {
    case 0:
      a2[1] = 3;
      result = a2[2] + 1;
      a2[2] = result;
      break;
    case 1:
      --a2[1];
      v4 = Function_2013b54(a2[195]);
      Function_21ef66c(v4, 3 - v2[1], 3);
      result = v2[1];
      if ( result <= 0 )
      {
        v2[1] = 3;
        result = v2[2] + 1;
        v2[2] = result;
      }
      break;
    case 2:
      --a2[1];
      v5 = Function_2013b54(a2[195]);
      Function_21ef66c(v5, v2[1], 3);
      result = v2[1];
      if ( result <= 0 )
      {
        result = v2[2] + 1;
        v2[2] = result;
      }
      break;
    case 3:
      Function_21ef710(a2);
      result = Function_20bfeac(0);
      break;
    default:
      return result;
  }
  return result;
}

//----- (021EF634) --------------------------------------------------------
int __fastcall Function_21ef634(int a1)
{
  int v1;
  int result;
  int v3;

  v1 = (ushort)REG_VCOUNT;
  result = Function_2013b68(*(uint *)(a1 + 780));
  if ( v1 < 192 )
  {
    v3 = v1 + 1;
    if ( v1 + 1 >= 192 )
      v3 = v1 - 191;
    if ( REG_DISPSTAT & 2 )
      result = Function_20bfeac(*(ushort *)(result + 2 * v3));
  }
  return result;
}

//----- (021EF66C) --------------------------------------------------------
uint __fastcall Function_21ef66c(ushort *a1, int a2, int a3)
{
  ushort *v3;
  int v4;
  uint v5;
  int v6;
  short v7;
  uint result;
  int v9;
  int v10;

  v3 = a1;
  v4 = 1;
  v5 = s32_div_f(3 * a2, a3);
  v6 = 0;
  v10 = 0xFFFF * v5 & 0xFFFF;
  v7 = v5;
  do
  {
    result = s32_div_f(v6, 10);
    if ( !v9 )
    {
      result = 1;
      v4 ^= 1u;
    }
    if ( v4 )
    {
      *v3 = v7;
    }
    else
    {
      result = v10;
      *v3 = v10;
    }
    ++v6;
    ++v3;
  }
  while ( v6 < 192 );
  return result;
}

//----- (021EF6B0) --------------------------------------------------------
int __fastcall Function_21ef6b0(int a1, int a2)
{
  *(uint *)(a2 + 792) = 0;
  return Function_20bfeac(0);
}

//----- (021EF6C0) --------------------------------------------------------
int __fastcall Function_21ef6c0(int a1, int a2)
{
  return Function_21ef6cc(a2);
}

//----- (021EF6CC) --------------------------------------------------------
uint *__fastcall Function_21ef6cc(uint *result)
{
  if ( *result == 1 && result[198] == 1 )
    result = (uint *)Function_21ef634((int)result);
  return result;
}

//----- (021EF6E4) --------------------------------------------------------
int __fastcall Function_21ef6e4(int a1, int a2)
{
  return Function_21ef6f0(a2);
}

//----- (021EF6F0) --------------------------------------------------------
int __fastcall Function_21ef6f0(int *a1)
{
  int *v1;
  int result;

  v1 = a1;
  result = *a1;
  if ( result == 1 )
  {
    Function_2013b94(v1[195]);
    result = 792;
    v1[198] = 1;
  }
  return result;
}

//----- (021EF710) --------------------------------------------------------
int __fastcall Function_21ef710(int a1)
{
  int v1;
  int v2;
  int result;

  v1 = a1;
  v2 = *(uint *)(a1 + 788);
  Function_21ef43c();
  *(uint *)(v1 + 788) = 0;
  Call_RemoveTaskFromTaskList(*(int **)(v1 + 796));
  *(uint *)(v1 + 796) = 0;
  Call_RemoveTaskFromTaskList(*(int **)(v1 + 800));
  *(uint *)(v1 + 800) = 0;
  Call_RemoveTaskFromTaskList(*(int **)(v1 + 804));
  result = 804;
  *(uint *)(v1 + 804) = 0;
  *(uint *)v1 = 0;
  return result;
}

//----- (021EF75C) --------------------------------------------------------
uint __fastcall Function_21ef75c(int a1, int a2)
{
  return Function_20182f0(a1, a2 + *(uint *)(a2 + 20) - a1);
}

//----- (021EF76C) --------------------------------------------------------
int __fastcall Function_21ef76c_AllocOverWorldData_30(int a1, int a2)
{
  int v2;
  int v3;
  int v4;

  v2 = a2;
  v3 = a1;
  v4 = malloc(4u, 3112);
  *(uint *)(v4 + 3104) = malloc2(4u, 16);
  **(uint **)(v4 + 3104) = v3;
  *(uint *)(*(uint *)(v4 + 3104) + 4) = v2;
  *(uint *)(*(uint *)(v4 + 3104) + 12) = 0;
  return v4;
}

//----- (021EF7A0) --------------------------------------------------------
int __fastcall LoadAreaData(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  uint v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  uint *v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  short v20;
  int v21;
  int v22;
  int result;
  int v24;
  int v25;
  int v26;
  int *v27;
  char v28;
  int v29;

  v29 = a4;
  v4 = a1;
  v5 = *(uint *)(a1 + 3104);
  LoadFromNARC(a1 + 3096, 42, *(uint *)v5);
  *(uint *)(v4 + 3108) = LoadFromNARC_2(43, *(ushort *)(v4 + 3096), 4u);
  v6 = **(ushort **)(v4 + 3108);
  *(ushort *)(v5 + 8) = v6;
  if ( v6 >= 0x300 )
    ErrorHandler();
  *(uint *)(v4 + 3084) = 0;
  *(uint *)(v4 + 3076) = LoadFromNARC_2(44, *(ushort *)(v4 + 3098), 4u);
  *(uint *)(v4 + 3080) = LoadFromNARC_2(71, *(ushort *)(v4 + 3096), 4u);
  *(uint *)(v4 + 3084) = Function_20b3c1c_GetTexOffsets(*(uint *)(v4 + 3076));
  if ( *(ushort *)(v5 + 8) )
    *(uint *)(v4 + 3088) = Function_20b3c1c_GetTexOffsets(*(uint *)(v4 + 3080));
  else
    *(uint *)(v4 + 3088) = 0;
  if ( !Function_201cbcc(*(uint *)(v4 + 3084)) )
    ErrorHandler();
  Function_21ef75c(*(uint *)(v4 + 3076), *(uint *)(v4 + 3084));
  v7 = *(uint *)(v4 + 3088);
  if ( v7 )
  {
    if ( !Function_201cbcc(v7) )
      ErrorHandler();
    Function_21ef75c(*(uint *)(v4 + 3080), *(uint *)(v4 + 3088));
  }
  v8 = 0;
  v9 = v4;
  do
  {
    ++v8;
    *(uint *)(v9 + 4) = 0;
    v9 += 4;
  }
  while ( v8 < 768 );
  *(uint *)(v4 + 3092) = 0;
  v27 = LoadFromNARC_8(40, 4u, v8, v9);
  v25 = Function_21d3f84(*(uint *)(v5 + 4));
  v26 = 0;
  if ( (int)*(ushort *)(v5 + 8) > 0 )
  {
    v24 = 0;
    do
    {
      v10 = *(ushort *)(*(uint *)(v4 + 3108) + v24 + 2);
      v11 = v4 + 4 * v10;
      if ( *(uint *)(v11 + 4) )
        ErrorHandler();
      *(uint *)(v11 + 4) = Function_2006cb8_LoadFileInMemory((int)v27, v10, 4u);
      if ( v10 < v25 )
      {
        v12 = Function_20b3c0c_GetAdrOfDataPart(*(uint *)(v11 + 4));
        if ( v12
          && (v12 == -8 || !*(uchar *)(v12 + 9) ? (v13 = 0) : (v13 = (uint *)(v12
                                                                              + 8
                                                                              + *(ushort *)(v12 + 14)
                                                                              + 4)),
              v13) )
        {
          v14 = v12 + *v13;
        }
        else
        {
          v14 = 0;
        }
        Function_21d3a50(v10, v14, *(uint *)(v4 + 3088), *(uint *)(v5 + 4));
      }
      if ( !Function_201cbb0(*(uint *)(v11 + 4), *(uint *)(v4 + 3088)) )
        ErrorHandler();
      v24 += 2;
      ++v26;
    }
    while ( v26 < *(ushort *)(v5 + 8) );
  }
  if ( !*(uint *)(v4 + 4) )
  {
    v15 = Function_2006cb8_LoadFileInMemory((int)v27, 0, 4u);
    *(uint *)(v4 + 4) = v15;
    v16 = Function_20b3c1c_GetTexOffsets(v15);
    v17 = v16;
    if ( v16 )
    {
      if ( !Function_201cbcc(v16) )
        ErrorHandler();
      if ( !Function_201cbb0(*(uint *)(v4 + 4), v17) )
        ErrorHandler();
    }
  }
  Call_FS_CloseFile(v27);
  GFX_CONTROL = GFX_CONTROL & 0xCFFF | 0x20;
  if ( Function_21efac0(v4) )
    SetEdgeTable((int)dword_21FF598, v18, v19, v20);
  else
    SetEdgeTable((int)dword_21FF588, v18, v19, v20);
  *(uint *)(v4 + 3092) = Function_21d56bc();
  Function_20d7510((int)&v28, "fielddata/build_model/build_model_matshp.dat");
  Function_21d56d4((uchar *)&v28, *(int **)(v4 + 3092), v21, v22);
  free(*(uint *)(v4 + 3104));
  result = 3104;
  *(uint *)(v4 + 3104) = 0;
  return result;
}

//----- (021EF9E8) --------------------------------------------------------
int __fastcall Function_5_21ef9e8(int a1, int a2)
{
  int v2;
  int v3;

  v2 = a1;
  v3 = a2;
  if ( !a2 )
    ErrorHandler();
  if ( *(uint *)(v3 + 4 + 4 * v2) )
    return v3 + 4 + 4 * v2;
  if ( !*(uint *)(v3 + 4) )
    ErrorHandler();
  return v3 + 4;
}

//----- (021EFA10) --------------------------------------------------------
int __fastcall Function_21efa10(int *a1)
{
  int *v1;
  int *v2;
  int v3;
  int v4;
  int v5;
  int result;

  v1 = a1;
  v2 = *(int **)(*a1 + 3092);
  if ( v2 )
    Function_21d5778(v2);
  v3 = 0;
  v4 = 0;
  do
  {
    v5 = *(uint *)(*v1 + v4 + 4);
    if ( v5 )
      free(v5);
    ++v3;
    v4 += 4;
  }
  while ( v3 < 768 );
  free(*(uint *)(*v1 + 3108));
  free(*(uint *)(*v1 + 3076));
  *(uint *)(*v1 + 3076) = 0;
  free(*(uint *)(*v1 + 3080));
  *(uint *)(*v1 + 3080) = 0;
  free(*v1);
  result = 0;
  *v1 = 0;
  return result;
}

//----- (021EFA8C) --------------------------------------------------------
int __fastcall Function_21efa8c(int a1)
{
  int v1;

  v1 = a1;
  if ( !a1 )
    ErrorHandler();
  return *(uint *)(v1 + 3084);
}

//----- (021EFAA0) --------------------------------------------------------
int __fastcall Function_5_21efaa0(int a1)
{
  int v1;

  v1 = a1;
  if ( !a1 )
    ErrorHandler();
  return *(uint *)(v1 + 3088);
}

//----- (021EFAB4) --------------------------------------------------------
int __fastcall Function_21efab4(int a1)
{
  return *(uint *)(a1 + 3092);
}

//----- (021EFAC0) --------------------------------------------------------
BOOL __fastcall Function_21efac0(int a1)
{
  int v1;

  v1 = *(ushort *)(a1 + 3102);
  return !v1 || v1 == 3;
}

//----- (021EFAD8) --------------------------------------------------------
int __fastcall Function_21efad8(int a1)
{
  return *(ushort *)(a1 + 3102) & 0xFF;
}

//----- (021EFAE8) --------------------------------------------------------
int __fastcall Function_5_21efae8(int a1, int a2)
{
  return *(ushort *)(*(uint *)(a1 + 3108) + 2 * a2);
}

//----- (021EFAF8) --------------------------------------------------------
BOOL __fastcall Function_21efaf8(int a1, int a2)
{
  return *(uint *)(a1 + 4 * a2 + 4) != 0;
}

//----- (021EFB0C) --------------------------------------------------------
int Function_21efb0c()
{
  int result;
  uint v1;
  int v2;

  result = malloc(4u, 252);
  v1 = 0;
  do
  {
    v2 = result + 8 * v1;
    *(uchar *)v2 = 0;
    v1 = (v1 + 1) & 0xFF;
    *(uint *)(v2 + 4) = 0;
  }
  while ( v1 < 0x15 );
  return result;
}

//----- (021EFB30) --------------------------------------------------------
int __fastcall Function_21efb30(int *a1)
{
  int *v1;
  int result;

  v1 = a1;
  free(*a1);
  result = 0;
  *v1 = 0;
  return result;
}

//----- (021EFB40) --------------------------------------------------------
int __fastcall Function_21efb40(int a1, uint *a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v8[4];
  int v9;

  v9 = a4;
  v4 = a1;
  *a2 = 2008;
  v5 = GetSpritePositionX(*(uint *)(a1 + 60));
  v6 = GetSpritePositionY(*(uint *)(v4 + 60));
  if ( GetSpriteFaceDirection(*(uint *)(v4 + 60)) )
    return 0;
  Function_20550f4(v5, v6, 0, -1, 1, 1, v8);
  return Function_2055178(v4, 26, v8, 0);
}

//----- (021EFB94) --------------------------------------------------------
int __fastcall Function_5_21efb94(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  uint *v5;

  v1 = a1;
  v2 = Function_21eff10(**(uint **)(a1 + 28));
  if ( v2 == 21 )
    ErrorHandler();
  v3 = LoadVariableAreaAdress_19(*(uint *)(v1 + 12));
  v4 = Function_202d840(v3);
  v5 = (uint *)Function_202d84c(v2, v4);
  if ( Function_21eff34(*v5) )
    return 3;
  if ( *v5 )
    return 2;
  return 1;
}

//----- (021EFBDC) --------------------------------------------------------
int __fastcall Function_5_21efbdc(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  uint v8;
  uint v9;
  int result;
  uchar *v11;

  v1 = a1;
  v2 = Function_21eff10(**(uint **)(a1 + 28));
  if ( v2 == 21 )
    ErrorHandler();
  v3 = LoadVariableAreaAdress_19(*(uint *)(v1 + 12));
  v11 = (uchar *)Function_202d840(v3);
  v4 = Function_202d84c(v2, (int)v11);
  *(uint *)v4 = 1440;
  v5 = LoadTrainerDataAdress(*(uint *)(v1 + 12));
  v6 = GetTrainerID(v5);
  v7 = Function_21eff4c(v6, v2);
  if ( v2 != Function_202d844(v11) )
    goto LABEL_14;
  v8 = PRNG();
  v9 = (ushort)s32_div_f(v8, 656);
  if ( v9 >= 0x64 )
    ErrorHandler();
  if ( v9 >= 0x5A )
  {
LABEL_14:
    Function_21efcf8(v7, v4 + 6);
    if ( *(uchar *)(v4 + 6) )
    {
      Function_21efd58(v4 + 4);
      *(uchar *)(v4 + 5) = Function_21efdac(*(uchar *)(v4 + 6));
    }
    else
    {
      *(uchar *)(v4 + 5) = 0;
      *(uchar *)(v4 + 4) = 0;
      *(uint *)v4 = 0;
    }
    *(uchar *)(v4 + 7) = Function_21efdc0(*(uchar *)(v4 + 6));
    result = Function_202d848(v2, v11);
  }
  else
  {
    Function_21efd58(v4 + 4);
    result = Function_21efdc0(*(uchar *)(v4 + 6));
    *(uchar *)(v4 + 7) = result;
  }
  return result;
}

//----- (021EFC90) --------------------------------------------------------
int __fastcall StopRandomBattle(int a1, int a2, int a3, int a4)
{
  int *v4;
  int v5;
  int v6;
  int result;
  int v8;
  uint *v9;
  int *v10;
  uint *v11;
  int v12;

  v12 = a4;
  v4 = (int *)a1;
  v5 = Function_21eff10(**(uint **)(a1 + 28));
  if ( v5 == 21 )
    ErrorHandler();
  v6 = 8 * v5;
  result = *(uint *)(v4[42] + v6 + 4);
  if ( result )
  {
    v8 = Function_21e9354(v4[10]);
    Function_5_21e9340(v8, v4[10], &v11);
    v9 = Function_5_21e18cc(v11, 26);
    v10 = (int *)Function_5_21e18bc((int)v9);
    if ( v9 )
      Function_21d3d18(v4[20], v10, 0x1Au, *(uchar *)(v4[42] + v6));
    result = v4[42] + v6;
    *(uint *)(result + 4) = 0;
  }
  return result;
}

//----- (021EFCF8) --------------------------------------------------------
int __fastcall Function_21efcf8(int a1, uchar *a2)
{
  int v2;
  uchar *v3;
  uint v4;
  int v5;
  int result;

  v2 = a1;
  v3 = a2;
  v4 = PRNG();
  v5 = (ushort)s32_div_f(v4, 656);
  if ( (uint)v5 >= 0x64 )
    ErrorHandler();
  if ( v2 )
  {
    if ( v5 >= 1 )
    {
      if ( v5 >= 10 )
      {
        if ( v5 >= 30 )
        {
          result = 2;
          *v3 = 2;
        }
        else
        {
          result = 1;
          *v3 = 1;
        }
      }
      else
      {
        result = 0;
        *v3 = 0;
      }
    }
    else
    {
      result = 3;
      *v3 = 3;
    }
  }
  else if ( v5 >= 10 )
  {
    if ( v5 >= 30 )
    {
      result = 1;
      *v3 = 1;
    }
    else
    {
      result = 2;
      *v3 = 2;
    }
  }
  else
  {
    result = 0;
    *v3 = 0;
  }
  return result;
}

//----- (021EFD58) --------------------------------------------------------
int __fastcall Function_21efd58(uchar *a1)
{
  uchar *v1;
  uint v2;
  int v3;
  int result;

  v1 = a1;
  v2 = PRNG();
  v3 = (ushort)s32_div_f(v2, 656);
  if ( (uint)v3 >= 0x64 )
    ErrorHandler();
  if ( v3 >= 5 )
  {
    if ( v3 >= 10 )
    {
      if ( v3 >= 20 )
      {
        if ( v3 >= 40 )
        {
          if ( v3 >= 60 )
          {
            result = 0;
            *v1 = 0;
          }
          else
          {
            result = 1;
            *v1 = 1;
          }
        }
        else
        {
          result = 2;
          *v1 = 2;
        }
      }
      else
      {
        result = 3;
        *v1 = 3;
      }
    }
    else
    {
      result = 4;
      *v1 = 4;
    }
  }
  else
  {
    result = 5;
    *v1 = 5;
  }
  return result;
}

//----- (021EFDAC) --------------------------------------------------------
int __fastcall Function_21efdac(int a1)
{
  int result;

  if ( a1 == 3 )
    result = 2;
  else
    result = a1 == 2;
  return result;
}

//----- (021EFDC0) --------------------------------------------------------
int __fastcall Function_21efdc0(int a1)
{
  int v1;
  uint v2;
  int v3;
  int result;

  v1 = a1;
  v2 = PRNG();
  v3 = (ushort)s32_div_f(v2, 656);
  if ( (uint)v3 >= 0x64 )
    ErrorHandler();
  switch ( v1 )
  {
    case 3:
      if ( v3 >= 5 )
      {
        if ( v3 >= 6 )
        {
          if ( v3 >= 7 )
            result = 3;
          else
            result = 0;
        }
        else
        {
          result = 1;
        }
      }
      else
      {
        result = 2;
      }
      break;
    case 2:
      if ( v3 >= 75 )
      {
        if ( v3 >= 95 )
        {
          if ( v3 >= 96 )
            result = 3;
          else
            result = 0;
        }
        else
        {
          result = 1;
        }
      }
      else
      {
        result = 2;
      }
      break;
    case 1:
      if ( v3 >= 19 )
      {
        if ( v3 >= 79 )
        {
          if ( v3 >= 99 )
            result = 3;
          else
            result = 0;
        }
        else
        {
          result = 1;
        }
      }
      else
      {
        result = 2;
      }
      break;
    default:
      if ( v3 >= 1 )
      {
        if ( v3 >= 19 )
        {
          if ( v3 >= 99 )
            result = 3;
          else
            result = 0;
        }
        else
        {
          result = 1;
        }
      }
      else
      {
        result = 2;
      }
      break;
  }
  return result;
}

//----- (021EFE58) --------------------------------------------------------
int __fastcall Function_21efe58(int a1, uchar *a2)
{
  int v2;

  v2 = 1;
  switch ( a1 )
  {
    case 3:
      *a2 = 2;
      break;
    case 2:
      *a2 = 1;
      break;
    case 1:
      *a2 = 0;
      break;
    default:
      v2 = 0;
      break;
  }
  return v2;
}

//----- (021EFE7C) --------------------------------------------------------
uint *__fastcall Function_21efe7c(int a1, uint *a2, int a3, int a4)
{
  int *v4;
  uint *v5;
  int v6;
  uint *result;
  int v8;
  int v9;
  int v10;
  uint *v11;
  uint *v12;
  uint *v13;
  int *v14;
  int v15;
  uchar v16;
  int v17;

  v17 = a4;
  v4 = (int *)a1;
  v5 = a2;
  v6 = Function_2039e68(*(uchar **)(a1 + 44), a3);
  result = (uint *)Function_21eff10(v6);
  v8 = (int)result;
  if ( result != (uint *)21 )
  {
    v9 = LoadVariableAreaAdress_19(v4[3]);
    v10 = Function_202d840(v9);
    v11 = (uint *)Function_202d84c(v8, v10);
    v12 = v11;
    result = (uint *)Function_21eff34(*v11);
    if ( result )
    {
      result = (uint *)Function_21efe58(*((uchar *)v12 + 7), &v16);
      v13 = result;
      if ( result )
      {
        result = Function_5_21e18cc(v5, 26);
        if ( result )
        {
          v14 = (int *)Function_5_21e18bc((int)result);
          v15 = 8 * v8;
          Function_21d3d18(v4[20], v14, 0x1Au, *(uchar *)(v4[42] + v15));
          *(uchar *)(v4[42] + v15) = v16;
          *(uint *)(v4[42] + v15 + 4) = v13;
          result = (uint *)Function_21d3b24(26, v16, 1, (int)v14, v4[20]);
        }
      }
    }
  }
  return result;
}

//----- (021EFF10) --------------------------------------------------------
uint __fastcall Function_21eff10(int a1)
{
  uint v1;

  v1 = 0;
  do
  {
    if ( a1 == dword_21FF5B4[v1] )
      return v1;
    v1 = (v1 + 1) & 0xFF;
  }
  while ( v1 < 0x15 );
  return v1;
}

//----- (021EFF34) --------------------------------------------------------
BOOL __fastcall Function_21eff34(int a1)
{
  return a1 > 0 && a1 <= 1080;
}

//----- (021EFF4C) --------------------------------------------------------
int __fastcall Function_21eff4c(int a1, int a2)
{
  int v2;
  char v3;
  uchar v4;
  uchar v5;
  uchar v6;
  uint v7;
  uint v8;
  int v9;
  uint v10;
  char v12;
  uchar v13;
  uchar v14;
  uchar v15;

  v2 = a2;
  v13 = BYTE2(a1);
  v14 = BYTE1(a1);
  v15 = a1;
  s32_div_f(HIBYTE(a1), 21);
  v12 = v3;
  s32_div_f(v13, 21);
  v13 = v4;
  s32_div_f(v14, 21);
  v14 = v5;
  s32_div_f(v15, 21);
  v15 = v6;
  v7 = 1;
  do
  {
    v8 = 0;
    if ( v7 )
    {
      do
      {
        v9 = (uchar)*(&v12 + v7);
        if ( (uchar)*(&v12 + v8) == v9 )
        {
          *(&v12 + v7) = v9 + 1;
          if ( (uchar)*(&v12 + v7) >= 0x15u )
            *(&v12 + v7) = 0;
        }
        v8 = (v8 + 1) & 0xFF;
      }
      while ( v8 < v7 );
    }
    v7 = (v7 + 1) & 0xFF;
  }
  while ( v7 < 4 );
  v10 = 0;
  do
  {
    if ( v2 == (uchar)*(&v12 + v10) )
      return 1;
    v10 = (v10 + 1) & 0xFF;
  }
  while ( v10 < 4 );
  return 0;
}

//----- (021EFFE4) --------------------------------------------------------
int __fastcall LoadEncounterDataEx(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;

  v1 = a1;
  v2 = Function_21eff10(**(uint **)(a1 + 28));
  if ( v2 == 21 )
    ErrorHandler();
  v3 = LoadVariableAreaAdress_19(*(uint *)(v1 + 12));
  v4 = Function_202d840(v3);
  v5 = Function_202d84c(v2, v4);
  v6 = v5;
  v7 = LoadFromNARC_4(106, dword_21FF5A8[*(uchar *)(v5 + 5)], 4u);
  v8 = *(uint *)(v7 + 4 * *(uchar *)(v6 + 4));
  free(v7);
  return v8;
}

//----- (021F0030) --------------------------------------------------------
uint *__fastcall Function_21f0030(uint *result, int a2, uint *a3)
{
  if ( a2 >= 0 )
    result = Function_21efe7c((int)result, a3, a2, a2);
  return result;
}

//----- (021F0040) --------------------------------------------------------
uint *__fastcall Function_5_21f0040(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  uint *result;

  v1 = a1;
  v2 = Function_21eff10(**(uint **)(a1 + 28));
  if ( v2 == 21 )
    ErrorHandler();
  *(uint *)(*(uint *)(v1 + 168) + 8 * v2 + 4) = 0;
  v3 = LoadVariableAreaAdress_19(*(uint *)(v1 + 12));
  v4 = Function_202d840(v3);
  result = (uint *)Function_202d84c(v2, v4);
  *result = 0;
  return result;
}

//----- (021F007C) --------------------------------------------------------
int __fastcall Function_21f007c(int a1, int a2, int *a3)
{
  int *v3;

  v3 = a3;
  *a3 = Function_2006f88(65, 55, a3 + 1, 4);
  v3[15] = 0;
  Function_21f02b8(v3 + 10);
  Function_2019060(2u, 0);
  Function_201ff0c(4u, 1);
  return Function_2005748(0x648u);
}

//----- (021F00BC) --------------------------------------------------------
int __fastcall Function_21f00bc(int a1, int a2, int *a3)
{
  int *v3;
  int result;

  v3 = a3;
  *a3 = Function_2006f88(65, 55, a3 + 1, 4);
  v3[15] = 0;
  Function_21f02b8(v3 + 10);
  result = 0;
  v3[15] = 0;
  return result;
}

//----- (021F00E4) --------------------------------------------------------
uint __fastcall Function_21f00e4(int a1, int a2, int *a3)
{
  return free(*a3);
}

//----- (021F00F0) --------------------------------------------------------
uint __fastcall Function_21f00f0(int a1, int a2, uint *a3)
{
  uint *v3;
  uint result;

  v3 = a3;
  result = a3[15];
  if ( result != 1 )
  {
    if ( Function_21f02c8(a3 + 10) )
      v3[15] = 1;
    Function_20039f8(*(uint *)(v3[1] + 12), (int)(v3 + 2), 1u, v3[10] & 0xFF, 0x5D5Fu);
    result = Function_201972c(2u, (int)(v3 + 2), 32, 192);
  }
  return result;
}

//----- (021F013C) --------------------------------------------------------
int __fastcall Function_21f013c(int a1, int a2, int a3)
{
  int v3;

  v3 = a3;
  Function_21f0260(*(uint *)(a2 + 8));
  Function_21f02b8(v3);
  *(uint *)(v3 + 20) = 0;
  G2x_SetBlendAlpha_((int *)&REG_BLDCNT, 4, 41, 0, 16);
  Function_2019060(2u, 0);
  Function_201ff0c(4u, 1);
  return Function_2005748(0x648u);
}

//----- (021F0188) --------------------------------------------------------
int *__fastcall Function_21f0188(int a1, int a2, int a3)
{
  int v3;

  v3 = a3;
  Function_21f0260(*(uint *)(a2 + 8));
  Function_21f02b8(v3);
  *(uint *)(v3 + 20) = 0;
  return G2x_SetBlendAlpha_((int *)&REG_BLDCNT, 4, 33, 10, 6);
}

//----- (021F01BC) --------------------------------------------------------
void Function_21f01bc()
{
  ;
}

//----- (021F01C0) --------------------------------------------------------
short *__fastcall Function_21f01c0(int a1, int a2, int a3)
{
  int v3;
  short *result;

  v3 = a3;
  result = *(short **)(a3 + 20);
  if ( result != (short *)1 )
  {
    if ( Function_21f02c8(a3) )
      *(uint *)(v3 + 20) = 1;
    result = &REG_BLDALPHA;
    REG_BLDALPHA = *(ushort *)v3 | ((16 - *(ushort *)v3) << 8);
  }
  return result;
}

//----- (021F01EC) --------------------------------------------------------
void Function_21f01ec()
{
  ;
}

//----- (021F01F0) --------------------------------------------------------
uint *__fastcall Function_21f01f0(int a1)
{
  return Function_5_21d1b6c(*(uint **)(*(uint *)(a1 + 4) + 4), (int)dword_21FF658);
}

//----- (021F0204) --------------------------------------------------------
uint *__fastcall Function_21f0204(int a1)
{
  return Function_5_21d1b6c(*(uint **)(*(uint *)(a1 + 4) + 4), (int)dword_21FF610);
}

//----- (021F0218) --------------------------------------------------------
int __fastcall Function_21f0218(int result)
{
  return Function_5_21d1bec(result);
}

//----- (021F0220) --------------------------------------------------------
int __fastcall Function_21f0220(int a1)
{
  return *(uint *)(Function_5_21d1c2c(a1) + 20);
}

//----- (021F022C) --------------------------------------------------------
uint *__fastcall Function_21f022c(int a1)
{
  return Function_5_21d1b6c(*(uint **)(*(uint *)(a1 + 4) + 4), (int)dword_21FF628);
}

//----- (021F0240) --------------------------------------------------------
uint *__fastcall Function_21f0240(int a1)
{
  return Function_5_21d1b6c(*(uint **)(*(uint *)(a1 + 4) + 4), (int)dword_21FF640);
}

//----- (021F0254) --------------------------------------------------------
int __fastcall Function_21f0254(int a1)
{
  return *(uint *)(Function_5_21d1c2c(a1) + 60);
}

//----- (021F0260) --------------------------------------------------------
int __fastcall Function_21f0260(uint *a1, int a2, int a3, int a4)
{
  uint *v4;
  int *v5;
  short v7;
  int v8;

  v8 = a4;
  v4 = a1;
  v7 = 23903;
  Function_201972c(2u, (int)&v7, 2, 194);
  v5 = (int *)malloc(4u, 32);
  Call_FillMemWithValue(v5, 0x11u, 0x20u);
  Function_201958c(v4, 2u, v5, 32, 1);
  free((int)v5);
  return Function_2019ee0(v4, 2u, 24577);
}

//----- (021F02B8) --------------------------------------------------------
uint *__fastcall Function_21f02b8(uint *result, int a2, int a3, int a4)
{
  *result = a2;
  result[1] = a2;
  result[2] = a3 - a2;
  result[4] = a4;
  result[3] = 0;
  return result;
}

//----- (021F02C8) --------------------------------------------------------
int __fastcall Function_21f02c8(uint *a1)
{
  uint *v1;
  int v2;
  int v3;
  int result;

  v1 = a1;
  *v1 = s32_div_f(a1[3] * a1[2], a1[4]) + v1[1];
  v2 = v1[4];
  v3 = v1[3] + 1;
  if ( v3 > v2 )
  {
    v1[3] = v2;
    result = 1;
  }
  else
  {
    v1[3] = v3;
    result = 0;
  }
  return result;
}

//----- (021F02F4) --------------------------------------------------------
uint Function_21f02f4()
{
  return Function_201975c(2u, 0);
}

//----- (021F0300) --------------------------------------------------------
uint Function_21f0300()
{
  return Function_201975c(2u, 0x7FFF);
}

//----- (021F0310) --------------------------------------------------------
uint __fastcall Function_21f0310(int a1)
{
  int v1;
  short v3;

  v1 = a1;
  v3 = 0x7FFF;
  Function_201ff0c(4u, 0);
  REG_BG2CNT = REG_BG2CNT & 0xFFFC | 3;
  Function_201972c(2u, (int)&v3, 2, 196);
  Function_20196c0(*(uint **)(v1 + 8), 2, 2, 1, 2);
  Function_2019ee0(*(uint **)(v1 + 8), 2u, 24578);
  Function_201ff0c(4u, 1);
  return Function_21f02f4();
}

//----- (021F0374) --------------------------------------------------------
uint __fastcall Function_21f0374(int a1)
{
  int v1;
  short v3;

  v1 = a1;
  v3 = 0x7FFF;
  Function_201ff0c(8u, 0);
  REG_BG3CNT = REG_BG3CNT & 0xFFFC | 3;
  Function_201972c(3u, (int)&v3, 2, 196);
  Function_20196c0(*(uint **)(v1 + 8), 3, 2, 1, 2);
  Function_2019ee0(*(uint **)(v1 + 8), 3u, 24578);
  Function_201ff0c(8u, 1);
  return Function_21f02f4();
}

//----- (021F03D8) --------------------------------------------------------
int __fastcall Function_21f03d8(int a1)
{
  int v1;
  int v3;
  int *v4;
  uint v5;

  v1 = *(uint *)(*(uint *)(a1 + 4) + 12);
  if ( !v1 )
    return 0;
  v3 = Function_21d5fe0(v1);
  v4 = &dword_21FF608;
  v5 = 0;
  do
  {
    if ( v3 == *v4 )
      return 1;
    ++v5;
    ++v4;
  }
  while ( v5 < 1 );
  return 0;
}

//----- (021F0408) --------------------------------------------------------
int __fastcall Function_21f0408(int a1)
{
  int v1;
  int v3;
  int *v4;
  int v5;

  v1 = *(uint *)(*(uint *)(a1 + 4) + 12);
  if ( !v1 )
    return 0;
  v3 = Function_21d5fe0(v1);
  v4 = &dword_21FF60C;
  v5 = 0;
  do
  {
    if ( v3 == *v4 )
      return 1;
    ++v5;
    ++v4;
  }
  while ( v5 < 1 );
  return 0;
}

//----- (021F0438) --------------------------------------------------------
int __fastcall Function_21f0438(int a1)
{
  int v1;
  int v3;
  int *v4;
  int v5;

  v1 = *(uint *)(*(uint *)(a1 + 4) + 12);
  if ( !v1 )
    return 0;
  v3 = Function_21d5fe0(v1);
  v4 = &dword_21FF670;
  v5 = 0;
  do
  {
    if ( v3 == *v4 )
      return 0;
    ++v5;
    ++v4;
  }
  while ( v5 < 18 );
  return 1;
}

//----- (021F0468) --------------------------------------------------------
uint __fastcall Function_21f0468(int *a1)
{
  int *v1;
  int v2;

  v1 = a1;
  v2 = *a1;
  if ( v2 )
  {
    Function_21f0218(v2);
    *v1 = 0;
  }
  return free((int)v1);
}

//----- (021F0484) --------------------------------------------------------
int Function_21f0484()
{
  return 16;
}

//----- (021F0488) --------------------------------------------------------
int __fastcall Function_21f0488(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  uint v5;
  int v6;
  uint *v7;
  bool v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  uint *v15;
  int v16;
  int v17;
  int result;

  v1 = a1;
  v2 = LoadOverWorldDataAdress(a1);
  v3 = GetUnknownStruct01_c(v1);
  v4 = v3;
  v5 = *(ushort *)(v3 + 12);
  if ( v5 <= 9 )
    JUMPOUT(__CS__, *((short *)&off_21F04AE + v5) + 35587248);
  switch ( (uchar)v5 )
  {
    case 0:
      if ( Function_21f0438(v2) == 1 )
      {
        *(ushort *)(v4 + 12) = 1;
        *(uint *)(v4 + 8) = Function_21f03d8(v2);
        v6 = Function_21f0408(v2);
        *(uint *)(v4 + 4) = v6;
        if ( v6 )
          Function_21f0300();
      }
      else
      {
        *(ushort *)(v4 + 12) = 7;
        *(ushort *)(v4 + 14) = 20;
      }
      goto LABEL_47;
    case 1:
      if ( *(uint *)(v3 + 8) )
        v7 = Function_21f022c(v2);
      else
        v7 = Function_21f01f0(v2);
      *(uint *)v4 = v7;
      *(ushort *)(v4 + 12) = 2;
      Function_2019060(2u, 0);
      Function_201ff0c(4u, 1);
      goto LABEL_47;
    case 2:
      v8 = *(uint *)(v3 + 8) == 0;
      v9 = *(uint *)v3;
      if ( v8 )
        v10 = Function_21f0220(v9);
      else
        v10 = Function_21f0254(v9);
      if ( v10 == 1 )
      {
        *(ushort *)(v4 + 14) = 22;
        *(ushort *)(v4 + 12) = 3;
      }
      goto LABEL_47;
    case 3:
      --*(ushort *)(v3 + 14);
      if ( HasMapWildPkmn(**(uint **)(v2 + 28)) )
      {
        if ( *(short *)(v4 + 14) < 0 )
        {
          v11 = GetSpritePositionX(*(uint *)(v2 + 60));
          v12 = GetSpritePositionY(*(uint *)(v2 + 60));
          v14 = Function_2054f94(v2, v11, v12, v13);
          if ( ((int (__fastcall *)(int, int))dword_2242110[0])(v2, v14) )
            *(ushort *)(v4 + 12) = 6;
          else
            *(ushort *)(v4 + 12) = 4;
        }
      }
      else
      {
        *(ushort *)(v4 + 12) = 4;
      }
      goto LABEL_47;
    case 4:
      Function_21f0218(*(uint *)v3);
      if ( *(uint *)(v4 + 8) )
        v15 = Function_21f0240(v2);
      else
        v15 = Function_21f0204(v2);
      *(uint *)v4 = v15;
      *(ushort *)(v4 + 12) = 5;
      goto LABEL_47;
    case 5:
      v8 = *(uint *)(v3 + 8) == 0;
      v16 = *(uint *)v3;
      if ( v8 )
        v17 = Function_21f0220(v16);
      else
        v17 = Function_21f0254(v16);
      if ( v17 == 1 )
      {
        if ( *(uint *)(v4 + 8) )
        {
          Function_2019060(2u, 1);
        }
        else
        {
          Function_201ff0c(4u, 0);
          REG_BLDCNT = 0;
          Function_2019060(2u, 3);
          Function_2019ebc(*(uint **)(v2 + 8), 2u);
        }
        *(ushort *)(v4 + 12) = 8;
      }
      goto LABEL_47;
    case 6:
      Function_21f0468((int *)v3);
      if ( *(uint *)(v4 + 4) )
        Function_21f0374(v2);
      if ( !((int (__fastcall *)(int, int))dword_22411C8[0])(v2, v1) )
        ErrorHandler();
      goto LABEL_47;
    case 7:
      if ( (short)--*(ushort *)(v3 + 14) < 0 )
      {
        Function_203e8e0(v1, 0x7EDu, 0, 0);
        *(ushort *)(v4 + 12) = 9;
      }
      goto LABEL_47;
    case 8:
      Function_203e8e0(v1, 0x7ECu, 0, 0);
      *(ushort *)(v4 + 12) = 9;
      goto LABEL_47;
    case 9:
      Function_21f0468((int *)v3);
      if ( *(uint *)(v4 + 4) )
        Function_21f0310(v2);
      result = 1;
      break;
    default:
      ErrorHandler();
LABEL_47:
      result = 0;
      break;
  }
  return result;
}

//----- (021F067C) --------------------------------------------------------
int *__fastcall Function_21f067c(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  uint v6;
  int v7;
  int *v8;
  int v10;
  int v11;
  int v12;

  v4 = a3;
  v5 = a3 + 8 * a4 + 24;
  v12 = 8 * a4;
  v10 = a1;
  v6 = a2;
  v11 = a4;
  if ( Function_2017fc8(a1, a2, v5) != 1 )
    ErrorHandler();
  v7 = v5 - v4;
  v8 = (int *)malloc(v6, v7);
  if ( !v8 )
    ErrorHandler();
  Call_FillMemWithValue(v8, 0, v7);
  *v8 = v10;
  v8[1] = v6;
  v8[2] = v11;
  v8[3] = v5;
  v8[4] = v12;
  v8[5] = (int)(v8 + 6);
  return v8;
}

//----- (021F06D8) --------------------------------------------------------
uint __fastcall Function_21f06d8(int a1)
{
  int v1;
  int v2;
  uint *i;
  int v4;
  int v5;

  v1 = a1;
  v2 = *(uint *)(a1 + 8);
  for ( i = *(uint **)(a1 + 20); v2; i += 2 )
  {
    if ( *i )
    {
      v4 = i[1];
      Function_21f0740(v1);
    }
    --v2;
  }
  v5 = *(uint *)(v1 + 4);
  free(v1);
  return Function_201807c(v5);
}

//----- (021F070C) --------------------------------------------------------
int __fastcall Function_21f070c(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v10;

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v7 = a4;
  v10 = Function_21f07fc(a1);
  if ( !v10 )
    ErrorHandler();
  v8 = Function_21f07b4(v4, v6, v7);
  Function_21f0814(v10, v5, v8);
  return v8;
}

//----- (021F0740) --------------------------------------------------------
int Function_21f0740()
{
  uint *v0;

  v0 = (uint *)Function_21f07dc();
  if ( !v0 )
    ErrorHandler();
  Call_free20(*v0);
  return Function_21f081c(v0);
}

//----- (021F075C) --------------------------------------------------------
int Function_21f075c()
{
  int v0;

  v0 = Function_21f07dc();
  if ( !v0 )
    ErrorHandler();
  return *(uint *)v0;
}

//----- (021F0770) --------------------------------------------------------
BOOL Function_21f0770()
{
  return Function_21f07dc() != 0;
}

//----- (021F0784) --------------------------------------------------------
int __fastcall Function_21f0784(int a1, int a2, int a3, uint a4, int a5)
{
  int v5;
  int v6;
  uint v7;
  int v8;
  int v9;
  int v10;

  v5 = a3;
  v6 = a1;
  v7 = a4;
  v8 = a2;
  v9 = Function_2006d84_GetFilesize(a3, a4, a3, a4);
  v10 = Function_21f070c(v6, v8, v9, a5);
  LoadFileFromNARCFileHandler(v5, v7, v10);
  return v10;
}

//----- (021F07B4) --------------------------------------------------------
int __fastcall Function_21f07b4(int a1, int a2, int a3)
{
  uint v3;
  int v4;
  int v5;

  v3 = *(uint *)(a1 + 4);
  if ( a3 )
    v4 = malloc2(v3, a2);
  else
    v4 = malloc(v3, a2);
  v5 = v4;
  if ( !v4 )
    ErrorHandler();
  return v5;
}

//----- (021F07D4) --------------------------------------------------------
uint __fastcall Call_free20(int a1)
{
  return free(a1);
}

//----- (021F07DC) --------------------------------------------------------
uint *__fastcall Function_21f07dc(int a1, int a2)
{
  int v2;
  uint *result;

  v2 = *(uint *)(a1 + 8);
  result = *(uint **)(a1 + 20);
  if ( !v2 )
    return 0;
  while ( !*result || result[1] != a2 )
  {
    result += 2;
    if ( !--v2 )
      return 0;
  }
  return result;
}

//----- (021F07FC) --------------------------------------------------------
uint *__fastcall Function_21f07fc(int a1)
{
  int v1;
  uint *result;

  v1 = *(uint *)(a1 + 8);
  result = *(uint **)(a1 + 20);
  if ( !v1 )
    return 0;
  while ( *result )
  {
    result += 2;
    if ( !--v1 )
      return 0;
  }
  return result;
}

//----- (021F0814) --------------------------------------------------------
uint *__fastcall Function_21f0814(uint *result, int a2, int a3)
{
  *result = a3;
  result[1] = a2;
  return result;
}

//----- (021F081C) --------------------------------------------------------
uint *__fastcall Function_21f081c(uint *result)
{
  *result = 0;
  result[1] = 0;
  return result;
}

//----- (021F0824) --------------------------------------------------------
int __fastcall Function_21f0824(int *a1, int a2, int a3, int a4)
{
  int *v4;
  int v5;
  int result;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  int v20;

  v20 = a4;
  v4 = a1;
  v5 = a1[3];
  result = Function_205a080();
  v7 = result;
  if ( result )
  {
    v8 = 0;
    v14 = ((int (*)(void))dword_2242E28[0])() << 21;
    v13 = ((int (*)(void))dword_2242E40[0])() << 21;
    do
    {
      v9 = Function_20293b0(v7, v8);
      v15 = Function_20573fc(v9);
      result = Function_205740c(v9);
      v16 = result;
      if ( v9 )
      {
        v10 = Function_20293fc(v7, v8);
        v11 = Function_202942c(v7, v8);
        v18 = 4096;
        v17 = (v10 << 16) + v14 + (v15 << 15);
        v19 = (v11 << 16) + v13 + (v16 << 15);
        v12 = Function_5_21efae8(v4[12], v9);
        result = Function_5_21e19cc(v4[41], v4[12], v12, &v17, 0, v4[20]);
      }
      ++v8;
    }
    while ( v8 < 32 );
  }
  return result;
}

//----- (021F08CC) --------------------------------------------------------
int __fastcall Function_5_21f08cc(int a1, uint a2, int a3)
{
  int v3;
  int v4;
  uchar *v5;
  int v6;

  v3 = a3;
  v4 = malloc2(a2, 24);
  v5 = (uchar *)v4;
  v6 = 24;
  do
  {
    *v5++ = 0;
    --v6;
  }
  while ( v6 );
  *(uint *)(v4 + 12) = v3;
  *(uint *)(v4 + 4) = Function_21f0e58(v3);
  return v4;
}

//----- (021F08F8) --------------------------------------------------------
int __fastcall Function_5_21f08f8(int a1)
{
  uint *v1;
  int v2;
  int *v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int *v8;
  int v9;
  int result;

  v1 = (uint *)a1;
  v2 = LoadOverWorldDataAdress(a1);
  v3 = (int *)GetUnknownStruct01_c((int)v1);
  v4 = (int)v3;
  v5 = *v3;
  if ( !v5 )
  {
    Function_2062c48(*(uint *)(v2 + 56));
    *(uint *)(v4 + 16) = 0;
    *(uint *)(v4 + 8) = ((int (__fastcall *)(int, uint, int))dword_224106C[0])(v2, *(uint *)(v4 + 12), v4 + 16);
    *(uint *)(v4 + 20) = Function_21f09b4(v2, *(uint *)(v4 + 12), *(uint *)(v4 + 8));
    ++*(uint *)v4;
    return 0;
  }
  if ( v5 != 1 || Function_21f09d8(*(uint *)(v4 + 20)) != 1 )
    return 0;
  v6 = Function_21f09e4(*(uint *)(v4 + 20));
  Function_21f09f0(*(uint *)(v4 + 20));
  v7 = *(uint *)(v4 + 16);
  if ( v6 == 1 )
  {
    v8 = GetAdrOfPkmnInParty(*(uint **)(v7 + 8), 0);
    Function_206d340(v2, 1, *(uint *)(v4 + 4), v8);
    v9 = LoadVariableAreaAdress_14(*(uint *)(v2 + 12));
    Function_202cf28(v9, 10);
    Function_2050e78(v2, v1, *(int **)(v4 + 16));
    free(v4);
    result = 0;
  }
  else
  {
    if ( v7 )
      Function_20520a4((int *)v7);
    Sprite_ReleaseAll(*(uint *)(v2 + 56));
    free(v4);
    result = 1;
  }
  return result;
}

//----- (021F09B4) --------------------------------------------------------
uint *__fastcall Function_21f09b4(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v5;
  uint *v6;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = (uint *)Function_21f0d1c(76);
  v6[8] = v3;
  v6[7] = v4;
  *v6 = v5;
  return AddTaskToTaskList1((int)Function_21f0a04, (int)v6, 0x80u);
}

//----- (021F09D8) --------------------------------------------------------
int __fastcall Function_21f09d8(int a1)
{
  return *(uint *)(Function_201ced0(a1) + 4);
}

//----- (021F09E4) --------------------------------------------------------
int __fastcall Function_21f09e4(int a1)
{
  return *(uint *)(Function_201ced0(a1) + 8);
}

//----- (021F09F0) --------------------------------------------------------
int __fastcall Function_21f09f0(int a1)
{
  int *v1;
  int v2;

  v1 = (int *)a1;
  v2 = Function_201ced0(a1);
  free(v2);
  return Call_RemoveTaskFromTaskList(v1);
}

//----- (021F0A04) --------------------------------------------------------
int __fastcall Function_21f0a04(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int result;

  v2 = a2;
  v3 = *(uint *)(*(uint *)(a2 + 32) + 60);
  v4 = Function_205eb3c(*(uint *)(*(uint *)(a2 + 32) + 60));
  do
    result = ((int (__fastcall *)(int, int, int))*(&off_21FFA0C + *(uint *)(v2 + 12)))(v2, v3, v4);
  while ( result );
  return result;
}

//----- (021F0A30) --------------------------------------------------------
int __fastcall Function_21f0a30(int a1, int a2, uint *a3)
{
  uint *v3;
  int v4;
  int result;

  v3 = a3;
  v4 = a1;
  Function_21f0d6c();
  UnsetSpriteFlag_Lock(v3);
  result = 1;
  *(uint *)(v4 + 12) = 1;
  return result;
}

//----- (021F0A48) --------------------------------------------------------
int __fastcall Function_21f0a48(int a1, int a2, uint *a3)
{
  uint *v3;
  int v4;
  int v5;

  v3 = a3;
  v4 = a1;
  v5 = a2;
  if ( IsSpriteMovable(a3) == 1 )
  {
    Function_20656ac(v3);
    Function_5_21dfb54(v5, 32);
    Function_5_21dfb5c(v5);
    SetSpritea0((int)v3, 1);
    *(uint *)(v4 + 12) = 2;
  }
  return 0;
}

//----- (021F0A80) --------------------------------------------------------
int __fastcall Function_21f0a80(uint *a1)
{
  uint *v1;
  int v2;
  int v4;

  v1 = a1;
  v2 = a1[4] + 1;
  v1[4] = v2;
  if ( v2 == 10 )
    Function_2005748(0x650u);
  if ( v1[4] < 34 )
    return 0;
  if ( *v1 == 1 )
    v4 = 3;
  else
    v4 = 12;
  v1[3] = v4;
  v1[4] = 0;
  return 1;
}

//----- (021F0AB8) --------------------------------------------------------
int __fastcall Function_21f0ab8(uint *a1)
{
  uint *v1;
  uint v2;

  v1 = a1;
  v2 = PRNG();
  v1[5] = 30 * ((v2 >> 31) + __ROR4__((v2 << 30) - (v2 >> 31), 30) + 1);
  v1[6] = dword_21FFA00[v1[7]];
  v1[3] = 4;
  return 1;
}

//----- (021F0AEC) --------------------------------------------------------
int __fastcall Function_21f0aec(uint *a1, int a2, int a3)
{
  uint *v3;
  int v4;
  int result;

  v3 = a1;
  v4 = a3;
  --a1[5];
  if ( Function_21f0d40() == 1 )
  {
    v3[3] = 10;
    result = 1;
  }
  else if ( v3[5] <= 0 )
  {
    SetSpritea0(v4, 2);
    v3[9] = Function_5_21f5d8c(v4);
    v3[3] = 5;
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (021F0B30) --------------------------------------------------------
int __fastcall Function_21f0b30(int a1)
{
  int v1;
  int result;

  v1 = a1;
  --*(uint *)(a1 + 24);
  if ( Function_21f0d40() == 1 )
  {
    *(uint *)(v1 + 12) = 6;
    result = 1;
  }
  else
  {
    if ( *(uint *)(v1 + 24) <= 0 )
      *(uint *)(v1 + 12) = 11;
    result = 0;
  }
  return result;
}

//----- (021F0B5C) --------------------------------------------------------
int __fastcall Function_21f0b5c(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int result;

  v3 = a1;
  v4 = a3;
  Function_21f5c58(*(uint *)(a1 + 36));
  SetSpritea0(v4, 3);
  result = 0;
  *(uint *)(v3 + 16) = 0;
  *(uint *)(v3 + 12) = 7;
  return result;
}

//----- (021F0B7C) --------------------------------------------------------
int __fastcall Function_21f0b7c(int a1)
{
  uint *v1;
  int *v2;

  v1 = (uint *)a1;
  ++*(uint *)(a1 + 16);
  v2 = *(int **)(a1 + 36);
  if ( v2 )
  {
    Function_207136c(v2);
    v1[9] = 0;
  }
  if ( v1[4] > 15 )
  {
    v1[4] = 0;
    v1[3] = 8;
    Function_21f0de8(v1, 57);
  }
  return 0;
}

//----- (021F0BB0) --------------------------------------------------------
int __fastcall Function_21f0bb0(int a1)
{
  int v1;

  v1 = a1;
  if ( !Function_21f0e24() )
    return 0;
  *(uint *)(v1 + 12) = 9;
  return 1;
}

//----- (021F0BC8) --------------------------------------------------------
int __fastcall Function_21f0bc8(int a1)
{
  *(uint *)(a1 + 8) = 1;
  *(uint *)(a1 + 12) = 15;
  return 1;
}

//----- (021F0BD4) --------------------------------------------------------
int __fastcall Function_21f0bd4(int a1, int a2, int a3)
{
  int v3;

  v3 = a1;
  SetSpritea0(a3, 0);
  Function_21f0de8(v3, 56);
  *(uint *)(v3 + 16) = 16;
  *(uint *)(v3 + 12) = 14;
  return 1;
}

//----- (021F0BF4) --------------------------------------------------------
int __fastcall Function_21f0bf4(uint *a1, int a2, int a3)
{
  uint *v3;
  int v4;
  short v5;

  v3 = a1;
  SetSpritea0(a3, 0);
  Function_21f0de8(v3, 55);
  v3[4] = 16;
  v3[3] = 14;
  v4 = LoadVariableAreaAdress_14(*(uint *)(v3[8] + 12));
  Function_202cf28(v4, 100);
  v5 = Function_21f0e58(v3[7]);
  Function_206d340(v3[8], 0, v5, 0);
  return 1;
}

//----- (021F0C34) --------------------------------------------------------
int __fastcall Function_21f0c34(int a1)
{
  *(uint *)(a1 + 16) = 120;
  *(uint *)(a1 + 12) = 13;
  return 1;
}

//----- (021F0C40) --------------------------------------------------------
int __fastcall Function_21f0c40(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int result;

  v3 = a1;
  v4 = a3;
  --*(uint *)(a1 + 16);
  if ( Function_21f0d40() == 1 )
  {
    *(uint *)(v3 + 12) = 10;
    result = 1;
  }
  else
  {
    if ( !*(uint *)(v3 + 16) )
    {
      SetSpritea0(v4, 0);
      Function_21f0de8(v3, 54);
      *(uint *)(v3 + 16) = 16;
      *(uint *)(v3 + 12) = 14;
    }
    result = 0;
  }
  return result;
}

//----- (021F0C84) --------------------------------------------------------
int __fastcall Function_21f0c84(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  v2 = *(uint *)(a1 + 16) + 1;
  *(uint *)(a1 + 16) = v2;
  if ( v2 < 16 )
    return 0;
  *(uint *)(a1 + 16) = 16;
  if ( !Function_21f0e24() )
    return 0;
  *(uint *)(v1 + 12) = 15;
  return 1;
}

//----- (021F0CB0) --------------------------------------------------------
int __fastcall Function_21f0cb0(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;

  v2 = a1;
  v3 = *(uint *)(a1 + 36);
  v4 = a2;
  if ( v3 )
    Function_21f5c58(v3);
  Function_21f0da4(v2);
  v5 = Function_205eb74(v4);
  v6 = Function_205eed8(v5);
  Function_5_21dfb54(v4, v6);
  Function_5_21dfb5c(v4);
  *(uint *)(v2 + 16) = 0;
  *(uint *)(v2 + 12) = 16;
  return 1;
}

//----- (021F0CEC) --------------------------------------------------------
int __fastcall Function_21f0cec(int a1)
{
  int v1;

  v1 = *(uint *)(a1 + 16) + 1;
  *(uint *)(a1 + 16) = v1;
  if ( v1 > 2 )
    *(uint *)(a1 + 12) = 17;
  return 0;
}

//----- (021F0D00) --------------------------------------------------------
int __fastcall Function_21f0d00(int a1)
{
  int v1;
  int *v2;

  v1 = a1;
  v2 = *(int **)(a1 + 36);
  if ( v2 )
  {
    Function_207136c(v2);
    *(uint *)(v1 + 36) = 0;
  }
  *(uint *)(v1 + 4) = 1;
  return 0;
}

//----- (021F0D1C) --------------------------------------------------------
int *__fastcall Function_21f0d1c(int a1)
{
  uint v1;
  int *v2;

  v1 = a1;
  v2 = (int *)malloc2(4u, a1);
  if ( !v2 )
    ErrorHandler();
  Call_FillMemWithValue(v2, 0, v1);
  return v2;
}

//----- (021F0D40) --------------------------------------------------------
int Function_21f0d40()
{
  int result;

  result = 1;
  if ( !(dword_21BF6C4 & 1) )
    result = 0;
  return result;
}

//----- (021F0D54) --------------------------------------------------------
BOOL Function_21f0d54()
{
  return (dword_21BF6C4 & 3) != 0;
}

//----- (021F0D6C) --------------------------------------------------------
uint *__fastcall Function_21f0d6c(uint *a1)
{
  uint *v1;
  uint *result;

  v1 = a1;
  a1[18] = LoadFromMsgNARC(1, 26, 213, 4u);
  v1[11] = Function_2023790(1024, 4u);
  v1[12] = Function_2023790(1024, 4u);
  result = Function_200b368(8u, 64, 4u);
  v1[13] = result;
  return result;
}

//----- (021F0DA4) --------------------------------------------------------
ushort *__fastcall Function_21f0da4(int a1, int a2)
{
  int v2;
  int v3;
  int v4;

  v2 = a1;
  Function_200b3f0(*(uint **)(a1 + 52), a2);
  Function_20237bc_FreeMsg(*(uint *)(v2 + 44), v3);
  Function_20237bc_FreeMsg(*(uint *)(v2 + 48), v4);
  return Function_200b190(*(ushort **)(v2 + 72));
}

//----- (021F0DC4) --------------------------------------------------------
uint __fastcall Function_21f0dc4(int a1)
{
  int v1;
  int v2;
  ushort *v3;

  v1 = a1;
  v2 = *(uint *)(a1 + 32);
  Function_205d8f4(*(uint **)(v2 + 8), a1 + 56, 3);
  v3 = (ushort *)LoadPlayerDataAdress(*(uint *)(v2 + 12));
  return Function_205d944(v1 + 56, v3);
}

//----- (021F0DE8) --------------------------------------------------------
int __fastcall Function_21f0de8(int a1, uint a2)
{
  int v2;
  uint v3;
  int v4;
  ushort *v5;
  int result;

  v2 = a1;
  v3 = a2;
  Function_21f0dc4(a1);
  v4 = *(uint *)(v2 + 32);
  Function_200b1b8_CallMsgDecrypt(*(ushort ***)(v2 + 72), v3, *(ushort **)(v2 + 48));
  Function_200c388(*(uint **)(v2 + 52), *(uint *)(v2 + 44), *(uint *)(v2 + 48));
  v5 = (ushort *)LoadPlayerDataAdress(*(uint *)(v4 + 12));
  result = Function_205d994(v2 + 56, *(uint *)(v2 + 44), v5, 1);
  *(uchar *)(v2 + 40) = result;
  return result;
}

//----- (021F0E24) --------------------------------------------------------
int __fastcall Function_21f0e24(int a1)
{
  int v1;

  v1 = a1;
  if ( Function_205da04(*(uchar *)(a1 + 40)) != 1 || Function_21f0d54() != 1 )
    return 0;
  Function_200e084(v1 + 56, 0);
  Function_201a8fc(v1 + 56);
  return 1;
}

//----- (021F0E58) --------------------------------------------------------
int __fastcall Function_21f0e58(int a1)
{
  if ( !a1 )
    return 445;
  if ( a1 == 1 )
    return 446;
  if ( a1 != 2 )
  {
    ErrorHandler();
    return 445;
  }
  return 447;
}

//----- (021F0E84) --------------------------------------------------------
int __fastcall Function_5_21f0e84(int a1)
{
  return LOWORD(dword_21FFA54[a1]);
}

//----- (021F0E90) --------------------------------------------------------
int __fastcall Function_5_21f0e90(int a1, int a2)
{
  int result;

  if ( a1 != 487 || a2 != 1 )
    result = HIWORD(dword_21FFA54[a1]);
  else
    result = 0;
  return result;
}

//----- (021F0EB0) --------------------------------------------------------
uint *__fastcall Function_5_21f0eb0(int a1, uint a2)
{
  int v2;
  int v3;
  int *v4;
  int v5;
  int v6;

  v2 = a2;
  v3 = a1;
  v4 = (int *)malloc2(a2, 52);
  Call_FillMemWithValue(v4, 0, 0x34u);
  *v4 = v2;
  v4[3] = 0;
  v4[11] = v3;
  v5 = *(uint *)(v3 + 36);
  v4[12] = v5;
  v6 = Function_2020a90(v5);
  v4[4] = v6;
  v4[8] = v6;
  return AddTaskToTaskList1((int)Function_21f0f2c, (int)v4, 0xFFFFu);
}

//----- (021F0EF0) --------------------------------------------------------
int __fastcall Function_5_21f0ef0(int a1)
{
  return *(uint *)(Function_201ced0(a1) + 8);
}

//----- (021F0EFC) --------------------------------------------------------
int __fastcall Function_5_21f0efc(int a1)
{
  int *v1;
  int v2;

  v1 = (int *)a1;
  v2 = Function_201ced0(a1);
  free(v2);
  return Call_RemoveTaskFromTaskList(v1);
}

//----- (021F0F10) --------------------------------------------------------
uint *__fastcall Function_5_21f0f10(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  uint *result;

  v4 = a2;
  v5 = a3;
  v6 = a4;
  result = (uint *)Function_201ced0(a1);
  result[1] = 0;
  result[2] = 0;
  result[3] = v4;
  result[5] = v5;
  result[7] = v6;
  result[9] = 0;
  return result;
}

//----- (021F0F2C) --------------------------------------------------------
int __fastcall Function_21f0f2c(int a1, int a2)
{
  return ((int (__fastcall *)(int))*(&off_220020C + *(uint *)(a2 + 12)))(a2);
}

//----- (021F0F40) --------------------------------------------------------
int __fastcall Function_21f0f40(int result)
{
  *(uint *)(result + 8) = 1;
  return result;
}

//----- (021F0F48) --------------------------------------------------------
int __fastcall Function_21f0f48(int result)
{
  int v1;
  int v2;

  v1 = result;
  v2 = *(uint *)(result + 4);
  if ( v2 )
  {
    if ( v2 != 1 )
      return result;
  }
  else
  {
    Function_21f0fc8();
    ++*(uint *)(v1 + 4);
  }
  if ( Function_21f0ff8(v1) == 1 )
  {
    ++*(uint *)(v1 + 4);
    *(uint *)(v1 + 8) = 1;
  }
  return Function_21f0fb8(v1);
}

//----- (021F0F80) --------------------------------------------------------
int __fastcall Function_21f0f80(int result)
{
  int v1;
  int v2;

  v1 = result;
  v2 = *(uint *)(result + 4);
  if ( v2 )
  {
    if ( v2 != 1 )
      return result;
  }
  else
  {
    Function_21f0fe0();
    ++*(uint *)(v1 + 4);
  }
  if ( Function_21f0ff8(v1) == 1 )
  {
    ++*(uint *)(v1 + 4);
    *(uint *)(v1 + 8) = 1;
  }
  return Function_21f0fb8(v1);
}

//----- (021F0FB8) --------------------------------------------------------
int __fastcall Function_21f0fb8(int a1)
{
  return Function_2020a50(*(uint *)(a1 + 32), *(uint *)(a1 + 48));
}

//----- (021F0FC8) --------------------------------------------------------
int __fastcall Function_21f0fc8(uint *a1)
{
  uint *v1;
  int result;

  v1 = a1;
  a1[10] = s32_div_f(a1[5], a1[7]);
  result = v1[8] + v1[5];
  v1[6] = result;
  return result;
}

//----- (021F0FE0) --------------------------------------------------------
int __fastcall Function_21f0fe0(uint *a1)
{
  uint *v1;
  int result;

  v1 = a1;
  a1[10] = s32_div_f(a1[4] - a1[8], a1[7]);
  result = v1[4];
  v1[6] = result;
  return result;
}

//----- (021F0FF8) --------------------------------------------------------
int __fastcall Function_21f0ff8(uint *a1)
{
  uint v1;
  uint v2;

  a1[8] += a1[10];
  v1 = a1[9] + 1;
  a1[9] = v1;
  v2 = a1[7];
  if ( v1 < v2 )
    return 0;
  a1[9] = v2;
  a1[8] = a1[6];
  return 1;
}

//----- (021F101C) --------------------------------------------------------
int __fastcall Function_21f101c(int a1)
{
  int v1;
  uint *v2;
  uint *v3;
  uint *v4;
  int v5;
  uint v6;
  int *v7;
  int v8;
  int result;
  int v10;

  v1 = a1;
  v10 = LoadOverWorldDataAdress(a1);
  v2 = (uint *)GetUnknownStruct01_c(v1);
  v3 = (uint *)Function_2050a68(v1);
  v4 = (uint *)v2[1];
  switch ( (uchar)*v3 )
  {
    case 0u:
      v2[1] = malloc2(0xBu, 8);
      ++*v3;
      goto LABEL_9;
    case 1u:
      v5 = Function_21f0484();
      v6 = v5;
      v7 = (int *)malloc2(0xBu, v5);
      v4[1] = v7;
      Call_FillMemWithValue(v7, 0, v6);
      ++*v3;
      goto LABEL_9;
    case 2u:
      v8 = Function_205eb98(*(uint *)(v10 + 60));
      *v4 = ((int (__fastcall *)(int, uint, uint, int))dword_2243F88[0])(v10, 0, *v2, v8);
      ++*v3;
      goto LABEL_9;
    case 3u:
      if ( ((int (__fastcall *)(uint))dword_2243FBC[0])(*v4) )
      {
        ((void (__fastcall *)(uint))dword_2243FC8[0])(*v4);
        ++*v3;
      }
      goto LABEL_9;
    case 4u:
      Function_2050944(v1, (int)Function_21f0488, v4[1]);
      ++*v3;
      goto LABEL_9;
    case 5u:
      free(v2[1]);
      free((int)v2);
      result = 1;
      break;
    default:
LABEL_9:
      result = 0;
      break;
  }
  return result;
}

//----- (021F10E8) --------------------------------------------------------
int *__fastcall Function_21f10e8(uint *a1)
{
  uint *v1;
  int *result;

  v1 = a1;
  result = Function_21df53c(a1, 12, 0, 0);
  *result = (int)v1;
  return result;
}

//----- (021F10FC) --------------------------------------------------------
uint __fastcall Function_21f10fc(int a1)
{
  int v1;
  int v2;

  v1 = a1;
  Function_21f114c();
  v2 = *(uint *)(v1 + 8);
  if ( v2 )
    Function_5_21df554(v2);
  return Function_5_21df554(v1);
}

//----- (021F1118) --------------------------------------------------------
int (__fastcall *__fastcall Function_21f1118(int a1, int a2, uint a3, int *a4))(uint *a1, int a2, uint a3, int a4)
{
  int v4;

  v4 = a1;
  *(uint *)a1 = a2;
  Function_5_21dfb00(a4, (uchar *)(a1 + 4), 0, a3, 0);
  return Function_2073b70((int *)(v4 + 24), v4 + 4);
}

//----- (021F113C) --------------------------------------------------------
uchar *__fastcall Function_21f113c(uint *a1)
{
  *a1 = 0xFFFF;
  return Function_207395c((int)(a1 + 1));
}

//----- (021F114C) --------------------------------------------------------
uchar *__fastcall Function_21f114c(uchar *result)
{
  uint v1;
  uint v2;
  uint *v3;

  v1 = *((uint *)result + 1);
  v2 = 0;
  v3 = (uint *)*((uint *)result + 2);
  if ( v1 )
  {
    do
    {
      result = (uchar *)*v3;
      if ( *v3 != 0xFFFF )
        result = Function_21f113c(v3);
      ++v2;
      v3 += 27;
    }
    while ( v2 < v1 );
  }
  return result;
}

//----- (021F1174) --------------------------------------------------------
uint *__fastcall Function_21f1174(int a1, int a2)
{
  int v2;
  uint *result;

  v2 = *(uint *)(a1 + 4);
  result = *(uint **)(a1 + 8);
  while ( *result != a2 )
  {
    result += 27;
    if ( !--v2 )
      return 0;
  }
  return result;
}

//----- (021F1188) --------------------------------------------------------
int *__fastcall Function_21f1188(uint *a1, int a2)
{
  int v2;
  uint *v3;
  int v4;
  int *result;

  v2 = a2;
  v3 = a1;
  v4 = Function_21df55c();
  if ( !v2 )
    ErrorHandler();
  *(uint *)(v4 + 4) = v2;
  result = Function_21df53c(v3, 108 * v2, 0, 0);
  *(uint *)(v4 + 8) = result;
  do
  {
    *result = 0xFFFF;
    result += 27;
    --v2;
  }
  while ( v2 );
  return result;
}

//----- (021F11C0) --------------------------------------------------------
uint *__fastcall Function_21f11c0(int *a1, int a2, uint a3)
{
  int v3;
  int *v4;
  uint v5;
  int v6;
  int v7;
  uint *result;
  uint *v9;

  v3 = a2;
  v4 = a1;
  v5 = a3;
  v6 = Function_21df55c();
  v7 = v6;
  result = Function_21f1174(v6, v3);
  if ( !result )
  {
    v9 = Function_21f1174(v7, 0xFFFF);
    if ( v9 )
      result = Function_21f1118((int)v9, v3, v5, v4);
    else
      result = (uint *)ErrorHandler();
  }
  return result;
}

//----- (021F11FC) --------------------------------------------------------
int __fastcall Function_21f11fc(int a1, int a2)
{
  int v2;
  int v3;
  uint *v4;

  v2 = a2;
  v3 = Function_21df55c();
  v4 = Function_21f1174(v3, v2);
  if ( !v4 )
    ErrorHandler();
  return (int)(v4 + 6);
}

//----- (021F121C) --------------------------------------------------------
int *__fastcall Function_21f121c(int a1, int *a2, int a3, int a4)
{
  int v4;
  int *v5;
  int v6;
  int v7;
  int v9;
  int v10;
  int v11;
  int v12;

  v12 = a4;
  v4 = a1;
  v5 = a2;
  v6 = Function_21df578(a1);
  v9 = GetSpriteGraphic(v4);
  v10 = v6;
  v11 = v4;
  v7 = Function_2062758(v4, 2);
  return Function_5_21df72c(v6, dword_220021C, v5, 0, (int)&v9, v7);
}

//----- (021F1258) --------------------------------------------------------
int __fastcall Function_21f1258(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  int v5;
  uint *v6;
  bool v7;
  uint *v8;
  int v9;

  v2 = (uint *)a1;
  v3 = a2;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v4[1];
  v6 = v3 + 7;
  *v6 = *v4;
  v6[1] = v5;
  v3[9] = v4[2];
  v3[1] = GetSpriteID(v3[9]);
  v3[6] = Function_21f11fc(v3[8], v3[7]);
  v7 = Function_2062e94((uint *)v3[9]) == 1;
  v8 = (uint *)v3[9];
  if ( v7 )
    v9 = Function_2062c18(v8);
  else
    v9 = GetSprite_c((int)v8);
  v3[2] = v9;
  Function_20715e4(v2, v3 + 3);
  return 1;
}

//----- (021F12A8) --------------------------------------------------------
void Function_21f12a8()
{
  ;
}

//----- (021F12AC) --------------------------------------------------------
int *__fastcall Function_21f12ac(int *a1, int *a2)
{
  int *v2;
  uint *v3;
  int *v4;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;

  v2 = a2;
  v3 = (uint *)a2[9];
  v4 = a1;
  if ( !Function_2062764(v3, a2[1], a2[2]) )
    return Function_5_21df74c(v4);
  CopySprite70Struct(v3, &v9);
  Function_2063078(v3, &v6);
  v9 += v6 + v2[3];
  v10 += v7 + v2[4];
  v11 += v8 + v2[5];
  return (int *)Function_20715d4(v4, &v9);
}

//----- (021F1310) --------------------------------------------------------
int *__fastcall Function_21f1310(uint *a1, int a2, int a3, int a4)
{
  int v4;
  int v6[3];
  int v7;

  v7 = a4;
  v4 = a2;
  Function_20715e4(a1, v6);
  return Function_2073bb4(*(uint **)(v4 + 24), v6);
}

//----- (021F1328) --------------------------------------------------------
uint *__fastcall Function_21f1328(uint *a1)
{
  int v1;
  int *v2;
  int *v3;
  uint *result;

  v1 = 9;
  v2 = (int *)a1;
  v3 = &dword_2200230;
  Function_21f1188(a1, 9);
  do
  {
    result = Function_21f11c0(v2, *v3, v3[1]);
    v3 += 2;
    --v1;
  }
  while ( v1 );
  return result;
}

//----- (021F134C) --------------------------------------------------------
int *__fastcall Function_21f134c(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 352, 0, 0);
  v3 = v2;
  v2[8] = (int)v1;
  Function_21f14fc();
  Function_21f1388(v3);
  return v3;
}

//----- (021F1370) --------------------------------------------------------
uint __fastcall Function_21f1370(int a1)
{
  int v1;

  v1 = a1;
  Function_21f13ac();
  Function_21f153c(v1);
  return Function_5_21df554(v1);
}

//----- (021F1388) --------------------------------------------------------
uint *__fastcall Function_21f1388(int a1)
{
  int v1;
  int v2;
  int v3;
  uint *result;

  v1 = a1;
  v2 = Function_21df574(*(uint *)(a1 + 32));
  v3 = GetSpriteListc(*(uint *)(v2 + 56));
  result = AddTaskToTaskList1((int)Function_21f1424, v1, v3 - 1);
  *(uint *)(v1 + 36) = result;
  return result;
}

//----- (021F13AC) --------------------------------------------------------
int __fastcall Function_21f13ac(int a1)
{
  return Call_RemoveTaskFromTaskList(*(int **)(a1 + 36));
}

//----- (021F13B8) --------------------------------------------------------
int __fastcall Function_21f13b8(uint *a1, uint *a2)
{
  uint *v2;
  uint *v3;
  int v4;
  int result;

  v2 = a2;
  v4 = a1[6];
  v3 = a1 + 7;
  *v2 = a1[5];
  v2[1] = v4;
  result = a1[7];
  v2[2] = *v3;
  return result;
}

//----- (021F13C8) --------------------------------------------------------
int __fastcall Function_21f13c8(int a1)
{
  return a1 / 4096;
}

//----- (021F13D4) --------------------------------------------------------
int __fastcall Function_21f13d4(int *a1)
{
  int *v1;
  int *v2;
  int v3;
  int v4;
  int result;

  a1[4] = dword_2200284[a1[1]];
  v1 = a1;
  v2 = &dword_22002E4[3 * a1[1]];
  v3 = *v2;
  v4 = v2[1];
  v2 += 2;
  v1 += 5;
  *v1 = v3;
  v1[1] = v4;
  result = *v2;
  v1[2] = *v2;
  return result;
}

//----- (021F1400) --------------------------------------------------------
int *__fastcall Function_21f1400(int *result, int a2, int a3)
{
  int v3;
  int v4;
  int v5;

  v3 = *result;
  if ( *result >= a2 )
  {
    if ( v3 > a2 )
    {
      v5 = v3 - a3;
      *result = v5;
      if ( v5 < a2 )
        *result = a2;
    }
  }
  else
  {
    v4 = v3 + a3;
    *result = v4;
    if ( v4 > a2 )
      *result = a2;
  }
  return result;
}

//----- (021F1424) --------------------------------------------------------
int __fastcall Function_21f1424(int a1, int *a2)
{
  int *v2;
  int result;
  int v4;
  int v5;
  int v6;
  int v7;
  int *v8;
  int v9;
  int v10;
  int v11;
  int v12;

  v2 = a2;
  result = Function_2013960();
  v4 = *v2;
  v5 = result;
  if ( !*v2 )
  {
    v2[1] = result;
    Function_21f13d4(v2);
    v6 = Function_21f13c8(v2[4]);
    Function_21f1554(v2, v6);
    result = *v2 + 1;
    *v2 = result;
    return result;
  }
  if ( v4 == 1 )
  {
    result = v2[1];
    if ( result == v5 )
      return result;
    *v2 = 2;
  }
  else if ( v4 != 2 )
  {
    return result;
  }
  v7 = dword_2200284[v5];
  v8 = &dword_22002E4[3 * v5];
  v9 = *v8;
  v11 = v8[1];
  v12 = v8[2];
  Function_21f1400(v2 + 5, *v8, 16);
  Function_21f1400(v2 + 6, v11, 16);
  Function_21f1400(v2 + 7, v12, 16);
  Function_21f1400(v2 + 4, v7, 512);
  v10 = Function_21f13c8(v2[4]);
  Function_21f1554(v2, v10);
  result = v2[5];
  if ( v9 == result )
  {
    result = v11;
    if ( v11 == v2[6] )
    {
      result = v2[7];
      if ( v12 == result )
      {
        result = v2[4];
        if ( v7 == result )
        {
          v2[1] = v5;
          result = 1;
          *v2 = 1;
        }
      }
    }
  }
  return result;
}

//----- (021F14FC) --------------------------------------------------------
int (__fastcall *__fastcall Function_21f14fc(int a1))(uint *a1, int a2, uint a3, int a4)
{
  uint *v1;
  int v2;
  uchar *v3;
  int *v4;
  int (__fastcall *result)(uint *, int, uint, int);
  int v6;

  v1 = (uint *)&dword_2200278;
  v6 = a1;
  v2 = 0;
  v3 = (uchar *)(a1 + 40);
  v4 = (int *)(a1 + 100);
  do
  {
    Function_5_21dfb00(*(int **)(v6 + 32), v3, 0, *v1, 0);
    result = Function_2073b70(v4, (int)v3);
    ++v2;
    ++v1;
    v3 += 20;
    v4 += 21;
  }
  while ( v2 < 3 );
  return result;
}

//----- (021F153C) --------------------------------------------------------
uchar *__fastcall Function_21f153c(int a1)
{
  int v1;
  int v2;
  uchar *result;

  v1 = 0;
  v2 = a1 + 40;
  do
  {
    result = Function_207395c(v2);
    ++v1;
    v2 += 20;
  }
  while ( v1 < 3 );
  return result;
}

//----- (021F1554) --------------------------------------------------------
uint __fastcall Function_21f1554(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;

  v2 = a1;
  v3 = a2;
  Function_20b2d8c(*(uint *)(a1 + 52), 1, 2031616);
  return Function_20b3764(*(uint *)(v2 + 52), v3, v4, v5);
}

//----- (021F1570) --------------------------------------------------------
int *__fastcall Function_21f1570(int a1, int a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int v6;
  int v7;
  int v9[3];
  int v10;
  int v11;
  uint *v12;
  int v13;

  v13 = a4;
  v4 = (uint *)a1;
  v5 = Function_21df578(a1);
  v6 = v5;
  v10 = v5;
  v11 = Function_21df55c();
  v12 = v4;
  CopySprite70Struct(v4, v9);
  v7 = Function_2062758((int)v4, 2);
  return Function_5_21df72c(v6, dword_22002AC, v9, 0, (int)&v10, v7);
}

//----- (021F15B4) --------------------------------------------------------
int __fastcall Function_21f15b4(int a1, int *a2)
{
  int v2;
  int *v3;
  uint *v4;
  int v5;
  uint *v6;
  bool v7;
  uint *v8;
  int v9;

  v2 = a1;
  v3 = a2;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v4[1];
  v6 = v3 + 5;
  *v6 = *v4;
  v6[1] = v5;
  v3[7] = v4[2];
  v3[4] = Function_20715b4(v2);
  *v3 = GetSpriteGraphic(v3[7]);
  v3[1] = GetSpriteID(v3[7]);
  v7 = Function_2062e94((uint *)v3[7]) == 1;
  v8 = (uint *)v3[7];
  if ( v7 )
    v9 = Function_2062c18(v8);
  else
    v9 = GetSprite_c((int)v8);
  v3[2] = v9;
  return 1;
}

//----- (021F1600) --------------------------------------------------------
void Function_21f1600_Dummy()
{
  ;
}

//----- (021F1604) --------------------------------------------------------
int *__fastcall Function_21f1604(int *a1, int *a2, int a3, int a4)
{
  int *v4;
  uint *v5;
  int *v6;
  int *result;
  int v8[3];
  int v9;

  v9 = a4;
  v4 = a2;
  v5 = (uint *)a2[7];
  v6 = a1;
  if ( !Function_20627b4(v5, *a2, v4[1], v4[2]) )
    return Function_5_21df74c(v6);
  if ( Function_2062cbc((int)v5, 8) )
    return Function_5_21df74c(v6);
  v4[3] = 0;
  if ( CheckSpriteFlags(v5, 1049088) == 1 )
  {
    result = (int *)1;
    v4[3] = 1;
  }
  else
  {
    CopySprite70Struct(v5, v8);
    result = (int *)Function_20715d4(v6, v8);
  }
  return result;
}

//----- (021F1670) --------------------------------------------------------
int *__fastcall Function_21f1670(uint *a1, int a2, int a3, int a4)
{
  int v4;
  uint *v5;
  int *result;
  int *v7;
  char *v8;
  int v9;
  int v10;
  int v11;
  int v12;
  char v13;
  int v14[3];
  int v15;
  int v16;
  int v17;
  int v18;

  v18 = a4;
  v4 = a2;
  v5 = a1;
  result = *(int **)(a2 + 12);
  if ( !result )
  {
    v7 = dword_22002C0;
    v8 = &v13;
    v9 = 4;
    do
    {
      v10 = *v7;
      v11 = v7[1];
      v7 += 2;
      *(uint *)v8 = v10;
      *((uint *)v8 + 1) = v11;
      v8 += 8;
      --v9;
    }
    while ( v9 );
    *(uint *)v8 = *v7;
    v12 = *(uint *)(v4 + 24);
    Function_21f13b8(*(uint **)(v4 + 24), v14);
    Function_20715e4(v5, &v15);
    v15 -= 2048;
    v16 -= 0x4000;
    v17 += 4096;
    result = Function_2073ba4((uint *)(v12 + 100), &v15, v14, (int *)&v13);
  }
  return result;
}

//----- (021F16D4) --------------------------------------------------------
int *__fastcall Function_5_21f16d4(int a1, int a2)
{
  uint *v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int v8[3];
  int v9;
  int v10;
  uint *v11;

  v2 = (uint *)a1;
  v3 = a2;
  v4 = Function_21df578(a1);
  v5 = v4;
  v9 = v4;
  v10 = Function_21df55c();
  v11 = v2;
  CopySprite70Struct(v2, v8);
  v6 = Function_2062758((int)v2, 2);
  return Function_5_21df72c(v5, dword_2200298, v8, v3, (int)&v9, v6);
}

//----- (021F1718) --------------------------------------------------------
int *__fastcall Function_21f1718(int *a1, int *a2, int a3, int a4)
{
  int *v4;
  uint *v5;
  int *v6;
  int *result;
  int v8[3];
  int v9;

  v9 = a4;
  v4 = a2;
  v5 = (uint *)a2[7];
  v6 = a1;
  if ( !Function_20627b4(v5, *a2, v4[1], v4[2]) )
    return Function_5_21df74c(v6);
  v4[3] = 0;
  if ( CheckSpriteFlags(v5, 1049088) == 1 )
  {
    result = (int *)1;
    v4[3] = 1;
  }
  else
  {
    CopySprite70Struct(v5, v8);
    result = (int *)Function_20715d4(v6, v8);
  }
  return result;
}

//----- (021F176C) --------------------------------------------------------
int *__fastcall Function_21f176c(int *result, int a2, int a3, int a4)
{
  int v4;
  int *v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;

  v12 = a4;
  v4 = a2;
  v5 = result;
  if ( *(uint *)(a2 + 12) != 1 )
  {
    v6 = Function_20715b4((int)result);
    v7 = *(uint *)(v4 + 24);
    v8 = 84 * v6;
    Function_20715e4(v5, &v9);
    v9 -= 2048;
    v10 -= 0x4000;
    v11 += 4096;
    result = Function_2073bb4((uint *)(v7 + 100 + v8), &v9);
  }
  return result;
}

//----- (021F17B8) --------------------------------------------------------
int *__fastcall Function_21f17b8(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 4, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f17e4();
  return v3;
}

//----- (021F17D4) --------------------------------------------------------
uint __fastcall Function_21f17d4(int a1)
{
  int v1;

  v1 = a1;
  Function_21f17f4();
  return Function_5_21df554(v1);
}

//----- (021F17E4) --------------------------------------------------------
int __fastcall Function_21f17e4(int *a1)
{
  return Function_21df9e0(*a1, 2, 20);
}

//----- (021F17F4) --------------------------------------------------------
int __fastcall Function_21f17f4(int *a1)
{
  return Function_21dfa08(*a1);
}

//----- (021F1800) --------------------------------------------------------
int *__fastcall Function_21f1800(int a1, int a2)
{
  uint *v2;
  int v3;
  int v4;
  int v6;
  int v7;
  int v8;
  uint *v9;
  char v10;

  v2 = (uint *)a1;
  v3 = a2;
  v6 = GetSpriteSpriteListFirstSprite(a1);
  v7 = Function_21df578((int)v2);
  v8 = Function_21df55c();
  v9 = v2;
  CopySprite70Struct(v2, &v10);
  v4 = Function_2062758((int)v2, 2);
  return Function_5_21df72c(v7, dword_2200338, (int *)&v10, v3, (int)&v6, v4);
}

//----- (021F184C) --------------------------------------------------------
int __fastcall Function_21f184c(int a1, int *a2)
{
  int *v2;
  uint *v3;
  uint *v4;
  uint *v5;
  int v6;
  uint *v7;
  int v8;
  int v9;
  char v11;

  v2 = a2;
  v3 = (uint *)a1;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v2 + 5;
  v6 = v4[1];
  *v5 = *v4;
  v5[1] = v6;
  v7 = v2 + 7;
  v8 = v4[3];
  *v7 = v4[2];
  v7[1] = v8;
  v2[4] = Function_20715b4((int)v3);
  *v2 = GetSpriteID(v2[8]);
  v2[1] = GetSprite_c(v2[8]);
  v9 = GetSpriteGraphic(v2[8]);
  v2[2] = v9;
  if ( IsValueSpriteBerrytree(v9) == 1 )
    v2[2] = Function_2067800(v2[8]);
  v2[10] = 4096;
  v2[11] = 4096;
  v2[12] = 4096;
  v2[13] = 64;
  if ( v2[4] == 2 )
    v2[13] = 0;
  Function_21f1a24(v2, v2[8], &v11);
  Function_20715d4(v3, (int *)&v11);
  Function_21f1a8c(v3, v2);
  return 1;
}

//----- (021F18D0) --------------------------------------------------------
int __fastcall Function_21f18d0(int a1, int a2)
{
  int result;

  result = *(uint *)(a2 + 12);
  if ( result == 1 )
    result = Function_20211fc(*(uint *)(a2 + 36));
  return result;
}

//----- (021F18E0) --------------------------------------------------------
int *__fastcall Function_21f18e0(int *a1, int *a2)
{
  int *v2;
  uint *v3;
  int *v4;
  int v5;
  int *result;
  int v7;
  char v8;

  v2 = a2;
  v3 = (uint *)a2[8];
  v4 = a1;
  v5 = GetSpriteGraphic(a2[8]);
  if ( IsValueSpriteBerrytree(v5) == 1 )
    v5 = Function_2067800(v2[8]);
  if ( v2[2] != v5 || !Function_2062764(v3, *v2, v2[1]) || !IsSetSpriteFlags1000000(v3) )
    return Function_5_21df74c(v4);
  v7 = v2[10] + v2[13];
  v2[10] = v7;
  if ( v7 < 4608 )
  {
    if ( v7 <= 3584 )
    {
      v2[10] = 3584;
      v2[13] = -v2[13];
    }
  }
  else
  {
    v2[10] = 4608;
    v2[13] = -v2[13];
  }
  Function_21f1a24(v2, v3, &v8);
  Function_20715d4(v4, (int *)&v8);
  result = (int *)v2[3];
  if ( !result )
    result = (int *)Function_21f1a8c(v4, v2);
  return result;
}

//----- (021F1978) --------------------------------------------------------
int *__fastcall Function_21f1978(int *a1, int *a2)
{
  int *v2;
  uint *v3;
  int *v4;
  int v5;
  int *result;
  bool v7;
  uint v8;
  int v9;
  int v10;
  short v11;
  int v12;
  char v13;

  v2 = a2;
  v3 = (uint *)a2[8];
  v4 = a1;
  v5 = GetSpriteGraphic(a2[8]);
  if ( IsValueSpriteBerrytree(v5) == 1 )
    v5 = Function_2067800(v2[8]);
  if ( v2[2] != v5 || !Function_2062764(v3, *v2, v2[1]) || !IsSetSpriteFlags1000000(v3) )
    return Function_5_21df74c(v4);
  result = (int *)v2[3];
  if ( result )
  {
    v7 = CheckSpriteFlag_200(v3) == 1;
    v8 = v2[9];
    if ( v7 )
      Function_2021320(v8, 0);
    else
      Function_2021320(v8, 1);
    Function_20715e4(v4, &v13);
    Function_20212a8((uint *)v2[9], &v13);
    Function_20212d0(v2[9], v2 + 10);
    v9 = Function_5_21eb1a0(v2[8]);
    v10 = v9;
    v11 = Function_2021358(v9);
    Function_2021344(v2[9], v11);
    v12 = Function_2021394(v10);
    result = (int *)Function_2021380(v2[9], v12);
  }
  return result;
}

//----- (021F1A24) --------------------------------------------------------
int __fastcall Function_21f1a24(int a1, uint *a2, int *a3, int a4)
{
  int *v4;
  int v5;
  uint *v6;
  int v7;
  int v8;
  int v9;
  int result;
  int v11;
  int v12;
  int v13;
  int v14;

  v14 = a4;
  v4 = a3;
  v5 = a1;
  v6 = a2;
  v11 = 49152;
  v12 = 0x10000;
  v13 = 49152;
  Function_2063078(a2, a3);
  v7 = -v4[2];
  v8 = *v4;
  CopySprite70Struct(v6, v4);
  v9 = Function_20644a4(*(uint *)(v5 + 20), v4);
  *v4 += v8;
  v4[2] += v7 - 28672;
  if ( v9 )
  {
    result = v4[1] - *(&v11 + *(uint *)(v5 + 16));
    v4[1] = result;
  }
  else
  {
    result = 0;
    v4[1] = 0;
  }
  return result;
}

//----- (021F1A8C) --------------------------------------------------------
int __fastcall Function_21f1a8c(uint *a1, int a2)
{
  int v2;
  uint *v3;
  int v4;
  int result;
  int v6;
  char v7;

  v2 = a2;
  v3 = a1;
  v4 = GetSpriteSpriteList(*(uint *)(a2 + 32));
  result = Function_21ed150(v4, *(uint *)(v2 + 8), &v6);
  if ( result )
  {
    result = Function_5_21edd94(*(uint **)(v2 + 32));
    if ( result != 1 )
    {
      v6 = Function_21df9fc(*(uint *)(v2 + 24), 2);
      Function_20715e4(v3, &v7);
      *(uint *)(v2 + 36) = Function_21df7f8(*(uint *)(v2 + 24), (int)&v6, (int *)&v7);
      result = 1;
      *(uint *)(v2 + 12) = 1;
    }
  }
  return result;
}

//----- (021F1AD8) --------------------------------------------------------
int __fastcall Function_21f1ad8(uint *a1, int a2, int a3, int a4)
{
  int v4;
  uint *v5;
  int *v6;
  int *v7;
  int v8;
  int v9;
  int v10;
  int v11;
  short v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v18;
  int v19[3];
  int v20;

  v20 = a4;
  v4 = a2;
  v5 = a1;
  v6 = (int *)(a2 + 16);
  v7 = &v18;
  v8 = 5;
  do
  {
    v9 = *v6;
    v10 = v6[1];
    v6 += 2;
    *v7 = v9;
    v7[1] = v10;
    v7 += 2;
    --v8;
  }
  while ( v8 );
  v18 = Function_21df9fc(*(uint *)(v4 + 8), 2);
  Function_20715e4(v5, v19);
  *(uint *)(v4 + 60) = Function_21df7f8(*(uint *)(v4 + 8), (int)&v18, v19);
  v11 = *(uint *)(v4 + 56);
  v12 = Function_2021358(*(uint *)(v4 + 56));
  Function_2021344(*(uint *)(v4 + 60), v12);
  v13 = Function_20213d4(v11);
  Function_20213a4(*(uint *)(v4 + 60), v13);
  v14 = Function_2021394(v11);
  Function_2021380(*(uint *)(v4 + 60), v14);
  Function_2021368(*(uint *)(v4 + 60), 0);
  return Function_2021414(*(uint *)(v4 + 60), v15, v16);
}

//----- (021F1B4C) --------------------------------------------------------
int __fastcall Function_21f1b4c(int *a1, int *a2)
{
  int *v2;
  int *v3;
  int v4;
  int v5;
  int result;
  int v7;
  int v8;
  int v9;

  v2 = a1;
  v3 = a2;
  v7 = 49152;
  v8 = 0x10000;
  v9 = 49152;
  v4 = a1[21];
  *v3 = a1[20];
  v3[1] = v4;
  v3[2] = a1[22];
  v5 = Function_20644a4(a1[1], v3);
  v3[2] -= 28672;
  if ( v5 )
  {
    result = v3[1] - *(&v7 + *v2);
    v3[1] = result;
  }
  else
  {
    result = 0;
    v3[1] = 0;
  }
  return result;
}

//----- (021F1BA4) --------------------------------------------------------
int *__fastcall Function_21f1ba4(int a1, int *a2, int a3, int a4, int a5, uint a6)
{
  int v6;
  int *v7;
  int v8;
  int *v9;
  char *v10;
  int v11;
  int v12;
  int v13;
  int v15;
  int v16;
  int v17;
  char v18;
  int v19;
  int v20;

  v20 = a4;
  v6 = a1;
  v7 = a2;
  v8 = a3;
  v9 = (int *)a4;
  v15 = Function_21df574(a1);
  v16 = v6;
  v17 = Function_21df55c();
  v10 = &v18;
  v11 = 5;
  do
  {
    v12 = *v7;
    v13 = v7[1];
    v7 += 2;
    *(uint *)v10 = v12;
    *((uint *)v10 + 1) = v13;
    v10 += 8;
    --v11;
  }
  while ( v11 );
  v19 = v8;
  return Function_5_21df72c(v6, dword_220034C, v9, a5, (int)&v15, a6);
}

//----- (021F1BEC) --------------------------------------------------------
int __fastcall Function_21f1bec(int a1, int *a2, int a3, int a4)
{
  uint *v4;
  int *v5;
  int *v6;
  uint *v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  char v14;
  int v15;

  v15 = a4;
  v4 = (uint *)a1;
  v5 = a2;
  v6 = (int *)Function_20715bc(a1);
  v7 = v5 + 1;
  v8 = 7;
  do
  {
    v9 = *v6;
    v10 = v6[1];
    v6 += 2;
    *v7 = v9;
    v7[1] = v10;
    v7 += 2;
    --v8;
  }
  while ( v8 );
  *v5 = Function_20715b4((int)v4);
  v5[16] = 4096;
  v5[17] = 4096;
  v5[18] = 4096;
  v5[19] = 64;
  if ( *v5 == 2 )
    v5[19] = 0;
  Function_20715e4(v4, v5 + 20);
  Function_21f1b4c(v5, (int *)&v14);
  Function_20715d4(v4, (int *)&v14);
  Function_21f1ad8(v4, (int)v5, v11, v12);
  Function_207153c((int)v4);
  return 1;
}

//----- (021F1C54) --------------------------------------------------------
int __fastcall Function_21f1c54(int a1, int a2)
{
  return Function_20211fc(*(uint *)(a2 + 60));
}

//----- (021F1C60) --------------------------------------------------------
int __fastcall Function_21f1c60(uint *a1, int *a2, int a3, int a4)
{
  uint *v4;
  int v5;
  char v7;
  int v8;

  v8 = a4;
  v4 = a1;
  v5 = a2[16] + a2[19];
  a2[16] = v5;
  if ( v5 < 4608 )
  {
    if ( v5 <= 3584 )
    {
      a2[16] = 3584;
      a2[19] = -a2[19];
    }
  }
  else
  {
    a2[16] = 4608;
    a2[19] = -a2[19];
  }
  Function_21f1b4c(a2, (int *)&v7);
  return Function_20715d4(v4, (int *)&v7);
}

//----- (021F1CA4) --------------------------------------------------------
int __fastcall Function_21f1ca4(uint *a1, int a2, int a3, int a4)
{
  int v4;
  char v6;
  int v7;

  v7 = a4;
  v4 = a2;
  Function_20715e4(a1, &v6);
  Function_20212a8(*(uint **)(v4 + 60), &v6);
  return Function_20212d0(*(uint *)(v4 + 60), (uint *)(v4 + 64));
}

//----- (021F1CC8) --------------------------------------------------------
int *__fastcall Function_21f1cc8(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 2084, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f1cf8();
  return v3;
}

//----- (021F1CE8) --------------------------------------------------------
uint __fastcall Function_21f1ce8(int a1)
{
  int v1;

  v1 = a1;
  Function_21f1d80();
  return Function_5_21df554(v1);
}

//----- (021F1CF8) --------------------------------------------------------
uint __fastcall Function_21f1cf8(int a1)
{
  uchar *v1;
  uint *v2;
  uint *v3;
  uchar *v4;
  uint result;
  int **v6;
  int *v7;
  int *v8;
  uint v9;

  v6 = (int **)a1;
  v9 = 0;
  v1 = (uchar *)(a1 + 4);
  v8 = (int *)(a1 + 404);
  v2 = (uint *)&dword_220039C;
  v3 = (uint *)&dword_2200374;
  v4 = (uchar *)(a1 + 204);
  v7 = (int *)(a1 + 1244);
  do
  {
    Function_5_21dfb00(*v6, v1, 0, *v2, 0);
    Function_2073b70(v8, (int)v1);
    Function_5_21dfb00(*v6, v4, 0, *v3, 0);
    Function_2073b70(v7, (int)v4);
    ++v2;
    v8 += 21;
    v1 += 20;
    v7 += 21;
    ++v3;
    result = v9 + 1;
    v4 += 20;
    v9 = result;
  }
  while ( result < 0xA );
  return result;
}

//----- (021F1D80) --------------------------------------------------------
uchar *__fastcall Function_21f1d80(int a1)
{
  int v1;
  int v2;
  int v3;
  uchar *result;

  v1 = 0;
  v2 = a1 + 4;
  v3 = a1 + 204;
  do
  {
    Function_207395c(v2);
    result = Function_207395c(v3);
    ++v1;
    v2 += 20;
    v3 += 20;
  }
  while ( v1 < 10 );
  return result;
}

//----- (021F1DA4) --------------------------------------------------------
int __fastcall Function_21f1da4(int a1, char a2, int a3, int a4)
{
  int v4;

  v4 = 0;
  switch ( a2 )
  {
    case 0:
      v4 = a1 + 404 + 84 * a3;
      break;
    case 1:
      v4 = a1 + 404 + 84 * dword_22003C4[4 * a4 + a3];
      break;
    case 2:
    case 4:
      v4 = a1 + 1244 + 84 * a3;
      break;
    case 3:
      v4 = a1 + 1244 + 84 * dword_22003C4[4 * a4 + a3];
      break;
    default:
      break;
  }
  if ( !v4 )
    ErrorHandler();
  return v4;
}

//----- (021F1E24) --------------------------------------------------------
int __fastcall Function_21f1e24(int a1, char a2, int a3, int a4)
{
  int v4;

  v4 = 0;
  switch ( a2 )
  {
    case 0:
      v4 = a1 + 4 + 20 * a3;
      break;
    case 1:
      v4 = a1 + 4 + 20 * dword_22003C4[4 * a4 + a3];
      break;
    case 2:
    case 4:
      v4 = a1 + 204 + 20 * a3;
      break;
    case 3:
      v4 = a1 + 204 + 20 * dword_22003C4[4 * a4 + a3];
      break;
    default:
      break;
  }
  if ( !v4 )
    ErrorHandler();
  return v4;
}

//----- (021F1E8C) --------------------------------------------------------
int __fastcall Function_21f1e8c(int a1)
{
  return Function_21f1ecc(a1, 0);
}

//----- (021F1E98) --------------------------------------------------------
int __fastcall Function_21f1e98(int a1)
{
  return Function_21f1ecc(a1, 1);
}

//----- (021F1EA4) --------------------------------------------------------
int __fastcall Function_21f1ea4(int a1)
{
  return Function_21f1ecc(a1, 2);
}

//----- (021F1EB0) --------------------------------------------------------
int __fastcall Function_21f1eb0(int a1)
{
  return Function_21f1ecc(a1, 3);
}

//----- (021F1EBC) --------------------------------------------------------
int __fastcall Function_5_21f1ebc(int a1)
{
  return Function_21f1ecc(a1, 4);
}

//----- (021F1EC8) --------------------------------------------------------
int Function_21f1ec8()
{
  return 0;
}

//----- (021F1ECC) --------------------------------------------------------
int *__fastcall Function_21f1ecc(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  char v11;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;

  v2 = a1;
  v3 = a2;
  v4 = GetSpriteX2(a1);
  v5 = GetSpriteY2(v2);
  v6 = GetSprite74(v2);
  v7 = LoadSpriteFaceDirection(v2);
  v8 = LoadSpriteOldFaceDirection(v2);
  v9 = Function_2062758(v2, 2);
  v13 = Function_21df578(v2);
  v10 = Function_21df55c();
  v14 = v3;
  v16 = Function_21f1da4(v10, v3, v7, v8);
  v15 = Function_21f1e24(v10, v3, v7, v8);
  v11 = Function_2064450(v4, v5, &v17);
  v18 = v6;
  switch ( v11 )
  {
    case 0:
    case 1:
    case 4:
    case 5:
      v18 = v6 - 0x8000;
      if ( (uint)(v3 - 2) > 1 )
        v19 += 4096;
      else
        v19 -= 0x2000;
      break;
    case 2:
    case 3:
      v18 = v6 - 40960;
      if ( (uint)(v3 - 2) > 1 )
        v19 += 0x2000;
      else
        v19 -= 0x2000;
      break;
    default:
      return Function_5_21df72c(v13, dword_2200360, &v17, 0, (int)&v14, v9);
  }
  return Function_5_21df72c(v13, dword_2200360, &v17, 0, (int)&v14, v9);
}

//----- (021F1FB8) --------------------------------------------------------
int __fastcall Function_21f1fb8(int a1, uint *a2)
{
  int v2;
  uint *v3;
  uint *v4;

  v2 = a1;
  v3 = a2;
  a2[4] = Function_20715b4(a1);
  v4 = (uint *)Function_20715bc(v2);
  v3[6] = v4[2];
  v3[5] = v4[1];
  v3[3] = 31;
  v3[4] = *v4;
  return 1;
}

//----- (021F1FE0) --------------------------------------------------------
void Function_21f1fe0()
{
  ;
}

//----- (021F1FE4) --------------------------------------------------------
int *__fastcall Function_21f1fe4(int *result, int **a2)
{
  int v2;

  if ( *a2 )
  {
    if ( *a2 == (int *)1 )
    {
      v2 = (int)a2[3] - 2;
      a2[3] = (int *)v2;
      if ( v2 < 0 )
        result = Function_5_21df74c(result);
    }
  }
  else
  {
    result = (int *)((char *)a2[1] + 1);
    a2[1] = result;
    if ( (int)result >= 16 )
    {
      result = (int *)((char *)*a2 + 1);
      *a2 = result;
    }
  }
  return result;
}

//----- (021F2014) --------------------------------------------------------
int *__fastcall Function_21f2014(int *result, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7[3];
  int v8;

  v8 = a4;
  v4 = a2;
  if ( !*(uint *)(a2 + 8) )
  {
    Function_20715e4(result, v7);
    Function_20b2d8c(*(uint *)(*(uint *)(v4 + 20) + 12), 1, 2031616);
    Function_20b3764(*(uint *)(*(uint *)(v4 + 20) + 12), *(uint *)(v4 + 12), v5, v6);
    result = Function_2073bb4(*(uint **)(v4 + 24), v7);
  }
  return result;
}

//----- (021F204C) --------------------------------------------------------
int *__fastcall Function_21f204c(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 316, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f2078();
  return v3;
}

//----- (021F2068) --------------------------------------------------------
uint __fastcall Function_21f2068(int a1)
{
  int v1;

  v1 = a1;
  Function_21f20b8();
  return Function_5_21df554(v1);
}

//----- (021F2078) --------------------------------------------------------
int (__fastcall *__fastcall Function_21f2078(int a1))(uint *a1, int a2, uint a3, int a4)
{
  uint *v1;
  int v2;
  uchar *v3;
  int *v4;
  int (__fastcall *result)(uint *, int, uint, int);
  int **v6;

  v1 = (uint *)&dword_2200404;
  v6 = (int **)a1;
  v2 = 0;
  v3 = (uchar *)(a1 + 256);
  v4 = (int *)(a1 + 4);
  do
  {
    Function_5_21dfb00(*v6, v3, 0, *v1, 0);
    result = Function_2073b70(v4, (int)v3);
    ++v2;
    ++v1;
    v3 += 20;
    v4 += 21;
  }
  while ( v2 < 3 );
  return result;
}

//----- (021F20B8) --------------------------------------------------------
uchar *__fastcall Function_21f20b8(int a1)
{
  int v1;
  int v2;
  uchar *result;

  v1 = 0;
  v2 = a1 + 256;
  do
  {
    result = Function_207395c(v2);
    ++v1;
    v2 += 20;
  }
  while ( v1 < 3 );
  return result;
}

//----- (021F20D4) --------------------------------------------------------
int *__fastcall Function_5_21f20d4(int a1, int a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int v6;
  int v7;
  int v9[3];
  int v10;
  int v11;
  uint *v12;
  int v13;

  v13 = a4;
  v4 = (uint *)a1;
  v5 = Function_21df578(a1);
  v6 = v5;
  v10 = v5;
  v11 = Function_21df55c();
  v12 = v4;
  CopySprite70Struct(v4, v9);
  v7 = GetSpriteSpriteListc((int)v4);
  return Function_5_21df72c(v6, dword_2200438, v9, 0, (int)&v10, v7 + 1);
}

//----- (021F2118) --------------------------------------------------------
int __fastcall Function_21f2118(int a1, int *a2)
{
  int *v2;
  uint *v3;
  int v4;
  uint *v5;

  v2 = a2;
  v3 = (uint *)Function_20715bc(a1);
  v4 = v3[1];
  v5 = v2 + 4;
  *v5 = *v3;
  v5[1] = v4;
  v2[6] = v3[2];
  *v2 = GetSpriteID(v2[6]);
  v2[1] = GetSprite_c(v2[6]);
  return 1;
}

//----- (021F2144) --------------------------------------------------------
void Function_21f2144()
{
  ;
}

//----- (021F2148) --------------------------------------------------------
int *__fastcall Function_21f2148(int *a1, int *a2, int a3, int a4)
{
  int *v4;
  uint *v5;
  int *v6;
  int *result;
  int v8;
  int v9;
  int v10[3];
  int v11;

  v11 = a4;
  v4 = a2;
  v5 = (uint *)a2[6];
  v6 = a1;
  if ( !Function_2062764(v5, *a2, a2[1]) )
    return Function_5_21df74c(v6);
  v4[2] = 0;
  if ( CheckSpriteFlags(v5, 512) != 1 && (v8 = GetSpriteSpriteListFirstSprite((int)v5), Function_2055f00(v8, v5)) )
  {
    v9 = GetSpriteSpriteListFirstSprite((int)v5);
    v4[3] = Function_2055f88(v9, v5);
    CopySprite70Struct(v5, v10);
    result = (int *)Function_20715d4(v6, v10);
  }
  else
  {
    result = (int *)1;
    v4[2] = 1;
  }
  return result;
}

//----- (021F21B8) --------------------------------------------------------
int *__fastcall Function_21f21b8(int *result, int a2, int a3, int a4)
{
  int v4;
  int v5[3];
  int v6;

  v6 = a4;
  v4 = a2;
  if ( *(uint *)(a2 + 8) != 1 )
  {
    Function_20715e4(result, v5);
    result = Function_2073bb4((uint *)(*(uint *)(v4 + 20) + 4 + 84 * *(uint *)(v4 + 12)), v5);
  }
  return result;
}

//----- (021F21E0) --------------------------------------------------------
int *__fastcall Function_21f21e0(uint *a1)
{
  uint *v1;
  int *result;

  v1 = a1;
  result = Function_21df53c(a1, 12, 0, 0);
  result[2] = (int)v1;
  return result;
}

//----- (021F21F4) --------------------------------------------------------
uint __fastcall Function_21f21f4(int a1)
{
  int v1;

  v1 = a1;
  Function_21f226c();
  return Function_5_21df554(v1);
}

//----- (021F2204) --------------------------------------------------------
uint *__fastcall Function_21f2204(uint *result)
{
  ++*result;
  return result;
}

//----- (021F220C) --------------------------------------------------------
uint *__fastcall Function_21f220c(uint *result)
{
  bool v1;

  v1 = (*result)-- - 1 < 0;
  if ( v1 )
    result = (uint *)ErrorHandler();
  return result;
}

//----- (021F221C) --------------------------------------------------------
int __fastcall Function_21f221c(int a1)
{
  int v1;
  int result;

  v1 = a1;
  result = *(uint *)(a1 + 4);
  if ( !result )
  {
    *(uint *)(v1 + 4) = 1;
    Function_21df9e0(*(uint *)(v1 + 8), 11, 109);
    Function_21dfa14(*(uint *)(v1 + 8), 11, 181);
    Function_21dfa3c(*(uint *)(v1 + 8), 12, 0xEu, 1);
    result = Function_21df864(*(uint *)(v1 + 8), 13, 11, 11, 12, 0, (int)&dword_220044C);
  }
  return result;
}

//----- (021F226C) --------------------------------------------------------
uint __fastcall Function_21f226c(int a1)
{
  int v1;
  uint result;

  v1 = a1;
  result = *(uint *)(a1 + 4);
  if ( result == 1 )
  {
    *(uint *)(v1 + 4) = 0;
    Function_21dfa08(*(uint *)(v1 + 8));
    Function_21dfa30(*(uint *)(v1 + 8));
    Function_21dfa7c(*(uint *)(v1 + 8), 12);
    result = Function_21df9d4(*(uint *)(v1 + 8), 13);
  }
  return result;
}

//----- (021F229C) --------------------------------------------------------
uint *__fastcall Function_21f229c(uint *result)
{
  if ( !*result )
    result = (uint *)Function_21f221c((int)result);
  return result;
}

//----- (021F22AC) --------------------------------------------------------
uint *__fastcall Function_21f22ac(uint *result)
{
  if ( !*result )
    result = (uint *)Function_21f226c((int)result);
  return result;
}

//----- (021F22BC) --------------------------------------------------------
int *__fastcall Function_5_21f22bc(int a1, int a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int v6;
  int v7;
  int v9;
  int v10;
  int v11[2];
  int v12;
  int v13;

  v13 = a4;
  v4 = (uint *)a1;
  v5 = Function_21df578(a1);
  Function_21ecda0(v4, v11, v6, v7);
  v12 += 0x8000;
  v9 = v5;
  v10 = Function_21df55c();
  return Function_5_21df72c(v5, dword_2200410, v11, 0, (int)&v9, 0xFFu);
}

//----- (021F2304) --------------------------------------------------------
int __fastcall Function_21f2304(int a1, int a2)
{
  uint *v2;
  int v3;
  uint *v4;
  int v5;
  uint *v6;
  char v8;

  v2 = (uint *)a1;
  v3 = a2;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v4[1];
  v6 = (uint *)(v3 + 12);
  *v6 = *v4;
  v6[1] = v5;
  *(uint *)(v3 + 20) = v4[2];
  Function_21f229c(*(uint **)(v3 + 16));
  Function_20715e4(v2, &v8);
  *(uint *)(v3 + 24) = Function_21df84c(*(uint *)(v3 + 12), 13, (int *)&v8);
  Function_21f2204(*(uint **)(v3 + 16));
  return 1;
}

//----- (021F2344) --------------------------------------------------------
uint *__fastcall Function_21f2344(int a1, int a2)
{
  int v2;

  v2 = a2;
  Function_20211fc(*(uint *)(a2 + 24));
  Function_21f220c(*(uint **)(v2 + 16));
  return Function_21f22ac(*(uint **)(v2 + 16));
}

//----- (021F235C) --------------------------------------------------------
int *__fastcall Function_21f235c(int *a1, uint *a2)
{
  int *v2;
  uint *v3;
  int v4;
  int *result;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;

  v2 = a1;
  v3 = a2;
  v6 = 4096;
  v7 = 4096;
  v8 = 0x2000;
  v9 = 0x2000;
  v10 = 4096;
  if ( a2[2] == 1 )
  {
    a2[2] = 0;
    v4 = a2[1] + 1;
    a2[1] = v4;
    if ( v4 >= 5 )
      return Function_5_21df74c(v2);
    Function_2021380(a2[6], 0);
  }
  result = (int *)Function_2021368(v3[6], *(&v6 + v3[1]));
  if ( result == (int *)1 )
  {
    result = (int *)1;
    v3[2] = 1;
  }
  return result;
}

//----- (021F23B8) --------------------------------------------------------
int __fastcall Function_21f23b8(uint *a1, int a2, int a3, int a4)
{
  int v4;
  char v6;
  int v7;

  v7 = a4;
  v4 = a2;
  Function_20715e4(a1, &v6);
  return Function_20212a8(*(uint **)(v4 + 24), &v6);
}

//----- (021F23D0) --------------------------------------------------------
int *__fastcall Function_21f23d0(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 60, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f23fc();
  return v3;
}

//----- (021F23EC) --------------------------------------------------------
uint __fastcall Function_21f23ec(int a1)
{
  int v1;

  v1 = a1;
  Function_21f2424();
  return Function_5_21df554(v1);
}

//----- (021F23FC) --------------------------------------------------------
int __fastcall Function_21f23fc(int a1)
{
  int v1;

  v1 = a1;
  Function_5_21dfb00(*(int **)a1, (uchar *)(a1 + 4), 0, 0x4Eu, 0);
  return Function_21dfb24(*(int **)v1, (int *)(v1 + 24), 0, 0xA5u, 0);
}

//----- (021F2424) --------------------------------------------------------
int *__fastcall Function_21f2424(int a1)
{
  int v1;

  v1 = a1;
  Function_207395c(a1 + 4);
  return Function_2073aa8(v1 + 24);
}

//----- (021F2438) --------------------------------------------------------
int *__fastcall Function_21f2438(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;

  v14 = a4;
  v4 = a1;
  v5 = Function_21df578(a1);
  v12 = Function_21df55c();
  v8 = 0;
  v9 = 0;
  v10 = 0;
  v11 = v5;
  v13 = v4;
  v6 = Function_2062758(v4, 2);
  return Function_5_21df72c(v5, dword_2200464, &v8, 0, (int)&v11, v6);
}

//----- (021F247C) --------------------------------------------------------
int __fastcall Function_21f247c(int a1)
{
  int result;

  result = Function_2071598(a1);
  *(uint *)(result + 12) = 1;
  return result;
}

//----- (021F2488) --------------------------------------------------------
int __fastcall Function_21f2488(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  int v5;
  uint *v6;
  uint *v7;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;

  v2 = (uint *)a1;
  v3 = a2;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v4[1];
  v6 = v3 + 4;
  *v6 = *v4;
  v6[1] = v5;
  v3[6] = v4[2];
  Function_21dfb40((uint *)v3[4], v3 + 7, v3[5] + 4, v3[5] + 24, 0);
  Function_2073b90(v3 + 16, v3[5] + 4, (int)(v3 + 7));
  v3[1] = GetSpriteID(v3[6]);
  v3[2] = GetSprite_c(v3[6]);
  v7 = (uint *)v3[6];
  CopySprite70Struct(v7, &v12);
  Function_2063078(v7, &v9);
  v12 += v9;
  v13 += v10;
  v14 += v11;
  Function_20715d4(v2, &v12);
  return 1;
}

//----- (021F2510) --------------------------------------------------------
int *__fastcall Function_21f2510(int a1, int a2)
{
  return Function_2073aa8(a2 + 28);
}

//----- (021F251C) --------------------------------------------------------
int *__fastcall Function_21f251c(int *a1, int *a2)
{
  int *v2;
  int *v3;
  uint *v4;
  int *result;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;

  v2 = a2;
  v3 = a1;
  v4 = (uint *)a2[6];
  if ( a2[3] )
  {
    if ( Function_2073b40(a2 + 7) == 1 )
      return Function_5_21df74c(v3);
    Function_2073ac0(v2 + 7, 4096, 0);
  }
  else if ( !Function_2062764(v4, a2[1], a2[2]) )
  {
    return Function_5_21df74c(v3);
  }
  result = (int *)v2[3];
  if ( !result )
  {
    CopySprite70Struct(v4, &v9);
    Function_2063078(v4, &v6);
    v9 += v6;
    v10 += v7;
    v11 += v8;
    result = (int *)Function_20715d4(v3, &v9);
  }
  return result;
}

//----- (021F25A4) --------------------------------------------------------
int *__fastcall Function_21f25a4(uint *a1, int a2, int a3, int a4)
{
  int v4;
  int v6[3];
  int v7;

  v7 = a4;
  v4 = a2;
  Function_20715e4(a1, v6);
  return Function_2073bb4((uint *)(v4 + 64), v6);
}

//----- (021F25C0) --------------------------------------------------------
int *__fastcall Function_21f25c0(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 108, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f25ec();
  return v3;
}

//----- (021F25DC) --------------------------------------------------------
uint __fastcall Function_21f25dc(int a1)
{
  int v1;

  v1 = a1;
  Function_21f2610();
  return Function_5_21df554(v1);
}

//----- (021F25EC) --------------------------------------------------------
int (__fastcall *__fastcall Function_21f25ec(int a1))(uint *a1, int a2, uint a3, int a4)
{
  int v1;

  v1 = a1;
  Function_5_21dfb00(*(int **)a1, (uchar *)(a1 + 4), 0, 0x51u, 0);
  return Function_2073b70((int *)(v1 + 24), v1 + 4);
}

//----- (021F2610) --------------------------------------------------------
uchar *__fastcall Function_21f2610(int a1)
{
  return Function_207395c(a1 + 4);
}

//----- (021F261C) --------------------------------------------------------
int *__fastcall Function_5_21f261c(int a1, int a2, int a3, int a4, int a5)
{
  int v5;
  int v6;
  uint *v7;
  int v8;
  int v9;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  uint *v20;

  v5 = a2;
  v6 = a3;
  v14 = 0;
  v15 = 0;
  v7 = (uint *)a1;
  v16 = 0;
  v17 = a4;
  v18 = Function_21df578(a1);
  v19 = Function_21df55c();
  v20 = v7;
  if ( a5 )
  {
    v11 = 0;
    v12 = 28672;
    v13 = 0x4000;
    CopySprite70Struct(v7, &v14);
    Function_20630ac(v7, &v11);
  }
  else
  {
    v8 = GetSpriteSpriteListFirstSprite((int)v7);
    v14 = (v5 << 16) + 0x8000;
    v16 = (v6 << 16) + 0x8000;
    Function_20644a4(v8, &v14);
  }
  v9 = Function_2062758((int)v7, 2);
  return Function_5_21df72c(v18, dword_2200490, &v14, a5, (int)&v17, v9);
}

//----- (021F26A8) --------------------------------------------------------
int __fastcall Function_21f26a8(int a1, uint *a2)
{
  int v2;
  uint *v3;
  uint *v4;
  uint *v5;
  int v6;
  uint *v7;
  int v8;
  uint *v9;
  int v10;

  v2 = a1;
  v3 = a2;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v4;
  v6 = v4[3];
  v7 = v3 + 9;
  v8 = v4[1];
  *v7 = *v4;
  v7[1] = v8;
  v9 = v3 + 11;
  v10 = v4[3];
  *v9 = v4[2];
  v9[1] = v10;
  v3[3] = GetSpriteID(v6);
  v3[4] = GetSprite_c(v6);
  v3[2] = *v5;
  v3[6] = Function_20715b4(v2);
  v3[7] = 4096;
  v3[8] = 1024;
  return 1;
}

//----- (021F26F0) --------------------------------------------------------
int __fastcall Function_21f26f0(int a1, int a2)
{
  uint *v2;
  int v4;
  int v5;
  int v6;

  v2 = *(uint **)(a2 + 48);
  v4 = 0;
  v5 = 0;
  v6 = 0;
  return Function_20630ac(v2, &v4);
}

//----- (021F2708) --------------------------------------------------------
int *__fastcall Function_21f2708(int *a1, int *a2)
{
  int *v2;
  uint *v3;
  int *v4;
  int *result;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;

  v2 = a2;
  v3 = (uint *)a2[12];
  v4 = a1;
  if ( !Function_2062764(v3, a2[3], a2[4]) )
    return Function_5_21df74c(v4);
  *v2 = 0;
  result = (int *)LoadSpriteFaceDirection((int)v3);
  v2[1] = (int)result;
  if ( result == (int *)-1 )
  {
    result = (int *)1;
    *v2 = 1;
  }
  else if ( v2[6] )
  {
    v2[2] = (int)result;
    v6 = v2[7] + v2[8];
    v2[7] = v6;
    if ( v6 < 0x4000 )
    {
      if ( v6 <= 4096 )
      {
        v2[7] = 4096;
        v2[8] = -v2[8];
      }
    }
    else
    {
      v2[7] = 0x4000;
      v2[8] = -v2[8];
    }
    v9 = 0;
    v10 = v2[7] + 28672;
    v11 = 0x4000;
    Function_20630ac(v3, &v9);
    CopySprite70Struct(v3, &v7);
    v8 += v2[7] - 4096;
    result = (int *)Function_20715d4(v4, &v7);
  }
  return result;
}

//----- (021F27B4) --------------------------------------------------------
int *__fastcall Function_21f27b4(uint *a1, int **a2, int a3, int a4)
{
  uint *v4;
  int *result;
  ushort v6;
  uint *v7;
  int v8;
  int v9;
  int v10;
  int v11[3];
  int v12[9];
  int v13;

  v13 = a4;
  v4 = a1;
  result = *a2;
  if ( *a2 != (int *)1 )
  {
    result = (int *)-1;
    if ( a2[2] != (int *)-1 )
    {
      a2[5] = (int *)((char *)a2[5] + 1);
      v8 = 4096;
      v9 = 4096;
      v6 = 0;
      v10 = 4096;
      v7 = a2[11] + 6;
      switch ( (uchar)a2[2] )
      {
        case 0u:
          v6 = 180;
          break;
        case 2u:
          v6 = 270;
          break;
        case 3u:
          v6 = 90;
          break;
        default:
          break;
      }
      Function_201e2e0(v12, 0, v6, 0);
      Function_20715e4(v4, v11);
      result = Function_2073ba4(v7, v11, &v8, v12);
    }
  }
  return result;
}

//----- (021F2838) --------------------------------------------------------
uint *__fastcall Function_21f2838(int a1, int a2)
{
  int v2;
  uint *result;

  v2 = a2;
  result = (uint *)Function_2071598(a1);
  result[6] = v2;
  result[7] = 4096;
  result[8] = 1024;
  return result;
}

//----- (021F2850) --------------------------------------------------------
int *__fastcall Function_21f2850(uint *a1)
{
  uint *v1;
  int *result;

  v1 = a1;
  result = Function_21df53c(a1, 124, 0, 0);
  result[4] = (int)v1;
  return result;
}

//----- (021F2864) --------------------------------------------------------
uint __fastcall Function_21f2864(int a1)
{
  int v1;

  v1 = a1;
  Function_21f28c0();
  return Function_5_21df554(v1);
}

//----- (021F2874) --------------------------------------------------------
uint *__fastcall Function_21f2874(uint *result)
{
  ++*result;
  return result;
}

//----- (021F287C) --------------------------------------------------------
uint *__fastcall Function_21f287c(uint *result)
{
  bool v1;

  v1 = (*result)-- - 1 < 0;
  if ( v1 )
    result = (uint *)ErrorHandler();
  return result;
}

//----- (021F288C) --------------------------------------------------------
int __fastcall Function_21f288c(int a1)
{
  int v1;
  int result;

  v1 = a1;
  result = *(uint *)(a1 + 4);
  if ( !result )
  {
    Function_5_21dfb00(*(int **)(v1 + 16), (uchar *)(v1 + 20), 0, 0x52u, 1);
    Function_2073b70((int *)(v1 + 40), v1 + 20);
    result = 1;
    *(uint *)(v1 + 4) = 1;
  }
  return result;
}

//----- (021F28C0) --------------------------------------------------------
uchar *__fastcall Function_21f28c0(uchar *result)
{
  if ( *((uint *)result + 1) == 1 )
  {
    *((uint *)result + 1) = 0;
    result = Function_207395c((int)(result + 20));
  }
  return result;
}

//----- (021F28D4) --------------------------------------------------------
uint *__fastcall Function_21f28d4(uint *result)
{
  if ( !*result )
    result = (uint *)Function_21f288c((int)result);
  return result;
}

//----- (021F28E4) --------------------------------------------------------
uchar *__fastcall Function_21f28e4(uchar *result)
{
  if ( !*(uint *)result )
    result = Function_21f28c0(result);
  return result;
}

//----- (021F28F4) --------------------------------------------------------
int *__fastcall Function_21f28f4(int a1, int a2, int a3, int a4, int a5)
{
  int v5;
  int v6;
  int v7;
  uint *v8;
  int v9;
  int v10;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  uint *v19;

  v5 = a2;
  v6 = a3;
  v12 = 0;
  v13 = 0;
  v7 = a4;
  v8 = (uint *)a1;
  v14 = 0;
  v9 = Function_21df578(a1);
  v16 = v9;
  v15 = v7;
  v17 = GetSpriteSpriteListFirstSprite((int)v8);
  v18 = Function_21df55c();
  v19 = v8;
  if ( a5 )
  {
    CopySprite70Struct(v8, &v12);
  }
  else
  {
    v12 = (v5 << 16) + 0x8000;
    v14 = (v6 << 16) + 0x8000;
    Function_20644a4(v17, &v12);
  }
  v10 = Function_2062758((int)v8, 2);
  return Function_5_21df72c(v9, dword_22004B0, &v12, a5, (int)&v15, v10);
}

//----- (021F2974) --------------------------------------------------------
int __fastcall Function_21f2974(int a1, int a2)
{
  int v2;
  int result;

  v2 = a2;
  result = Function_2071598(a1);
  *(uint *)(result + 12) = v2;
  return result;
}

//----- (021F2980) --------------------------------------------------------
int __fastcall Function_21f2980(int a1, int a2)
{
  int v2;
  int v3;
  uint *v4;
  int v5;
  uint *v6;
  uint *v7;
  int v8;

  v2 = a1;
  v3 = a2;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v4[1];
  v6 = (uint *)(v3 + 16);
  *v6 = *v4;
  v6[1] = v5;
  v7 = (uint *)(v3 + 24);
  v8 = v4[3];
  *v7 = v4[2];
  v7[1] = v8;
  *(uint *)(v3 + 32) = v4[4];
  *(uint *)(v3 + 4) = *v4;
  *(uint *)(v3 + 12) = Function_20715b4(v2);
  Function_21f28d4(*(uint **)(v3 + 28));
  Function_21f2874(*(uint **)(v3 + 28));
  return 1;
}

//----- (021F29BC) --------------------------------------------------------
uchar *__fastcall Function_21f29bc(int a1, int a2)
{
  int v2;

  v2 = a2;
  Function_21f287c(*(uint **)(a2 + 28));
  return Function_21f28e4(*(uchar **)(v2 + 28));
}

//----- (021F29D0) --------------------------------------------------------
int __fastcall Function_21f29d0(uint *a1, int a2, int a3, int a4)
{
  uint *v4;
  int result;
  uint *v6;
  int v7[3];
  int v8;
  int v9;
  int v10;
  int v11;

  v11 = a4;
  v4 = a1;
  result = *(uint *)(a2 + 12);
  v6 = *(uint **)(a2 + 32);
  if ( result )
  {
    v8 = 0;
    v9 = 0;
    v10 = 0;
    Function_20630ac(v6, &v8);
    CopySprite70Struct(v6, v7);
    result = Function_20715d4(v4, v7);
  }
  return result;
}

//----- (021F2A04) --------------------------------------------------------
int *__fastcall Function_21f2a04(uint *a1, int **a2, int a3, int a4)
{
  uint *v4;
  int *result;
  ushort v6;
  uint *v7;
  int v8;
  int v9;
  int v10;
  int v11[3];
  int v12[9];
  int v13;

  v13 = a4;
  v4 = a1;
  result = *a2;
  if ( *a2 != (int *)1 )
  {
    a2[2] = (int *)((char *)a2[2] + 1);
    v8 = 4096;
    v9 = 4096;
    v6 = 0;
    v10 = 4096;
    v7 = a2[7] + 10;
    switch ( (uchar)a2[1] )
    {
      case 0u:
        v6 = 180;
        break;
      case 2u:
        v6 = 270;
        break;
      case 3u:
        v6 = 90;
        break;
      default:
        break;
    }
    Function_201e2e0(v12, 0, v6, 0);
    Function_20715e4(v4, v11);
    result = Function_2073ba4(v7, v11, &v8, v12);
  }
  return result;
}

//----- (021F2A7C) --------------------------------------------------------
int *__fastcall Function_21f2a7c(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 60, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f2aa8();
  return v3;
}

//----- (021F2A98) --------------------------------------------------------
uint __fastcall Function_21f2a98(int a1)
{
  int v1;

  v1 = a1;
  Function_21f2ad0();
  return Function_5_21df554(v1);
}

//----- (021F2AA8) --------------------------------------------------------
int __fastcall Function_21f2aa8(int a1)
{
  int v1;

  v1 = a1;
  Function_5_21dfb00(*(int **)a1, (uchar *)(a1 + 4), 0, 0xFu, 0);
  return Function_21dfb24(*(int **)v1, (int *)(v1 + 24), 0, 0xA0u, 0);
}

//----- (021F2AD0) --------------------------------------------------------
int *__fastcall Function_21f2ad0(int a1)
{
  int v1;

  v1 = a1;
  Function_207395c(a1 + 4);
  return Function_2073aa8(v1 + 24);
}

//----- (021F2AE4) --------------------------------------------------------
int *__fastcall Function_5_21f2ae4(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v7 = a4;
  v10 = Function_21df578(a1);
  v11 = Function_21df55c();
  Function_2064450(v5, v7, &v12);
  v14 += 8 * v6 + 4096;
  v13 = (GetSpriteZ2(v4) << 15) - 0x8000;
  v8 = Function_2062758(v4, 2);
  return Function_5_21df72c(v10, dword_22004C4, &v12, 0, (int)&v10, v8);
}

//----- (021F2B48) --------------------------------------------------------
int __fastcall Function_21f2b48(int a1, int a2)
{
  int v2;
  uint *v3;
  int v4;

  v2 = a2;
  v3 = (uint *)Function_20715bc(a1);
  v4 = v3[1];
  *(uint *)(v2 + 120) = *v3;
  *(uint *)(v2 + 124) = v4;
  Function_21dfb40(*(uint **)(v2 + 120), (int *)v2, v4 + 4, v4 + 24, 0);
  Function_2073b90((int *)(v2 + 36), *(uint *)(v2 + 124) + 4, v2);
  return 1;
}

//----- (021F2B80) --------------------------------------------------------
int *__fastcall Function_21f2b80(int a1, int a2)
{
  return Function_2073aa8(a2);
}

//----- (021F2B8C) --------------------------------------------------------
int *__fastcall Function_21f2b8c(int *a1, int *a2)
{
  int *v2;
  int *v3;
  int *result;

  v2 = a2;
  v3 = a1;
  if ( Function_2073b40(a2) == 1 )
    result = Function_5_21df74c(v3);
  else
    result = (int *)Function_2073ac0(v2, 4096, 0);
  return result;
}

//----- (021F2BB4) --------------------------------------------------------
int *__fastcall Function_21f2bb4(uint *a1, int a2, int a3, int a4)
{
  int v4;
  int v6[3];
  int v7;

  v7 = a4;
  v4 = a2;
  Function_20715e4(a1, v6);
  return Function_2073bb4((uint *)(v4 + 36), v6);
}

//----- (021F2BD0) --------------------------------------------------------
int *__fastcall Function_21f2bd0(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 60, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f2bfc();
  return v3;
}

//----- (021F2BEC) --------------------------------------------------------
uint __fastcall Function_21f2bec(int a1)
{
  int v1;

  v1 = a1;
  Function_21f2c24();
  return Function_5_21df554(v1);
}

//----- (021F2BFC) --------------------------------------------------------
int __fastcall Function_21f2bfc(int a1)
{
  int v1;

  v1 = a1;
  Function_5_21dfb00(*(int **)a1, (uchar *)(a1 + 4), 0, 0x10u, 0);
  return Function_21dfb24(*(int **)v1, (int *)(v1 + 24), 0, 0xA1u, 0);
}

//----- (021F2C24) --------------------------------------------------------
int *__fastcall Function_21f2c24(int a1)
{
  int v1;

  v1 = a1;
  Function_207395c(a1 + 4);
  return Function_2073aa8(v1 + 24);
}

//----- (021F2C38) --------------------------------------------------------
int *__fastcall Function_5_21f2c38(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v7 = a4;
  v10 = Function_21df578(a1);
  v11 = Function_21df55c();
  Function_2064450(v5, v7, &v12);
  v14 += 8 * v6;
  v13 = (GetSpriteZ2(v4) << 15) - 0x8000;
  v8 = Function_2062758(v4, 2);
  return Function_5_21df72c(v10, dword_22004D8, &v12, 0, (int)&v10, v8);
}

//----- (021F2C98) --------------------------------------------------------
int __fastcall Function_21f2c98(int a1, int a2)
{
  int v2;
  uint *v3;
  int v4;

  v2 = a2;
  v3 = (uint *)Function_20715bc(a1);
  v4 = v3[1];
  *(uint *)(v2 + 120) = *v3;
  *(uint *)(v2 + 124) = v4;
  Function_21dfb40(*(uint **)(v2 + 120), (int *)v2, v4 + 4, v4 + 24, 0);
  Function_2073b90((int *)(v2 + 36), *(uint *)(v2 + 124) + 4, v2);
  return 1;
}

//----- (021F2CD0) --------------------------------------------------------
int *__fastcall Function_21f2cd0(int a1, int a2)
{
  return Function_2073aa8(a2);
}

//----- (021F2CDC) --------------------------------------------------------
int *__fastcall Function_21f2cdc(int *a1, int *a2)
{
  int *v2;
  int *v3;
  int *result;

  v2 = a2;
  v3 = a1;
  if ( Function_2073b40(a2) == 1 )
    result = Function_5_21df74c(v3);
  else
    result = (int *)Function_2073ac0(v2, 4096, 0);
  return result;
}

//----- (021F2D04) --------------------------------------------------------
int *__fastcall Function_21f2d04(uint *a1, int a2, int a3, int a4)
{
  int v4;
  int v6[3];
  int v7;

  v7 = a4;
  v4 = a2;
  Function_20715e4(a1, v6);
  return Function_2073bb4((uint *)(v4 + 36), v6);
}

//----- (021F2D20) --------------------------------------------------------
int *__fastcall Function_21f2d20(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 4, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f2d4c();
  return v3;
}

//----- (021F2D3C) --------------------------------------------------------
uint __fastcall Function_21f2d3c(int a1)
{
  int v1;

  v1 = a1;
  Function_21f2e2c();
  return Function_5_21df554(v1);
}

//----- (021F2D4C) --------------------------------------------------------
int __fastcall Function_21f2d4c(int *a1)
{
  int *v1;

  v1 = a1;
  Function_21df9e0(*a1, 0, 83);
  Function_21df9e0(*v1, 5, 84);
  Function_21dfa14(*v1, 0, 170);
  Function_21dfa14(*v1, 3, 171);
  Function_21dfa14(*v1, 4, 172);
  Function_21dfa14(*v1, 5, 173);
  Function_21dfa3c(*v1, 0, 0, 1);
  Function_21dfa3c(*v1, 4, 1u, 1);
  Function_21dfa3c(*v1, 5, 2u, 1);
  Function_21dfa3c(*v1, 6, 3u, 1);
  Function_21df864(*v1, 0, 0, 0, 0, 0, (int)&dword_2200540);
  Function_21df864(*v1, 5, 5, 3, 4, 0, (int)&dword_2200558);
  Function_21df864(*v1, 6, 5, 4, 5, 0, (int)&dword_2200528);
  return Function_21df864(*v1, 7, 5, 5, 6, 0, (int)&dword_2200570);
}

//----- (021F2E2C) --------------------------------------------------------
uint __fastcall Function_21f2e2c(int *a1)
{
  int *v1;

  v1 = a1;
  Function_21dfa08(*a1);
  Function_21dfa08(*v1);
  Function_21dfa30(*v1);
  Function_21dfa30(*v1);
  Function_21dfa30(*v1);
  Function_21dfa30(*v1);
  Function_21dfa7c(*v1, 0);
  Function_21dfa7c(*v1, 4);
  Function_21dfa7c(*v1, 5);
  Function_21dfa7c(*v1, 6);
  Function_21df9d4(*v1, 0);
  Function_21df9d4(*v1, 5);
  Function_21df9d4(*v1, 6);
  return Function_21df9d4(*v1, 7);
}

//----- (021F2EA4) --------------------------------------------------------
int *__fastcall Function_5_21f2ea4(int a1, int a2)
{
  uint *v2;
  int v3;
  int v4;
  int v5;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  uint *v13;
  char v14;

  v2 = (uint *)a1;
  v3 = a2;
  v4 = Function_21df578(a1);
  v7 = LoadSpritePositionX((int)v2);
  v8 = LoadSpritePositionZ((int)v2);
  v9 = LoadSpritePositionY((int)v2);
  v11 = v4;
  v10 = Function_21df574(v4);
  v12 = Function_21df55c();
  v13 = v2;
  CopySprite70Struct(v2, &v14);
  v5 = Function_2062758((int)v2, 2);
  return Function_5_21df72c(v4, dword_22004EC, (int *)&v14, v3, (int)&v7, v5);
}

//----- (021F2F0C) --------------------------------------------------------
int __fastcall Function_21f2f0c(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  int v5;
  uint *v6;
  uint *v7;
  int v8;
  uint *v9;
  int v10;
  int v12;
  int v13;
  int v14;

  v2 = (uint *)a1;
  v3 = a2;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v4[1];
  v6 = v3 + 6;
  *v6 = *v4;
  v6[1] = v5;
  v7 = v3 + 8;
  v8 = v4[3];
  *v7 = v4[2];
  v7[1] = v8;
  v9 = v3 + 10;
  v10 = v4[5];
  *v9 = v4[4];
  v9[1] = v10;
  v3[12] = v4[6];
  v3[1] = Function_2062924(v3[12]);
  v3[2] = GetSpriteID(v3[12]);
  v3[3] = GetSprite_c(v3[12]);
  v12 = v3[6] << 16;
  v14 = v3[8] << 16;
  v13 = GetSprite74(v3[12]);
  v3[5] = Function_20644a4(v3[9], &v12);
  v12 += 0x8000;
  v14 += 73728;
  Function_20715d4(v2, &v12);
  v3[13] = Function_21df84c(v3[10], 0, &v12);
  if ( !Function_20715b4((int)v2) )
    *v3 = 1;
  return 1;
}

//----- (021F2FA0) --------------------------------------------------------
int __fastcall Function_21f2fa0(int a1, int a2)
{
  return Function_20211fc(*(uint *)(a2 + 52));
}

//----- (021F2FAC) --------------------------------------------------------
int *__fastcall Function_21f2fac(int *a1, int **a2, int a3, int a4)
{
  int **v4;
  int *v5;
  int *v6;
  int *result;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;

  v15 = a4;
  v4 = a2;
  v5 = a2[12];
  v6 = a1;
  if ( !Function_20627b4(v5, (int)a2[1], (int)v4[2], (int)v4[3]) )
    return Function_5_21df74c(v6);
  if ( !v4[5] )
  {
    Function_20715e4(v6, &v13);
    v10 = (uint)v4[6] << 16;
    v12 = (uint)v4[8] << 16;
    v11 = v14;
    v8 = Function_20644a4((int)v4[9], &v10);
    v4[5] = (int *)v8;
    if ( v8 == 1 )
    {
      v14 = v11;
      Function_20715d4(v6, &v13);
    }
  }
  result = *v4;
  if ( *v4 )
  {
    if ( result == (int *)1 )
    {
      Function_2021380((uint)v4[13], 49152);
      *v4 = (int *)2;
    }
    else if ( result != (int *)2 )
    {
      return result;
    }
    if ( Function_20627b4(v5, (int)v4[1], (int)v4[2], (int)v4[3]) )
    {
      v9 = LoadSpritePositionX((int)v5);
      result = (int *)LoadSpritePositionY((int)v5);
      if ( v4[6] != (int *)v9 || v4[8] != result )
        result = Function_5_21df74c(v6);
    }
    else
    {
      result = Function_5_21df74c(v6);
    }
  }
  else
  {
    Function_2021368((int)v4[13], 4096);
    result = (int *)(Function_20213d4((int)v4[13]) / 4096);
    if ( (int)result >= 12 )
    {
      result = (int *)1;
      *v4 = (int *)1;
    }
  }
  return result;
}

//----- (021F308C) --------------------------------------------------------
int *__fastcall Function_21f308c(int *a1, int a2)
{
  int v2;
  int *v3;
  char v5;

  v2 = a2;
  v3 = a1;
  if ( !Function_20627b4(*(uint **)(a2 + 48), *(uint *)(a2 + 4), *(uint *)(v2 + 8), *(uint *)(v2 + 12)) )
    return Function_5_21df74c(v3);
  Function_20715e4(v3, &v5);
  return (int *)Function_20212a8(*(uint **)(v2 + 52), &v5);
}

//----- (021F30C4) --------------------------------------------------------
int __fastcall Function_21f30c4(int a1, int *a2)
{
  uint *v2;
  int *v3;
  uint *v4;
  int v5;
  uint *v6;
  uint *v7;
  int v8;
  char v10;

  v2 = (uint *)a1;
  v3 = a2;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v4[1];
  v6 = v3 + 2;
  *v6 = *v4;
  v6[1] = v5;
  v7 = v3 + 4;
  v8 = v4[3];
  *v7 = v4[2];
  v7[1] = v8;
  v3[6] = v4[4];
  Function_20715e4(v2, &v10);
  v3[7] = Function_21df84c(v3[5], 0, (int *)&v10);
  return 1;
}

//----- (021F30FC) --------------------------------------------------------
int __fastcall Function_21f30fc(int a1, int a2)
{
  return Function_20211fc(*(uint *)(a2 + 28));
}

//----- (021F3108) --------------------------------------------------------
int __fastcall Function_21f3108(int a1, uint *a2)
{
  uint *v2;
  int result;

  v2 = a2;
  result = *a2;
  if ( !*a2 )
  {
    Function_2021368(a2[7], 4096);
    result = Function_20213d4(v2[7]) / 4096;
    if ( result >= 12 )
    {
      result = 1;
      v2[1] = 1;
      *v2 = 1;
    }
  }
  return result;
}

//----- (021F313C) --------------------------------------------------------
int __fastcall Function_21f313c(uint *a1, int a2, int a3, int a4)
{
  int v4;
  char v6;
  int v7;

  v7 = a4;
  v4 = a2;
  Function_20715e4(a1, &v6);
  return Function_20212a8(*(uint **)(v4 + 28), &v6);
}

//----- (021F3154) --------------------------------------------------------
int *__fastcall Function_5_21f3154(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;

  v17 = a4;
  v4 = *(uint *)(a1 + 64);
  v5 = a2;
  v6 = a3;
  v11 = a1;
  v7 = a4;
  v9 = a2;
  v10 = a3;
  v12 = v4;
  v13 = Function_21df55c();
  v14 = (v5 << 16) + 0x8000;
  v15 = 0;
  v16 = (v6 << 16) + 36864;
  return Function_5_21df72c(v4, dword_2200514, &v14, v7, (int)&v9, 0xFFu);
}

//----- (021F31A8) --------------------------------------------------------
int __fastcall Function_5_21f31a8(int a1)
{
  return *(uint *)(Function_2071598(a1) + 4);
}

//----- (021F31B4) --------------------------------------------------------
int __fastcall Function_21f31b4(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  int v5;
  uint *v6;
  uint *v7;
  int v8;
  int v9;
  int v10;
  int v12;
  int v13;
  int v14;

  v2 = (uint *)a1;
  v3 = a2;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v4[1];
  v6 = v3 + 4;
  *v6 = *v4;
  v6[1] = v5;
  v7 = v3 + 6;
  v8 = v4[3];
  *v7 = v4[2];
  v7[1] = v8;
  v3[8] = v4[4];
  v3[3] = Function_20715b4((int)v2);
  v12 = (v3[4] << 16) + 0x8000;
  v14 = (v3[5] << 16) + 36864;
  v13 = 0;
  Function_20644a4(v3[6], &v12);
  v13 += 4096;
  Function_20715d4(v2, &v12);
  v9 = v3[3];
  if ( v9 )
  {
    if ( v9 == 1 )
      v10 = 6;
    else
      v10 = 7;
  }
  else
  {
    v10 = 5;
  }
  v3[9] = Function_21df84c(v3[7], v10, &v12);
  return 1;
}

//----- (021F3238) --------------------------------------------------------
int __fastcall Function_21f3238(int a1, int a2)
{
  return Function_20211fc(*(uint *)(a2 + 36));
}

//----- (021F3244) --------------------------------------------------------
int __fastcall Function_21f3244(int a1, int *a2)
{
  int *v2;
  int result;

  v2 = a2;
  result = *a2;
  if ( !*a2 )
  {
    result = Function_2021368(a2[9], 4096);
    if ( result == 1 )
    {
      v2[1] = 1;
      result = *v2 + 1;
      *v2 = result;
    }
  }
  return result;
}

//----- (021F326C) --------------------------------------------------------
int __fastcall Function_21f326c(uint *a1, int a2, int a3, int a4)
{
  int v4;
  char v6;
  int v7;

  v7 = a4;
  v4 = a2;
  Function_20715e4(a1, &v6);
  return Function_20212a8(*(uint **)(v4 + 36), &v6);
}

//----- (021F3284) --------------------------------------------------------
int *__fastcall Function_21f3284(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 4, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f32b0();
  return v3;
}

//----- (021F32A0) --------------------------------------------------------
uint __fastcall Function_21f32a0(int a1)
{
  int v1;

  v1 = a1;
  Function_21f32f4();
  return Function_5_21df554(v1);
}

//----- (021F32B0) --------------------------------------------------------
int __fastcall Function_21f32b0(int *a1)
{
  int *v1;

  v1 = a1;
  Function_21df9e0(*a1, 3, 86);
  Function_21dfa14(*v1, 2, 174);
  Function_21dfa3c(*v1, 2, 5u, 1);
  return Function_21df864(*v1, 3, 3, 2, 2, 0, (int)&dword_220059C);
}

//----- (021F32F4) --------------------------------------------------------
uint __fastcall Function_21f32f4(int *a1)
{
  int *v1;

  v1 = a1;
  Function_21dfa08(*a1);
  Function_21dfa30(*v1);
  Function_21dfa7c(*v1, 2);
  return Function_21df9d4(*v1, 3);
}

//----- (021F331C) --------------------------------------------------------
int *__fastcall Function_21f331c(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;

  v16 = a4;
  v4 = a1;
  v5 = a2;
  v6 = Function_21df578(a1);
  v12 = GetSpriteSpriteListFirstSprite(v4);
  v13 = v6;
  v14 = Function_21df55c();
  v9 = 0;
  v10 = 0;
  v11 = 0;
  v15 = v4;
  v7 = Function_2062758(v4, 2);
  return Function_5_21df72c(v6, dword_2200588, &v9, v5, (int)&v12, v7);
}

//----- (021F336C) --------------------------------------------------------
int __fastcall Function_21f336c(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  uint *v5;
  int v6;
  uint *v7;
  int v8;
  int v10;
  int v11;
  int v12;

  v2 = a2;
  v10 = 0;
  v11 = 0;
  v3 = (uint *)a1;
  v12 = 0;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v2 + 5;
  v6 = v4[1];
  *v5 = *v4;
  v5[1] = v6;
  v7 = v2 + 7;
  v8 = v4[3];
  *v7 = v4[2];
  v7[1] = v8;
  v2[1] = Function_2062924(v2[8]);
  v2[2] = GetSpriteID(v2[8]);
  v2[3] = GetSprite_c(v2[8]);
  Function_20715d4(v3, &v10);
  v2[9] = Function_21df84c(v2[6], 3, &v10);
  return 1;
}

//----- (021F33C4) --------------------------------------------------------
int __fastcall Function_21f33c4(int a1, int a2)
{
  return Function_20211fc(*(uint *)(a2 + 36));
}

//----- (021F33D0) --------------------------------------------------------
int __fastcall Function_21f33d0(int *a1, int *a2)
{
  int *v2;
  uint *v3;
  int *v4;
  int result;
  int v6;

  v2 = a2;
  v3 = (uint *)a2[8];
  v4 = a1;
  if ( !Function_20627b4(v3, a2[1], v2[2], v2[3]) )
    return (int)Function_5_21df74c(v4);
  v6 = Function_20715b4((int)v4);
  if ( v6 == 1 && !Function_2062ec8(v3) )
    return (int)Function_5_21df74c(v4);
  result = *v2;
  if ( !*v2 )
  {
    Function_2021368(v2[9], 4096);
    result = Function_20213d4(v2[9]) / 4096;
    if ( result >= 12 )
    {
      if ( v6 )
        result = Function_2021380(v2[9], 0);
      else
        result = (int)Function_5_21df74c(v4);
    }
  }
  return result;
}

//----- (021F3448) --------------------------------------------------------
int *__fastcall Function_21f3448(int *a1, int a2, int a3, int a4)
{
  int v4;
  uint *v5;
  int *v6;
  char v8;
  int v9;
  int v10;

  v10 = a4;
  v4 = a2;
  v5 = *(uint **)(a2 + 32);
  v6 = a1;
  if ( !Function_20627b4(v5, *(uint *)(a2 + 4), *(uint *)(v4 + 8), *(uint *)(v4 + 12)) )
    return Function_5_21df74c(v6);
  CopySprite70Struct(v5, &v8);
  v9 += 0x8000;
  return (int *)Function_20212a8(*(uint **)(v4 + 36), &v8);
}

//----- (021F348C) --------------------------------------------------------
int *__fastcall Function_21f348c(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 8, 0, 0);
  v3 = v2;
  v2[1] = (int)v1;
  Function_21f34d0();
  return v3;
}

//----- (021F34A8) --------------------------------------------------------
uint __fastcall Function_21f34a8(int a1)
{
  int v1;

  v1 = a1;
  Function_21f358c();
  return Function_5_21df554(v1);
}

//----- (021F34B8) --------------------------------------------------------
uint *Function_5_21f34b8()
{
  uint *result;

  result = (uint *)Function_21df55c();
  if ( *result != 1 )
  {
    *result = 1;
    result = (uint *)Function_21f3518();
  }
  return result;
}

//----- (021F34D0) --------------------------------------------------------
int __fastcall Function_21f34d0(int a1)
{
  int v1;

  v1 = a1;
  Function_21df9e0(*(uint *)(a1 + 4), 6, 88);
  Function_21dfa14(*(uint *)(v1 + 4), 6, 175);
  Function_21dfa3c(*(uint *)(v1 + 4), 7, 7u, 1);
  return Function_21df864(*(uint *)(v1 + 4), 8, 6, 6, 7, 0, (int)&dword_22005D8);
}

//----- (021F3518) --------------------------------------------------------
int __fastcall Function_21f3518(int a1)
{
  int v1;

  v1 = a1;
  Function_21df9e0(*(uint *)(a1 + 4), 12, 159);
  Function_21df9e0(*(uint *)(v1 + 4), 13, 157);
  Function_21df9e0(*(uint *)(v1 + 4), 14, 158);
  Function_21df864(*(uint *)(v1 + 4), 14, 12, 6, 7, 0, (int)&dword_22005D8);
  Function_21df864(*(uint *)(v1 + 4), 15, 13, 6, 7, 0, (int)&dword_22005D8);
  return Function_21df864(*(uint *)(v1 + 4), 16, 14, 6, 7, 0, (int)&dword_22005D8);
}

//----- (021F358C) --------------------------------------------------------
uint __fastcall Function_21f358c(uint *a1)
{
  uint *v1;
  uint result;

  v1 = a1;
  Function_21dfa08(a1[1]);
  Function_21dfa30(v1[1]);
  Function_21dfa7c(v1[1], 7);
  Function_21df9d4(v1[1], 8);
  result = *v1;
  if ( *v1 == 1 )
  {
    Function_21dfa08(v1[1]);
    Function_21dfa08(v1[1]);
    Function_21dfa08(v1[1]);
    Function_21df9d4(v1[1], 14);
    Function_21df9d4(v1[1], 15);
    result = Function_21df9d4(v1[1], 16);
  }
  return result;
}

//----- (021F35E8) --------------------------------------------------------
int __fastcall Function_21f35e8(int a1, int a2, int *a3, uint *a4, int *a5)
{
  uint *v5;
  int v6;
  int *v7;
  uint *v8;
  int v9;
  int v10;
  int result;

  v5 = (uint *)a2;
  v6 = a1;
  v7 = a3;
  v8 = a4;
  *a3 = GetSpriteSpriteListFirstSprite(a2);
  v7[1] = v6;
  v7[2] = Function_21df55c();
  v7[3] = (int)v5;
  CopySprite70Struct(v5, v8);
  v9 = LoadSpritePositionX((int)v5);
  v10 = LoadSpritePositionY((int)v5);
  Function_2064450(v9, v10, v8);
  result = Function_2062758((int)v5, 2);
  *a5 = result;
  return result;
}

//----- (021F3638) --------------------------------------------------------
int *__fastcall Function_21f3638(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  uint v7;
  char v8;
  int v9[2];
  int v10;
  int v11;

  v11 = a4;
  v4 = a1;
  v5 = Function_21df578(a1);
  Function_21f35e8(v5, v4, (int *)&v8, v9, (int *)&v7);
  v10 += 0x8000;
  return Function_5_21df72c(v5, dword_22005C4, v9, 0, (int)&v8, v7);
}

//----- (021F3678) --------------------------------------------------------
int *__fastcall Function_5_21f3678(int a1, int a2)
{
  int *v2;
  int v3;
  int v4;
  char *v5;
  int v6;
  int v7;
  int v8;
  int v9;
  uint v11;
  char v12[4];
  char v13[4];
  char v14[40];
  char v15;
  uint *v16;
  int v17;
  int v18;
  int v19;

  v2 = dword_22005F0;
  v3 = a1;
  v4 = a2;
  v5 = v12;
  v6 = 6;
  do
  {
    v7 = *v2;
    v8 = v2[1];
    v2 += 2;
    *(uint *)v5 = v7;
    *((uint *)v5 + 1) = v8;
    v5 += 8;
    --v6;
  }
  while ( v6 );
  v9 = Function_21df578(v3);
  Function_21f35e8(v9, v3, (int *)&v15, &v17, (int *)&v11);
  if ( *v16 != 1 )
    ErrorHandler();
  v17 += *(uint *)&v12[12 * v4];
  v18 += *(uint *)&v13[12 * v4];
  v19 += *(uint *)&v14[12 * v4];
  return Function_5_21df72c(v9, dword_22005C4, &v17, v4, (int)&v15, v11);
}

//----- (021F36F4) --------------------------------------------------------
int __fastcall Function_21f36f4(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  uint *v5;
  int v6;
  uint *v7;
  int v8;
  int v9;
  int v11;
  int v12;
  int v13;
  int v14;
  char v15;

  v2 = a2;
  v3 = (uint *)a1;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v2 + 4;
  v6 = v4[1];
  *v5 = *v4;
  v5[1] = v6;
  v7 = v2 + 6;
  v8 = v4[3];
  *v7 = v4[2];
  v7[1] = v8;
  v2[1] = GetSpriteID(v2[7]);
  v2[2] = GetSprite_c(v2[7]);
  Function_20715e4(v3, &v15);
  v11 = 8;
  v12 = 14;
  v13 = 15;
  v14 = 16;
  v9 = Function_20715b4((int)v3);
  v2[8] = Function_21df84c(v2[5], *(&v11 + v9), (int *)&v15);
  return 1;
}

//----- (021F3754) --------------------------------------------------------
int __fastcall Function_21f3754(int a1, int a2)
{
  return Function_20211fc(*(uint *)(a2 + 32));
}

//----- (021F3760) --------------------------------------------------------
int *__fastcall Function_21f3760(int *a1, int **a2)
{
  int **v2;
  int *v3;
  int *result;

  v2 = a2;
  v3 = a1;
  result = *a2;
  if ( !*a2 )
  {
    Function_2021368((int)a2[8], 4096);
    result = (int *)(Function_20213d4((int)v2[8]) / 4096);
    if ( (int)result >= 9 )
      result = Function_5_21df74c(v3);
  }
  return result;
}

//----- (021F3790) --------------------------------------------------------
int __fastcall Function_21f3790(uint *a1, int a2, int a3, int a4)
{
  int v4;
  char v6;
  int v7;

  v7 = a4;
  v4 = a2;
  Function_20715e4(a1, &v6);
  return Function_20212a8(*(uint **)(v4 + 32), &v6);
}

//----- (021F37A8) --------------------------------------------------------
int *__fastcall Function_21f37a8(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 4, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f37d4();
  return v3;
}

//----- (021F37C4) --------------------------------------------------------
uint __fastcall Function_21f37c4(int a1)
{
  int v1;

  v1 = a1;
  Function_21f381c();
  return Function_5_21df554(v1);
}

//----- (021F37D4) --------------------------------------------------------
int __fastcall Function_21f37d4(int *a1)
{
  int *v1;

  v1 = a1;
  Function_21df9e0(*a1, 7, 89);
  Function_21dfa14(*v1, 7, 176);
  Function_21dfa3c(*v1, 8, 8u, 1);
  return Function_21df864(*v1, 9, 7, 7, 8, 0, (int)&dword_2200634);
}

//----- (021F381C) --------------------------------------------------------
uint __fastcall Function_21f381c(int *a1)
{
  int *v1;

  v1 = a1;
  Function_21dfa08(*a1);
  Function_21dfa30(*v1);
  Function_21dfa7c(*v1, 8);
  return Function_21df9d4(*v1, 9);
}

//----- (021F3844) --------------------------------------------------------
int *__fastcall Function_5_21f3844(int a1, int a2)
{
  uint *v2;
  int v3;
  int v4;
  int v5;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  uint *v13;
  char v14;

  v2 = (uint *)a1;
  v3 = a2;
  v4 = Function_21df578(a1);
  v7 = LoadSpritePositionX((int)v2);
  v8 = LoadSpritePositionZ((int)v2);
  v9 = LoadSpritePositionY((int)v2);
  v11 = v4;
  v10 = Function_21df574(v4);
  v12 = Function_21df55c();
  v13 = v2;
  CopySprite70Struct(v2, &v14);
  v5 = Function_2062758((int)v2, 2);
  return Function_5_21df72c(v4, dword_2200620, (int *)&v14, v3, (int)&v7, v5);
}

//----- (021F38AC) --------------------------------------------------------
int __fastcall Function_21f38ac(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  int v5;
  uint *v6;
  uint *v7;
  int v8;
  uint *v9;
  int v10;
  int v12;
  int v13;
  int v14;

  v2 = (uint *)a1;
  v3 = a2;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v4[1];
  v6 = v3 + 6;
  *v6 = *v4;
  v6[1] = v5;
  v7 = v3 + 8;
  v8 = v4[3];
  *v7 = v4[2];
  v7[1] = v8;
  v9 = v3 + 10;
  v10 = v4[5];
  *v9 = v4[4];
  v9[1] = v10;
  v3[12] = v4[6];
  v3[1] = Function_2062924(v3[12]);
  v3[2] = GetSpriteID(v3[12]);
  v3[3] = GetSprite_c(v3[12]);
  v12 = v3[6] << 16;
  v14 = v3[8] << 16;
  v13 = GetSprite74(v3[12]);
  v3[5] = Function_20644a4(v3[9], &v12);
  v12 += 0x8000;
  v14 += 73728;
  Function_20715d4(v2, &v12);
  v3[13] = Function_21df84c(v3[10], 9, &v12);
  if ( !Function_20715b4((int)v2) )
    *v3 = 1;
  return 1;
}

//----- (021F3940) --------------------------------------------------------
int __fastcall Function_21f3940(int a1, int a2)
{
  return Function_20211fc(*(uint *)(a2 + 52));
}

//----- (021F394C) --------------------------------------------------------
int *__fastcall Function_21f394c(int *a1, int **a2, int a3, int a4)
{
  int **v4;
  int *v5;
  int *v6;
  int *result;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;

  v15 = a4;
  v4 = a2;
  v5 = a2[12];
  v6 = a1;
  if ( !Function_20627b4(v5, (int)a2[1], (int)v4[2], (int)v4[3]) )
    return Function_5_21df74c(v6);
  if ( !v4[5] )
  {
    Function_20715e4(v6, &v13);
    v10 = (uint)v4[6] << 16;
    v12 = (uint)v4[8] << 16;
    v11 = v14;
    v8 = Function_20644a4((int)v4[9], &v10);
    v4[5] = (int *)v8;
    if ( v8 == 1 )
    {
      v14 = v11;
      Function_20715d4(v6, &v13);
    }
  }
  result = *v4;
  if ( *v4 )
  {
    if ( result == (int *)1 )
    {
      Function_2021380((uint)v4[13], 49152);
      Function_2021368((int)v4[13], 0);
      *v4 = (int *)2;
    }
    else if ( result != (int *)2 )
    {
      return result;
    }
    v9 = LoadSpritePositionX((int)v5);
    result = (int *)LoadSpritePositionY((int)v5);
    if ( v4[6] != (int *)v9 || v4[8] != result )
      result = Function_5_21df74c(v6);
  }
  else
  {
    Function_2021368((int)v4[13], 4096);
    result = (int *)(Function_20213d4((int)v4[13]) / 4096);
    if ( (int)result >= 12 )
    {
      result = (int *)1;
      *v4 = (int *)1;
    }
  }
  return result;
}

//----- (021F3A18) --------------------------------------------------------
int *__fastcall Function_21f3a18(int *a1, int a2)
{
  int v2;
  int *v3;
  char v5;

  v2 = a2;
  v3 = a1;
  if ( !Function_20627b4(*(uint **)(a2 + 48), *(uint *)(a2 + 4), *(uint *)(v2 + 8), *(uint *)(v2 + 12)) )
    return Function_5_21df74c(v3);
  Function_20715e4(v3, &v5);
  return (int *)Function_20212a8(*(uint **)(v2 + 52), &v5);
}

//----- (021F3A50) --------------------------------------------------------
int *__fastcall Function_21f3a50(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 4, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f3a7c();
  return v3;
}

//----- (021F3A6C) --------------------------------------------------------
uint __fastcall Function_21f3a6c(int a1)
{
  int v1;

  v1 = a1;
  Function_21f3ac4();
  return Function_5_21df554(v1);
}

//----- (021F3A7C) --------------------------------------------------------
int __fastcall Function_21f3a7c(int *a1)
{
  int *v1;

  v1 = a1;
  Function_21df9e0(*a1, 8, 90);
  Function_21dfa14(*v1, 8, 177);
  Function_21dfa3c(*v1, 9, 9u, 1);
  return Function_21df864(*v1, 10, 8, 8, 9, 0, (int)&dword_2200660);
}

//----- (021F3AC4) --------------------------------------------------------
uint __fastcall Function_21f3ac4(int *a1)
{
  int *v1;

  v1 = a1;
  Function_21dfa08(*a1);
  Function_21dfa30(*v1);
  Function_21dfa7c(*v1, 9);
  return Function_21df9d4(*v1, 10);
}

//----- (021F3AEC) --------------------------------------------------------
int *__fastcall Function_5_21f3aec(int a1, int a2)
{
  uint *v2;
  int v3;
  int v4;
  int v5;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  uint *v13;
  char v14;

  v2 = (uint *)a1;
  v3 = a2;
  v4 = Function_21df578(a1);
  v7 = LoadSpritePositionX((int)v2);
  v8 = LoadSpritePositionZ((int)v2);
  v9 = LoadSpritePositionY((int)v2);
  v11 = v4;
  v10 = Function_21df574(v4);
  v12 = Function_21df55c();
  v13 = v2;
  CopySprite70Struct(v2, &v14);
  v5 = Function_2062758((int)v2, 2);
  return Function_5_21df72c(v4, dword_220064C, (int *)&v14, v3, (int)&v7, v5);
}

//----- (021F3B54) --------------------------------------------------------
int __fastcall Function_21f3b54(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  int v5;
  uint *v6;
  uint *v7;
  int v8;
  uint *v9;
  int v10;
  int v12;
  int v13;
  int v14;

  v2 = (uint *)a1;
  v3 = a2;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v4[1];
  v6 = v3 + 6;
  *v6 = *v4;
  v6[1] = v5;
  v7 = v3 + 8;
  v8 = v4[3];
  *v7 = v4[2];
  v7[1] = v8;
  v9 = v3 + 10;
  v10 = v4[5];
  *v9 = v4[4];
  v9[1] = v10;
  v3[12] = v4[6];
  v3[1] = Function_2062924(v3[12]);
  v3[2] = GetSpriteID(v3[12]);
  v3[3] = GetSprite_c(v3[12]);
  v12 = v3[6] << 16;
  v14 = v3[8] << 16;
  v13 = GetSprite74(v3[12]);
  v3[5] = Function_20644a4(v3[9], &v12);
  v12 += 30720;
  v13 -= 0x8000;
  v14 += 53248;
  Function_20715d4(v2, &v12);
  v3[13] = Function_21df84c(v3[10], 10, &v12);
  if ( !Function_20715b4((int)v2) )
    *v3 = 1;
  return 1;
}

//----- (021F3BF4) --------------------------------------------------------
int __fastcall Function_21f3bf4(int a1, int a2)
{
  return Function_20211fc(*(uint *)(a2 + 52));
}

//----- (021F3C00) --------------------------------------------------------
int *__fastcall Function_21f3c00(int *a1, int **a2, int a3, int a4)
{
  int **v4;
  int *v5;
  int *v6;
  int *result;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;

  v15 = a4;
  v4 = a2;
  v5 = a2[12];
  v6 = a1;
  if ( !Function_20627b4(v5, (int)a2[1], (int)v4[2], (int)v4[3]) )
    return Function_5_21df74c(v6);
  if ( !v4[5] )
  {
    Function_20715e4(v6, &v13);
    v10 = (uint)v4[6] << 16;
    v12 = (uint)v4[8] << 16;
    v11 = v14;
    v8 = Function_20644a4((int)v4[9], &v10);
    v4[5] = (int *)v8;
    if ( v8 == 1 )
    {
      v14 = v11;
      Function_20715d4(v6, &v13);
    }
  }
  result = *v4;
  if ( *v4 )
  {
    if ( result == (int *)1 )
    {
      Function_2021380((uint)v4[13], 0x2000);
      Function_2021368((int)v4[13], 0);
      *v4 = (int *)2;
    }
    else if ( result != (int *)2 )
    {
      return result;
    }
    v9 = LoadSpritePositionX((int)v5);
    result = (int *)LoadSpritePositionY((int)v5);
    if ( v4[6] != (int *)v9 || v4[8] != result )
      result = Function_5_21df74c(v6);
  }
  else
  {
    Function_2021368((int)v4[13], 4096);
    result = (int *)(Function_20213d4((int)v4[13]) / 4096);
    if ( (int)result >= 2 )
    {
      result = (int *)1;
      *v4 = (int *)1;
    }
  }
  return result;
}

//----- (021F3CCC) --------------------------------------------------------
int *__fastcall Function_21f3ccc(int *a1, int a2)
{
  int v2;
  int *v3;
  char v5;

  v2 = a2;
  v3 = a1;
  if ( !Function_2062764(*(uint **)(a2 + 48), *(uint *)(a2 + 8), *(uint *)(a2 + 12)) )
    return Function_5_21df74c(v3);
  Function_20715e4(v3, &v5);
  return (int *)Function_20212a8(*(uint **)(v2 + 52), &v5);
}

//----- (021F3D00) --------------------------------------------------------
int *__fastcall Function_21f3d00(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 420, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f3d2c();
  return v3;
}

//----- (021F3D1C) --------------------------------------------------------
uint __fastcall Function_21f3d1c(int a1)
{
  int v1;

  v1 = a1;
  Function_21f3d6c();
  return Function_5_21df554(v1);
}

//----- (021F3D2C) --------------------------------------------------------
int (__fastcall *__fastcall Function_21f3d2c(int a1))(uint *a1, int a2, uint a3, int a4)
{
  uint *v1;
  int v2;
  uchar *v3;
  int *v4;
  int (__fastcall *result)(uint *, int, uint, int);
  int **v6;

  v1 = (uint *)&dword_2200678;
  v6 = (int **)a1;
  v2 = 0;
  v3 = (uchar *)(a1 + 4);
  v4 = (int *)(a1 + 84);
  do
  {
    Function_5_21dfb00(*v6, v3, 0, *v1, 0);
    result = Function_2073b70(v4, (int)v3);
    ++v2;
    ++v1;
    v3 += 20;
    v4 += 21;
  }
  while ( v2 < 4 );
  return result;
}

//----- (021F3D6C) --------------------------------------------------------
uchar *__fastcall Function_21f3d6c(int a1)
{
  int v1;
  int v2;
  uchar *result;

  v1 = 0;
  v2 = a1 + 4;
  do
  {
    result = Function_207395c(v2);
    ++v1;
    v2 += 20;
  }
  while ( v1 < 4 );
  return result;
}

//----- (021F3D84) --------------------------------------------------------
int __fastcall Function_21f3d84(int a1, int a2)
{
  return a1 + 84 + 84 * a2;
}

//----- (021F3D90) --------------------------------------------------------
int *__fastcall Function_5_21f3d90(int a1, int a2)
{
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  char v15;

  v2 = a1;
  v3 = a2;
  v4 = Function_21df578(a1);
  v5 = Function_21df574(v4);
  v6 = LoadSpritePositionX(v2);
  v7 = LoadSpritePositionY(v2);
  Function_2064450(v6, v7, &v15);
  Function_20644a4(v5, (int *)&v15);
  v10 = v3;
  v11 = v4;
  v12 = Function_21df55c();
  v13 = v2;
  v14 = Function_21f3d84(v12, v3);
  v8 = Function_2062758(v2, 2);
  return Function_5_21df72c(v4, dword_2200688, (int *)&v15, 0, (int)&v10, v8);
}

//----- (021F3E00) --------------------------------------------------------
int __fastcall Function_21f3e00(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  int v4;
  int v5;
  uint *v6;
  uint *v7;
  int v8;

  v2 = a2;
  v3 = (uint *)Function_20715bc(a1);
  v4 = v3[3];
  v5 = v3[1];
  v6 = v2 + 4;
  *v6 = *v3;
  v6[1] = v5;
  v7 = v2 + 6;
  v8 = v3[3];
  *v7 = v3[2];
  v7[1] = v8;
  v2[8] = v3[4];
  v2[2] = GetSpriteID(v4);
  v2[3] = GetSprite_c(v4);
  return 1;
}

//----- (021F3E30) --------------------------------------------------------
int __fastcall Function_21f3e30(int a1, int *a2)
{
  uint *v2;
  int result;

  v2 = (uint *)a2[7];
  result = Function_2062764(v2, a2[2], a2[3]);
  if ( result == 1 )
    result = Function_206a218((int)v2, 0);
  return result;
}

//----- (021F3E50) --------------------------------------------------------
void Function_21f3e50()
{
  ;
}

//----- (021F3E54) --------------------------------------------------------
int *__fastcall Function_21f3e54(int *result, int a2, int a3, int a4)
{
  int v4;
  int v5[3];
  int v6;

  v6 = a4;
  v4 = a2;
  if ( *(uint *)(a2 + 4) != 1 )
  {
    Function_20715e4(result, v5);
    result = Function_2073bb4(*(uint **)(v4 + 32), v5);
  }
  return result;
}

//----- (021F3E74) --------------------------------------------------------
int *__fastcall Function_21f3e74(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 4, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f3ea0();
  return v3;
}

//----- (021F3E90) --------------------------------------------------------
uint __fastcall Function_21f3e90(int a1)
{
  int v1;

  v1 = a1;
  Function_21f3ee8();
  return Function_5_21df554(v1);
}

//----- (021F3EA0) --------------------------------------------------------
int __fastcall Function_21f3ea0(int *a1)
{
  int *v1;

  v1 = a1;
  Function_21df9e0(*a1, 9, 107);
  Function_21dfa14(*v1, 9, 180);
  Function_21dfa3c(*v1, 10, 0xCu, 1);
  return Function_21df864(*v1, 11, 9, 9, 10, 0, (int)&dword_22006B0);
}

//----- (021F3EE8) --------------------------------------------------------
uint __fastcall Function_21f3ee8(int *a1)
{
  int *v1;

  v1 = a1;
  Function_21dfa08(*a1);
  Function_21dfa30(*v1);
  Function_21dfa7c(*v1, 10);
  return Function_21df9d4(*v1, 11);
}

//----- (021F3F10) --------------------------------------------------------
int *__fastcall Function_5_21f3f10(int a1, int a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v10[3];
  int v11;
  int v12;
  int v13;
  uint *v14;
  int v15;

  v15 = a4;
  v4 = (uint *)a1;
  v5 = Function_21df578(a1);
  v11 = GetSpriteSpriteListFirstSprite((int)v4);
  v12 = v5;
  v13 = Function_21df55c();
  v14 = v4;
  CopySprite70Struct(v4, v10);
  v6 = LoadSpritePositionX((int)v4);
  v7 = LoadSpritePositionY((int)v4);
  Function_2064450(v6, v7, v10);
  v8 = Function_2062758((int)v4, 2);
  return Function_5_21df72c(v5, dword_220069C, v10, 0, (int)&v11, v8);
}

//----- (021F3F74) --------------------------------------------------------
int __fastcall Function_21f3f74(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  uint *v5;
  int v6;
  uint *v7;
  int v8;
  char v10;

  v2 = a2;
  v3 = (uint *)a1;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v2 + 4;
  v6 = v4[1];
  *v5 = *v4;
  v5[1] = v6;
  v7 = v2 + 6;
  v8 = v4[3];
  *v7 = v4[2];
  v7[1] = v8;
  v2[1] = GetSpriteID(v2[7]);
  v2[2] = GetSprite_c(v2[7]);
  Function_20715e4(v3, &v10);
  v2[8] = Function_21df84c(v2[5], 11, (int *)&v10);
  return 1;
}

//----- (021F3FB8) --------------------------------------------------------
int __fastcall Function_21f3fb8(int a1, int a2)
{
  return Function_20211fc(*(uint *)(a2 + 32));
}

//----- (021F3FC4) --------------------------------------------------------
int *__fastcall Function_21f3fc4(int *a1, int **a2)
{
  int **v2;
  int *v3;
  int *result;

  v2 = a2;
  v3 = a1;
  result = *a2;
  if ( !*a2 )
  {
    Function_2021368((int)a2[8], 4096);
    result = (int *)(Function_20213d4((int)v2[8]) / 4096);
    if ( (int)result >= 7 )
      result = Function_5_21df74c(v3);
  }
  return result;
}

//----- (021F3FF4) --------------------------------------------------------
int __fastcall Function_21f3ff4(uint *a1, int a2, int a3, int a4)
{
  int v4;
  char v6;
  int v7;
  int v8;

  v8 = a4;
  v4 = a2;
  Function_20715e4(a1, &v6);
  v7 += 0x8000;
  return Function_20212a8(*(uint **)(v4 + 32), &v6);
}

//----- (021F4018) --------------------------------------------------------
int *__fastcall Function_21f4018(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 128, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f4044();
  return v3;
}

//----- (021F4034) --------------------------------------------------------
uint __fastcall Function_21f4034(int a1)
{
  int v1;

  v1 = a1;
  Function_21f407c();
  return Function_5_21df554(v1);
}

//----- (021F4044) --------------------------------------------------------
int __fastcall Function_21f4044(int a1)
{
  int v1;

  v1 = a1;
  Function_5_21dfb00(*(int **)a1, (uchar *)(a1 + 4), 0, 0x6Fu, 0);
  Function_21dfb24(*(int **)v1, (int *)(v1 + 24), 0, 0xA6u, 0);
  return Function_21dfb24(*(int **)v1, (int *)(v1 + 60), 0, 0xA7u, 0);
}

//----- (021F407C) --------------------------------------------------------
int *__fastcall Function_21f407c(int a1)
{
  int v1;

  v1 = a1;
  Function_207395c(a1 + 4);
  Function_2073aa8(v1 + 24);
  return Function_2073aa8(v1 + 60);
}

//----- (021F4098) --------------------------------------------------------
int *__fastcall Function_5_21f4098(int a1, int *a2, int a3, int a4)
{
  int v4;
  int v5;
  int **v6;
  int v7;
  int v8;
  int *result;
  int v10;
  int **v11;
  int v12;
  int v13;
  int *v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  int v20;
  int v21;

  v21 = a4;
  v13 = a1;
  v14 = a2;
  v18 = 0;
  v19 = 0;
  v20 = 0;
  v15 = *(uint *)(a1 + 64);
  if ( !Function_21df4e4() )
    Function_5_21df4a8(v15, 30);
  v5 = Function_21df55c();
  v17 = v5;
  v16 = v15;
  if ( v14 != (int *)1 )
  {
    v6 = (int **)(v5 + 96);
    v7 = 1;
    v8 = 16;
    do
    {
      v18 = (v8 << 12) + 0x8000;
      v20 = 1277952;
      v19 = Function_20644d0(v13, &v18, 0, v4);
      ++v7;
      v8 += 16;
      *v6 = Function_5_21df72c(v15, dword_22006C8, &v18, 0, (int)&v16, 0);
      ++v6;
    }
    while ( v7 < 5 );
  }
  result = v14;
  if ( v14 )
  {
    v10 = 18;
    v11 = (int **)(v5 + 112);
    v12 = 288;
    do
    {
      v18 = (v12 << 12) + 0x8000;
      v20 = 1277952;
      v19 = Function_20644d0(v13, &v18, 0, v4);
      result = Function_5_21df72c(v15, dword_22006C8, &v18, 0, (int)&v16, 0);
      ++v10;
      v12 += 16;
      *v11 = result;
      ++v11;
    }
    while ( v10 < 22 );
  }
  return result;
}

//----- (021F416C) --------------------------------------------------------
uint __fastcall Function_5_21f416c(int a1, int a2)
{
  int v2;
  int v3;
  int *v4;
  int v5;
  int *v6;
  int *v7;
  uint result;
  uint *v9;

  v2 = a2;
  v9 = *(uint **)(a1 + 64);
  if ( Function_21df4e4() != 1 )
    ErrorHandler();
  v3 = Function_21df55c();
  if ( v2 )
    v4 = (int *)(v3 + 112);
  else
    v4 = (int *)(v3 + 96);
  v5 = 0;
  do
  {
    v6 = (int *)Function_2071598(*v4);
    v7 = v6;
    *v6 = 1;
    Function_2073a90((int)(v6 + 1));
    Function_2073974(v7 + 1);
    Function_21dfb40(v9, v7 + 1, v7[32] + 4, v7[32] + 60, 0);
    result = Function_2073b90(v7 + 10, v7[32] + 4, (int)(v7 + 1));
    ++v5;
    ++v4;
  }
  while ( v5 < 4 );
  return result;
}

//----- (021F41F0) --------------------------------------------------------
int __fastcall Function_21f41f0(int a1, int a2)
{
  int v2;
  uint *v3;
  int v4;

  v2 = a2;
  v3 = (uint *)Function_20715bc(a1);
  v4 = v3[1];
  *(uint *)(v2 + 124) = *v3;
  *(uint *)(v2 + 128) = v4;
  Function_21dfb40(
    *(uint **)(v2 + 124),
    (int *)(v2 + 4),
    *(uint *)(v2 + 128) + 4,
    *(uint *)(v2 + 128) + 24,
    0);
  Function_2073b90((int *)(v2 + 40), *(uint *)(v2 + 128) + 4, v2 + 4);
  return 1;
}

//----- (021F4234) --------------------------------------------------------
int *__fastcall Function_21f4234(int a1, int a2)
{
  return Function_2073aa8(a2 + 4);
}

//----- (021F4240) --------------------------------------------------------
int *__fastcall Function_21f4240(int *a1, uint *a2)
{
  uint *v2;
  int *v3;
  int v4;

  v2 = a2;
  v3 = a1;
  v4 = 1;
  if ( *a2 == 1 )
  {
    if ( Function_2073b40(a2 + 1) == 1 )
      return Function_5_21df74c(v3);
    v4 = 0;
  }
  return (int *)Function_2073ac0(v2 + 1, 4096, v4);
}

//----- (021F4270) --------------------------------------------------------
int *__fastcall Function_21f4270(uint *a1, int a2, int a3, int a4)
{
  int v4;
  int v6[3];
  int v7;

  v7 = a4;
  v4 = a2;
  Function_20715e4(a1, v6);
  return Function_2073bb4((uint *)(v4 + 40), v6);
}

//----- (021F428C) --------------------------------------------------------
int *__fastcall Function_21f428c(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 512, 0, 0);
  v3 = v2;
  v2[2] = (int)v1;
  Function_21f431c();
  return v3;
}

//----- (021F42A8) --------------------------------------------------------
uint __fastcall Function_21f42a8(int a1)
{
  int v1;
  int v2;
  int v3;

  v1 = a1;
  v2 = *(uint *)(a1 + 504);
  if ( v2 )
    free(v2);
  v3 = *(uint *)(v1 + 508);
  if ( v3 )
    free(v3);
  Function_21f4370(v1);
  return Function_5_21df554(v1);
}

//----- (021F42D8) --------------------------------------------------------
int *__fastcall Function_5_21f42d8(uint *a1, int a2, int a3)
{
  int v3;
  uint *v4;
  int v5;
  int *result;
  int *v7;

  v3 = a2;
  v4 = a1;
  v5 = a3;
  result = (int *)Function_21df55c();
  v7 = result;
  result[1] = v5;
  *result = v3;
  if ( v3 )
  {
    result = Function_21df53c(v4, 4 * v3, 0, 0);
    v7[126] = (int)result;
  }
  if ( v5 )
  {
    result = Function_21df53c(v4, 4 * v5, 0, 0);
    v7[127] = (int)result;
  }
  return result;
}

//----- (021F431C) --------------------------------------------------------
int __fastcall Function_21f431c(int a1)
{
  int v1;
  uint *v2;
  int v3;
  uchar *v4;
  uint *v5;
  int v6;
  int *v7;
  int result;

  v1 = a1;
  v2 = (uint *)&dword_22006DC;
  v3 = 0;
  v4 = (uchar *)(a1 + 12);
  do
  {
    Function_5_21dfb00(*(int **)(v1 + 8), v4, 0, *v2, 0);
    ++v3;
    ++v2;
    v4 += 20;
  }
  while ( v3 < 3 );
  v5 = (uint *)&dword_2200720;
  v6 = 0;
  v7 = (int *)(v1 + 72);
  do
  {
    result = Function_21dfb24(*(int **)(v1 + 8), v7, 0, *v5, 0);
    ++v6;
    ++v5;
    v7 += 9;
  }
  while ( v6 < 12 );
  return result;
}

//----- (021F4370) --------------------------------------------------------
int *__fastcall Function_21f4370(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  int v5;
  int *result;

  v1 = a1;
  v2 = 0;
  v3 = a1 + 12;
  do
  {
    Function_207395c(v3);
    ++v2;
    v3 += 20;
  }
  while ( v2 < 3 );
  v4 = 0;
  v5 = v1 + 72;
  do
  {
    result = Function_2073aa8(v5);
    ++v4;
    v5 += 36;
  }
  while ( v4 < 12 );
  return result;
}

//----- (021F439C) --------------------------------------------------------
int __fastcall Function_21f439c(int a1, short a2, short a3, int a4, int a5, int a6)
{
  int v6;
  int *v7;
  int v8;
  int v9;
  uint *v10;
  int v11;
  uint *v12;
  int result;
  int v14;
  short v15;
  short v16;
  int v17;

  v14 = a1;
  v15 = a2;
  v6 = *(uint *)(a1 + 64);
  v16 = a3;
  v17 = a4;
  v7 = (int *)Function_21df55c();
  if ( a5 )
  {
    v8 = v7[1];
    v9 = 127;
  }
  else
  {
    v8 = *v7;
    v9 = 126;
  }
  v10 = (uint *)v7[v9];
  if ( !v8 )
    ErrorHandler();
  v11 = 0;
  *(ushort *)(a6 + 2) = v15;
  *(ushort *)(a6 + 4) = v16;
  *(uint *)(a6 + 8) = v17;
  *(uint *)(a6 + 16) = v14;
  *(uint *)(a6 + 12) = v7;
  if ( v8 <= 0 )
  {
LABEL_11:
    ErrorHandler();
    result = 0;
  }
  else
  {
    v12 = v10;
    while ( *v12 )
    {
      ++v11;
      ++v12;
      if ( v11 >= v8 )
        goto LABEL_11;
    }
    result = (int)&v10[v11];
  }
  return result;
}

//----- (021F440C) --------------------------------------------------------
int __fastcall Function_21f440c(int a1, int a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int v6;
  int v7;
  uint *v8;
  uint *v9;
  int v10;
  int v12;
  int v13;
  int v14;

  v14 = a4;
  v4 = (uint *)a1;
  v5 = a2;
  v6 = Function_20715bc(a1);
  v7 = *(uint *)(v6 + 4);
  v8 = (uint *)(v5 + 132);
  *v8 = *(uint *)v6;
  v8[1] = v7;
  v9 = (uint *)(v5 + 140);
  v10 = *(uint *)(v6 + 12);
  *v9 = *(uint *)(v6 + 8);
  v9[1] = v10;
  *(uint *)(v5 + 148) = *(uint *)(v6 + 16);
  *(ushort *)(v5 + 2) = *(ushort *)(v6 + 2);
  *(ushort *)(v5 + 4) = *(ushort *)(v6 + 4);
  *(uchar *)(v5 + 1) = *(uchar *)(v6 + 1);
  *(uint *)(v5 + 8) = 4096;
  Function_2064450(*(short *)(v5 + 2), *(short *)(v5 + 4), &v12);
  Function_20644a4(*(uint *)(v5 + 148), &v12);
  v13 += *(uint *)(v5 + 140) + 24576;
  return Function_20715d4(v4, &v12);
}

//----- (021F4474) --------------------------------------------------------
int *__fastcall Function_5_21f4474(int a1, short a2, short a3, int a4)
{
  int v4;
  int **v5;
  int *result;
  char v7;

  v4 = *(uint *)(a1 + 64);
  v5 = (int **)Function_21f439c(a1, a2, a3, a4, 0, (int)&v7);
  result = Function_5_21df72c(v4, dword_220070C, 0, 0, (int)&v7, 0);
  *v5 = result;
  return result;
}

//----- (021F44A4) --------------------------------------------------------
int __fastcall Function_5_21f44a4(int a1)
{
  uint *v1;
  int v2;
  int *v3;
  int result;
  int v5;
  int v6;

  v1 = (uint *)Function_2071598(a1);
  v5 = v1[27];
  if ( v1[29] )
    ErrorHandler();
  *v1 = 1;
  v1[29] = Function_21df53c(*(uint **)(v5 + 8), 148, 1, 0);
  Function_2073b70(v1 + 3, v1[27] + 12);
  v6 = 0;
  v2 = 0;
  v3 = &dword_22006E8;
  do
  {
    Function_21dfb40(*(uint **)(v5 + 8), (int *)(v1[29] + 4 + v2), v5 + 12, v5 + 72 + 36 * *v3, 0);
    Function_2073b84((uint)(v1 + 3), v1[29] + 4 + v2);
    ++v3;
    result = v6 + 1;
    v2 += 36;
    v6 = result;
  }
  while ( result < 4 );
  return result;
}

//----- (021F453C) --------------------------------------------------------
BOOL __fastcall Function_5_21f453c(int a1)
{
  int v1;

  v1 = Function_2071598(a1);
  if ( !*(uint *)(v1 + 116) )
    ErrorHandler();
  return **(uint **)(v1 + 116) == 15;
}

//----- (021F4560) --------------------------------------------------------
int __fastcall Function_21f4560(int a1, int a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int v6;
  int v7;
  uint *v8;
  uint *v9;
  int v10;
  int v12;
  int v13;
  int v14;

  v14 = a4;
  v4 = (uint *)a1;
  v5 = a2;
  v6 = Function_20715bc(a1);
  v7 = *(uint *)(v6 + 4);
  v8 = (uint *)(v5 + 96);
  *v8 = *(uint *)v6;
  v8[1] = v7;
  v9 = (uint *)(v5 + 104);
  v10 = *(uint *)(v6 + 12);
  *v9 = *(uint *)(v6 + 8);
  v9[1] = v10;
  *(uint *)(v5 + 112) = *(uint *)(v6 + 16);
  *(ushort *)(v5 + 4) = *(ushort *)(v6 + 2);
  *(ushort *)(v5 + 6) = *(ushort *)(v6 + 4);
  *(ushort *)(v5 + 8) = *(char *)(v6 + 1);
  Function_2064450(*(short *)(v5 + 4), *(short *)(v5 + 6), &v12);
  Function_20644a4(*(uint *)(v5 + 112), &v12);
  v13 += *(uint *)(v5 + 104) + 24576;
  Function_20715d4(v4, &v12);
  Function_2073b70((int *)(v5 + 12), *(uint *)(v5 + 108) + 32);
  return 1;
}

//----- (021F45D0) --------------------------------------------------------
uint __fastcall Function_21f45d0(int a1, int a2)
{
  int v2;
  uint result;
  int v4;
  int v5;

  v2 = a2;
  result = *(uint *)(a2 + 116);
  if ( result )
  {
    v4 = 0;
    v5 = 0;
    do
    {
      Function_2073aa8(*(uint *)(v2 + 116) + 4 + v5);
      ++v4;
      v5 += 36;
    }
    while ( v4 < 4 );
    result = free(*(uint *)(v2 + 116));
  }
  return result;
}

//----- (021F45F8) --------------------------------------------------------
uint *__fastcall Function_21f45f8(int a1, uint *a2)
{
  uint *result;
  int v3;
  uint *v4;
  int *v5;
  uint *v6;

  result = (uint *)*a2;
  v6 = a2;
  if ( *a2 && result == (uint *)1 )
  {
    if ( !a2[29] )
      ErrorHandler();
    v3 = 0;
    v4 = (uint *)v6[29];
    v5 = v4 + 1;
    do
    {
      if ( Function_2073ac0(v5, 4096, 0) )
        *v4 |= 1 << v3;
      ++v3;
      v5 += 9;
    }
    while ( v3 < 4 );
    result = (uint *)*v4;
    if ( *v4 == 15 )
    {
      result = v6;
      *v6 = 0;
    }
  }
  return result;
}

//----- (021F464C) --------------------------------------------------------
int *__fastcall Function_21f464c(uint *a1, int a2, int a3, int a4)
{
  int v4;
  int v6[3];
  int v7;

  v7 = a4;
  v4 = a2;
  Function_20715e4(a1, v6);
  return Function_2073bb4((uint *)(v4 + 12), v6);
}

//----- (021F4668) --------------------------------------------------------
int *__fastcall Function_5_21f4668(int a1, short a2, short a3, int a4)
{
  int v4;
  int **v5;
  int *result;
  char v7;

  v4 = *(uint *)(a1 + 64);
  v5 = (int **)Function_21f439c(a1, a2, a3, a4, 1, (int)&v7);
  result = Function_5_21df72c(v4, dword_22006F8, 0, 0, (int)&v7, 0);
  *v5 = result;
  return result;
}

//----- (021F4698) --------------------------------------------------------
uint __fastcall Function_5_21f4698(int a1, int a2, int a3)
{
  int v3;
  int v4;
  uchar *v5;
  int v6;
  int v7;
  int v8;

  v3 = a2;
  v4 = a3;
  v5 = (uchar *)Function_2071598(a1);
  v6 = *((uint *)v5 + 36);
  if ( (uint)*v5 << 25 >> 31 == 1 )
    Function_2073a90((int)(v5 + 12));
  *v5 |= 0x40u;
  *v5 &= 0x7Fu;
  *v5 = *v5 & 0xC0 | 1;
  v7 = GetOppositeFaceDirection(v3);
  v8 = v7;
  if ( v4 == 1 )
    v8 = v7 + 4;
  Function_21dfb40(*(uint **)(v6 + 8), (int *)v5 + 3, v6 + 52, v6 + 72 + 36 * v8, 0);
  return Function_2073b90((int *)v5 + 12, v6 + 52, (int)(v5 + 12));
}

//----- (021F4714) --------------------------------------------------------
int __fastcall Function_5_21f4714(int a1, int a2)
{
  int v2;
  int result;

  v2 = a2;
  result = Function_2071598(a1);
  *(uint *)(result + 8) = v2;
  return result;
}

//----- (021F4720) --------------------------------------------------------
uint __fastcall Function_5_21f4720(int a1)
{
  return (uint)*(uchar *)Function_2071598(a1) << 24 >> 31;
}

//----- (021F4730) --------------------------------------------------------
int __fastcall Function_21f4730(int a1, int a2, int a3, int a4)
{
  int v4;

  v4 = a2;
  Function_21f440c(a1, a2, a3, a4);
  Function_2073b70((int *)(v4 + 48), *(uint *)(v4 + 144) + 52);
  return 1;
}

//----- (021F474C) --------------------------------------------------------
uint __fastcall Function_21f474c(int a1, uchar *a2)
{
  uint result;

  result = (uint)(uchar)*a2 << 25 >> 31;
  if ( *a2 & 0x40 )
    result = (uint)Function_2073aa8((int)(a2 + 12));
  return result;
}

//----- (021F4760) --------------------------------------------------------
int __fastcall Function_21f4760(int a1, int a2)
{
  uchar *v2;
  int result;
  int v4;

  v2 = (uchar *)a2;
  result = *(uchar *)a2 & 0x3F;
  if ( *(uchar *)a2 & 0x3F && result == 1 )
  {
    result = Function_2073ac0((int *)(a2 + 12), *(uint *)(a2 + 8), 0);
    if ( result )
    {
      *v2 &= 0xC0u;
      v4 = (uchar)*v2;
      result = v4 | 0x80;
      *v2 = v4 | 0x80;
    }
  }
  return result;
}

//----- (021F4794) --------------------------------------------------------
int *__fastcall Function_21f4794(uint *a1, int a2, int a3, int a4)
{
  int v4;
  int v6[3];
  int v7;

  v7 = a4;
  v4 = a2;
  Function_20715e4(a1, v6);
  return Function_2073bb4((uint *)(v4 + 48), v6);
}

//----- (021F47B0) --------------------------------------------------------
int *__fastcall Function_21f47b0(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 220, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f47dc();
  return v3;
}

//----- (021F47CC) --------------------------------------------------------
uint __fastcall Function_21f47cc(int a1)
{
  int v1;

  v1 = a1;
  Function_21f4820();
  return Function_5_21df554(v1);
}

//----- (021F47DC) --------------------------------------------------------
int __fastcall Function_21f47dc(int a1)
{
  int v1;
  uint *v2;
  int v3;
  uchar *v4;
  int v5;
  int v6;

  v1 = a1;
  v2 = (uint *)&dword_220079C;
  v3 = 0;
  v4 = (uchar *)(a1 + 4);
  do
  {
    Function_5_21dfb00(*(int **)v1, v4, 0, *v2, 0);
    ++v3;
    ++v2;
    v4 += 20;
  }
  while ( v3 < 9 );
  Function_20b37a4(*(uint *)(v1 + 16), 0, v5, v6);
  return Function_21dfb24(*(int **)v1, (int *)(v1 + 184), 0, 0xC7u, 0);
}

//----- (021F4820) --------------------------------------------------------
int *__fastcall Function_21f4820(int a1)
{
  int v1;
  int v2;
  int v3;

  v1 = a1;
  v2 = 0;
  v3 = a1 + 4;
  do
  {
    Function_207395c(v3);
    ++v2;
    v3 += 20;
  }
  while ( v2 < 9 );
  return Function_2073aa8(v1 + 184);
}

//----- (021F4840) --------------------------------------------------------
int *__fastcall Function_5_21f4840(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v9;
  int v10;
  int v11;
  int v12;

  v4 = a1;
  v5 = a2;
  v6 = a4;
  v9 = a3;
  v10 = a1;
  v11 = Function_21df55c();
  v12 = v5;
  v7 = Function_2062758(v5, v6);
  return Function_5_21df72c(v4, dword_2200754, 0, 0, (int)&v9, v7);
}

//----- (021F487C) --------------------------------------------------------
int __fastcall Function_21f487c(int a1, int a2)
{
  int v2;
  int v3;
  uint *v4;
  uint *v5;
  uint *v6;
  int v7;
  uint *v8;
  int v9;

  v2 = a2;
  v3 = a1;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v4;
  v6 = (uint *)(v2 + 36);
  v7 = v4[1];
  *v6 = *v4;
  v6[1] = v7;
  v8 = (uint *)(v2 + 44);
  v9 = v4[3];
  *v8 = v4[2];
  v8[1] = v9;
  *(uchar *)v2 = LoadSpriteFaceDirection(v4[3]);
  *(uint *)(v2 + 136) = Function_21df528((uint *)v5[1], 36, 0);
  Function_2073b70((int *)(v2 + 52), *(uint *)(v2 + 44) + 4);
  Function_21dfb40(
    *(uint **)(v2 + 40),
    *(int **)(v2 + 136),
    *(uint *)(v2 + 44) + 4,
    *(uint *)(v2 + 44) + 184,
    0);
  Function_2073b84(v2 + 52, *(uint *)(v2 + 136));
  Function_21f4a24(v3, v2);
  return 1;
}

//----- (021F48F0) --------------------------------------------------------
uint __fastcall Function_21f48f0(int a1, int a2)
{
  int v2;

  v2 = a2;
  Function_2073a90(*(uint *)(a2 + 136));
  return free(*(uint *)(v2 + 136));
}

//----- (021F4908) --------------------------------------------------------
int __fastcall Function_21f4908(int a1, char *a2, int a3, int a4)
{
  char *v4;
  uint *v5;
  int v6;
  char v7;
  char v8;
  char v10;
  char v11;
  int v12;

  v12 = a4;
  v4 = a2;
  v5 = (uint *)*((uint *)a2 + 12);
  v6 = a1;
  v7 = LoadSpriteFaceDirection(*((uint *)a2 + 12));
  CopySprite70Struct(v5, &v10);
  v8 = Function_21f4ab4(v5, *((uint *)v4 + 9), &v11);
  *v4 = v7;
  v4[1] = v8;
  if ( v4[1] == *((uint *)v4 + 9) )
  {
    Function_21f4a24(v6, v4);
  }
  else
  {
    Function_21f4b6c(*v4);
    Function_21f49d0(v6, v4);
  }
  return Function_2073ac0(*((int **)v4 + 34), 4096, 1);
}

//----- (021F4974) --------------------------------------------------------
int *__fastcall Function_21f4974(int *result, int a2, int a3, int a4)
{
  int v4;
  short v5;
  short v6;
  short v7;
  short v8;
  int v9;
  int v10;
  int v11;

  v11 = a4;
  v4 = a2;
  if ( !*(uchar *)(a2 + 2) )
  {
    Function_20715e4(result, &v9);
    v10 += 0x10000;
    v5 = *(ushort *)(v4 + 28);
    v6 = *(ushort *)(v4 + 30);
    v7 = *(ushort *)(v4 + 32);
    v8 = *(ushort *)(v4 + 34);
    Function_21f4a80(&v5, 0);
    Function_21f4a80(&v6, 0);
    Function_21f4a80(&v7, 0);
    result = Function_2073bc8((uint *)(v4 + 52), &v9, (int *)(v4 + 16), (ushort *)&v5);
  }
  return result;
}

//----- (021F49D0) --------------------------------------------------------
int __fastcall Function_21f49d0(uint *a1, char *a2)
{
  uint *v2;
  uint *v3;
  int v4;
  int v6;
  int v7;
  int v8;

  v2 = a1;
  v3 = a2;
  v4 = 2 * *a2;
  *((ushort *)a2 + 14) = dword_220077C[v4];
  *((ushort *)a2 + 15) = HIWORD(dword_220077C[v4]);
  *((ushort *)a2 + 16) = dword_220077C[v4 + 1];
  *((ushort *)a2 + 17) = HIWORD(dword_220077C[v4 + 1]);
  CopySprite70Struct(*((uint **)a2 + 12), &v6);
  v6 += v3[1];
  v7 += v3[2];
  v8 += v3[3];
  return Function_20715d4(v2, &v6);
}

//----- (021F4A24) --------------------------------------------------------
int __fastcall Function_21f4a24(uint *a1, char *a2)
{
  char *v2;
  int *v3;
  int *v4;
  int v5;
  int *v6;
  int v7;
  int *v8;

  v2 = a2;
  v3 = &dword_22007C0[18 * *a2 + 3 * a2[1]];
  v4 = (int *)a2;
  v5 = v3[1];
  v4 += 4;
  *v4 = *v3;
  v4[1] = v5;
  v4[2] = v3[2];
  v6 = &dword_22008E0[18 * *v2 + 3 * v2[1]];
  v7 = v6[1];
  v8 = (int *)(v2 + 4);
  *v8 = *v6;
  v8[1] = v7;
  *((uint *)v2 + 3) = v6[2];
  return Function_21f49d0(a1, v2);
}

//----- (021F4A80) --------------------------------------------------------
uint __fastcall Function_21f4a80(ushort *a1, short a2)
{
  ushort *v2;
  uint v3;
  uint result;
  short v5;

  v2 = a1;
  *a1 += a2;
  v3 = (ushort)*a1;
  if ( (v3 & 0x8000u) == 0 )
  {
    result = s32_div_f(v3, 360);
    *v2 = v5;
  }
  else
  {
    result = 360;
    do
      *v2 += 360;
    while ( (short)*v2 < 0 );
  }
  return result;
}

//----- (021F4AB4) --------------------------------------------------------
int __fastcall Function_21f4ab4(uint *a1, int a2, uint *a3)
{
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  uint *v9;
  int result;
  uint *v11;
  int v12;
  uint *v13;
  int v14;
  char v15;

  v11 = a1;
  v12 = a2;
  v13 = a3;
  if ( !a2 )
    ErrorHandler();
  v3 = LoadSpritePositionX((int)v11);
  v14 = LoadSpritePositionZ((int)v11);
  v4 = LoadSpritePositionY((int)v11);
  v5 = LoadSpriteFaceDirection((int)v11);
  CopySprite70Struct(v11, &v15);
  v6 = 0;
  if ( v12 <= 0 )
  {
LABEL_13:
    Function_2064450(v3, v4, v13);
    result = v6;
  }
  else
  {
    while ( 1 )
    {
      v3 += GetWalkPositionXChange(v5);
      v4 += GetWalkPositionYChange(v5);
      v7 = Function_2063e18((int)v11, (int)&v15, v3, v14, v4, v5);
      if ( v7 )
      {
        if ( v7 != 1 )
          break;
      }
      if ( ++v6 >= v12 )
        goto LABEL_13;
    }
    if ( v7 == 4 )
    {
      v8 = GetSpriteSpriteList((int)v11);
      v9 = Function_206326c(v8, v3, v4, 1);
      if ( !v9 )
        ErrorHandler();
      CopySprite70Struct(v9, v13);
    }
    else
    {
      Function_2064450(v3, v4, v13);
    }
    result = v6;
  }
  return result;
}

//----- (021F4B6C) --------------------------------------------------------
uint __fastcall Function_21f4b6c(int a1, int a2, uint *a3, uint *a4, int *a5, uint *a6)
{
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int *v11;
  int v12;
  int v13;
  int *v14;
  int v15;
  int *v16;
  int v17;
  int v18;
  uint result;
  int v20;
  int v21;

  v20 = a1;
  switch ( (uchar)a1 )
  {
    case 0:
      a1 = a4[2] - a3[2];
      break;
    case 1:
      a1 = a3[2] - a4[2];
      break;
    case 2:
      a1 = *a4 - *a3;
      break;
    case 3:
      a1 = *a3 - *a4;
      break;
    default:
      break;
  }
  v6 = a1 / 0x10000;
  if ( a1 / 0x10000 < 0 )
    v6 = a1 / -65536;
  if ( v6 > a2 )
    v6 = a2;
  v7 = v6 - 1;
  if ( v7 < 0 )
    v7 = 0;
  v21 = v7;
  v8 = ((uint)a1 >> 31) + __ROR4__((a1 << 16) - ((uint)a1 >> 31), 16);
  if ( v8 >= 0 )
  {
    if ( v8 > 0 )
      v21 = v7 + 1;
  }
  else
  {
    v21 = v7 - 1;
  }
  if ( v21 >= 0 )
  {
    if ( v21 > a2 )
      v21 = a2;
  }
  else
  {
    v21 = 0;
  }
  v9 = s32_div_f(v8, 6553);
  v10 = v9;
  if ( v9 < 0 )
    v10 = -v9;
  v11 = &dword_22008E0[18 * v20];
  v12 = (int)&v11[3 * v21];
  v13 = 3 * v7;
  v14 = &v11[3 * v7];
  v15 = v14[1];
  *a5 = *v14;
  a5[1] = v15;
  a5[2] = v14[2];
  v16 = &dword_22007C0[18 * v20];
  v17 = (int)&v16[3 * v21];
  v18 = v16[v13 + 1];
  *a6 = v16[v13];
  a6[1] = v18;
  a6[2] = v16[v13 + 2];
  *a5 += s32_div_f(v11[3 * v21] - *a5, 10) * v10;
  a5[1] += s32_div_f(*(uint *)(v12 + 4) - a5[1], 10) * v10;
  a5[2] += s32_div_f(*(uint *)(v12 + 8) - a5[2], 10) * v10;
  *a6 += s32_div_f(v16[3 * v21] - *a6, 10) * v10;
  a6[1] += s32_div_f(*(uint *)(v17 + 4) - a6[1], 10) * v10;
  result = a6[2] + s32_div_f(*(uint *)(v17 + 8) - a6[2], 10) * v10;
  a6[2] = result;
  return result;
}

//----- (021F4CEC) --------------------------------------------------------
int *__fastcall Function_5_21f4cec(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v10;
  int v11;
  int v12;

  v4 = a1;
  v5 = a2;
  v10 = 0;
  v11 = 0;
  v6 = a4;
  v7 = a3;
  v12 = 0;
  if ( a4 >= 8 )
    ErrorHandler();
  Function_2064450(v5, v7, &v10);
  v8 = Function_21df574(v4);
  Function_20644a4(v8, &v10);
  v11 -= 12288;
  v12 -= 0x4000;
  return Function_5_21df72c(v4, dword_2200768, &v10, v6, v4, 0);
}

//----- (021F4D50) --------------------------------------------------------
int __fastcall Function_21f4d50(int a1, int *a2)
{
  int v2;
  int *v3;

  v2 = a1;
  v3 = a2;
  *a2 = Function_20715b4(a1);
  v3[1] = Function_20715bc(v2);
  v3[2] = Function_21df55c();
  Function_2073b70(v3 + 3, v3[2] + 4 + 20 * (*v3 + 1));
  return 1;
}

//----- (021F4D88) --------------------------------------------------------
void Function_21f4d88()
{
  ;
}

//----- (021F4D8C) --------------------------------------------------------
void Function_21f4d8c()
{
  ;
}

//----- (021F4D90) --------------------------------------------------------
int *__fastcall Function_21f4d90(uint *a1, int a2, int a3, int a4)
{
  int v4;
  int v6[3];
  int v7;

  v7 = a4;
  v4 = a2;
  Function_20715e4(a1, v6);
  return Function_2073bb4((uint *)(v4 + 12), v6);
}

//----- (021F4DAC) --------------------------------------------------------
int *__fastcall Function_21f4dac(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 108, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f4dd8();
  return v3;
}

//----- (021F4DC8) --------------------------------------------------------
uint __fastcall Function_21f4dc8(int a1)
{
  int v1;

  v1 = a1;
  Function_21f4dfc();
  return Function_5_21df554(v1);
}

//----- (021F4DD8) --------------------------------------------------------
int (__fastcall *__fastcall Function_21f4dd8(int a1))(uint *a1, int a2, uint a3, int a4)
{
  int v1;

  v1 = a1;
  Function_5_21dfb00(*(int **)a1, (uchar *)(a1 + 4), 0, 0x11u, 0);
  return Function_2073b70((int *)(v1 + 24), v1 + 4);
}

//----- (021F4DFC) --------------------------------------------------------
uchar *__fastcall Function_21f4dfc(int a1)
{
  return Function_207395c(a1 + 4);
}

//----- (021F4E08) --------------------------------------------------------
int *__fastcall Function_21f4e08(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 3436, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f4e38();
  return v3;
}

//----- (021F4E28) --------------------------------------------------------
uint __fastcall Function_21f4e28(int a1)
{
  int v1;

  v1 = a1;
  Function_21f4e94();
  return Function_5_21df554(v1);
}

//----- (021F4E38) --------------------------------------------------------
int (__fastcall *__fastcall Function_21f4e38(int a1))(uint *a1, int a2, uint a3, int a4)
{
  int **v1;
  int v2;
  uchar *v3;
  int *v4;

  v1 = (int **)a1;
  v2 = 0;
  v3 = (uchar *)(a1 + 4);
  v4 = (int *)(a1 + 664);
  do
  {
    Function_5_21dfb00(*v1, v3, 0, v2 + 26, 0);
    Function_2073b70(v4, (int)v3);
    ++v2;
    v3 += 20;
    v4 += 21;
  }
  while ( v2 < 32 );
  Function_5_21dfb00(*v1, &v1[5 * v2 + 1], 0, 0x19u, 0);
  return Function_2073b70((int *)&v1[21 * v2 + 166], (int)&v1[5 * v2 + 1]);
}

//----- (021F4E94) --------------------------------------------------------
uchar *__fastcall Function_21f4e94(int a1)
{
  int v1;
  int v2;
  uchar *result;

  v1 = 0;
  v2 = a1 + 4;
  do
  {
    result = Function_207395c(v2);
    ++v1;
    v2 += 20;
  }
  while ( v1 < 33 );
  return result;
}

//----- (021F4EAC) --------------------------------------------------------
int *__fastcall Function_5_21f4eac(int a1, int a2, int a3, int a4, int a5)
{
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int *v11;
  int *v12;
  uint *v13;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  int v20;
  int v21;
  int v22;

  v5 = a1;
  v6 = *(uint *)(a1 + 64);
  v7 = a2;
  v8 = a3;
  v9 = a4;
  v10 = v6;
  v21 = v6;
  v22 = Function_21df55c();
  v15 = (v7 << 16) + 36864;
  v17 = v8 << 16;
  v18 = v7;
  v19 = v8;
  v20 = v5;
  v16 = 0;
  v11 = Function_5_21df72c(v10, dword_2200A0C, &v15, 0, (int)&v18, 0xFFu);
  v12 = v11;
  if ( v11 )
  {
    v13 = (uint *)Function_2071598((int)v11);
    v13[21] = a5;
    v13[22] = fflt(v9);
    v13[23] = fflt(v9);
  }
  return v12;
}

//----- (021F4F18) --------------------------------------------------------
int *__fastcall Function_5_21f4f18(int a1, int a2, int a3, int a4, int a5)
{
  int v5;
  int *v6;
  int *v7;
  int v8;

  v5 = a4;
  v6 = Function_5_21f4eac(a1, a2, a3, a4, a5);
  v7 = v6;
  if ( v6 )
  {
    v8 = Function_2071598((int)v6);
    *(uint *)(v8 + 88) = 0;
    *(uint *)(v8 + 92) = fflt(v5);
  }
  return v7;
}

//----- (021F4F44) --------------------------------------------------------
int __fastcall Function_21f4f44(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  int v5;
  uint *v6;
  uint *v7;
  int v8;
  int v10;
  int v11;
  int v12;

  v2 = (uint *)a1;
  v3 = a2;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v4[1];
  v6 = v3 + 27;
  *v6 = *v4;
  v6[1] = v5;
  v7 = v3 + 29;
  v8 = v4[3];
  *v7 = v4[2];
  v7[1] = v8;
  v3[31] = v4[4];
  v10 = (v3[27] << 16) + 36864;
  v12 = v3[28] << 16;
  v11 = 0;
  Function_20715d4(v2, &v10);
  return 1;
}

//----- (021F4F88) --------------------------------------------------------
void Function_21f4f88()
{
  ;
}

//----- (021F4F8C) --------------------------------------------------------
uint __fastcall Function_21f4f8c(int a1, int a2)
{
  int v2;
  uint result;
  char v4;
  long long v5;
  int v6;
  uint v7;

  v2 = a2;
  result = Function_20e11cc(*(uint *)(a2 + 88), *(uint *)(a2 + 92));
  if ( !v4 )
  {
    LODWORD(v5) = f2d(*(uint *)(v2 + 88));
    v6 = dadd(v5, 4596373779694328218LL);
    result = d2f(v6, v7);
    *(uint *)(v2 + 88) = result;
  }
  return result;
}

//----- (021F4FB8) --------------------------------------------------------
int *__fastcall Function_21f4fb8(uint *a1, uint *a2, int a3, int a4)
{
  uint *v4;
  uint *v5;
  int *v6;
  char *v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  char v20;
  int v21;
  int v22;
  int v23;
  int v24;
  int v25;
  int v26;
  int v27;

  v27 = a4;
  v4 = a1;
  v5 = a2;
  v21 = 4096;
  v22 = 4096;
  v6 = dword_2200A20;
  v23 = 4096;
  v7 = &v20;
  v8 = 4;
  do
  {
    v9 = *v6;
    v10 = v6[1];
    v6 += 2;
    *(uint *)v7 = v9;
    *((uint *)v7 + 1) = v10;
    v7 += 8;
    --v8;
  }
  while ( v8 );
  *(uint *)v7 = *v6;
  v11 = v5[31] + 664;
  v12 = 84 * v5[21];
  Function_20715e4(v4, &v24);
  v13 = fflt(v21);
  v14 = fmul(v13, v5[22]);
  v21 = ffix(v14);
  v15 = fflt(v22);
  v16 = fmul(v15, v5[22]);
  v22 = ffix(v16);
  v17 = fflt(v23);
  v18 = fmul(v17, v5[22]);
  v23 = ffix(v18);
  v24 -= 2048;
  v25 -= 4096;
  v26 += 20480;
  return Function_2073ba4((uint *)(v11 + v12), &v24, &v21, (int *)&v20);
}

//----- (021F5060) --------------------------------------------------------
int *__fastcall Function_21f5060(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 108, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f508c();
  return v3;
}

//----- (021F507C) --------------------------------------------------------
uint __fastcall Function_21f507c(int a1)
{
  int v1;

  v1 = a1;
  Function_21f50b0();
  return Function_5_21df554(v1);
}

//----- (021F508C) --------------------------------------------------------
int (__fastcall *__fastcall Function_21f508c(int a1))(uint *a1, int a2, uint a3, int a4)
{
  int v1;

  v1 = a1;
  Function_5_21dfb00(*(int **)a1, (uchar *)(a1 + 4), 0, 0x15u, 0);
  return Function_2073b70((int *)(v1 + 24), v1 + 4);
}

//----- (021F50B0) --------------------------------------------------------
uchar *__fastcall Function_21f50b0(int a1)
{
  return Function_207395c(a1 + 4);
}

//----- (021F50BC) --------------------------------------------------------
int *__fastcall Function_21f50bc(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 120, 0, 0);
  v3 = v2;
  v2[2] = (int)v1;
  Function_21f50e8();
  return v3;
}

//----- (021F50D8) --------------------------------------------------------
uint __fastcall Function_21f50d8(int a1)
{
  int v1;

  v1 = a1;
  Function_21f5110();
  return Function_5_21df554(v1);
}

//----- (021F50E8) --------------------------------------------------------
int (__fastcall *__fastcall Function_21f50e8(int a1))(uint *a1, int a2, uint a3, int a4)
{
  int v1;

  v1 = a1;
  Function_5_21dfb00(*(int **)(a1 + 8), (uchar *)(a1 + 12), 0, 0x16u, 0);
  return Function_2073b70((int *)(v1 + 32), v1 + 12);
}

//----- (021F5110) --------------------------------------------------------
uchar *__fastcall Function_21f5110(int a1)
{
  return Function_207395c(a1 + 12);
}

//----- (021F511C) --------------------------------------------------------
int *__fastcall Function_5_21f511c(int a1, int a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int v6;
  int v8[3];
  int v9;
  int v10;
  uint *v11;
  int v12;

  v12 = a4;
  v4 = (uint *)a1;
  v5 = Function_21df578(a1);
  v6 = v5;
  v9 = v5;
  v10 = Function_21df55c();
  v11 = v4;
  CopySprite70Struct(v4, v8);
  return Function_5_21df72c(v6, dword_2200A50, v8, 0, (int)&v9, 0xFFu);
}

//----- (021F5158) --------------------------------------------------------
int __fastcall Function_21f5158(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  int v5;
  uint *v6;
  char v8;

  v2 = (uint *)a1;
  v3 = a2;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v4[1];
  v6 = v3 + 12;
  *v6 = *v4;
  v6[1] = v5;
  v3[14] = v4[2];
  v3[2] = GetSpriteID(v3[14]);
  v3[3] = GetSprite_c(v3[14]);
  v3[10] = 24576;
  CopySprite70Struct((uint *)v3[14], &v8);
  Function_20715d4(v2, (int *)&v8);
  return 1;
}

//----- (021F51A0) --------------------------------------------------------
void Function_21f51a0()
{
  ;
}

//----- (021F51A4) --------------------------------------------------------
int __fastcall Function_21f51a4(uint *a1, int *a2, int a3, int a4)
{
  int *v4;
  uint *v5;
  uint *v6;
  int result;
  int v8[2];
  int v9;
  int v10;

  v10 = a4;
  v4 = a2;
  v5 = (uint *)a2[14];
  v6 = a1;
  if ( !Function_2062764(v5, a2[2], a2[3]) )
    ErrorHandler();
  result = *v4;
  if ( *v4 )
  {
    if ( result == 1 )
    {
      result = v4[1] + 1;
      v4[1] = result;
      if ( result >= 30 )
      {
        result = *v4 + 1;
        *v4 = result;
      }
    }
  }
  else
  {
    CopySprite70Struct(v5, v8);
    v9 -= 40960;
    result = Function_20715d4(v6, v8);
  }
  return result;
}

//----- (021F5204) --------------------------------------------------------
int __fastcall Function_21f5204(uint *a1, int a2)
{
  uint *v2;
  int v3;
  int *v4;
  char *v5;
  int v6;
  int v7;
  int v8;
  int *v9;
  int v10;
  int v12[9];
  int v13[9];
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;

  v2 = a1;
  v3 = a2;
  v14 = 4096;
  v15 = 4096;
  v4 = dword_2200A64;
  v16 = 4096;
  v5 = (char *)v13;
  v6 = 4;
  do
  {
    v7 = *v4;
    v8 = v4[1];
    v4 += 2;
    *(uint *)v5 = v7;
    *((uint *)v5 + 1) = v8;
    v5 += 8;
    --v6;
  }
  while ( v6 );
  *(uint *)v5 = *v4;
  Function_20715e4(v2, &v17);
  v18 += 102400;
  v19 -= 20480;
  v9 = Function_20af5e0();
  Function_201e2e0(v13, 0x5Au, 0, 0);
  MI_Copy36B(v9, v12);
  MTX_Concat33(v13, v12, v13, v10);
  return Function_2073c1c(*(uint *)(v3 + 52) + 32, &v17, &v14, v13);
}

//----- (021F5284) --------------------------------------------------------
int *__fastcall Function_21f5284(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 120, 0, 0);
  v3 = v2;
  v2[2] = (int)v1;
  Function_21f52b0();
  return v3;
}

//----- (021F52A0) --------------------------------------------------------
uint __fastcall Function_21f52a0(int a1)
{
  int v1;

  v1 = a1;
  Function_21f52d8();
  return Function_5_21df554(v1);
}

//----- (021F52B0) --------------------------------------------------------
int (__fastcall *__fastcall Function_21f52b0(int a1))(uint *a1, int a2, uint a3, int a4)
{
  int v1;

  v1 = a1;
  Function_5_21dfb00(*(int **)(a1 + 8), (uchar *)(a1 + 12), 0, 0x17u, 0);
  return Function_2073b70((int *)(v1 + 32), v1 + 12);
}

//----- (021F52D8) --------------------------------------------------------
uchar *__fastcall Function_21f52d8(int a1)
{
  return Function_207395c(a1 + 12);
}

//----- (021F52E4) --------------------------------------------------------
int *__fastcall Function_5_21f52e4(int a1, int a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int v6;
  int v8[3];
  int v9;
  int v10;
  uint *v11;
  int v12;

  v12 = a4;
  v4 = (uint *)a1;
  v5 = Function_21df578(a1);
  v6 = v5;
  v9 = v5;
  v10 = Function_21df55c();
  v11 = v4;
  CopySprite70Struct(v4, v8);
  return Function_5_21df72c(v6, dword_2200A94, v8, 0, (int)&v9, 0xFFu);
}

//----- (021F5320) --------------------------------------------------------
int __fastcall Function_21f5320(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  int v5;
  uint *v6;
  char v8;

  v2 = (uint *)a1;
  v3 = a2;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v4[1];
  v6 = v3 + 12;
  *v6 = *v4;
  v6[1] = v5;
  v3[14] = v4[2];
  v3[2] = GetSpriteID(v3[14]);
  v3[3] = GetSprite_c(v3[14]);
  v3[10] = 24576;
  CopySprite70Struct((uint *)v3[14], &v8);
  Function_20715d4(v2, (int *)&v8);
  return 1;
}

//----- (021F5368) --------------------------------------------------------
void Function_21f5368()
{
  ;
}

//----- (021F536C) --------------------------------------------------------
int __fastcall Function_21f536c(uint *a1, int *a2)
{
  uint *v2;
  uint *v3;
  int v5[2];
  int v6;

  v2 = (uint *)a2[14];
  v3 = a1;
  if ( !Function_2062764(v2, a2[2], a2[3]) )
    ErrorHandler();
  CopySprite70Struct(v2, v5);
  v6 -= 40960;
  return Function_20715d4(v3, v5);
}

//----- (021F53A8) --------------------------------------------------------
int __fastcall Function_21f53a8(uint *a1, int a2)
{
  uint *v2;
  int v3;
  int *v4;
  char *v5;
  int v6;
  int v7;
  int v8;
  int *v9;
  int v10;
  int v12[9];
  int v13[9];
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;

  v2 = a1;
  v3 = a2;
  v14 = 4096;
  v15 = 4096;
  v4 = dword_2200AA8;
  v16 = 4096;
  v5 = (char *)v13;
  v6 = 4;
  do
  {
    v7 = *v4;
    v8 = v4[1];
    v4 += 2;
    *(uint *)v5 = v7;
    *((uint *)v5 + 1) = v8;
    v5 += 8;
    --v6;
  }
  while ( v6 );
  *(uint *)v5 = *v4;
  Function_20715e4(v2, &v17);
  v18 += 102400;
  v19 -= 20480;
  v9 = Function_20af5e0();
  Function_201e2e0(v13, 0x5Au, 0, 0);
  MI_Copy36B(v9, v12);
  MTX_Concat33(v13, v12, v13, v10);
  return Function_2073c1c(*(uint *)(v3 + 52) + 32, &v17, &v14, v13);
}

//----- (021F5428) --------------------------------------------------------
int *__fastcall Function_21f5428(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 120, 0, 0);
  v3 = v2;
  v2[2] = (int)v1;
  Function_21f5454();
  return v3;
}

//----- (021F5444) --------------------------------------------------------
uint __fastcall Function_21f5444(int a1)
{
  int v1;

  v1 = a1;
  Function_21f547c();
  return Function_5_21df554(v1);
}

//----- (021F5454) --------------------------------------------------------
int (__fastcall *__fastcall Function_21f5454(int a1))(uint *a1, int a2, uint a3, int a4)
{
  int v1;

  v1 = a1;
  Function_5_21dfb00(*(int **)(a1 + 8), (uchar *)(a1 + 12), 0, 0x18u, 0);
  return Function_2073b70((int *)(v1 + 32), v1 + 12);
}

//----- (021F547C) --------------------------------------------------------
uchar *__fastcall Function_21f547c(int a1)
{
  return Function_207395c(a1 + 12);
}

//----- (021F5488) --------------------------------------------------------
int *__fastcall Function_5_21f5488(int a1, int a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int v6;
  int v8[3];
  int v9;
  int v10;
  uint *v11;
  int v12;

  v12 = a4;
  v4 = (uint *)a1;
  v5 = Function_21df578(a1);
  v6 = v5;
  v9 = v5;
  v10 = Function_21df55c();
  v11 = v4;
  CopySprite70Struct(v4, v8);
  return Function_5_21df72c(v6, dword_2200AD8, v8, 0, (int)&v9, 0xFFu);
}

//----- (021F54C4) --------------------------------------------------------
int __fastcall Function_21f54c4(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  int v5;
  uint *v6;
  char v8;

  v2 = (uint *)a1;
  v3 = a2;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v4[1];
  v6 = v3 + 13;
  *v6 = *v4;
  v6[1] = v5;
  v3[15] = v4[2];
  v3[2] = GetSpriteID(v3[15]);
  v3[3] = GetSprite_c(v3[15]);
  v3[10] = 24576;
  CopySprite70Struct((uint *)v3[15], &v8);
  Function_20715d4(v2, (int *)&v8);
  v3[12] = 60;
  return 1;
}

//----- (021F5510) --------------------------------------------------------
void Function_21f5510()
{
  ;
}

//----- (021F5514) --------------------------------------------------------
int *__fastcall Function_21f5514(int *a1, int a2, int a3, int a4)
{
  int v4;
  int *v5;
  int v7[2];
  int v8;
  int v9;

  v9 = a4;
  v4 = *(uint *)(a2 + 48);
  v5 = a1;
  if ( !v4 )
    return Function_5_21df74c(a1);
  *(uint *)(a2 + 48) = v4 - 1;
  CopySprite70Struct(*(uint **)(a2 + 60), v7);
  v8 -= 40960;
  return (int *)Function_20715d4(v5, v7);
}

//----- (021F554C) --------------------------------------------------------
int __fastcall Function_21f554c(uint *a1, int a2)
{
  uint *v2;
  int v3;
  int *v4;
  char *v5;
  int v6;
  int v7;
  int v8;
  int *v9;
  int v10;
  int v12[9];
  int v13[9];
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;

  v2 = a1;
  v3 = a2;
  v14 = 4096;
  v15 = 4096;
  v4 = dword_2200AEC;
  v16 = 4096;
  v5 = (char *)v13;
  v6 = 4;
  do
  {
    v7 = *v4;
    v8 = v4[1];
    v4 += 2;
    *(uint *)v5 = v7;
    *((uint *)v5 + 1) = v8;
    v5 += 8;
    --v6;
  }
  while ( v6 );
  *(uint *)v5 = *v4;
  Function_20715e4(v2, &v17);
  v18 += 102400;
  v19 -= 20480;
  v9 = Function_20af5e0();
  Function_201e2e0(v13, 0x5Au, 0, 0);
  MI_Copy36B(v9, v12);
  MTX_Concat33(v13, v12, v13, v10);
  return Function_2073c1c(*(uint *)(v3 + 56) + 32, &v17, &v14, v13);
}

//----- (021F55CC) --------------------------------------------------------
int *__fastcall Function_21f55cc(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 60, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f55f8();
  return v3;
}

//----- (021F55E8) --------------------------------------------------------
uint __fastcall Function_21f55e8(int a1)
{
  int v1;

  v1 = a1;
  Function_21f5620();
  return Function_5_21df554(v1);
}

//----- (021F55F8) --------------------------------------------------------
int __fastcall Function_21f55f8(int a1)
{
  int v1;

  v1 = a1;
  Function_5_21dfb00(*(int **)a1, (uchar *)(a1 + 4), 0, 0x3Au, 0);
  return Function_21dfb24(*(int **)v1, (int *)(v1 + 24), 0, 0xA2u, 0);
}

//----- (021F5620) --------------------------------------------------------
int *__fastcall Function_21f5620(int a1)
{
  int v1;

  v1 = a1;
  Function_207395c(a1 + 4);
  return Function_2073aa8(v1 + 24);
}

//----- (021F5634) --------------------------------------------------------
int __fastcall Function_5_21f5634(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;

  v4 = a2;
  v5 = a4;
  v7 = *(uint *)(a1 + 64);
  v8 = Function_21df55c();
  v9 = (v4 << 16) + 0x8000;
  v10 = 40960;
  v11 = v5 << 16;
  Function_5_21df72c(v7, dword_2200B1C, &v9, 0, (int)&v7, 0xFFu);
  return Function_2005748(0x609u);
}

//----- (021F5684) --------------------------------------------------------
int __fastcall Function_21f5684(int a1, int a2)
{
  int v2;
  uint *v3;
  int v4;

  v2 = a2;
  v3 = (uint *)Function_20715bc(a1);
  v4 = v3[1];
  *(uint *)(v2 + 120) = *v3;
  *(uint *)(v2 + 124) = v4;
  Function_21dfb40(*(uint **)(v2 + 120), (int *)v2, v4 + 4, v4 + 24, 0);
  Function_2073b90((int *)(v2 + 36), *(uint *)(v2 + 124) + 4, v2);
  return 1;
}

//----- (021F56BC) --------------------------------------------------------
int *__fastcall Function_21f56bc(int a1, int a2)
{
  return Function_2073aa8(a2);
}

//----- (021F56C8) --------------------------------------------------------
int *__fastcall Function_21f56c8(int *a1, int *a2)
{
  int *v2;
  int *v3;
  int *result;

  v2 = a2;
  v3 = a1;
  if ( Function_2073b40(a2) == 1 )
    result = Function_5_21df74c(v3);
  else
    result = (int *)Function_2073ac0(v2, 4096, 0);
  return result;
}

//----- (021F56F0) --------------------------------------------------------
int *__fastcall Function_21f56f0(uint *a1, int a2)
{
  uint *v2;
  int v3;
  int *v4;
  char *v5;
  int v6;
  int v7;
  int v8;
  int *v9;
  int v10;
  int v12[9];
  int v13[9];
  int v14;
  int v15;
  int v16;
  char v17;

  v2 = a1;
  v3 = a2;
  v14 = 4096;
  v15 = 4096;
  v4 = dword_2200B30;
  v16 = 4096;
  v5 = (char *)v13;
  v6 = 4;
  do
  {
    v7 = *v4;
    v8 = v4[1];
    v4 += 2;
    *(uint *)v5 = v7;
    *((uint *)v5 + 1) = v8;
    v5 += 8;
    --v6;
  }
  while ( v6 );
  *(uint *)v5 = *v4;
  v9 = Function_20af5e0();
  Function_201e2e0(v13, 0x5Au, 0, 0);
  MI_Copy36B(v9, v12);
  MTX_Concat33(v13, v12, v13, v10);
  Function_20715e4(v2, &v17);
  return Function_2073ba4((uint *)(v3 + 36), (int *)&v17, &v14, v13);
}

//----- (021F575C) --------------------------------------------------------
int *__fastcall Function_21f575c(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 64, 0, 0);
  v3 = v2;
  v2[1] = (int)v1;
  Function_21f5788();
  return v3;
}

//----- (021F5778) --------------------------------------------------------
uint __fastcall Function_21f5778(int a1)
{
  int v1;

  v1 = a1;
  Function_21f57b4();
  return Function_5_21df554(v1);
}

//----- (021F5788) --------------------------------------------------------
int __fastcall Function_21f5788(int a1)
{
  int v1;

  v1 = a1;
  Function_5_21dfb00(*(int **)(a1 + 4), (uchar *)(a1 + 8), 0, 0x5Cu, 0);
  return Function_21dfb24(*(int **)(v1 + 4), (int *)(v1 + 28), 0, 0xA4u, 0);
}

//----- (021F57B4) --------------------------------------------------------
int *__fastcall Function_21f57b4(int a1)
{
  int v1;

  v1 = a1;
  Function_207395c(a1 + 8);
  return Function_2073aa8(v1 + 28);
}

//----- (021F57C8) --------------------------------------------------------
int *__fastcall Function_5_21f57c8(int a1, int a2, int a3)
{
  int v3;
  int v4;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;

  v3 = a2;
  v4 = a3;
  v6 = *(uint *)(a1 + 64);
  v7 = Function_21df55c();
  v8 = (v3 << 16) + 0x8000;
  v10 = (v4 << 16) + 0x8000;
  v9 = 0;
  return Function_5_21df72c(v6, dword_2200B54, &v8, 0, (int)&v6, 0xFFu);
}

//----- (021F580C) --------------------------------------------------------
int __fastcall Function_21f580c(int a1, int a2)
{
  int v2;
  uint *v3;
  int v4;

  v2 = a2;
  v3 = (uint *)Function_20715bc(a1);
  v4 = v3[1];
  *(uint *)(v2 + 120) = *v3;
  *(uint *)(v2 + 124) = v4;
  Function_21dfb40(*(uint **)(v2 + 120), (int *)v2, v4 + 8, v4 + 28, 0);
  Function_2073b90((int *)(v2 + 36), *(uint *)(v2 + 124) + 8, v2);
  return 1;
}

//----- (021F5844) --------------------------------------------------------
int *__fastcall Function_21f5844(int a1, int a2)
{
  return Function_2073aa8(a2);
}

//----- (021F5850) --------------------------------------------------------
int *__fastcall Function_21f5850(int *a1, int *a2)
{
  int *v2;
  int *v3;
  int *result;

  v2 = a2;
  v3 = a1;
  if ( Function_2073b40(a2) == 1 )
    result = Function_5_21df74c(v3);
  else
    result = (int *)Function_2073ac0(v2, 4096, 0);
  return result;
}

//----- (021F5878) --------------------------------------------------------
int *__fastcall Function_21f5878(uint *a1, int a2, int a3, int a4)
{
  int v4;
  int v6[3];
  int v7;

  v7 = a4;
  v4 = a2;
  Function_20715e4(a1, v6);
  return Function_2073bb4((uint *)(v4 + 36), v6);
}

//----- (021F5894) --------------------------------------------------------
int *__fastcall Function_21f5894(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 60, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f58c0();
  return v3;
}

//----- (021F58B0) --------------------------------------------------------
uint __fastcall Function_21f58b0(int a1)
{
  int v1;

  v1 = a1;
  Function_21f58e8();
  return Function_5_21df554(v1);
}

//----- (021F58C0) --------------------------------------------------------
int __fastcall Function_21f58c0(int a1)
{
  int v1;

  v1 = a1;
  Function_5_21dfb00(*(int **)a1, (uchar *)(a1 + 4), 0, 0x5Bu, 0);
  return Function_21dfb24(*(int **)v1, (int *)(v1 + 24), 0, 0xA3u, 0);
}

//----- (021F58E8) --------------------------------------------------------
int *__fastcall Function_21f58e8(int a1)
{
  int v1;

  v1 = a1;
  Function_207395c(a1 + 4);
  return Function_2073aa8(v1 + 24);
}

//----- (021F58FC) --------------------------------------------------------
int *__fastcall Function_5_21f58fc(int a1, int a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;

  v11 = a4;
  v4 = (uint *)a1;
  v7 = Function_21df578(a1);
  v8 = Function_21df55c();
  CopySprite70Struct(v4, &v9);
  switch ( (uchar)LoadSpriteFaceDirection((int)v4) )
  {
    case 0u:
      v10 -= 0x10000;
      break;
    case 1u:
      v10 += 0x10000;
      break;
    case 2u:
      v9 -= 0x10000;
      break;
    case 3u:
      v9 += 0x10000;
      break;
    default:
      break;
  }
  v5 = Function_2062758((int)v4, 2);
  return Function_5_21df72c(v7, dword_2200B68, &v9, 0, (int)&v7, v5);
}

//----- (021F5988) --------------------------------------------------------
int __fastcall Function_21f5988(int a1, int a2)
{
  int v2;
  uint *v3;
  int v4;

  v2 = a2;
  v3 = (uint *)Function_20715bc(a1);
  v4 = v3[1];
  *(uint *)(v2 + 120) = *v3;
  *(uint *)(v2 + 124) = v4;
  Function_21dfb40(*(uint **)(v2 + 120), (int *)v2, v4 + 4, v4 + 24, 0);
  Function_2073b90((int *)(v2 + 36), *(uint *)(v2 + 124) + 4, v2);
  return 1;
}

//----- (021F59C0) --------------------------------------------------------
int *__fastcall Function_21f59c0(int a1, int a2)
{
  return Function_2073aa8(a2);
}

//----- (021F59CC) --------------------------------------------------------
int *__fastcall Function_21f59cc(int *a1, int *a2)
{
  int *v2;
  int *v3;
  int *result;

  v2 = a2;
  v3 = a1;
  if ( Function_2073b40(a2) == 1 )
    result = Function_5_21df74c(v3);
  else
    result = (int *)Function_2073ac0(v2, 4096, 0);
  return result;
}

//----- (021F59F4) --------------------------------------------------------
int *__fastcall Function_21f59f4(uint *a1, int a2, int a3, int a4)
{
  int v4;
  int v6[3];
  int v7;

  v7 = a4;
  v4 = a2;
  Function_20715e4(a1, v6);
  return Function_2073bb4((uint *)(v4 + 36), v6);
}

//----- (021F5A10) --------------------------------------------------------
int *__fastcall Function_21f5a10(uint *a1)
{
  uint *v1;
  int *result;

  v1 = a1;
  result = Function_21df53c(a1, 12, 0, 0);
  result[2] = (int)v1;
  return result;
}

//----- (021F5A24) --------------------------------------------------------
uint __fastcall Function_21f5a24(int a1)
{
  int v1;

  v1 = a1;
  Function_21f5b50();
  return Function_5_21df554(v1);
}

//----- (021F5A34) --------------------------------------------------------
ushort *__fastcall Function_21f5a34(ushort *result)
{
  ++*result;
  return result;
}

//----- (021F5A40) --------------------------------------------------------
int __fastcall Function_21f5a40(ushort *a1)
{
  int result;

  result = (short)--*a1;
  if ( result < 0 )
    result = ErrorHandler();
  return result;
}

//----- (021F5A58) --------------------------------------------------------
int __fastcall Function_21f5a58(int result)
{
  ++*(ushort *)(result + 2);
  return result;
}

//----- (021F5A64) --------------------------------------------------------
int __fastcall Function_21f5a64(int a1)
{
  int result;

  result = (short)--*(ushort *)(a1 + 2);
  if ( result < 0 )
    result = ErrorHandler();
  return result;
}

//----- (021F5A7C) --------------------------------------------------------
ushort *__fastcall Function_21f5a7c(ushort *a1, int a2)
{
  ushort *result;

  if ( a2 )
    result = (ushort *)Function_21f5a58((int)a1);
  else
    result = Function_21f5a34(a1);
  return result;
}

//----- (021F5A90) --------------------------------------------------------
int __fastcall Function_21f5a90(ushort *a1, int a2)
{
  int result;

  if ( a2 )
    result = Function_21f5a64((int)a1);
  else
    result = Function_21f5a40(a1);
  return result;
}

//----- (021F5AA4) --------------------------------------------------------
int __fastcall Function_5_21f5aa4(int a1, char a2)
{
  int v2;
  char v3;
  int result;

  v2 = *(uint *)(a1 + 64);
  v3 = a2;
  result = Function_21df55c();
  *(uchar *)(result + 6) = v3;
  return result;
}

//----- (021F5AB4) --------------------------------------------------------
int __fastcall Function_21f5ab4(int a1)
{
  int v1;
  int result;

  v1 = a1;
  result = *(uchar *)(a1 + 4);
  if ( !result )
  {
    *(uchar *)(v1 + 4) = 1;
    Function_21df9e0(*(uint *)(v1 + 8), 1, 85);
    Function_21dfa14(*(uint *)(v1 + 8), 1, 170);
    Function_21dfa3c(*(uint *)(v1 + 8), 1, 4u, 1);
    result = Function_21df864(*(uint *)(v1 + 8), 1, 1, 1, 1, 0, (int)&dword_2200BC0);
  }
  return result;
}

//----- (021F5B00) --------------------------------------------------------
int __fastcall Function_21f5b00(int a1)
{
  int v1;
  int result;

  v1 = a1;
  result = *(uchar *)(a1 + 5);
  if ( !result )
  {
    *(uchar *)(v1 + 5) = 1;
    Function_21df9e0(*(uint *)(v1 + 8), 10, 108);
    Function_21dfa14(*(uint *)(v1 + 8), 10, 170);
    Function_21dfa3c(*(uint *)(v1 + 8), 11, 0xDu, 1);
    result = Function_21df864(*(uint *)(v1 + 8), 12, 10, 10, 11, 0, (int)&dword_2200BC0);
  }
  return result;
}

//----- (021F5B50) --------------------------------------------------------
uint __fastcall Function_21f5b50(int a1)
{
  int v1;
  uint result;

  v1 = a1;
  result = *(uchar *)(a1 + 4);
  if ( result == 1 )
  {
    *(uchar *)(v1 + 4) = 0;
    Function_21dfa08(*(uint *)(v1 + 8));
    Function_21dfa30(*(uint *)(v1 + 8));
    Function_21dfa7c(*(uint *)(v1 + 8), 1);
    result = Function_21df9d4(*(uint *)(v1 + 8), 1);
  }
  return result;
}

//----- (021F5B80) --------------------------------------------------------
uint __fastcall Function_21f5b80(int a1)
{
  int v1;
  uint result;

  v1 = a1;
  result = *(uchar *)(a1 + 5);
  if ( result == 1 )
  {
    *(uchar *)(v1 + 5) = 0;
    Function_21dfa08(*(uint *)(v1 + 8));
    Function_21dfa30(*(uint *)(v1 + 8));
    Function_21dfa7c(*(uint *)(v1 + 8), 11);
    result = Function_21df9d4(*(uint *)(v1 + 8), 12);
  }
  return result;
}

//----- (021F5BB0) --------------------------------------------------------
ushort *__fastcall Function_21f5bb0(ushort *result)
{
  if ( !*result )
    result = (ushort *)Function_21f5ab4((int)result);
  return result;
}

//----- (021F5BC0) --------------------------------------------------------
int __fastcall Function_21f5bc0(int result)
{
  if ( !*(ushort *)(result + 2) )
    result = Function_21f5b00(result);
  return result;
}

//----- (021F5BD0) --------------------------------------------------------
ushort *__fastcall Function_21f5bd0(ushort *result)
{
  if ( !*result )
    result = (ushort *)Function_21f5b50((int)result);
  return result;
}

//----- (021F5BE0) --------------------------------------------------------
int __fastcall Function_21f5be0(int result)
{
  if ( !*(ushort *)(result + 2) )
    result = Function_21f5b80(result);
  return result;
}

//----- (021F5BF0) --------------------------------------------------------
ushort *__fastcall Function_21f5bf0(ushort *a1, int a2)
{
  ushort *result;

  if ( a2 )
    result = (ushort *)Function_21f5bc0((int)a1);
  else
    result = Function_21f5bb0(a1);
  return result;
}

//----- (021F5C04) --------------------------------------------------------
ushort *__fastcall Function_21f5c04(ushort *a1, int a2)
{
  ushort *result;

  if ( a2 )
    result = (ushort *)Function_21f5be0((int)a1);
  else
    result = Function_21f5bd0(a1);
  return result;
}

//----- (021F5C18) --------------------------------------------------------
int __fastcall Function_21f5c18(int a1, int a2, int *a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v11;
  int v12;

  v4 = a4;
  v11 = 1;
  v12 = 12;
  v5 = Function_21df84c(a1, *(&v11 + a2), a3);
  v6 = v5;
  if ( v4 == 1 )
  {
    v7 = Function_20213f4(v5);
    Function_20b37a4(v7, 0, v8, v9);
  }
  return v6;
}

//----- (021F5C4C) --------------------------------------------------------
int __fastcall Function_5_21f5c4c(int a1)
{
  return *(uint *)(Function_2071598(a1) + 20);
}

//----- (021F5C58) --------------------------------------------------------
uint __fastcall Function_21f5c58(int a1)
{
  int v1;
  uint result;

  v1 = Function_2071598(a1);
  *(uint *)(v1 + 16) = 1;
  result = *(uint *)(v1 + 64);
  if ( result )
    result = Function_2021320(result, 0);
  return result;
}

//----- (021F5C70) --------------------------------------------------------
int __fastcall Function_21f5c70(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  uint *v5;
  int v6;
  uint *v7;
  int v8;
  char v10;

  v2 = a2;
  v3 = (uint *)a1;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v2 + 12;
  v6 = v4[1];
  *v5 = *v4;
  v5[1] = v6;
  v7 = v2 + 14;
  v8 = v4[3];
  *v7 = v4[2];
  v7[1] = v8;
  v2[10] = 24576;
  Function_21f5bf0((ushort *)v2[14], v2[12]);
  Function_20715e4(v3, &v10);
  v2[16] = Function_21f5c18(v2[13], v2[12], (int *)&v10, *(uchar *)(v2[14] + 6));
  Function_21f5a7c((ushort *)v2[14], v2[12]);
  if ( Function_20715b4((int)v3) == 1 )
    Function_2005748(0x5DDu);
  return 1;
}

//----- (021F5CD4) --------------------------------------------------------
int __fastcall Function_21f5cd4(uint *a1, uint *a2)
{
  uint *v2;
  uint *v3;
  int v4;
  int v5;
  char v7;

  v2 = a2;
  v3 = a1;
  Function_20715e4(a1, &v7);
  if ( *v2 )
  {
    if ( *v2 == 1 )
    {
      v5 = v2[1] + 1;
      v2[1] = v5;
      if ( v5 >= 30 )
      {
        ++*v2;
        v2[1] = 0;
        v2[5] = 1;
      }
    }
  }
  else
  {
    v4 = v2[7] + v2[10];
    v2[7] = v4;
    if ( v4 )
    {
      v2[10] -= 0x2000;
    }
    else
    {
      v2[10] = 0;
      ++*v2;
    }
  }
  return Function_20715d4(v3, (int *)&v7);
}

//----- (021F5D38) --------------------------------------------------------
ushort *__fastcall Function_21f5d38(int a1, int a2)
{
  int v2;

  v2 = a2;
  Function_20211fc(*(uint *)(a2 + 64));
  Function_21f5a90(*(ushort **)(v2 + 56), *(uint *)(v2 + 48));
  return Function_21f5c04(*(ushort **)(v2 + 56), *(uint *)(v2 + 48));
}

//----- (021F5D54) --------------------------------------------------------
uint *__fastcall Function_21f5d54(uint *result, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;

  v8 = a4;
  v4 = a2;
  if ( *(uint *)(a2 + 16) != 1 )
  {
    Function_20715e4(result, &v5);
    v5 += *(uint *)(v4 + 24);
    v6 += *(uint *)(v4 + 28);
    v7 += *(uint *)(v4 + 32);
    result = (uint *)Function_20212a8(*(uint **)(v4 + 64), &v5);
  }
  return result;
}

//----- (021F5D8C) --------------------------------------------------------
int *__fastcall Function_5_21f5d8c(int a1, int a2, int a3, int a4)
{
  uint *v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int *v10;
  int v12;
  int v13[3];
  int v14;
  int v15;
  int v16;
  uint *v17;
  int v18;

  v18 = a4;
  v4 = (uint *)a1;
  v5 = a2;
  v12 = a3;
  v6 = a4;
  v7 = Function_21df578(a1);
  v8 = v7;
  v14 = v5;
  v15 = v7;
  v16 = Function_21df55c();
  v17 = v4;
  CopySprite70Struct(v4, v13);
  v9 = GetSpriteSpriteListc((int)v4);
  if ( v6 == 1 )
    v10 = dword_2200BAC;
  else
    v10 = dword_2200B84;
  return Function_5_21df72c(v8, v10, v13, v12, (int)&v14, v9 + 1);
}

//----- (021F5DE4) --------------------------------------------------------
int __fastcall Function_21f5de4(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  uint *v5;
  int v6;
  uint *v7;
  int v8;
  char v10;

  v2 = a2;
  v3 = (uint *)a1;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v2 + 12;
  v6 = v4[1];
  *v5 = *v4;
  v5[1] = v6;
  v7 = v2 + 14;
  v8 = v4[3];
  *v7 = v4[2];
  v7[1] = v8;
  v2[2] = GetSpriteID(v2[15]);
  v2[3] = GetSprite_c(v2[15]);
  v2[10] = 24576;
  Function_21f5bf0((ushort *)v2[14], v2[12]);
  Function_20715e4(v3, &v10);
  v2[16] = Function_21f5c18(v2[13], v2[12], (int *)&v10, *(uchar *)(v2[14] + 6));
  Function_21f5a7c((ushort *)v2[14], v2[12]);
  if ( Function_20715b4((int)v3) == 1 )
    Function_2005748(0x5DDu);
  return 1;
}

//----- (021F5E58) --------------------------------------------------------
int __fastcall Function_21f5e58(uint *a1, int *a2, int a3, int a4)
{
  int *v4;
  uint *v5;
  uint *v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v12;
  int v13;
  int v14;
  int v15;

  v15 = a4;
  v4 = a2;
  v5 = (uint *)a2[15];
  v6 = a1;
  if ( !Function_2062764(v5, a2[2], a2[3]) )
    ErrorHandler();
  Function_21ecda0(v5, &v12, v7, v8);
  v13 += 0x20000;
  v14 += 4096;
  if ( *v4 )
  {
    if ( *v4 == 1 )
    {
      v10 = v4[1] + 1;
      v4[1] = v10;
      if ( v10 >= 30 )
      {
        ++*v4;
        v4[1] = 0;
        v4[5] = 1;
      }
    }
  }
  else
  {
    v9 = v4[7] + v4[10];
    v4[7] = v9;
    if ( v9 )
    {
      v4[10] -= 0x2000;
    }
    else
    {
      v4[10] = 0;
      ++*v4;
    }
  }
  return Function_20715d4(v6, &v12);
}

//----- (021F5EE0) --------------------------------------------------------
int __fastcall Function_21f5ee0(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  int v5;
  uint *v6;
  int v7;

  v2 = a2;
  v3 = (uint *)Function_20715bc(a1);
  v4 = v2 + 12;
  v5 = v3[1];
  *v4 = *v3;
  v4[1] = v5;
  v6 = v2 + 14;
  v7 = v3[3];
  *v6 = v3[2];
  v6[1] = v7;
  v2[2] = GetSpriteID(v2[15]);
  v2[3] = GetSprite_c(v2[15]);
  v2[10] = 24576;
  v2[4] = 1;
  Function_21f5bf0((ushort *)v2[14], v2[12]);
  Function_21f5a7c((ushort *)v2[14], v2[12]);
  return 1;
}

//----- (021F5F24) --------------------------------------------------------
int __fastcall Function_21f5f24(uint *a1, int *a2, int a3, int a4)
{
  int *v4;
  uint *v5;
  uint *v6;
  int v7;
  int v8;
  char v9;
  int v10;
  int v11;
  int v12;
  int v14;
  int v15;
  int v16;
  int v17;

  v17 = a4;
  v4 = a2;
  v5 = (uint *)a2[15];
  v6 = a1;
  if ( !Function_2062764(v5, a2[2], a2[3]) )
    ErrorHandler();
  Function_21ecda0(v5, &v14, v7, v8);
  v15 += 0x20000;
  v9 = v16;
  v16 += 4096;
  switch ( v9 )
  {
    case 0:
    case 1:
      ++*v4;
      break;
    case 2:
      v10 = Function_21f5c18(v4[13], v4[12], &v14, *(uchar *)(v4[14] + 6));
      v4[16] = v10;
      Function_2021320(v10, 0);
      ++*v4;
      break;
    case 3:
      Function_2021320(v4[16], 1);
      v4[4] = 0;
      if ( Function_20715b4((int)v6) == 1 )
        Function_2005748(0x5DDu);
      ++*v4;
      goto LABEL_9;
    case 4:
LABEL_9:
      v11 = v4[7] + v4[10];
      v4[7] = v11;
      if ( v11 )
      {
        v4[10] -= 0x2000;
      }
      else
      {
        v4[10] = 0;
        ++*v4;
      }
      break;
    case 5:
      v12 = v4[1] + 1;
      v4[1] = v12;
      if ( v12 >= 30 )
      {
        ++*v4;
        v4[1] = 0;
        v4[5] = 1;
      }
      break;
    default:
      return Function_20715d4(v6, &v14);
  }
  return Function_20715d4(v6, &v14);
}

//----- (021F600C) --------------------------------------------------------
int *__fastcall Function_21f600c(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 4, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f6038();
  return v3;
}

//----- (021F6028) --------------------------------------------------------
uint __fastcall Function_21f6028(int a1)
{
  int v1;

  v1 = a1;
  Function_21f6074();
  return Function_5_21df554(v1);
}

//----- (021F6038) --------------------------------------------------------
int __fastcall Function_21f6038(int *a1)
{
  int *v1;

  v1 = a1;
  Function_21df9e0(*a1, 4, 87);
  Function_21dfa3c(*v1, 3, 6u, 1);
  return Function_21df864(*v1, 4, 4, 0, 3, 0, (int)&dword_2200BEC);
}

//----- (021F6074) --------------------------------------------------------
uint __fastcall Function_21f6074(int *a1)
{
  int *v1;

  v1 = a1;
  Function_21dfa08(*a1);
  Function_21dfa7c(*v1, 3);
  return Function_21df9d4(*v1, 4);
}

//----- (021F6094) --------------------------------------------------------
int *__fastcall Function_5_21f6094(int a1)
{
  int v1;
  int v2;
  int v3;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;

  v1 = a1;
  v2 = Function_21df578(a1);
  v8 = GetSpriteSpriteListFirstSprite(v1);
  v9 = v2;
  v10 = Function_21df55c();
  v5 = 0;
  v6 = 0;
  v7 = 0;
  v11 = v1;
  v3 = Function_2062758(v1, 2);
  return Function_5_21df72c(v2, dword_2200BD8, &v5, 0, (int)&v8, v3);
}

//----- (021F60E4) --------------------------------------------------------
int __fastcall Function_21f60e4(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  uint *v4;
  uint *v5;
  int v6;
  uint *v7;
  int v8;
  int v10;
  int v11;
  int v12;

  v2 = a2;
  v10 = 0;
  v11 = 0;
  v3 = (uint *)a1;
  v12 = 0;
  v4 = (uint *)Function_20715bc(a1);
  v5 = v2 + 4;
  v6 = v4[1];
  *v5 = *v4;
  v5[1] = v6;
  v7 = v2 + 6;
  v8 = v4[3];
  *v7 = v4[2];
  v7[1] = v8;
  v2[1] = GetSpriteID(v2[7]);
  v2[2] = GetSprite_c(v2[7]);
  Function_20715d4(v3, &v10);
  v2[8] = Function_21df84c(v2[5], 4, &v10);
  return 1;
}

//----- (021F6134) --------------------------------------------------------
int __fastcall Function_21f6134(int a1, int a2)
{
  return Function_20211fc(*(uint *)(a2 + 32));
}

//----- (021F6140) --------------------------------------------------------
int *__fastcall Function_21f6140(int *a1, int a2)
{
  int *v2;
  int *result;

  v2 = a1;
  result = (int *)Function_2062764(*(uint **)(a2 + 28), *(uint *)(a2 + 4), *(uint *)(a2 + 8));
  if ( !result )
    result = Function_5_21df74c(v2);
  return result;
}

//----- (021F615C) --------------------------------------------------------
int *__fastcall Function_21f615c(int *a1, int *a2)
{
  int *v2;
  uint *v3;
  int *v4;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;

  v2 = a2;
  v3 = (uint *)a2[7];
  v4 = a1;
  if ( !Function_2062764(v3, a2[1], a2[2]) )
    return Function_5_21df74c(v4);
  CopySprite70Struct(v3, &v9);
  Function_2063078(v3, &v6);
  v9 += v6;
  v10 += v7;
  v11 += v8 + 49152;
  return (int *)Function_20212a8((uint *)v2[8], &v9);
}

//----- (021F61BC) --------------------------------------------------------
int *__fastcall Function_21f61bc(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 108, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f61e8();
  return v3;
}

//----- (021F61D8) --------------------------------------------------------
uint __fastcall Function_21f61d8(int a1)
{
  int v1;

  v1 = a1;
  Function_21f620c();
  return Function_5_21df554(v1);
}

//----- (021F61E8) --------------------------------------------------------
int (__fastcall *__fastcall Function_21f61e8(int a1))(uint *a1, int a2, uint a3, int a4)
{
  int v1;

  v1 = a1;
  Function_5_21dfb00(*(int **)a1, (uchar *)(a1 + 4), 0, 0x50u, 0);
  return Function_2073b70((int *)(v1 + 24), v1 + 4);
}

//----- (021F620C) --------------------------------------------------------
uchar *__fastcall Function_21f620c(int a1)
{
  return Function_207395c(a1 + 4);
}

//----- (021F6218) --------------------------------------------------------
int *__fastcall Function_21f6218(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;

  v8 = 0;
  v9 = 0;
  v1 = a1;
  v10 = 0;
  v2 = Function_205eb3c(a1);
  v3 = v2;
  v4 = Function_21df578(v2);
  v5 = v4;
  v11 = v4;
  v12 = Function_21df55c();
  v13 = v1;
  v6 = Function_2062758(v3, 2);
  return Function_5_21df72c(v5, dword_2200C10, &v8, 0, (int)&v11, v6);
}

//----- (021F6264) --------------------------------------------------------
int __fastcall Function_21f6264(int a1, uint *a2)
{
  uint *v2;
  uint *v3;
  int v4;
  uint *v5;
  int v6;

  v2 = a2;
  v3 = (uint *)Function_20715bc(a1);
  v4 = v3[1];
  v5 = v2 + 9;
  *v5 = *v3;
  v5[1] = v4;
  v2[11] = v3[2];
  v6 = Function_205eb3c(v3[2]);
  v2[1] = -1;
  v2[5] = GetSpriteID(v6);
  v2[6] = GetSprite_c(v6);
  return 1;
}

//----- (021F629C) --------------------------------------------------------
void Function_21f629c()
{
  ;
}

//----- (021F62A0) --------------------------------------------------------
int *__fastcall Function_21f62a0(int *a1, int a2)
{
  int v2;
  uint *v3;
  int *result;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int *v11;
  int v12;
  int v13;
  int v14;
  char v15;
  int v16;

  v2 = a2;
  v11 = a1;
  v12 = *(uint *)(a2 + 44);
  v3 = (uint *)Function_205eb3c(*(uint *)(a2 + 44));
  if ( !Function_2062764(v3, *(uint *)(v2 + 20), *(uint *)(v2 + 24)) )
    return Function_5_21df74c(v11);
  v5 = *(uint *)(v2 + 4);
  *(uchar *)(v2 + 8) = Function_2062be8((int)v3);
  *(uint *)(v2 + 4) = Function_21f6414(*(uchar *)(v2 + 8));
  *(uint *)v2 = 0;
  v6 = *(uint *)(v2 + 4);
  if ( v6 != -1 && v6 == GetSpriteFaceDirection(v12) )
  {
    if ( v5 != v6 )
    {
      *(uint *)(v2 + 28) = 0;
      *(uint *)(v2 + 32) = 0;
    }
    v7 = LoadSpritePositionX((int)v3);
    v8 = GetWalkPositionXChange(*(uint *)(v2 + 4));
    v9 = LoadSpritePositionY((int)v3);
    v10 = GetWalkPositionYChange(*(uint *)(v2 + 4));
    Function_2064450(v7 + v8, v9 + v10, &v13);
    CopySprite70Struct(v3, &v15);
    v14 = v16;
    Function_20715d4(v11, &v13);
    result = (int *)(*(uint *)(v2 + 28) + 1);
    *(uint *)(v2 + 28) = result;
    if ( (int)result > 15 )
    {
      *(uint *)(v2 + 28) = 0;
      result = (int *)(((uint)(*(uint *)(v2 + 32) + 1) >> 31)
                     + __ROR4__(
                         ((*(uint *)(v2 + 32) + 1) << 31) - ((uint)(*(uint *)(v2 + 32) + 1) >> 31),
                         31));
      *(uint *)(v2 + 32) = result;
    }
  }
  else
  {
    *(uint *)(v2 + 28) = 0;
    *(uint *)(v2 + 32) = 0;
    result = (int *)1;
    *(uint *)v2 = 1;
  }
  return result;
}

//----- (021F636C) --------------------------------------------------------
int *__fastcall Function_21f636c(uint *a1, int **a2)
{
  uint *v2;
  int *result;
  int *v4;
  ushort v5;
  uint *v6;
  int *v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  char v14;

  v2 = a1;
  result = *a2;
  if ( *a2 != (int *)1 )
  {
    result = (int *)-1;
    if ( a2[1] != (int *)-1 )
    {
      v8 = 4096;
      v9 = 4096;
      v10 = 4096;
      v4 = &dword_2200C24[6 * (uint)a2[1]];
      v5 = 0;
      v6 = a2[10] + 6;
      v7 = &v4[3 * (uint)a2[8]];
      switch ( (uchar)v4 )
      {
        case 0:
          v5 = 180;
          break;
        case 2:
          v5 = 270;
          break;
        case 3:
          v5 = 90;
          break;
        default:
          break;
      }
      Function_201e2e0(&v14, 0, v5, 0);
      Function_20715e4(v2, &v11);
      v11 += *v7;
      v12 += v7[1];
      v13 += v7[2];
      result = Function_2073ba4(v6, &v11, &v8, (int *)&v14);
    }
  }
  return result;
}

//----- (021F6414) --------------------------------------------------------
int __fastcall Function_21f6414(int a1)
{
  int v1;

  v1 = a1;
  if ( Function_205db10(a1) )
    return 0;
  if ( Function_205db1c(v1) )
    return 1;
  if ( Function_205db04(v1) )
    return 2;
  if ( Function_205daf8(v1) )
    return 3;
  return -1;
}

//----- (021F6454) --------------------------------------------------------
int __fastcall Function_5_21f6454(int a1, int a2, int a3, int a4)
{
  int v4;
  int *v5;
  int v6;
  int v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  int v13;
  ushort *v14;
  int v15;
  int v16;
  ushort *v17;
  int v19;
  ushort *v20;
  int v21;
  uchar *v22;
  uchar v23;
  uint v24;
  int v25;
  int v26;
  int v27;

  v27 = a4;
  v19 = a1;
  v4 = *(uint *)(a1 + 128);
  v5 = (int *)ScriptHandler_GetSomeScriptAddresses(*(uint *)(a1 + 128), 0xFu);
  v6 = ScriptHandler_LoadHWord(v19);
  v23 = ScriptHandler_CheckSaveParameter(*(uint *)(v19 + 128), v6);
  v7 = ScriptHandler_LoadHWord(v19);
  v24 = ScriptHandler_CheckSaveParameter(*(uint *)(v19 + 128), v7);
  v8 = ScriptHandler_LoadHWord(v19);
  v9 = ScriptHandler_LoadHWord(v19);
  v10 = ScriptHandler_LoadHWord(v19);
  *(uint *)(v19 + 100) = v8;
  v20 = (ushort *)LoadFromMsgNARC(0, 26, 412, 0x20u);
  ScriptHandler_CheckLoadParameter(v4, v8);
  ScriptHandler_GetSomeScriptAddresses(*(uint *)(v19 + 128), 1u);
  ScriptHandler_CheckLoadParameter(v4, v9);
  ScriptHandler_CheckLoadParameter(v4, v10);
  v11 = *v5;
  v12 = Function_21f6704(v4, 20);
  v22 = Function_20308a0(*(uint *)(v4 + 12), 0xBu, (int)&v26);
  if ( v26 == 1 )
  {
    v21 = Function_21f65fc(32, *((ushort *)dword_220210C + v24), &v25);
    v13 = 0;
    if ( v25 > 0 )
    {
      v14 = (ushort *)v21;
      do
      {
        v15 = Function_205e584(v23);
        if ( Function_20308bc(*(uint *)(v4 + 12), (int)v22, v15, *v14) )
        {
          v16 = *v14;
          Function_21f6760(v12);
        }
        ++v13;
        ++v14;
      }
      while ( v13 < v25 );
    }
    free(v21);
  }
  if ( v22 )
    free((int)v22);
  v17 = (ushort *)LoadFromMsgNARC(1, 26, 361, 0x20u);
  Function_21f661c(v12, v17);
  Function_21f6760(v12);
  Function_200b190(v17);
  Function_21f661c(v12, v20);
  Function_21f6768(v12);
  ScriptHandler_AddFunction(v19, (int)Function_21f65d4);
  Function_200b190(v20);
  return 1;
}

//----- (021F65D4) --------------------------------------------------------
BOOL __fastcall Function_21f65d4(int a1)
{
  return *(ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(a1 + 128), *(uint *)(a1 + 100) & 0xFFFF) != 61166;
}

//----- (021F65FC) --------------------------------------------------------
uint *__fastcall Function_21f65fc(int a1, int a2, uint *a3, int a4)
{
  uint *v4;
  uint *result;
  uint v6;
  int v7;

  v7 = a4;
  v4 = a3;
  result = Function_2007068(75, a2, 0, a1, 0, (int *)&v6);
  *v4 = v6 >> 1;
  return result;
}

//----- (021F661C) --------------------------------------------------------
int __fastcall Function_21f661c(int result, int a2)
{
  *(uint *)(result + 508) = a2;
  return result;
}

//----- (021F6624) --------------------------------------------------------
ushort *__fastcall Function_21f6624(int a1, int a2, char a3, char a4, uchar a5, char a6, int a7, int a8, int a9, int a10, int a11, int a12)
{
  int v12;
  ushort *v13;
  int v14;
  int v15;
  int v16;
  int v17;
  int v18;
  ushort *result;

  v12 = a2;
  *(uint *)(a2 + 508) = a10;
  *(uchar *)(a2 + 519) &= 0xFDu;
  *(uint *)(a2 + 512) = a8;
  *(uint *)a2 = a1;
  *(uint *)(a2 + 528) = a7;
  v13 = *(ushort **)(a2 + 528);
  v14 = 0;
  *v13 = 0;
  *(uint *)(v12 + 532) = a11;
  *(uint *)(v12 + 536) = a12;
  *(uchar *)(v12 + 519) = *(uchar *)(v12 + 519) & 0xFE | a6 & 1;
  *(uchar *)(v12 + 518) = a5;
  *(uchar *)(v12 + 520) = a3;
  *(uchar *)(v12 + 521) = a4;
  *(uchar *)(v12 + 523) = 0;
  *(uint *)(v12 + 24) = a9;
  *(uchar *)(v12 + 516) = 3;
  *(ushort *)(v12 + 1780) = a5;
  v15 = v12;
  v16 = v12;
  v17 = 0;
  do
  {
    *(uint *)(v15 + 580) = 0;
    *(uint *)(v15 + 584) = 0;
    *(ushort *)(v16 + 1540) = 255;
    ++v14;
    v15 += 8;
    v16 += 2;
  }
  while ( v14 < 120 );
  v18 = v12;
  do
  {
    *(uint *)(v18 + 28) = Function_2023790(80, 4u);
    ++v17;
    v18 += 4;
  }
  while ( v17 < 120 );
  result = *(ushort **)(v12 + 528);
  *result = -4370;
  return result;
}

//----- (021F6704) --------------------------------------------------------
int __fastcall Function_21f6704(int a1, char a2, char a3, uchar a4, char a5, int a6, int a7, int a8, int a9, int a10, int a11)
{
  char v11;
  int v12;
  uchar v13;
  int *v14;
  int v15;
  char v17;

  v11 = a2;
  v12 = a1;
  v17 = a3;
  v13 = a4;
  v14 = (int *)malloc(4u, 1784);
  v15 = (int)v14;
  if ( !v14 )
    return 0;
  Call_FillMemWithValue(v14, 0, 0x6F8u);
  Function_21f6624(v12, v15, v11, v17, v13, a5, a6, a7, a8, a9, a10, a11);
  return v15;
}

//----- (021F6760) --------------------------------------------------------
int Function_21f6760()
{
  return Function_21f6830();
}

//----- (021F6768) --------------------------------------------------------
uint *__fastcall Function_21f6768(int a1)
{
  int v1;
  uint v2;
  uint *result;

  v1 = a1;
  v2 = *(uchar *)(a1 + 523);
  if ( v2 <= 8 )
    Function_201a7e8(
      *(uint **)(*(uint *)a1 + 8),
      a1 + 8,
      3,
      *(uchar *)(a1 + 520),
      *(uchar *)(a1 + 521),
      0xBu,
      2 * v2,
      13,
      1);
  else
    Function_201a7e8(
      *(uint **)(*(uint *)a1 + 8),
      a1 + 8,
      3,
      *(uchar *)(a1 + 520),
      *(uchar *)(a1 + 521),
      0xBu,
      0x10u,
      13,
      1);
  Function_200daa4(*(uint **)(*(uint *)v1 + 8), 3u, 985, 11, 0, 4);
  Function_200dc48(v1 + 8, 1, 985, 0xBu);
  Function_21f68bc(v1);
  *(uint *)(v1 + 572) = Function_200112c((uint *)(v1 + 540), **(ushort **)(v1 + 532), **(ushort **)(v1 + 536), 4u);
  result = AddTaskToTaskList1((int)Function_21f6a34, v1, 0);
  *(uint *)(v1 + 4) = result;
  return result;
}

//----- (021F6830) --------------------------------------------------------
int __fastcall Function_21f6830(int a1, uint a2, short a3, int a4)
{
  int v4;
  uint v5;
  short v6;
  int v7;
  ushort *v8;
  int v9;
  int v10;
  int v11;
  int result;

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v7 = a4;
  v8 = (ushort *)Function_2023790(80, 4u);
  Function_200b1b8_CallMsgDecrypt(*(ushort ***)(v4 + 508), v5, v8);
  Function_200c388(*(uint **)(v4 + 512), *(uint *)(v4 + 4 * *(uchar *)(v4 + 523) + 28), (int)v8);
  v9 = *(uchar *)(v4 + 523);
  v10 = v4 + 4 * v9;
  v11 = v4 + 8 * v9;
  *(uint *)(v11 + 580) = *(uint *)(v10 + 28);
  Function_20237bc_FreeMsg((int)v8, v11);
  if ( v7 == 250 )
    *(uint *)(v4 + 8 * *(uchar *)(v4 + 523) + 584) = -3;
  else
    *(uint *)(v4 + 8 * *(uchar *)(v4 + 523) + 584) = v7;
  *(ushort *)(v4 + 2 * *(uchar *)(v4 + 523) + 1540) = v6;
  result = *(uchar *)(v4 + 523) + 1;
  *(uchar *)(v4 + 523) = result;
  return result;
}

//----- (021F68BC) --------------------------------------------------------
int __fastcall Function_21f68bc(int result)
{
  *(uint *)(result + 540) = result + 580;
  *(uint *)(result + 544) = Function_21f69f0;
  *(uint *)(result + 548) = Function_21f69cc;
  *(uint *)(result + 552) = result + 8;
  *(ushort *)(result + 556) = *(uchar *)(result + 523);
  *(ushort *)(result + 558) = 8;
  *(uchar *)(result + 560) = 1;
  *(uchar *)(result + 561) = 12;
  *(uchar *)(result + 562) = 2;
  *(uchar *)(result + 563) = *(uchar *)(result + 563) & 0xF0 | 1;
  *(uchar *)(result + 563) = *(uchar *)(result + 563) & 0xF | 0x10;
  *(uchar *)(result + 564) = *(uchar *)(result + 564) & 0xF0 | 0xF;
  *(uchar *)(result + 564) = *(uchar *)(result + 564) & 0xF | 0x20;
  *(ushort *)(result + 566) &= 0xFFF8u;
  *(ushort *)(result + 566) &= 0xFF87u;
  *(ushort *)(result + 566) = *(ushort *)(result + 566) & 0xFE7F | 0x80;
  *(ushort *)(result + 566) &= 0x81FFu;
  *(ushort *)(result + 566) &= 0x7FFFu;
  *(uint *)(result + 568) = result;
  return result;
}

//----- (021F69CC) --------------------------------------------------------
uchar *__fastcall Function_21f69cc(uchar *a1, int a2)
{
  uchar *result;

  if ( a2 == -3 )
    result = Function_200147c(a1, 3, 15, 4);
  else
    result = Function_200147c(a1, 1, 15, 2);
  return result;
}

//----- (021F69F0) --------------------------------------------------------
ushort *__fastcall Function_21f69f0(int a1)
{
  int v1;
  uint v2;
  ushort *result;
  ushort *v4;
  short v5;
  short v6;

  v6 = 0;
  v5 = 0;
  v1 = a1;
  v2 = Function_2001504(a1, 0x13u);
  result = (ushort *)Function_20014dc(v1, &v6, &v5);
  v4 = *(ushort **)(v2 + 532);
  if ( v4 )
  {
    result = *(ushort **)(v2 + 536);
    if ( result )
    {
      *v4 = v6;
      result = *(ushort **)(v2 + 536);
      *result = v5;
    }
  }
  return result;
}

//----- (021F6A34) --------------------------------------------------------
int __fastcall Function_21f6a34(int a1, int a2)
{
  int v2;
  int result;
  int v4;
  int v5;
  int v6;

  v2 = a2;
  result = 516;
  v4 = *(uchar *)(a2 + 516);
  if ( v4 )
  {
    *(uchar *)(v2 + 516) = v4 - 1;
  }
  else
  {
    result = Function_200f2ac();
    if ( result )
    {
      v5 = Function_2001288(*(uint *)(v2 + 572));
      v6 = *(ushort *)(v2 + 1780);
      Function_20014d0(*(uint *)(v2 + 572), (ushort *)(v2 + 1780));
      if ( v6 != *(ushort *)(v2 + 1780) )
        Function_2005748(0x5DCu);
      if ( v5 == -2 )
      {
        result = *(uchar *)(v2 + 519) & 1;
        if ( result == 1 )
        {
          Function_2005748(0x5DCu);
          **(ushort **)(v2 + 528) = -2;
          result = Function_21f6ad4(v2);
        }
      }
      else
      {
        result = -1;
        if ( v5 != -1 )
        {
          Function_2005748(0x5DCu);
          **(ushort **)(v2 + 528) = v5;
          result = Function_21f6ad4(v2);
        }
      }
    }
  }
  return result;
}

//----- (021F6AD4) --------------------------------------------------------
uint __fastcall Function_21f6ad4(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;

  v1 = a1;
  Function_2005748(0x5DCu);
  Function_2001384(*(uint *)(v1 + 572), 0, 0);
  Function_200dc9c(*(uint *)(v1 + 552), 0);
  Function_201a8fc(v1 + 8);
  v3 = 0;
  v4 = v1;
  do
  {
    Function_20237bc_FreeMsg(*(uint *)(v4 + 28), v2);
    ++v3;
    v4 += 4;
  }
  while ( v3 < 120 );
  if ( (uint)*(uchar *)(v1 + 519) << 30 >> 31 == 1 )
    Function_200b190(*(ushort **)(v1 + 508));
  Call_RemoveTaskFromTaskList(*(int **)(v1 + 4));
  return free(v1);
}

//----- (021F6B3C) --------------------------------------------------------
int __fastcall Function_5_21f6b3c(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  ushort *v9;
  int v10;
  ushort *v11;
  int v12;
  ushort *v13;
  uint *v14;
  int *v15;
  uint v16;
  uint v17;
  uint v18;
  uint v19;
  uint v20;
  uint v21;
  uint v23;
  uint v24;
  uint v25;
  uint v26;
  uint v27;
  uint v28;
  int v29;

  v29 = a4;
  v4 = a1;
  v5 = *(uint *)(a1 + 128);
  v6 = ScriptHandler_LoadHWord(a1);
  v7 = ScriptHandler_CheckSaveParameter(*(uint *)(v4 + 128), v6);
  v8 = ScriptHandler_LoadHWord(v4);
  v9 = (ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(v4 + 128), v8);
  v10 = ScriptHandler_LoadHWord(v4);
  v11 = (ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(v4 + 128), v10);
  v12 = ScriptHandler_LoadHWord(v4);
  v13 = (ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(v4 + 128), v12);
  v14 = (uint *)LoadPokePartyAdress(*(uint *)(v5 + 12));
  v15 = GetAdrOfPkmnInParty(v14, v7);
  v23 = GetPkmnData(v15, 0x46u, 0);
  v24 = GetPkmnData(v15, 0x47u, 0);
  v25 = GetPkmnData(v15, 0x48u, 0);
  v26 = GetPkmnData(v15, 0x49u, 0);
  v27 = GetPkmnData(v15, 0x4Au, 0);
  v16 = GetPkmnData(v15, 0x4Bu, 0);
  v17 = 0;
  v28 = v16;
  *v9 = 0;
  do
  {
    *v9 += *(&v23 + v17);
    v17 = (v17 + 1) & 0xFF;
  }
  while ( v17 < 6 );
  *v11 = 0;
  v18 = 1;
  *v13 = v23;
  do
  {
    v19 = *(&v23 + v18);
    v20 = *(&v23 + (ushort)*v11);
    if ( v20 >= v19 )
    {
      if ( v20 == v19 )
      {
        v21 = PRNG();
        if ( !((v21 >> 31) + __ROR4__((v21 << 31) - (v21 >> 31), 31)) )
        {
          *v11 = v18;
          *v13 = v19;
        }
      }
    }
    else
    {
      *v11 = v18;
      *v13 = v19;
    }
    v18 = (v18 + 1) & 0xFF;
  }
  while ( v18 < 6 );
  *v11 = aZ[(ushort)*v11];
  return 0;
}

//----- (021F6C60) --------------------------------------------------------
int __fastcall Function_5_21f6c60(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  uint *v6;
  int v7;
  int v8;
  char *v9;
  int *v10;
  uint v11;
  int v12;
  int v14;
  char *v15;
  int *v16;
  int i;
  int *v18;
  uint v19;
  int v20;
  int v21;
  ushort *v22;
  int v23;
  int v24;
  int v25;
  char v26;
  int v27;

  v27 = a4;
  v4 = a1;
  v24 = 0;
  v23 = *(uint *)(a1 + 128);
  v5 = ScriptHandler_LoadHWord(a1);
  v22 = (ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(v4 + 128), v5);
  v6 = (uint *)LoadPokePartyAdress(*(uint *)(v23 + 12));
  v7 = GetNrOfPkmnInParty((int)v6);
  v8 = 0;
  *v22 = 0;
  if ( v7 > 0 )
  {
    v9 = &v26;
    do
    {
      v10 = GetAdrOfPkmnInParty(v6, v8);
      v11 = GetPkmnData(v10, 6u, 0);
      *(uint *)v9 = v11;
      if ( v11 == 112 )
        ++v24;
      ++v8;
      v9 += 4;
    }
    while ( v8 < v7 );
  }
  if ( v24 > 0 )
  {
    v12 = LoadVariableAreaAdressItemList(*(uint *)(v23 + 12));
    if ( !TakeItem(v12, 0x70u, (ushort)v24, 4u) )
    {
      *v22 = 255;
      return 0;
    }
    v14 = 0;
    v25 = 0;
    if ( v7 > 0 )
    {
      v15 = &v26;
      do
      {
        if ( *(uint *)v15 == 112 )
        {
          v16 = GetAdrOfPkmnInParty(v6, v14);
          SetPkmnData((int)v16, 6, (ushort *)&v25);
        }
        ++v14;
        v15 += 4;
      }
      while ( v14 < v7 );
    }
  }
  for ( i = 0; i < v7; ++i )
  {
    v18 = GetAdrOfPkmnInParty(v6, i);
    if ( (int)GetPkmnData(v18, 0x70u, 0) > 0 )
    {
      v19 = GetPkmnData(v18, 5u, 0);
      switch ( v19 )
      {
        case 0x1DFu:
          Function_2077c20(v18, 0, 0, v21);
          break;
        case 0x1E7u:
          Function_2077a00((int)v18, 487, v20, v21);
          break;
        case 0x1ECu:
          Function_2077acc((int)v18, 0, v20, v21);
          break;
      }
    }
  }
  return 0;
}

//----- (021F6D80) --------------------------------------------------------
int __fastcall Function_5_21f6d80(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  ushort *v9;
  uint *v10;
  int *v11;
  int *v12;
  int v14;
  uint v15;
  int v16;
  int v17;

  v17 = a4;
  v4 = a1;
  v5 = *(uint *)(a1 + 128);
  v6 = ScriptHandler_LoadHWord(a1);
  v7 = ScriptHandler_CheckSaveParameter(*(uint *)(v4 + 128), v6);
  v8 = ScriptHandler_LoadHWord(v4);
  v9 = (ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(v4 + 128), v8);
  v10 = (uint *)LoadPokePartyAdress(*(uint *)(v5 + 12));
  v11 = GetAdrOfPkmnInParty(v10, v7);
  v12 = v11;
  *v9 = 0;
  if ( v7 == 255 )
    return 0;
  if ( GetPkmnData(v11, 6u, 0) == 112 )
  {
    v14 = LoadVariableAreaAdressItemList(*(uint *)(v5 + 12));
    if ( !TakeItem(v14, 0x70u, 1, 4u) )
    {
      *v9 = 255;
      return 0;
    }
    v17 = 0;
    SetPkmnData((int)v12, 6, (ushort *)&v17);
  }
  if ( (int)GetPkmnData(v12, 0x70u, 0) > 0 )
  {
    v15 = GetPkmnData(v12, 5u, 0);
    switch ( v15 )
    {
      case 0x1DFu:
        Function_2077c20(v12, 0, 0, v16);
        break;
      case 0x1E7u:
        Function_2077a00((int)v12, 487, 479, v16);
        break;
      case 0x1ECu:
        Function_2077acc((int)v12, 0, 492, v16);
        break;
    }
  }
  return 0;
}

//----- (021F6E50) --------------------------------------------------------
int __fastcall Function_5_21f6e50(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  uint *v9;
  int *v10;
  short v12;
  int v13;

  v13 = a4;
  v4 = a1;
  v5 = *(uint *)(a1 + 128);
  v6 = ScriptHandler_LoadHWord(a1);
  v7 = ScriptHandler_CheckSaveParameter(*(uint *)(v4 + 128), v6);
  v8 = ScriptHandler_LoadHWord(v4);
  v12 = ScriptHandler_CheckSaveParameter(*(uint *)(v4 + 128), v8);
  v9 = (uint *)LoadPokePartyAdress(*(uint *)(v5 + 12));
  v10 = GetAdrOfPkmnInParty(v9, v7);
  SetPkmnData((int)v10, 112, (ushort *)&v12);
  return 0;
}

//----- (021F6E9C) --------------------------------------------------------
int __fastcall Function_5_21f6e9c(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  ushort *v5;
  short v6;
  int v7;
  int *v8;
  uint v9;
  uint v10;
  ushort *v12;
  uint *v13;
  int v14;
  uint v15;

  v1 = a1;
  v2 = *(uint *)(a1 + 128);
  v3 = ScriptHandler_LoadHWord(a1);
  v12 = (ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(v1 + 128), v3);
  v4 = ScriptHandler_LoadHWord(v1);
  v5 = (ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(v1 + 128), v4);
  *v5 = 255;
  v6 = 0;
  v13 = (uint *)LoadPokePartyAdress(*(uint *)(v2 + 12));
  v7 = 0;
  v14 = GetNrOfPkmnInParty((int)v13);
  if ( v14 > 0 )
  {
    do
    {
      v8 = GetAdrOfPkmnInParty(v13, v7);
      v9 = GetPkmnData(v8, 5u, 0);
      v15 = GetPkmnData(v8, 0x70u, 0);
      v10 = GetPkmnData(v8, 0x4Cu, 0);
      if ( v9 == 479 && v15 && !v10 )
      {
        if ( *v5 == 255 )
          *v5 = v7;
        ++v6;
      }
      ++v7;
    }
    while ( v7 < v14 );
  }
  *v12 = v6;
  return 0;
}

//----- (021F6F44) --------------------------------------------------------
int __fastcall Function_5_21f6f44(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  int v9;
  uint *v10;
  int *v11;
  int v12;
  uint *v13;

  v1 = a1;
  v2 = *(uint *)(a1 + 128);
  v3 = ScriptHandler_LoadHWord(a1);
  v4 = ScriptHandler_CheckSaveParameter(*(uint *)(v1 + 128), v3);
  v5 = ScriptHandler_LoadHWord(v1);
  v6 = ScriptHandler_CheckSaveParameter(*(uint *)(v1 + 128), v5);
  v7 = ScriptHandler_LoadHWord(v1);
  ScriptHandler_CheckSaveParameter(*(uint *)(v1 + 128), v7);
  v8 = ScriptHandler_LoadHWord(v1);
  v9 = ScriptHandler_CheckSaveParameter(*(uint *)(v1 + 128), v8);
  v10 = (uint *)LoadPokePartyAdress(*(uint *)(v2 + 12));
  v11 = GetAdrOfPkmnInParty(v10, v4);
  Function_2077c20(v11, v9, v6, v12);
  v13 = (uint *)LoadPokedexDataAdress(*(uint *)(v2 + 12));
  Function_202736c(v13, v11);
  return 0;
}

//----- (021F6FC0) --------------------------------------------------------
int __fastcall Function_5_21f6fc0(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  ushort *v9;
  uint *v10;
  int *v11;
  int v12;
  int v14;
  char v15;
  int v16;

  v16 = a4;
  v4 = a1;
  v5 = *(uint *)(a1 + 128);
  v6 = ScriptHandler_LoadHWord(a1);
  v7 = ScriptHandler_CheckSaveParameter(*(uint *)(v4 + 128), v6);
  v8 = ScriptHandler_LoadHWord(v4);
  v9 = (ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(v4 + 128), v8);
  v10 = (uint *)LoadPokePartyAdress(*(uint *)(v5 + 12));
  v11 = GetAdrOfPkmnInParty(v10, v7);
  v12 = (ushort)GetPkmnData(v11, 5u, 0);
  if ( !GetPkmnData(v11, 0x4Cu, 0) )
  {
    if ( v12 <= 266 )
    {
      if ( v12 < 266 )
      {
        if ( v12 > 132 )
          JUMPOUT((char *)&off_21F703C + 16);
        if ( v12 < 132 )
        {
          if ( v12 > 14 )
            JUMPOUT((char *)&off_21F703C + 10);
          if ( v12 - 10 >= 0 )
            JUMPOUT(__CS__, *((short *)&off_21F703C + v12 - 10) + 35614782);
          goto LABEL_24;
        }
      }
LABEL_23:
      *v9 = -1;
      return 0;
    }
    if ( v12 > 374 )
    {
      if ( v12 > 412 )
      {
        if ( v12 == 415 )
          goto LABEL_23;
      }
      else if ( v12 >= 412 || v12 == 401 )
      {
        goto LABEL_23;
      }
    }
    else
    {
      if ( v12 >= 374 )
        goto LABEL_23;
      if ( v12 > 268 )
      {
        if ( v12 == 360 )
          goto LABEL_23;
      }
      else if ( v12 == 268 )
      {
        goto LABEL_23;
      }
    }
  }
LABEL_24:
  Function_21f70cc(v11, &v15, &v14);
  *v9 = v14;
  return 0;
}

//----- (021F70CC) --------------------------------------------------------
int __fastcall Function_21f70cc(int *a1, int *a2, int *a3)
{
  int *v3;
  int *v4;
  int *v5;
  int result;
  int v7;
  int v8;
  int v9;
  uint v10;
  uint v11;
  uint v12;
  uint v13;
  char v14;

  v3 = a2;
  v4 = a3;
  v5 = a1;
  v14 = GetPkmnData(a1, 0x46u, 0);
  v13 = GetPkmnData(v5, 0x47u, 0);
  v12 = GetPkmnData(v5, 0x48u, 0);
  v11 = GetPkmnData(v5, 0x49u, 0);
  v10 = GetPkmnData(v5, 0x4Au, 0);
  result = GetPkmnData(v5, 0x4Bu, 0);
  v7 = result;
  if ( v3 )
  {
    v8 = 8 * (v10 & 2) | 4 * (v11 & 2) | 2 * (v12 & 2) | v13 & 2 | ((v14 & 2) >> 1) | 16 * (result & 2);
    *v3 = v8;
    result = s32_div_f(40 * v8, 63) + 30;
    *v3 = result;
  }
  if ( v4 )
  {
    v9 = 32 * v7 & 0x3F | v14 & 1 | 2 * v13 & 3 | 4 * v12 & 7 | 8 * v11 & 0xF | 16 * v10 & 0x1F;
    *v4 = v9;
    result = s32_div_f(15 * v9, 63) + 1;
    *v4 = result;
    if ( result >= 9 )
      *v4 = ++result;
  }
  return result;
}

//----- (021F71B8) --------------------------------------------------------
int __fastcall Function_5_21f71b8(int a1)
{
  int v1;
  int v2;
  uint *v3;
  int *v4;
  int v5;
  short v6;
  char v7;
  char v8;

  v1 = a1 + 128;
  v2 = *(uint *)v1;
  v3 = (uint *)LoadPokePartyAdress(*(uint *)(*(uint *)v1 + 12));
  v4 = GetAdrOfPkmnInParty(v3, 0);
  v5 = LoadVariableAreaAdress_a_3(*(uint *)(v2 + 12));
  v6 = GetPkmnData(v4, 5u, 0);
  v7 = GetPkmnData(v4, 0x70u, 0);
  v8 = GetPkmnData(v4, 0x4Cu, 0);
  Function_20278dc(v5, v6, v7, v8);
  return 0;
}

//----- (021F7208) --------------------------------------------------------
int __fastcall Function_5_21f7208(int a1)
{
  int v1;
  int v2;
  int v3;
  ushort *v4;
  int v5;
  ushort *v6;
  int v7;
  ushort *v8;
  int v9;
  int v11;
  int v12;
  int v13;

  v1 = a1;
  v2 = *(uint *)(a1 + 128);
  v3 = ScriptHandler_LoadHWord(a1);
  v4 = (ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(v1 + 128), v3);
  v5 = ScriptHandler_LoadHWord(v1);
  v6 = (ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(v1 + 128), v5);
  v7 = ScriptHandler_LoadHWord(v1);
  v8 = (ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(v1 + 128), v7);
  v9 = LoadVariableAreaAdress_a_3(*(uint *)(v2 + 12));
  Function_2027914(v9, &v13, &v12, (uint *)&v11);
  *v4 = v13;
  *v6 = v12;
  *v8 = v11;
  return 0;
}

//----- (021F7270) --------------------------------------------------------
int __fastcall Function_5_21f7270(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  int v5;
  ushort *v6;
  uint *v7;
  int *v8;

  v1 = a1;
  v2 = *(uint *)(a1 + 128);
  v3 = ScriptHandler_LoadHWord(a1);
  v4 = ScriptHandler_CheckSaveParameter(*(uint *)(v1 + 128), v3);
  v5 = ScriptHandler_LoadHWord(v1);
  v6 = (ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(v1 + 128), v5);
  v7 = (uint *)LoadPokePartyAdress(*(uint *)(v2 + 12));
  v8 = GetAdrOfPkmnInParty(v7, v4);
  *v6 = GetPkmnData(v8, 0x70u, 0);
  return 0;
}

//----- (021F72B8) --------------------------------------------------------
int __fastcall Function_5_21f72b8(int a1)
{
  int v1;
  int v2;
  int v3;
  uint v4;
  int v5;
  ushort *v6;
  int v7;
  int v8;
  uint v9;
  int v10;

  v1 = a1;
  v2 = *(uint *)(a1 + 128);
  v3 = ScriptHandler_LoadHWord(a1);
  v4 = ScriptHandler_CheckSaveParameter(*(uint *)(v1 + 128), v3);
  v5 = ScriptHandler_LoadHWord(v1);
  v6 = (ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(v1 + 128), v5);
  v7 = LoadFlagAdress(*(uint *)(v2 + 12));
  v8 = LoadVariableAreaAdress_14(*(uint *)(v2 + 12));
  v9 = v4 - 13;
  v10 = v8;
  *v6 = 1;
  if ( v9 <= 7 )
    JUMPOUT(__CS__, (char *)&off_21F730E + *((short *)&off_21F730E + v9) + 2);
  switch ( 1 )
  {
    case 0:
      if ( Function_202cfb8(v8, 29) < 1 )
        *v6 = 0;
      if ( Function_202cfb8(v10, 60) < 1 )
        *v6 = 0;
      if ( Function_202cfb8(v10, 61) < 1 )
        *v6 = 0;
      if ( Function_202cfb8(v10, 62) < 1 )
        *v6 = 0;
      if ( Function_202cfb8(v10, 63) < 1 )
        *v6 = 0;
      break;
    case 1:
      *v6 = 0;
      if ( (uint)Function_206b588(v7) >= 2 )
        *v6 = 1;
      if ( (uint)Function_206b598(v7) >= 2 )
        *v6 = 1;
      if ( (uint)Function_206b5a8(v7) >= 2 )
        *v6 = 1;
      if ( (uint)Function_206b5b8(v7) >= 2 )
        *v6 = 1;
      if ( (uint)Function_206b5c8(v7) >= 2 )
        *v6 = 1;
      break;
    case 2:
      if ( Function_202cfb8(v8, 73) < 0xA )
        *v6 = 0;
      break;
    case 3:
      if ( Function_202cfb8(v8, 57) < 0x32 )
        *v6 = 0;
      break;
    case 4:
      if ( Function_202cfb8(v8, 4) < 0x32 )
        *v6 = 0;
      break;
    case 5:
      if ( Function_202cfb8(v8, 11) < 0x1E )
        *v6 = 0;
      break;
    case 7:
      if ( Function_202cfb8(v8, 0) < 0x493E0 )
        *v6 = 0;
      break;
    default:
      return 0;
  }
  return 0;
}

//----- (021F7414) --------------------------------------------------------
int Function_5_21f7414()
{
  return 1;
}

//----- (021F7418) --------------------------------------------------------
int __fastcall Function_5_21f7418(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  ushort *v6;
  int v7;
  uint v8;
  int v9;
  uint v10;
  int v11;
  uint v12;
  uint v13;
  char *v14;
  uint v15;
  char *v16;
  uint v17;
  char *v18;
  int v20;

  v20 = a4;
  v4 = a1;
  v5 = ScriptHandler_LoadHWord(a1);
  v6 = (ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(v4 + 128), v5);
  v7 = ScriptHandler_LoadHWord(v4);
  v8 = ScriptHandler_CheckSaveParameter(*(uint *)(v4 + 128), v7);
  v9 = ScriptHandler_LoadHWord(v4);
  v10 = ScriptHandler_CheckSaveParameter(*(uint *)(v4 + 128), v9);
  v11 = ScriptHandler_LoadHWord(v4);
  v12 = ScriptHandler_CheckSaveParameter(*(uint *)(v4 + 128), v11);
  switch ( v8 )
  {
    case 0x24Cu:
      v20 = 127;
      v13 = 0;
      v14 = byte_2200C90;
      while ( v10 != *(short *)v14 || v12 != *((short *)v14 + 1) )
      {
        ++v13;
        v14 += 4;
        if ( v13 >= 7 )
          goto LABEL_22;
      }
      Function_2005748(0x5CFu);
      *v6 |= 1 << v13;
      break;
    case 0x24Eu:
      v20 = 127;
      v15 = 0;
      v16 = byte_2200CAC;
      while ( v10 != *(short *)v16 || v12 != *((short *)v16 + 1) )
      {
        ++v15;
        v16 += 4;
        if ( v15 >= 7 )
          goto LABEL_22;
      }
      Function_2005748(0x5CFu);
      *v6 |= 1 << v15;
      break;
    case 0x250u:
      v20 = 127;
      v17 = 0;
      v18 = byte_2200CC8;
      while ( v10 != *(short *)v18 || v12 != *((short *)v18 + 1) )
      {
        ++v17;
        v18 += 4;
        if ( v17 >= 7 )
          goto LABEL_22;
      }
      Function_2005748(0x5CFu);
      *v6 |= 1 << v17;
      break;
  }
LABEL_22:
  if ( (ushort)*v6 == v20 )
    *v6 = 260;
  return 0;
}

//----- (021F7538) --------------------------------------------------------
int __fastcall Function_5_21f7538(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  int v8;
  uint *v9;
  int v10;
  uint *v12;
  uint *v13;
  int v14;
  int v15;
  int v16;
  int v17;

  v17 = a4;
  v14 = 0;
  v4 = *(uint *)(a1 + 128);
  v5 = *(uint *)(v4 + 56);
  v12 = (uint *)Function_205eb3c(*(uint *)(v4 + 60));
  CopySprite70Struct(v12, &v15);
  v6 = v16;
  while ( Function_20625b0(v5, &v13, &v14, 1) == 1 )
  {
    if ( v13 != v12 )
    {
      SetSpriteFlags(v13, 0x2000);
      if ( CheckSpriteFlags(v13, 4096) == 1 )
      {
        CopySprite70Struct(v13, &v15);
        v16 = v6;
        CopyToSprite70Struct(v13, &v15);
        SaveSpritePositionZ((int)v13, (int)((v6 >> 3) + ((uint)(v6 >> 14) >> 20)) >> 12);
      }
      v9 = (uint *)Function_5_21eb1a0((int)v13);
      if ( !v9 )
      {
        v10 = GetSpriteGraphic((int)v13);
        if ( IsValueSpriteBerrytree(v10) )
        {
          if ( CheckSpriteFlag_4000(v13) )
          {
            Function_2062b68((int)v13);
            v9 = (uint *)Function_2067a58((int)v13);
          }
        }
      }
      if ( v9 )
      {
        Function_5_21edeb4(v13, v9, v7, v8);
        Function_2021320((uint)v9, 1);
      }
    }
  }
  return 0;
}

//----- (021F7604) --------------------------------------------------------
int __fastcall Function_5_21f7604(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  uint *v8;
  int v9;
  int v10;

  v10 = a4;
  v9 = 0;
  v4 = *(uint *)(a1 + 128);
  v5 = *(uint *)(v4 + 56);
  v6 = Function_205eb3c(*(uint *)(v4 + 60));
  while ( Function_20625b0(v5, &v8, &v9, 1) == 1 )
  {
    if ( v8 != (uint *)v6 )
      UnsetSpriteFlags(v8, 0x2000);
  }
  return 0;
}

//----- (021F7654) --------------------------------------------------------
uint *__fastcall Function_21f7654(uint *a1, int a2)
{
  int v2;
  uint *v3;
  uint *result;
  int v5;
  int v6;
  uint v7;
  int v8;
  int v9;

  v2 = a2;
  v3 = a1;
  SetSpriteFlags(a1, 0x2000);
  CopySprite70Struct(v3, &v8);
  v9 = v2 << 16;
  CopyToSprite70Struct(v3, &v8);
  SaveSpritePositionZ((int)v3, 2 * v2);
  result = (uint *)Function_5_21eb1a0((int)v3);
  v7 = (uint)result;
  if ( result )
  {
    Function_5_21edeb4(v3, result, v5, v6);
    result = (uint *)Function_2021320(v7, 1);
  }
  return result;
}

//----- (021F76A0) --------------------------------------------------------
int __fastcall Function_5_21f76a0(int a1)
{
  int v1;
  uint *v2;
  uint *v3;

  v1 = *(uint *)(*(uint *)(a1 + 128) + 56);
  v2 = GetAdressOfSpriteID(*(uint *)(*(uint *)(a1 + 128) + 56), 32);
  if ( v2 )
    Function_21f7654(v2, 9);
  v3 = GetAdressOfSpriteID(v1, 2);
  if ( v3 )
    Function_21f7654(v3, 9);
  return 0;
}

//----- (021F76D0) --------------------------------------------------------
int __fastcall Function_5_21f76d0(int a1)
{
  int v1;
  uint *v2;
  uint *v3;

  v1 = *(uint *)(*(uint *)(a1 + 128) + 56);
  v2 = GetAdressOfSpriteID(*(uint *)(*(uint *)(a1 + 128) + 56), 32);
  if ( v2 )
    UnsetSpriteFlags(v2, 0x2000);
  v3 = GetAdressOfSpriteID(v1, 2);
  if ( v3 )
    UnsetSpriteFlags(v3, 0x2000);
  return 0;
}

//----- (021F7704) --------------------------------------------------------
int __fastcall Function_5_21f7704(int a1)
{
  uint *v1;
  uint *v2;
  int v3;
  int v4;

  v1 = GetAdressOfSpriteID(*(uint *)(*(uint *)(a1 + 128) + 56), 15);
  v2 = v1;
  if ( v1 )
  {
    v3 = LoadSpritePositionX((int)v1);
    if ( v3 > 40 )
    {
      if ( v3 != 48 )
        goto LABEL_15;
      v4 = 2;
    }
    else if ( v3 < 38 )
    {
      if ( v3 != 28 )
        goto LABEL_15;
      v4 = 6;
    }
    else if ( v3 == 38 )
    {
      v4 = 5;
    }
    else
    {
      if ( v3 != 40 )
      {
LABEL_15:
        v4 = 4;
        goto LABEL_16;
      }
      v4 = 3;
    }
LABEL_16:
    Function_21f7654(v2, v4);
  }
  return 0;
}

//----- (021F7754) --------------------------------------------------------
int __fastcall Function_5_21f7754(int a1)
{
  uint *v1;

  v1 = GetAdressOfSpriteID(*(uint *)(*(uint *)(a1 + 128) + 56), 15);
  if ( v1 )
    UnsetSpriteFlags(v1, 0x2000);
  return 0;
}

//----- (021F7774) --------------------------------------------------------
int __fastcall Function_5_21f7774(int a1)
{
  int v1;

  v1 = Function_202c878(*(uint *)(*(uint *)(a1 + 128) + 12));
  Function_2038f8c(v1);
  return 1;
}

//----- (021F7788) --------------------------------------------------------
int __fastcall Function_5_21f7788(int a1)
{
  int v1;
  int v2;
  char v3;

  v1 = a1;
  v2 = ScriptHandler_LoadHWord(a1);
  v3 = ScriptHandler_CheckSaveParameter(*(uint *)(v1 + 128), v2);
  Function_200544c(1, v3);
  return 0;
}

//----- (021F77A8) --------------------------------------------------------
int __fastcall Function_5_21f77a8(int a1)
{
  int v1;
  int v2;
  uint v3;
  int v4;
  ushort *v5;
  uint *v6;

  v1 = a1;
  v2 = ScriptHandler_LoadHWord(a1);
  v3 = ScriptHandler_CheckSaveParameter(*(uint *)(v1 + 128), v2);
  v4 = ScriptHandler_LoadHWord(v1);
  v5 = (ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(v1 + 128), v4);
  v6 = (uint *)LoadPokedexDataAdress(*(uint *)(*(uint *)(v1 + 128) + 12));
  *v5 = WasPkmnSeen(v6, v3);
  return 0;
}

//----- (021F77E8) --------------------------------------------------------
int __fastcall Function_5_21f77e8(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  uint v5;
  int v6;
  ushort *v7;
  uint *v8;
  int *v9;

  v1 = a1;
  v2 = ScriptHandler_LoadHWord(a1);
  v3 = ScriptHandler_CheckSaveParameter(*(uint *)(v1 + 128), v2);
  v4 = ScriptHandler_LoadHWord(v1);
  v5 = ScriptHandler_CheckSaveParameter(*(uint *)(v1 + 128), v4);
  v6 = ScriptHandler_LoadHWord(v1);
  v7 = (ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(v1 + 128), v6);
  v8 = (uint *)LoadPokePartyAdress(*(uint *)(*(uint *)(v1 + 128) + 12));
  v9 = GetAdrOfPkmnInParty(v8, v3);
  *v7 = Function_21f7b60(v9, v5);
  return 0;
}

//----- (021F7844) --------------------------------------------------------
int __fastcall Function_5_21f7844(int a1)
{
  int v1;
  int v2;
  int v3;
  int v4;
  uchar v5;
  int v6;
  int v7;
  uint *v8;

  v1 = a1;
  v2 = ScriptHandler_LoadHWord(a1);
  v3 = ScriptHandler_CheckSaveParameter(*(uint *)(v1 + 128), v2);
  v4 = ScriptHandler_LoadHWord(v1);
  v5 = ScriptHandler_CheckSaveParameter(*(uint *)(v1 + 128), v4);
  v6 = ScriptHandler_LoadHWord(v1);
  v7 = ScriptHandler_CheckSaveParameter(*(uint *)(v1 + 128), v6);
  v8 = (uint *)LoadPokePartyAdress(*(uint *)(*(uint *)(v1 + 128) + 12));
  Function_2054988(v8, v3, v5, v7);
  return 0;
}

//----- (021F789C) --------------------------------------------------------
int __fastcall Function_5_21f789c(int a1)
{
  uint v1;
  int v2;
  int v3;
  uint v4;
  int v5;
  ushort *v6;
  int v7;
  short *v8;
  int v9;
  uint v10;
  int result;
  uint v12;
  uint v13;
  uint v14;

  v2 = a1;
  v3 = ScriptHandler_LoadHWord(a1);
  v4 = ScriptHandler_CheckSaveParameter(*(uint *)(v2 + 128), v3);
  v5 = ScriptHandler_LoadHWord(v2);
  v6 = (ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(v2 + 128), v5);
  v7 = LoadVariableAreaAdressItemList(*(uint *)(*(uint *)(v2 + 128) + 12));
  v8 = &word_2200CE4;
  v9 = v7;
  v10 = 0;
  while ( v4 != (ushort)*v8 )
  {
    ++v10;
    v8 += 6;
    if ( v10 >= 0x26 )
      goto LABEL_5;
  }
  v14 = LOBYTE(word_2200CE6[6 * v10]);
  v13 = HIBYTE(word_2200CE6[6 * v10]);
  v12 = LOBYTE(dword_2200CE8[3 * v10]);
  v1 = BYTE1(dword_2200CE8[3 * v10]);
LABEL_5:
  if ( v10 == 38 )
  {
    ErrorHandler();
    result = 0;
    *v6 = 0;
  }
  else
  {
    *v6 = 1;
    if ( v14 && !CheckItem(v7, 0x48u, v14, 0x20u) )
      *v6 = 0;
    if ( v13 && !CheckItem(v9, 0x49u, v13, 0x20u) )
      *v6 = 0;
    if ( v12 && !CheckItem(v9, 0x4Au, v12, 0x20u) )
      *v6 = 0;
    if ( v1 )
    {
      if ( !CheckItem(v9, 0x4Bu, v1, 0x20u) )
        *v6 = 0;
    }
    result = 0;
  }
  return result;
}

//----- (021F7998) --------------------------------------------------------
int __fastcall Function_5_21f7998(int a1)
{
  uint v1;
  uint v2;
  int v3;
  int v4;
  uint v5;
  int v6;
  short *v7;
  int v8;
  uint v9;
  uint v11;
  uint v12;

  v3 = a1;
  v4 = ScriptHandler_LoadHWord(a1);
  v5 = ScriptHandler_CheckSaveParameter(*(uint *)(v3 + 128), v4);
  v6 = LoadVariableAreaAdressItemList(*(uint *)(*(uint *)(v3 + 128) + 12));
  v7 = &word_2200CE4;
  v8 = v6;
  v9 = 0;
  while ( v5 != (ushort)*v7 )
  {
    ++v9;
    v7 += 6;
    if ( v9 >= 0x26 )
      goto LABEL_5;
  }
  v12 = LOBYTE(word_2200CE6[6 * v9]);
  v11 = HIBYTE(word_2200CE6[6 * v9]);
  v2 = LOBYTE(dword_2200CE8[3 * v9]);
  v1 = BYTE1(dword_2200CE8[3 * v9]);
LABEL_5:
  if ( v9 == 38 )
    ErrorHandler();
  GiveItem(v8, 0x48u, v12, 0x20u);
  GiveItem(v8, 0x49u, v11, 0x20u);
  GiveItem(v8, 0x4Au, v2, 0x20u);
  GiveItem(v8, 0x4Bu, v1, 0x20u);
  return 0;
}

//----- (021F7A3C) --------------------------------------------------------
int __fastcall Function_21f7a3c(int a1)
{
  return (ushort)word_2200CE4[6 * a1];
}

//----- (021F7A4C) --------------------------------------------------------
int __fastcall Function_21f7a4c(int a1)
{
  short *v1;
  uint v2;

  v1 = word_2200CE4;
  v2 = 0;
  do
  {
    if ( a1 == (ushort)*v1 )
      return (ushort)v2;
    ++v2;
    v1 += 6;
  }
  while ( v2 < 0x26 );
  ErrorHandler();
  return 0;
}

//----- (021F7A74) --------------------------------------------------------
int __fastcall Function_21f7a74(int *a1, int a2)
{
  int v2;
  int *v3;
  uint v4;
  uint v5;
  int v6;

  v2 = a2;
  v3 = a1;
  v4 = GetPkmnData(a1, 5u, 0);
  v5 = GetPkmnData(v3, 0x70u, 0);
  v6 = (ushort)v4;
  if ( v4 > 0x1DF )
  {
    if ( v4 > 0x1E7 )
    {
      if ( v4 == 492 && v5 == 1 )
        v6 = 500;
    }
    else if ( v4 == 487 && v5 == 1 )
    {
      v6 = 499;
    }
  }
  else if ( v4 >= 0x1DF )
  {
    switch ( v5 )
    {
      case 1u:
        v6 = 501;
        break;
      case 2u:
        v6 = 502;
        break;
      case 3u:
        v6 = 503;
        break;
      case 4u:
        v6 = 504;
        break;
      case 5u:
        v6 = 505;
        break;
    }
  }
  else if ( v4 > 0x182 )
  {
    if ( v4 == 413 )
    {
      if ( v5 == 1 )
      {
        v6 = 497;
      }
      else if ( v5 == 2 )
      {
        v6 = 498;
      }
    }
  }
  else if ( v4 == 386 )
  {
    switch ( v5 )
    {
      case 1u:
        v6 = 494;
        break;
      case 2u:
        v6 = 495;
        break;
      case 3u:
        v6 = 496;
        break;
    }
  }
  return *((uchar *)dword_2200EAC + 5 * (v6 - 1) + v2);
}

//----- (021F7B60) --------------------------------------------------------
int __fastcall Function_21f7b60(int *a1, int a2)
{
  int v2;
  int v3;
  char *v4;
  int v5;
  int v6;
  short *v7;
  int v8;
  char *v9;
  int *v11;
  int v12;
  int v13;
  char v14;

  v2 = a2;
  v11 = a1;
  GetPkmnData(a1, 5u, 0);
  v3 = 0;
  v4 = &v14;
  do
  {
    *(ushort *)v4 = GetPkmnData(v11, v3++ + 54, 0);
    v4 += 2;
  }
  while ( v3 < 4 );
  v13 = 0;
  v12 = 0;
  do
  {
    v5 = Function_21f7a74(v11, (uchar)v13);
    v6 = 0;
    v7 = &word_2200CE4[6 * v12];
    do
    {
      if ( ((v5 >> v6) & 1) == 1 && v2 == *((uint *)v7 + 2) )
      {
        v8 = 0;
        v9 = &v14;
        do
        {
          if ( *(ushort *)v9 == (ushort)*v7 )
            break;
          ++v8;
          v9 += 2;
        }
        while ( v8 < 4 );
        if ( v8 == 4 )
          return 1;
      }
      ++v6;
      v7 += 6;
    }
    while ( v6 < 8 );
    v12 += 8;
    ++v13;
  }
  while ( v13 < 5 );
  return 0;
}

//----- (021F7C04) --------------------------------------------------------
int __fastcall Function_5_21f7c04(int a1)
{
  int v1;
  int *v2;
  int v3;
  int v4;
  int v5;
  int v6;
  uint *v7;
  int v8;
  uint v9;
  char *v10;
  int v11;
  int v12;
  char *v13;
  char *v14;
  int v15;
  int v16;
  short *v17;
  int v18;
  int v19;
  char *v20;
  short *v21;
  uint v22;
  char *v23;
  int v24;
  char *v25;
  int v26;
  ushort *v27;
  int v29;
  int v30;
  uint v31;
  int v32;
  int v33;
  ushort *v34;
  int *v35;
  char v36;
  char v37;

  v29 = a1;
  v1 = *(uint *)(a1 + 128);
  v2 = (int *)ScriptHandler_GetSomeScriptAddresses(*(uint *)(a1 + 128), 0xFu);
  v3 = ScriptHandler_LoadHWord(v29);
  v4 = ScriptHandler_CheckSaveParameter(*(uint *)(v29 + 128), v3);
  v5 = ScriptHandler_LoadHWord(v29);
  v31 = ScriptHandler_CheckSaveParameter(*(uint *)(v29 + 128), v5);
  v6 = ScriptHandler_LoadHWord(v29);
  *(uint *)(v29 + 100) = v6;
  if ( v4 != 255 )
  {
    v7 = (uint *)LoadPokePartyAdress(*(uint *)(*(uint *)(v29 + 128) + 12));
    v35 = GetAdrOfPkmnInParty(v7, v4);
  }
  v34 = (ushort *)LoadFromMsgNARC(0, 26, 647, 0x20u);
  ScriptHandler_CheckLoadParameter(v1, v6);
  ScriptHandler_GetSomeScriptAddresses(*(uint *)(v29 + 128), 1u);
  v8 = *v2;
  v33 = Function_21f7ed8(v1, 20);
  v9 = 0;
  v10 = &v37;
  v11 = 0;
  do
  {
    ++v9;
    *(ushort *)v10 = 0;
    v10 += 2;
  }
  while ( v9 < 0x26 );
  if ( v4 == 255 )
  {
    v21 = word_2200CE4;
    v22 = 0;
    v23 = &v37;
    do
    {
      if ( v31 == *((uint *)v21 + 2) )
      {
        *(ushort *)v23 = Function_21f7a3c((ushort)v22);
        v23 += 2;
        ++v11;
      }
      ++v22;
      v21 += 6;
    }
    while ( v22 < 0x26 );
  }
  else
  {
    v12 = 0;
    v13 = &v36;
    do
    {
      *(ushort *)v13 = GetPkmnData(v35, v12++ + 54, 0);
      v13 += 2;
    }
    while ( v12 < 4 );
    v30 = 0;
    v32 = 0;
    v14 = &v37;
    do
    {
      v15 = Function_21f7a74(v35, (uchar)v30);
      v16 = 0;
      v17 = &word_2200CE4[6 * v32];
      do
      {
        if ( ((v15 >> v16) & 1) == 1 && v31 == *((uint *)v17 + 2) )
        {
          v18 = (ushort)*v17;
          v19 = 0;
          v20 = &v36;
          do
          {
            if ( *(ushort *)v20 == v18 )
              break;
            ++v19;
            v20 += 2;
          }
          while ( v19 < 4 );
          if ( v19 == 4 )
          {
            *(ushort *)v14 = v18;
            v14 += 2;
            ++v11;
          }
        }
        ++v16;
        v17 += 6;
      }
      while ( v16 < 8 );
      v32 += 8;
      ++v30;
    }
    while ( v30 < 5 );
  }
  v24 = 0;
  if ( v11 > 0 )
  {
    v25 = &v37;
    do
    {
      v26 = *(ushort *)v25;
      Function_21f7f2c(v33);
      ++v24;
      v25 += 2;
    }
    while ( v24 < v11 );
  }
  v27 = (ushort *)LoadFromMsgNARC(1, 26, 361, 0x20u);
  Function_21f7e10(v33, v27);
  Function_21f7f2c(v33);
  Function_200b190(v27);
  Function_21f7e10(v33, v34);
  Function_21f7f34(v33);
  ScriptHandler_AddFunction(v29, (int)Function_21f7de8);
  Function_200b190(v34);
  return 1;
}

//----- (021F7DE8) --------------------------------------------------------
BOOL __fastcall Function_21f7de8(int a1)
{
  return *(ushort *)ScriptHandler_CheckLoadParameter(*(uint *)(a1 + 128), *(uint *)(a1 + 100) & 0xFFFF) != 61166;
}

//----- (021F7E10) --------------------------------------------------------
uint *__fastcall Function_21f7e10(int a1, int a2)
{
  uint *result;

  result = (uint *)(a1 + 184);
  *result = a2;
  return result;
}

//----- (021F7E18) --------------------------------------------------------
ushort *__fastcall Function_21f7e18(int a1, int a2, char a3, char a4, uchar a5, char a6, int a7, int a8, int a9, int a10)
{
  int v10;
  int v11;
  uint v12;
  int v13;
  int v14;
  uint v15;
  int v16;
  uint *v17;
  ushort *result;

  v10 = a2;
  *(uint *)(a2 + 184) = a10;
  *(uchar *)(a2 + 195) &= 0xFDu;
  *(uint *)(a2 + 188) = a8;
  *(uint *)a2 = a1;
  *(uint *)(a2 + 204) = a7;
  *(uchar *)(a2 + 195) = a6 & 1 | *(uchar *)(a2 + 195) & 0xFE;
  *(uchar *)(a2 + 194) = a5;
  *(uchar *)(a2 + 196) = a3;
  *(uchar *)(a2 + 197) = a4;
  v11 = a2;
  v12 = 0;
  *(uchar *)(v11 + 199) = 0;
  *(uint *)(v10 + 24) = a9;
  *(uchar *)(v10 + 192) = 3;
  v13 = v10;
  *(ushort *)(v10 + 638) = a5;
  v14 = v10;
  v15 = 0;
  do
  {
    *(uint *)(v14 + 248) = 0;
    *(uint *)(v14 + 252) = 0;
    *(ushort *)(v13 + 560) = 255;
    ++v12;
    v14 += 8;
    v13 += 2;
  }
  while ( v12 < 0x27 );
  v16 = v10;
  do
  {
    *(uint *)(v16 + 28) = Function_2023790(80, 4u);
    ++v15;
    v16 += 4;
  }
  while ( v15 < 0x27 );
  v17 = (uint *)(v10 + 204);
  result = (ushort *)*v17;
  *(ushort *)*v17 = -4370;
  return result;
}

//----- (021F7ED8) --------------------------------------------------------
int __fastcall Function_21f7ed8(int a1, char a2, char a3, uchar a4, char a5, int a6, int a7, int a8, int a9)
{
  char v9;
  int v10;
  uchar v11;
  int *v12;
  int v13;
  char v15;

  v9 = a2;
  v10 = a1;
  v15 = a3;
  v11 = a4;
  v12 = (int *)malloc(4u, 640);
  v13 = (int)v12;
  if ( !v12 )
    return 0;
  Call_FillMemWithValue(v12, 0, 0x280u);
  Function_21f7e18(v10, v13, v9, v15, v11, a5, a6, a7, a8, a9);
  return v13;
}

//----- (021F7F2C) --------------------------------------------------------
int Function_21f7f2c()
{
  return Function_21f7ff8();
}

//----- (021F7F34) --------------------------------------------------------
uint *__fastcall Function_21f7f34(int a1)
{
  int v1;
  uint v2;
  uint *result;

  v1 = a1;
  v2 = *(uchar *)(a1 + 199);
  if ( v2 <= 8 )
    Function_201a7e8(
      *(uint **)(*(uint *)a1 + 8),
      a1 + 8,
      3,
      *(uchar *)(a1 + 196),
      *(uchar *)(a1 + 197),
      0xBu,
      2 * v2,
      13,
      1);
  else
    Function_201a7e8(
      *(uint **)(*(uint *)a1 + 8),
      a1 + 8,
      3,
      *(uchar *)(a1 + 196),
      *(uchar *)(a1 + 197),
      0xBu,
      0x10u,
      13,
      1);
  Function_200daa4(*(uint **)(*(uint *)v1 + 8), 3u, 985, 11, 0, 4);
  Function_200dc48(v1 + 8, 1, 985, 0xBu);
  Function_21f8090(v1);
  *(uint *)(v1 + 240) = Function_200112c((uint *)(v1 + 208), 0, *(uchar *)(v1 + 194), 4u);
  result = AddTaskToTaskList1((int)Function_21f81a8, v1, 0);
  *(uint *)(v1 + 4) = result;
  return result;
}

//----- (021F7FF8) --------------------------------------------------------
int __fastcall Function_21f7ff8(int a1, uint a2, short a3, int a4)
{
  int v4;
  uint v5;
  short v6;
  int v7;
  ushort *v8;
  int v9;
  int v10;
  uint *v11;
  int result;

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v7 = a4;
  v8 = (ushort *)Function_2023790(80, 4u);
  Function_200b1b8_CallMsgDecrypt(*(ushort ***)(v4 + 184), v5, v8);
  Function_200c388(*(uint **)(v4 + 188), *(uint *)(v4 + 4 * *(uchar *)(v4 + 199) + 28), (int)v8);
  v9 = *(uchar *)(v4 + 199);
  v10 = v4 + 4 * v9;
  v11 = (uint *)(v4 + 8 * v9 + 248);
  *v11 = *(uint *)(v10 + 28);
  Function_20237bc_FreeMsg((int)v8, (int)v11);
  if ( v7 == 250 )
    *(uint *)(v4 + 8 * *(uchar *)(v4 + 199) + 252) = -3;
  else
    *(uint *)(v4 + 8 * *(uchar *)(v4 + 199) + 252) = v7;
  *(ushort *)(v4 + 2 * *(uchar *)(v4 + 199) + 560) = v6;
  result = *(uchar *)(v4 + 199) + 1;
  *(uchar *)(v4 + 199) = result;
  return result;
}

//----- (021F8090) --------------------------------------------------------
int __fastcall Function_21f8090(int result)
{
  *(uint *)(result + 208) = result + 248;
  *(uint *)(result + 212) = Function_21f819c;
  *(uint *)(result + 216) = 0;
  *(uint *)(result + 220) = result + 8;
  *(ushort *)(result + 224) = *(uchar *)(result + 199);
  *(ushort *)(result + 226) = 8;
  *(uchar *)(result + 228) = 1;
  *(uchar *)(result + 229) = 12;
  *(uchar *)(result + 230) = 2;
  *(uchar *)(result + 231) = *(uchar *)(result + 231) & 0xF0 | 1;
  *(uchar *)(result + 231) = *(uchar *)(result + 231) & 0xF | 0x10;
  *(uchar *)(result + 232) = *(uchar *)(result + 232) & 0xF0 | 0xF;
  *(uchar *)(result + 232) = *(uchar *)(result + 232) & 0xF | 0x20;
  *(ushort *)(result + 234) &= 0xFFF8u;
  *(ushort *)(result + 234) &= 0xFF87u;
  *(ushort *)(result + 234) = *(ushort *)(result + 234) & 0xFE7F | 0x80;
  *(ushort *)(result + 234) &= 0x81FFu;
  *(ushort *)(result + 234) &= 0x7FFFu;
  *(uint *)(result + 236) = result;
  return result;
}

//----- (021F819C) --------------------------------------------------------
uint __fastcall Function_21f819c(int a1)
{
  return Function_2001504(a1, 0x13u);
}

//----- (021F81A8) --------------------------------------------------------
int __fastcall Function_21f81a8(int a1, int a2)
{
  int v2;
  int result;
  int v4;
  int v5;

  v2 = a2;
  if ( *(uchar *)(a2 + 192) )
  {
    result = *(uchar *)(a2 + 192) - 1;
    *(uchar *)(a2 + 192) = result;
  }
  else
  {
    result = Function_200f2ac();
    if ( result )
    {
      v4 = Function_2001288(*(uint *)(v2 + 240));
      v5 = *(ushort *)(v2 + 638);
      Function_20014d0(*(uint *)(v2 + 240), (ushort *)(v2 + 638));
      if ( v5 != *(ushort *)(v2 + 638) )
        Function_2005748(0x5DCu);
      if ( v4 == -2 )
      {
        result = *(uchar *)(v2 + 195) & 1;
        if ( result == 1 )
        {
          Function_2005748(0x5DCu);
          **(ushort **)(v2 + 204) = -2;
          result = Function_21f8250(v2);
        }
      }
      else
      {
        result = -1;
        if ( v4 != -1 )
        {
          Function_2005748(0x5DCu);
          **(ushort **)(v2 + 204) = v4;
          result = Function_21f8250(v2);
        }
      }
    }
  }
  return result;
}

//----- (021F8250) --------------------------------------------------------
uint __fastcall Function_21f8250(int a1)
{
  int v1;
  int v2;
  uint v3;
  int v4;

  v1 = a1;
  Function_2005748(0x5DCu);
  Function_2001384(*(uint *)(v1 + 240), 0, 0);
  Function_200dc9c(*(uint *)(v1 + 220), 0);
  Function_201a8fc(v1 + 8);
  v3 = 0;
  v4 = v1;
  do
  {
    Function_20237bc_FreeMsg(*(uint *)(v4 + 28), v2);
    ++v3;
    v4 += 4;
  }
  while ( v3 < 0x27 );
  if ( (uint)*(uchar *)(v1 + 195) << 30 >> 31 == 1 )
    Function_200b190(*(ushort **)(v1 + 184));
  Call_RemoveTaskFromTaskList(*(int **)(v1 + 4));
  return free(v1);
}

//----- (021F82B8) --------------------------------------------------------
int __fastcall Function_5_21f82b8(int a1)
{
  int v1;
  int v2;
  int *v3;
  int *v4;
  char *v5;
  char v6;
  char v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;

  v1 = a1;
  v2 = *(uint *)(a1 + 128);
  v3 = (int *)ScriptHandler_GetSomeScriptAddresses(*(uint *)(a1 + 128), 0xFu);
  v4 = (int *)ScriptHandler_GetSomeScriptAddresses(v2, 0);
  v5 = *(char **)(v1 + 8);
  *(uint *)(v1 + 8) = v5 + 1;
  v6 = *v5;
  *(uint *)(v1 + 8) = v5 + 2;
  v7 = v5[1];
  v8 = ScriptHandler_LoadHWord(v1);
  v9 = ScriptHandler_CheckSaveParameter(*(uint *)(v1 + 128), v8);
  v10 = ScriptHandler_LoadHWord(v1);
  v11 = ScriptHandler_CheckLoadParameter(*(uint *)(v1 + 128), v10);
  v12 = Function_21f7a4c(v9);
  *v4 = Function_21dd250(
          v2,
          v6,
          v7,
          v11,
          *v3,
          word_2200CE6[6 * v12],
          HIBYTE(word_2200CE6[6 * v12]),
          dword_2200CE8[3 * v12],
          BYTE1(dword_2200CE8[3 * v12]));
  return 0;
}

//----- (021F8358) --------------------------------------------------------
int __fastcall Function_5_21f8358(int a1)
{
  int *v1;

  v1 = (int *)ScriptHandler_GetSomeScriptAddresses(*(uint *)(a1 + 128), 0);
  Function_21dd3a8(*v1);
  return 0;
}

//----- (021F8370) --------------------------------------------------------
int __fastcall Function_21f8370(int a1)
{
  int v1;
  int v2;
  uint *v3;
  uint *v4;
  int *v5;
  int v6;
  int result;

  v1 = a1;
  v2 = GetOverWorldData_VariableAreaAdresses(a1);
  v3 = (uint *)Function_2027860(v2);
  v4 = Function_2027f6c(v3, 10);
  v5 = (int *)malloc(4u, 284);
  Call_FillMemWithValue(v5, 0, 0x11Cu);
  *v5 = v1;
  v5[1] = (int)v4;
  v6 = 0;
  *(uint *)(*(uint *)(v1 + 4) + 36) = v5;
  do
  {
    result = Function_21f8508(v1, v6);
    if ( result == 1 )
      result = Function_21f8480(v5, v6);
    ++v6;
  }
  while ( v6 < 20 );
  return result;
}

//----- (021F83C0) --------------------------------------------------------
int __fastcall Function_21f83c0(int a1)
{
  int v1;
  int result;

  v1 = a1;
  free(*(uint *)(*(uint *)(a1 + 4) + 36));
  result = *(uint *)(v1 + 4);
  *(uint *)(result + 36) = 0;
  return result;
}

//----- (021F83D4) --------------------------------------------------------
int __fastcall Function_5_21f83d4(int a1, int a2, int a3, int a4, uint *a5)
{
  int v5;
  short *v6;
  int v7;
  int v8;
  int result;
  int v10;

  v5 = a1;
  v6 = &word_220192C;
  v7 = a2;
  v10 = a3;
  v8 = 0;
  do
  {
    if ( Function_21f851c(v7, v10, v6, v5) == 1 )
    {
      result = 1;
      *a5 = 1;
      return result;
    }
    ++v8;
    v6 += 12;
  }
  while ( v8 < 23 );
  result = 0;
  *a5 = 0;
  return result;
}

//----- (021F8410) --------------------------------------------------------
int __fastcall Function_21f8410(int a1, int a2, int a3, int a4)
{
  int v4;
  int v5;
  int v6;
  int v7;
  short *v8;
  int v9;
  int v10;
  int v12;
  int v13;

  v4 = a1;
  v12 = a2;
  v13 = a3;
  v5 = a4;
  v6 = GetOverWorldData_VariableAreaAdresses(a1);
  v7 = Function_2027860(v6);
  if ( Function_2027f80(v7) != 10 )
    return 0;
  v8 = &word_220192C;
  v9 = 0;
  while ( 1 )
  {
    if ( Function_21f851c(v12, v13, v8, v4) == 1 )
    {
      v10 = dword_22018DC[(ushort)*v8];
      if ( v10 != 10100 || !v5 )
        break;
    }
    ++v9;
    v8 += 12;
    if ( v9 >= 23 )
      return 0;
  }
  Function_203e880(v4, (ushort)v10, 0);
  return 1;
}

//----- (021F8480) --------------------------------------------------------
int __fastcall Function_21f8480(int **a1, int a2, int a3, int a4)
{
  short *v4;
  int v5;
  int *v6;
  int v7;
  int v8;
  int result;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;

  v16 = a4;
  v11 = a2;
  v13 = 0;
  v14 = 0;
  v15 = 0;
  v12 = 0;
  v4 = &word_220192C;
  v5 = dword_220188C[a2];
  v6 = *a1;
  v10 = (int)(a1 + 2);
  do
  {
    if ( (ushort)*v4 == v11 )
    {
      v7 = v10;
      v8 = 0;
      while ( *(ushort *)v7 )
      {
        ++v8;
        v7 += 12;
        if ( v8 >= 23 )
          goto LABEL_7;
      }
      *(ushort *)v7 = 1;
      *(uint *)(v7 + 4) = v5;
      *(ushort *)(v7 + 2) = Function_5_21e19cc(v6[41], v6[12], v5, (uint *)v4 + 1, &v13, v6[20]);
      *(uint *)(v7 + 8) = Function_5_21e18cc((uint *)v6[41], v5);
    }
LABEL_7:
    v4 += 12;
    result = v12 + 1;
    v12 = result;
  }
  while ( result < 23 );
  return result;
}

//----- (021F8508) --------------------------------------------------------
int __fastcall Function_21f8508(int a1, int a2)
{
  int v2;
  int v3;

  v2 = a2;
  v3 = LoadFlagAdress(*(uint *)(a1 + 12));
  return Function_206af6c(v3, 2, v2);
}

//----- (021F851C) --------------------------------------------------------
BOOL __fastcall Function_21f851c(int a1, int a2, ushort *a3, int a4)
{
  int v4;
  int v5;
  short *v6;

  v4 = a1;
  v5 = a2;
  v6 = (short *)(a3 + 8);
  return a3[1] == 1 && Function_21f8508(a4, *a3) == 1 && v5 >= v6[1] && v5 <= v6[3] && v4 >= *v6 && v4 <= v6[2];
}

//----- (021F8560) --------------------------------------------------------
int *__fastcall Function_21f8560(uint *a1)
{
  uint *v1;
  int *v2;
  int *v3;

  v1 = a1;
  v2 = Function_21df53c(a1, 108, 0, 0);
  v3 = v2;
  *v2 = (int)v1;
  Function_21f858c();
  return v3;
}

//----- (021F857C) --------------------------------------------------------
uint __fastcall Function_21f857c(int a1)
{
  int v1;

  v1 = a1;
  Function_21f85b0();
  return Function_5_21df554(v1);
}

//----- (021F858C) --------------------------------------------------------
int (__fastcall *__fastcall Function_21f858c(int a1))(uint *a1, int a2, uint a3, int a4)
{
  int v1;

  v1 = a1;
  Function_5_21dfb00(*(int **)a1, (uchar *)(a1 + 4), 0, 0x51u, 0);
  return Function_2073b70((int *)(v1 + 24), v1 + 4);
}

//----- (021F85B0) --------------------------------------------------------
uchar *__fastcall Function_21f85b0(int a1)
{
  return Function_207395c(a1 + 4);
}

//----- (021F85BC) --------------------------------------------------------
int *__fastcall Function_5_21f85bc(int a1, int a2, int a3, int a4, int a5, int a6, int a7)
{
  int v7;
  int v8;
  int v9;
  uint *v10;
  int *v11;
  int v12;
  int v13;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  uint *v20;
  int v21;
  int v22;
  int v23;
  int v24;
  int v25;

  v25 = a4;
  v7 = a2;
  v8 = a3;
  v22 = 0;
  v23 = 0;
  v9 = a1;
  v15 = a4;
  v24 = 0;
  v10 = (uint *)Function_205eb3c(a1);
  v16 = a5;
  v17 = a7;
  v18 = Function_21df578((int)v10);
  v19 = Function_21df55c();
  v20 = v10;
  v21 = v9;
  if ( a6 )
  {
    CopySprite70Struct(v10, &v22);
    Function_20630ac(v10, &dword_2201C10[3 * a7]);
  }
  else
  {
    GetSpriteSpriteListFirstSprite((int)v10);
    v11 = &dword_2201BC8[3 * a7];
    v12 = v11[1];
    v22 = dword_2201BC8[3 * a7] + (v7 << 16);
    v23 = v12 + (v8 << 16);
    v24 = v11[2] + (v15 << 16);
  }
  v13 = Function_2062758((int)v10, 2);
  return Function_5_21df72c(v18, dword_2201B54, &v22, a6, (int)&v16, v13);
}

//----- (021F8668) --------------------------------------------------------
int __fastcall Function_21f8668(int a1, int a2)
{
  int v2;
  int v3;
  uint *v4;
  uint *v5;
  int v6;
  uint *v7;
  int v8;
  uint *v9;
  int v10;
  int v11;

  v2 = a2;
  v3 = a1;
  v4 = (uint *)Function_20715bc(a1);
  v5 = (uint *)(v2 + 56);
  v6 = v4[1];
  *v5 = *v4;
  v5[1] = v6;
  v7 = (uint *)(v2 + 64);
  v8 = v4[3];
  *v7 = v4[2];
  v7[1] = v8;
  v9 = (uint *)(v2 + 72);
  v10 = v4[5];
  *v9 = v4[4];
  v9[1] = v10;
  *(ushort *)(v2 + 4) = *v4;
  *(uint *)(v2 + 44) = 4096;
  *(uint *)(v2 + 48) = 1024;
  *(uint *)(v2 + 52) = v4[1];
  v11 = *(short *)(v2 + 4);
  Function_21f8878();
  *(ushort *)(v2 + 8) = dword_2201B68[*(uint *)(v2 + 52)];
  *(ushort *)(v2 + 10) = 20;
  if ( Function_20715b4(v3) == 1 )
    *(uint *)v2 |= 2u;
  return 1;
}

//----- (021F86CC) --------------------------------------------------------
int __fastcall Function_21f86cc(int a1, int a2)
{
  uint *v2;
  int v4;
  int v5;
  int v6;

  v2 = *(uint **)(a2 + 72);
  v4 = 0;
  v5 = 0;
  v6 = 0;
  return Function_20630ac(v2, &v4);
}

//----- (021F86E4) --------------------------------------------------------
int __fastcall Function_21f86e4(uint *a1, int a2)
{
  int v2;
  uint *v3;
  int result;
  uint *v5;
  uint *v6;
  int v7;
  int v8;
  int v9;
  int *v10;
  uint v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;

  v2 = a2;
  v3 = a1;
  result = 2;
  v5 = *(uint **)(a2 + 72);
  v6 = *(uint **)(a2 + 76);
  if ( *(uint *)a2 & 2 )
  {
    *(ushort *)(a2 + 4) = LoadSpriteFace2Direction(*(uint *)(a2 + 72));
    *(uint *)(v2 + 52) = Function_205f108(v6);
    if ( *(short *)(v2 + 4) == -1 )
      ErrorHandler();
    v7 = *(uint *)(v2 + 44) + *(uint *)(v2 + 48);
    *(uint *)(v2 + 44) = v7;
    if ( v7 < 0x4000 )
    {
      if ( v7 <= 4096 )
      {
        *(uint *)(v2 + 44) = 4096;
        *(uint *)(v2 + 48) = -*(uint *)(v2 + 48);
      }
    }
    else
    {
      *(uint *)(v2 + 44) = 0x4000;
      *(uint *)(v2 + 48) = -*(uint *)(v2 + 48);
    }
    if ( !(*(uint *)v2 & 4) )
      Function_21f8878(*(uint *)(v2 + 52), *(short *)(v2 + 4), v2 + 12);
    if ( !(*(uint *)v2 & 0x10) )
      *(ushort *)(v2 + 8) = dword_2201B68[*(uint *)(v2 + 52)];
    result = 8;
    if ( !(*(uint *)v2 & 8) )
    {
      v8 = 3 * *(uint *)(v2 + 52);
      v9 = dword_2201C10[v8 + 1];
      v14 = dword_2201C10[v8];
      v15 = v9;
      v16 = dword_2201C10[v8 + 2];
      if ( *(uint *)v2 & 0x20 )
      {
        v14 += *(uint *)(v2 + 20);
        v15 += *(uint *)(v2 + 24);
        v16 += *(uint *)(v2 + 28);
      }
      else
      {
        v15 += *(uint *)(v2 + 44);
      }
      Function_20630ac(v5, &v14);
      CopySprite70Struct(v5, &v14);
      if ( *(uint *)v2 & 0x40 )
        v10 = (int *)(v2 + 32);
      else
        v10 = &dword_2201B80[3 * *(uint *)(v2 + 52)];
      v14 += *v10 + Function_201d1d4(*(ushort *)(v2 + 8)) * *(ushort *)(v2 + 10);
      v11 = Function_201d15c(*(ushort *)(v2 + 8));
      v12 = v15 + v10[1] + 0x8000 + v11 * *(ushort *)(v2 + 10);
      v15 += v10[1] + 0x8000 + v11 * *(ushort *)(v2 + 10);
      v13 = v16 + v10[2];
      v16 += v10[2];
      if ( *(uint *)v2 & 0x20 )
      {
        v14 += *(uint *)(v2 + 20);
        v15 = v12 + *(uint *)(v2 + 24);
        v16 = v13 + *(uint *)(v2 + 28);
      }
      else
      {
        v15 = v12 + *(uint *)(v2 + 44);
      }
      result = Function_20715d4(v3, &v14);
    }
  }
  return result;
}

//----- (021F8848) --------------------------------------------------------
int __fastcall Function_21f8848(uint *a1, ushort *a2)
{
  ushort *v2;
  uint *v3;
  int result;
  char v5;

  v2 = a2;
  if ( !(*(uint *)a2 & 1) )
  {
    v3 = (uint *)(*((uint *)a2 + 17) + 24);
    Function_20715e4(a1, &v5);
    Function_2073bf0(v3, (int *)&v5, v2 + 6);
  }
  result = v2[3] + 1;
  v2[3] = result;
  return result;
}

//----- (021F8878) --------------------------------------------------------
int __fastcall Function_21f8878(uint a1, int a2, ushort *a3)
{
  uint v3;
  int v4;
  ushort *v5;
  int *v6;
  int result;

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( a1 >= 6 )
    ErrorHandler();
  v6 = &dword_2201C58[8 * v3];
  *v5 = v6[2 * v4];
  v5[1] = HIWORD(v6[2 * v4]);
  v5[2] = v6[2 * v4 + 1];
  result = HIWORD(v6[2 * v4 + 1]);
  v5[3] = result;
  return result;
}

//----- (021F88A8) --------------------------------------------------------
int __fastcall Function_5_21f88a8(int a1)
{
  return Function_2071598(a1) + 12;
}

//----- (021F88B4) --------------------------------------------------------
int __fastcall Function_5_21f88b4(int a1, int a2, uint a3)
{
  int v3;
  uint v4;
  int v5;

  v3 = a2;
  v4 = a3;
  v5 = Function_2071598(a1);
  return Function_21f8878(v4, v3, (ushort *)(v5 + 12));
}

//----- (021F88CC) --------------------------------------------------------
uint *__fastcall Function_5_21f88cc(int a1, int a2)
{
  int v2;
  uint *result;

  v2 = a2;
  result = (uint *)Function_2071598(a1);
  *result |= v2;
  return result;
}

//----- (021F88DC) --------------------------------------------------------
uint *__fastcall Function_5_21f88dc(int a1, int a2)
{
  int v2;
  uint *result;

  v2 = a2;
  result = (uint *)Function_2071598(a1);
  *result &= ~v2;
  return result;
}

//----- (021F88F0) --------------------------------------------------------
int __fastcall Function_5_21f88f0(int a1)
{
  return Function_2071598(a1) + 20;
}

//----- (021F88FC) --------------------------------------------------------
int __fastcall Function_5_21f88fc(int a1)
{
  return Function_2071598(a1) + 32;
}

//----- (021F8908) --------------------------------------------------------
int __fastcall Function_5_21f8908(int a1, short a2)
{
  short v2;
  int result;

  v2 = a2;
  result = Function_2071598(a1);
  *(ushort *)(result + 8) = v2;
  return result;
}

